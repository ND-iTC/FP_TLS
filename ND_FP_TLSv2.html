<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<title>Network Device iTC Functional Package for Transport Layer Security (TLS)</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
<h1>Network Device iTC Functional Package for Transport Layer Security (TLS)</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Version: 1.0 draft<br>
Date: TBD<br></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_revision_history">Revision History</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Version</th>
<th class="tableblock halign-left valign-top">Date</th>
<th class="tableblock halign-left valign-top">Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First publication</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_contents">Contents</h3>
<div id="toc" class="toc">
<div id="toctitle" class="title"></div>
<ul class="sectlevel2">
<li><a href="#_revision_history">Revision History</a></li>
<li><a href="#_contents">Contents</a></li>
<li><a href="#_1_introduction">1 Introduction</a>
<ul class="sectlevel2">
<li><a href="#_1_1_acknowledgements">1.1 Acknowledgements</a></li>
<li><a href="#_1_2_overview">1.2 Overview</a></li>
<li><a href="#_1_3_terms">1.3 Terms</a>
<ul class="sectlevel3">
<li><a href="#_1_3_1_common_criteria_terms">1.3.1 Common Criteria Terms</a></li>
<li><a href="#_1_3_2_technical_terms">1.3.2 Technical Terms</a></li>
</ul>
</li>
<li><a href="#_1_4_compliant_targets_of_evaluation">1.4 Compliant Targets of Evaluation</a></li>
</ul>
</li>
<li><a href="#_2_conformance_claims">2 Conformance Claims</a></li>
<li><a href="#_3_security_functional_requirements">3 Security Functional Requirements</a>
<ul class="sectlevel2">
<li><a href="#_3_1_auditable_events_for_mandatory_sfrs">3.1 Auditable Events for Mandatory SFRs</a></li>
<li><a href="#_3_2_cryptographic_support_fcs">3.2 Cryptographic Support (FCS)</a></li>
</ul>
</li>
<li><a href="#_appendix_a_optional_requirements">Appendix A - Optional Requirements</a>
<ul class="sectlevel2">
<li><a href="#_a_1_strictly_optional_requirements">A.1 Strictly Optional Requirements</a></li>
<li><a href="#_a_2_objective_requirements">A.2 Objective Requirements</a></li>
<li><a href="#_a_3_implementation_based_requirements">A.3 Implementation-based Requirements</a></li>
</ul>
</li>
<li><a href="#_appendix_b_selection_based_requirements">Appendix B - Selection-based Requirements</a>
<ul class="sectlevel2">
<li><a href="#_b_1_auditable_events_for_selection_based_requirements">B.1 Auditable Events for Selection-based Requirements</a></li>
<li><a href="#_b_2_cryptographic_support_fcs">B.2 Cryptographic Support (FCS)</a>
<ul class="sectlevel3">
<li><a href="#_b_2_1_fcs_dtlsc_ext_1_dtls_client_protocol">B.2.1 FCS_DTLSC_EXT.1 DTLS Client Protocol</a></li>
<li><a href="#_b_2_2_fcs_dtlsc_ext_2_dtls_client_support_for_mutual_authentication">B.2.2 FCS_DTLSC_EXT.2 DTLS Client Support for Mutual Authentication</a></li>
<li><a href="#_b_2_3_fcs_dtlsc_ext_3_dtls_client_downgrade_protection">B.2.3 FCS_DTLSC_EXT.3 DTLS Client Downgrade Protection</a></li>
<li><a href="#_b_2_4_fcs_dtlsc_ext_4_dtls_client_support_for_renegotiation">B.2.4 FCS_DTLSC_EXT.4 DTLS Client Support for Renegotiation</a></li>
<li><a href="#_b_2_5_fcs_dtlsc_ext_5_dtls_client_support_for_session_resumption">B.2.5 FCS_DTLSC_EXT.5 DTLS Client Support for Session Resumption</a></li>
<li><a href="#_b_2_6_fcs_dtlsc_ext_6_dtls_client_tls_1_3_resumption_refinements">B.2.6 FCS_DTLSC_EXT.6 DTLS Client TLS 1.3 Resumption Refinements</a></li>
<li><a href="#_b_3_1_fcs_dtlss_ext_1_dtls_server_protocol">B.3.1 FCS_DTLSS_EXT.1 DTLS Server Protocol</a></li>
<li><a href="#_b_3_2_fcs_dtlss_ext_2_dtls_server_support_for_mutual_authentication">B.3.2 FCS_DTLSS_EXT.2 DTLS Server Support for Mutual Authentication</a></li>
<li><a href="#_b_3_3_fcs_dtlss_ext_3_dtls_server_downgrade_protection">B.3.3 FCS_DTLSS_EXT.3 DTLS Server Downgrade Protection</a></li>
<li><a href="#_b_3_4_fcs_dtlss_ext_4_dtls_server_support_for_renegotiation">B.3.4 FCS_DTLSS_EXT.4 DTLS Server Support for Renegotiation</a></li>
<li><a href="#_b_3_5_fcs_dtlss_ext_5_dtls_server_support_for_session_resumption">B.3.5 FCS_DTLSS_EXT.5 DTLS Server Support for Session Resumption</a></li>
<li><a href="#_b_3_6_fcs_dtlss_ext_6_dtls_server_dtls_1_3_resumption_refinements">B.3.6 FCS_DTLSS_EXT.6 DTLS Server DTLS 1.3 Resumption Refinements</a></li>
<li><a href="#_b_4_1_fcs_tlsc_ext_1_tls_client_protocol">B.4.1 FCS_TLSC_EXT.1 TLS Client Protocol</a></li>
<li><a href="#_b_4_2_fcs_tlsc_ext_2_tls_client_support_for_mutual_authentication">B.4.2 FCS_TLSC_EXT.2 TLS Client Support for Mutual Authentication</a></li>
<li><a href="#_b_4_3_fcs_tlsc_ext_3_tls_client_downgrade_protection">B.4.3 FCS_TLSC_EXT.3 TLS Client Downgrade Protection</a></li>
<li><a href="#_b_4_4_fcs_tlsc_ext_4_tls_client_support_for_renegotiation">B.4.4 FCS_TLSC_EXT.4 TLS Client Support for Renegotiation</a></li>
<li><a href="#_b_4_5_fcs_tlsc_ext_5_tls_client_support_for_session_resumption">B.4.5 FCS_TLSC_EXT.5 TLS Client Support for Session Resumption</a></li>
<li><a href="#_b_4_6_fcs_tlsc_ext_6_tls_client_tls_1_3_resumption_refinements">B.4.6 FCS_TLSC_EXT.6 TLS Client TLS 1.3 Resumption Refinements</a></li>
<li><a href="#_b_5_1_fcs_tlss_ext_1_tls_server_protocol">B.5.1. FCS_TLSS_EXT.1 TLS Server Protocol</a></li>
<li><a href="#_b_5_2_fcs_tlss_ext_2_tls_server_support_for_mutual_authentication">B.5.2 FCS_TLSS_EXT.2 TLS Server Support for Mutual Authentication</a></li>
<li><a href="#_b_5_3_fcs_tlss_ext_3_tls_server_downgrade_protection">B.5.3 FCS_TLSS_EXT.3 TLS Server Downgrade Protection</a></li>
<li><a href="#_b_5_4_fcs_tlss_ext_4_tls_server_support_for_renegotiation">B.5.4 FCS_TLSS_EXT.4 TLS Server Support for Renegotiation</a></li>
<li><a href="#_b_5_5_fcs_tlss_ext_5_tls_server_support_for_session_resumption">B.5.5 FCS_TLSS_EXT.5 TLS Server Support for Session Resumption</a></li>
<li><a href="#_b_5_6_fcs_tlss_ext_6_tls_server_tls_1_3_resumption_refinements">B.5.6 FCS_TLSS_EXT.6 TLS Server TLS 1.3 Resumption Refinements</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_appendix_c_extended_component_definitions">Appendix C - Extended Component Definitions</a>
<ul class="sectlevel3">
<li><a href="#_c_1_cryptographic_support_fcs">C.1 Cryptographic Support (FCS)</a></li>
<li><a href="#_c_1_1_fcs_tls_ext_tls_protocol">C.1.1 FCS_TLS_EXT TLS Protocol</a>
<ul class="sectlevel3">
<li><a href="#_c_2_1_fcs_dtlsc_ext_dtls_client_protocol">C.2.1 FCS_DTLSC_EXT DTLS Client Protocol</a></li>
<li><a href="#_c_2_1_fcs_dtlss_ext_dtls_server_protocol">C.2.1 FCS_DTLSS_EXT DTLS Server Protocol</a></li>
<li><a href="#_c_3_1_fcs_tlsc_ext_tls_client_protocol">C.3.1 FCS_TLSC_EXT TLS Client Protocol</a></li>
<li><a href="#_c_4_1_fcs_tlss_ext_tls_server_protocol">C.4.1 FCS_TLSS_EXT TLS Server Protocol</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#acronyms">Appendix D - Acronyms</a></li>
<li><a href="#_appendix_e_bibliography">Appendix E - Bibliography</a></li>
</ul>
</div>
</div>
<div class="sect1">
<h2 id="_1_introduction">1 Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_1_1_acknowledgements">1.1 Acknowledgements</h3>
<div class="paragraph">
<p>This Functional Package (FP) was developed by the Network Device international Technical Community (ND iTC) with representatives from industry, Government agencies, Common Criteria Test Laboratories, and members of academia.</p>
</div>
</div>
<div class="sect2">
<h3 id="_1_2_overview">1.2 Overview</h3>
<div class="paragraph">
<p>Transport Layer Security (TLS) and the closely-related Datagram TLS (DTLS) are cryptographic protocols designed to provide communications security over IP networks. Several versions of the protocol are in widespread use in software that provides functionality such as web browsing, email, instant messaging, and voice-over-IP (VoIP). Organizations use TLS to protect communications to their syslog servers. TLS is also used to protect communications between hosts and network infrastructure devices for administration. The underlying platform often provides the actual TLS implementation. The primary goal of the TLS protocol is to provide confidentiality and integrity of data transmitted between two communicating endpoints, as well as authentication of at least the server endpoint.</p>
</div>
<div class="paragraph">
<p>TLS supports many different methods for exchanging keys, encrypting data, and authenticating message integrity. These methods are dynamically negotiated between the client and server when the TLS connection is established. As a result, evaluating the implementation of both endpoints is typically necessary to provide assurance for the operating environment.</p>
</div>
<div class="paragraph">
<p>This "Network Device iTC Functional Package for Transport Layer Security" (short name "ND_iTC_TLS-PKG") defines functional requirements for the implementation of the TLS and DTLS protocols on Network Devices. The requirements are intended to improve the security of products by enabling their evaluation.</p>
</div>
</div>
<div class="sect2">
<h3 id="_1_3_terms">1.3 Terms</h3>
<div class="paragraph">
<p>The following sections list Common Criteria and technology terms used in this document.</p>
</div>
<div class="sect3">
<h4 id="_1_3_1_common_criteria_terms">1.3.1 Common Criteria Terms</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Assurance</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Grounds for confidence that a TOE meets the SFRs [CC].</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Base Protection Profile (Base-PP)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Protection Profile used as a basis to build a PP-Configuration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Collaborative Protection Profile (cPP)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Protection Profile developed by international technical communities and approved by multiple schemes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Common Criteria (CC)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Common Criteria for Information Technology Security Evaluation (International Standard ISO/IEC 15408).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Common Criteria Testing Laboratory</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Within the context of the Common Criteria Evaluation and Validation Scheme (CCEVS), an IT security evaluation facility accredited by the National Voluntary Laboratory Accreditation Program (NVLAP) and approved by the NIAP Validation Body to conduct Common Criteria-based evaluations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Common Evaluation Methodology (CEM)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Common Evaluation Methodology for Information Technology Security Evaluation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Distributed TOE</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A TOE composed of multiple components operating as a logical whole.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Extended Package (EP)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A deprecated document form for collecting SFRs that implement a particular protocol, technology, or functionality. See Functional Packages.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Functional Package (FP)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A document that collects SFRs for a particular protocol, technology, or functionality.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Operational Environment (OE)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hardware and software that are outside the TOE boundary that support the TOE functionality and security policy.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Protection Profile (PP)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An implementation-independent set of security requirements for a category of products.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Protection Profile Configuration (PP-Configuration)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A comprehensive set of security requirements for a product type that consists of at least one Base-PP and at least one PP-Module.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Protection Profile Module (PP-Module)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An implementation-independent statement of security needs for a TOE type complementary to one or more Base-PPs.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Security Assurance Requirement (SAR)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A requirement to assure the security of the TOE.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Security Functional Requirement (SFR)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A requirement for security enforcement by the TOE.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Security Target (ST)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A set of implementation-dependent security requirements for a specific
product.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Target of Evaluation (TOE)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The product under evaluation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>TOE Security Functionality (TSF)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The security functionality of the product under evaluation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>TOE Summary Specification (TSS)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A description of how a TOE satisfies the SFRs in an ST.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_1_3_2_technical_terms">1.3.2 Technical Terms</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Certificate Authority (CA)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Issuer of digital certificates.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Datagram Transport Layer Security (DTLS)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cryptographic network protocol, based on TLS, which provides communications security for datagram protocols.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Transport Layer Security (TLS)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cryptographic network protocol for providing communications security over a TCP/IP network.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_1_4_compliant_targets_of_evaluation">1.4 Compliant Targets of Evaluation</h3>
<div class="paragraph">
<p>The Target of Evaluation (TOE) in this Package is a product that acts as a (D)TLS client, a (D)TLS server, or both. This Package describes the security functionality of TLS and DTLS in terms of [CC].</p>
</div>
<div class="paragraph">
<p>The contents of this Package must be appropriately combined with a cPP, PP, or PP-Module. When this Package is instantiated by a cPP, PP, or PP-Module, the Package must include selection-based requirements in accordance with the selections or assignments indicated in the cPP, PP, or PP-Module. These may be expanded by the ST author.</p>
</div>
<div class="paragraph">
<p>The cPP, PP, or PP-Module which instantiates this Package must typically include the following components in order to satisfy dependencies of this Package. It is the responsibility of the cPP, PP, or PP-Module author who instantiates this Package to
ensure that dependence on these components is satisfied:<br></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Component</th>
<th class="tableblock halign-left valign-top">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_CKM.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">To support TLS ciphersuites that use RSA, DHE or ECDHE for key exchange, the cPP, PP, or PP-Module must include FCS_CKM.1 and specify the corresponding key generation algorithm.<br></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_CKM.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">To support TLS ciphersuites that use RSA, DHE or ECDHE for key exchange, the cPP, PP, or PP-Module must include FCS_CKM.2 and specify the corresponding algorithm.<br></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_COP.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">To support TLS ciphersuites that use AES for encryption and decryption, the cPP, PP, or PP-Module must include FCS_COP.1 (iterating as needed) and specify AES with corresponding key sizes and modes. To support TLS ciphersuites that use SHA for hashing, the cPP, PP, or PP-Module must include FCS_COP.1 (iterating as needed) and specify SHA with corresponding digest sizes.<br></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_RBG_EXT.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">To support random bit generation needed for the TLS handshake, the cPP, PP, or PP-Module must include FCS_RBG_EXT.1.<br></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FIA_X509_EXT.1/Rev, FIA_X509_EXT.1/ITT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">To support validation of certificates needed during TLS connection setup, the cPP, PP, or PP-Module must include FIA_X509_EXT.1/Rev and/or FIA_X509_EXT.1/ITT.<br></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FIA_X509_EXT.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">To support the use of X509 certificates for authentication in TLS connection setup, the cPP, PP, or PP-Module must include FIA_X509_EXT.2.<br></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An ST must identify the applicable version of the cPP, PP, or PP-Module and this Package in its conformance claims.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_2_conformance_claims">2 Conformance Claims</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1">Conformance Statement</dt>
<dd>
<p>An ST must claim exact conformance to this PP-Package, as defined in the CC and CEM addenda for Exact Conformance, Selection-based SFRs, and Optional SFRs (dated May 2017).</p>
</dd>
<dt class="hdlist1">CC Conformance Claims</dt>
<dd>
<p>This PP-Package is conformant to Parts 2 (extended) and 3 (conformant) of Common Criteria Version 3.1, Revision 5.</p>
</dd>
<dt class="hdlist1">PP Claim</dt>
<dd>
<p>This Functional Package does not claim conformance to any PP.
PP-Configurations do not require enumeration of Functional Packages; this Functional Package can be claimed in any
PP-Configuration that includes a cPP, PP, or PP-Module that permits the Functional Package to be claimed as part of it.</p>
</dd>
<dt class="hdlist1">Package Claim</dt>
<dd>
<p>This Functional Package does not claim conformance to any other Functional Packages.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_3_security_functional_requirements">3 Security Functional Requirements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes the security requirements which have to be fulfilled by the product under evaluation. Those requirements comprise functional components from Part 2 of [CC]. The following conventions are used for the completion of operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Refinement</strong> operation (denoted by <strong>bold text</strong> or <strong class="line-through">strikethrough text</strong>): Is used to add details to a requirement (including replacing an assignment with a more restrictive selection) or to remove part of the requirement that is made irrelevant through the completion of another operation, and thus further restricts a requirement.</p>
</li>
<li>
<p><strong>Selection</strong> (denoted by <em>italicized text</em>): Is used to select one or more options provided by the [CC] in stating a requirement.</p>
</li>
<li>
<p><strong>Assignment</strong> operation (denoted by <span class="assignable-content">italicized text</span>): Is used to assign a specific value to an unspecified parameter, such as the length of a password. Showing the value in square brackets indicates assignment.</p>
</li>
<li>
<p><strong>Iteration</strong> operation: Is indicated by appending the SFR name with a slash and unique identifier suggesting the purpose of the operation, e.g. "/EXAMPLE1."</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_3_1_auditable_events_for_mandatory_sfrs">3.1 Auditable Events for Mandatory SFRs</h3>
<div class="paragraph">
<p>The auditable events specified in this Functional Package are included in a Security Target if the incorporating cPP, PP, or PP-Module supports audit event reporting through FAU_GEN.1 and all other criteria in the incorporating cPP, PP, or PP-Module are met.</p>
</div>
<div class="paragraph text-center">
<p><strong>Table 1: Auditable Events for Mandatory Requirements</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Requirement</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Auditable Events</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Additional Audit Record Contents</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_TLS_EXT.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No events specified</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_3_2_cryptographic_support_fcs">3.2 Cryptographic Support (FCS)</h3>
<div class="paragraph">
<p><strong>FCS_TLS_EXT.1 TLS Protocol</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_TLS_EXT.1.1</strong> The TSF shall implement [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS as a client</em></p>
</li>
<li>
<p><em>TLS as a server</em></p>
</li>
<li>
<p><em>DTLS as a client</em></p>
</li>
<li>
<p><em>DTLS as a server</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>].</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 1</em></strong></p>
</div>
<div class="paragraph">
<p>If <em>TLS as a client is selected</em>, then the ST must include the requirements from FCS_TLSC_EXT.1 and FCS_TLSC_EXT.4.</p>
</div>
<div class="paragraph">
<p>If <em>TLS as a server is selected</em>, then the ST must include the requirements from FCS_TLSS_EXT.1 and FCS_TLSS_EXT.4.</p>
</div>
<div class="paragraph">
<p>If <em>DTLS as a client</em> is selected, then the ST must include the requirements from FCS_DTLSC_EXT.1 and FCS_DTLSC_EXT.4.</p>
</div>
<div class="paragraph">
<p>If <em>DTLS as a server</em> is selected, then the ST must include the requirements from FCS_DTLSS_EXT.1 and FCS_DTLSS_EXT.4.</p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_TLS_EXT.1</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the TSS to verify that the TLS and DTLS claims are consistent with
those selected in the SFR.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall ensure that the selections indicated in the ST are consistent with selections in the dependent components.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>There are no test activities for this SFR; the following information is provided as an overview of the expected functionality and test environment for all subsequent SFRs.</em></p>
</div>
<div class="paragraph">
<p><strong>Test Environment:</strong></p>
</div>
<div class="paragraph">
<p><em>Tests for TLS 1.2 and TLS 1.3 include examination of the handshake messages and behavior of the TSF when presented with unexpected or invalid messages.  For TLS 1.2 and below, previous versions of this Functional Package only required visibility of network traffic and the ability to modify a valid handshake message sent to the TSF.</em></p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="data:image/png;base64,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" alt="Figure1">
</div>
</div>
<div class="paragraph text-center">
<p><strong><em>Figure 1: Test environment for TLS 1.2 using network traffic visibility and control tools</em></strong></p>
</div>
<div class="paragraph">
<p><em>TLS 1.3 introduces the encryption of handshake messages subsequent to the server hello exchange which prevents visibility and control using midpoint capabilities. To achieve equivalent validation of TLS 1.3 requires the ability to modify the traffic underlying the encryption applied after the server hello message. This can be achieved by introducing additional control of the messages sent, and visibility of messages received by the test TLS client, (when validating TLS server functionality) or the test server (when validating TLS client functionality).</em></p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="data:image/png;base64,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" alt="Figure2">
</div>
</div>
<div class="paragraph text-center">
<p><strong><em>Figure 2:  Test environment for TLS 1.3 using custom endpoint capabilities for visibility and control</em></strong></p>
</div>
<div class="paragraph">
<p><em>Typically, a compliant TLS 1.3 library modified to provide visibility and control of the handshake messages prior to
encryption suffices for all tests. Such modification will require the test client, test server, or both to be validated.</em></p>
</div>
<div class="paragraph">
<p><em>Since validations of products supporting only TLS 1.2 are still expected under this Package, the test environment for TLS 1.2-only validations may include network sniffers and man-in-the-middle products that do not require such modifications to a compliant TLS 1.2 library. For consistency, a compliant TLS client (or TLS server) together with the network sniffers and man-in-the-middle capabilities will also be referred to as a test TLS client (or test TLS server, respectively) in the following evaluation activities.</em></p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="data:image/png;base64,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" alt="Figure3">
</div>
</div>
<div class="paragraph text-center">
<p><strong><em>Figure 3:  Combined test environment for TLS 1.2 and TLS 1.3 using both network tools and custom endpoint capabilities</em></strong></p>
</div>
</div>
</details>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_appendix_a_optional_requirements">Appendix A - Optional Requirements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As indicated in the introduction to this PP-Package, the baseline requirements (those that must be performed by the TOE) are contained in the body of this PP-Package. This appendix contains three other types of optional requirements that may be included in the ST, but are not required in order to conform to this PP-Package. However, applied modules, packages and/or use cases may refine specific requirements as mandatory.</p>
</div>
<div class="paragraph">
<p>The first type (A.1 Strictly Optional Requirements) are strictly optional requirements that are independent of the TOE implementing any function. If the TOE fulfills any of these requirements or supports a certain functionality, the vendor is encouraged to include the SFRs in the ST, but are not required in order to conform to this PP-Package.</p>
</div>
<div class="paragraph">
<p>The second type (A.2 Objective Requirements) are objective requirements that describe security functionality not yet widely available in commercial technology. The requirements are not currently mandated in the body of this PP-Package, but will be included in the baseline requirements in future versions of this PP-Package. Adoption by vendors is encouraged and expected as soon as possible.</p>
</div>
<div class="paragraph">
<p>The third type (A.3 Implementation-based Requirements) are dependent on the TOE implementing a particular function. If the TOE fulfills any of these requirements, the vendor must either add the related SFR or disable the functionality for the evaluated configuration.</p>
</div>
<div class="sect2">
<h3 id="_a_1_strictly_optional_requirements">A.1 Strictly Optional Requirements</h3>
<div class="paragraph">
<p>This PP-Package does not define any Strictly Optional requirements.</p>
</div>
</div>
<div class="sect2">
<h3 id="_a_2_objective_requirements">A.2 Objective Requirements</h3>
<div class="paragraph">
<p>This PP-Package does not define any Objective requirements.</p>
</div>
</div>
<div class="sect2">
<h3 id="_a_3_implementation_based_requirements">A.3 Implementation-based Requirements</h3>
<div class="paragraph">
<p>This PP-Package does not define any Implementation-based requirements.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_appendix_b_selection_based_requirements">Appendix B - Selection-based Requirements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As indicated in the introduction to this PP-Package, the baseline requirements (those that must be performed by the TOE or its underlying platform) are contained in the body of this PP-Package. There are additional requirements based on selections in the body of the PP-Package: if certain selections are made, then additional requirements below must be included.</p>
</div>
<div class="sect2">
<h3 id="_b_1_auditable_events_for_selection_based_requirements">B.1 Auditable Events for Selection-based Requirements</h3>
<div class="paragraph">
<p>The auditable events in the table below are included in a Security Target if both the associated requirement is included and the incorporating PP or PP-Module supports audit event reporting through FAU_GEN.1 and any other criteria in the incorporating cPP, PP, or PP-Module are met.  Note that, if "None" is not selected in the "Auditable Events" column, it should not be selected in the "Additional Audit Record Contents" column. Likewise, if "None" is selected in the "Auditable Events" column, it should also be selected in the "Additional Audit Record Contents" column.</p>
</div>
<div class="paragraph text-center">
<p><strong>Table 2: Auditable Events for Selection-based Requirements</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Requirement</th>
<th class="tableblock halign-left valign-top">Auditable Events</th>
<th class="tableblock halign-left valign-top">Additional Audit Record Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">FCS_DTLSC_EXT.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[selection: <em>Establishment/termination of a DTLS session, None</em>]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[selection: <em>Non-TOE endpoint of connection, None</em>]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">[selection: <em>Failure to establish a DTLS session, None</em>]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[selection: <em>Reason for failure, None</em>]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">[selection: <em>Failure to verify presented identifier, None</em>]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[selection: <em>Presented identifier and reference identifier, None</em>]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_DTLSC_EXT.2</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_DTLSC_EXT.3</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_DTLSC_EXT.4</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_DTLSC_EXT.5</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_DTLSC_EXT.6</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_DTLSS_EXT.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[selection: selection: <em>Failure to establish a DTLS session, None</em>]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[selection: <em>Reason for failure, None</em>]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_DTLSS_EXT.2</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_DTLSS_EXT.3</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_DTLSS_EXT.4</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_DTLSS_EXT.5</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_DTLSS_EXT.6</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">FCS_TLSC_EXT.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[selection: <em>Establishment/termination of a TLS session, None</em>]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[selection: <em>Non-TOE endpoint of connection, None</em>]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">[selection: <em>Failure to establish a DTLS session, None</em>]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[selection: <em>Reason for failure, None</em>]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">[selection: <em>Failure to verify presented identifier, None</em>]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[selection: <em>Presented identifier and reference identifier, None</em>]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_TLSC_EXT.2</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_TLSC_EXT.3</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_TLSC_EXT.4</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_TLSC_EXT.5</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_TLSC_EXT.6</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_TLSS_EXT.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[selection: selection: <em>Failure to establish a TLS session, None</em>]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[selection: <em>Reason for failure, None</em>]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_TLSS_EXT.2</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_TLSS_EXT.3</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_TLSS_EXT.4</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_TLSS_EXT.5</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_TLSS_EXT.6</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_b_2_cryptographic_support_fcs">B.2 Cryptographic Support (FCS)</h3>
<div class="sect3">
<h4 id="_b_2_1_fcs_dtlsc_ext_1_dtls_client_protocol">B.2.1 FCS_DTLSC_EXT.1 DTLS Client Protocol</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>The inclusion of this selection-based component depends upon selection in FCS_TLS_EXT.1.1.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1 DTLS Client Protocol</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.1</strong>  The TSF shall implement [selection: <em>DTLS 1.2 (RFC 6347), DTLS 1.3 (RFC 9147)</em>]
and no other DTLS version as a client that supports additional functionality for session renegotiation protection and [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>mutual authentication</em></p>
</li>
<li>
<p><em>supplemental downgrade protection</em></p>
</li>
<li>
<p><em>session resumption</em></p>
</li>
<li>
<p><em>no optional functionality</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>] and shall abort attempts by a server to negotiate all other DTLS versions.</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 2</em></strong></p>
</div>
<div class="paragraph">
<p><em>This SFR is claimed if "DTLS as a client" is selected in FCS_TLS_EXT.1.1.  Session renegotiation protection is required for both DTLS 1.2 and DTLS 1.3, and the ST must include the requirements from FCS_DTLSC_EXT.4. Within FCS_DTLSC_EXT.4 options for implementation of secure session renegotiation for DTLS 1.2, or rejecting renegotiation requests are claimed.</em></p>
</div>
<div class="paragraph">
<p><em>The ST author will claim DTLS 1.3 functionality if supported, and optional functionality as appropriate for the claimed versions.</em></p>
</div>
<div class="paragraph">
<p><em>If "mutual authentication" is selected, then the ST must additionally include the requirements from FCS_DTLSC_EXT.2.</em></p>
</div>
<div class="paragraph">
<p><em>If "supplemental downgrade protection" is selected, then the ST must additionally include the requirements from FCS_DTLSC_EXT.3.  This is claimed if DTLS 1.3 is supported, or if the product supports TLS 1.1 or below downgrade protection using the mechanism described in RFC 8446.  Note that TLS 1.1 or below downgrade protection in DTLS is used to notify a client that the server is capable of supporting DTLS 1.2 or DTLS 1.3, but that it received a client hello indicating maximum support for DTLS 1.0 (there is no DTLS version 1.1).</em></p>
</div>
<div class="paragraph">
<p><em>If "session resumption" is selected, then the ST must additionally include the requirements from FCS_DTLSC_EXT.5.</em></p>
</div>
<div class="paragraph">
<p><em>DTLS version numbers are denoted on the wire as the 1’s complement of the corresponding textual DTLS versions as described in Section 4.1 of RFC 6347. DTLS version 1.2 is 0xfefd; DTLS version 1.3 is 0xfefc.</em></p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.2</strong> The TSF shall be able to support the following TLS 1.2 ciphersuites: [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289 and RFC 8422</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 8422</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</em></p>
</li>
<li>
<p><em>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</em></p>
</li>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined RFC 5289</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_128_CBC_SHA as defined in RFC 5246</em></p>
</li>
<li>
<p><em>no TLS 1.2 ciphersuites</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>], the following PP-specific ciphersuites using pre-shared secrets: [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 8442</em></p>
</li>
<li>
<p><em>TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>TLS_RSA_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 8442</em></p>
</li>
<li>
<p><em>TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>TLS_RSA_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>no ciphersuites using pre-shared secrets</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>], and the following TLS 1.3 ciphersuites: [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS_AES_256_GCM_SHA384 as defined in RFC 8446</em></p>
</li>
<li>
<p><em>TLS_AES_128_GCM_SHA256 as defined in RFC 8446</em></p>
</li>
<li>
<p><em>[assignment: other TLS 1.3 ciphersuites]</em></p>
</li>
<li>
<p><em>no TLS 1.3 ciphersuites</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>offering the supported ciphersuites in a client hello message in preference order: [<em>assignment: list of supported ciphersuites</em>].</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 3</em></strong></p>
</div>
<div class="paragraph">
<p><em>DTLS uses TLS ciphersuites. The ST author should select the ciphersuites that are supported, and must select at least one ciphersuite for each DTLS version supported – TLS 1.2 ciphersuites for DTLS 1.2 and TLS 1.3 ciphersuites for DTLS 1.3.</em></p>
</div>
<div class="paragraph">
<p><em>The ST author should select the ciphersuites that are supported, and must select at least one ciphersuite for each DTLS version supported. The ciphersuites to be tested in the evaluated configuration are limited by this requirement. However, this requirement does not restrict the TOE&#8217;s ability to propose additional non-deprecated ciphersuites beyond the ones listed in this requirement in its client hello message as indicated in the ST. That is, the TOE may propose any ciphersuite not excluded by this element, but the evaluation will only test ciphersuites from the above list. It is necessary to limit the ciphersuites that can be used in an evaluated configuration administratively on the server in the test environment.</em></p>
</div>
<div class="paragraph">
<p><em>TLS 1.3 ciphersuites are claimed if support for DTLS 1.3 is claimed in FCS_DTLSC_EXT.1.1. The assignment of preference order provides an ordered list of all supported ciphersuites with the most preferred ciphersuites listed first. Ciphersuites listed in RFC 9151, “Commercial National Security Algorithm (CNSA) Suite Profile for TLS and DTLS 1.2 and 1.3” are preferred over all other ciphersuites, GCM ciphersuites are preferred over CBC ciphersuites, ECDHE preferred over RSA and DHE, and SHA-256 or SHA-384 over SHA-1.</em></p>
</div>
<div class="paragraph">
<p><em>Ciphersuites for TLS 1.2 are of the form TLS</em>(key exchange algorithm)<em>WITH</em>(encryption algorithm)<em>(message digest algorithm}, and are listed in the TLS parameters section of the internet assignments at iana.org.</em></p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.3</strong>  The TSF shall not offer ciphersuites indicating the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the null encryption component</p>
</li>
<li>
<p>support for anonymous servers</p>
</li>
<li>
<p>use of deprecated or export-grade cryptography including DES, 3DES, RC2, RC4, or IDEA for encryption</p>
</li>
<li>
<p>use of MD</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>and shall abort sessions where a server attempts to negotiate ciphersuites not enumerated in the client hello message.</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.4</strong>  The TSF shall be able to support the following DTLS client hello message extensions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>signature_algorithms extension (RFC 8446) indicating support for [selection:</p>
<div class="ulist">
<ul>
<li>
<p><em>ecdsa-secp384r1_sha384 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pkcs1_sha384 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pss_pss_sha384 (RFC8603)</em></p>
</li>
<li>
<p><em>rsa_pss_rsae_sha384 (RFC 8603)</em></p>
</li>
<li>
<p><em>[assignment: other non-deprecated signature algorithms]</em></p>
</li>
<li>
<p><em>no other signature algorithms</em></p>
<div class="paragraph">
<p>]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>the following other extensions: [selection:</p>
<div class="ulist">
<ul>
<li>
<p><em>signature_algorithms_cert extension (RFC 8446) indicating support for [selection:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>ecdsa-secp384r1_sha384 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pkcs1_sha384 (RFC8446)</em></p>
</li>
<li>
<p><em>rsa_pss_pss_sha384 (RFC 8603)</em></p>
</li>
<li>
<p><em>rsa_pss_rsae_sha384 (RFC 8603)</em></p>
</li>
<li>
<p><em>rsa_pkcs1_sha256 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pss_rsae_sha256 (RFC 8446)</em></p>
</li>
<li>
<p><em>[assignment: other non-deprecated signature algorithms]</em></p>
</li>
<li>
<p><em>no other signature algorithms</em></p>
<div class="paragraph">
<p>]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>supported_versions extension (RFC 8446) indicating support for TLS 1.3</em></p>
</li>
<li>
<p><em>supported_groups extension (RFC 7919, RFC 8446) indicating support for [selection:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>secp256r1</em></p>
</li>
<li>
<p><em>secp384r1</em></p>
</li>
<li>
<p><em>secp521r1</em></p>
</li>
<li>
<p><em>ffdhe2048(256)</em></p>
</li>
<li>
<p><em>ffdhe3072(257)</em></p>
</li>
<li>
<p><em>ffdhe4096(258)</em></p>
</li>
<li>
<p><em>ffdhe6144(259)</em></p>
</li>
<li>
<p><em>ffdhe8192(260)</em></p>
<div class="paragraph">
<p>]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>key_share extension (RFC 8446)</em></p>
</li>
<li>
<p><em>post_handshake_auth (RFC 8446), pre_shared_key (RFC 8446), and psk_key_exchange_mode (RFC 8446) indicating DHE or ECDHE mode</em></p>
</li>
<li>
<p><em>extended_master_secret extension (RFC 7627) [selection: enforcing, allow legacy] server support</em></p>
</li>
<li>
<p><em>no other extensions</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>] and shall not send the following extensions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>early_data</em></p>
</li>
<li>
<p><em>psk_key_exchange_mode indicating PSK only mode.</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong><em>Application Note 4</em></strong></p>
</div>
<div class="paragraph">
<p><em>DTLS uses TLS extensions.  If DTLS 1.3 is claimed in FCS_DTLSC_EXT.1.1, supported_versions, supported_groups, and key_share extensions are claimed in accordance with RFC 8446. If DTLS 1.3 is not claimed, supported_versions and key_share extensions are not claimed.  Other extensions may be supported; certain extensions may need to be claimed based on other SFR claims made.</em></p>
</div>
<div class="paragraph">
<p><em>If ECDHE ciphersuites are claimed in FCS_DTLSC_EXT.1.2, the supported_groups extension is claimed here with appropriate secp groups claimed. If DHE ciphersuites are claimed in FCS_DTLSC_EXT.1.2, it is preferred that the appropriate ffdhe groups be claimed here. In a subsequent version of this FP, support for ffdhe groups will be required whenever DHE ciphersuites are claimed.</em></p>
</div>
<div class="paragraph">
<p><em>When ‘other non-deprecated signature algorithms’ is claimed, the assignment will describe the standard signature and hash algorithms supported. MD5 and SHA-1 hashes are deprecated and are not included in the signature_algorithms or signature_algorithms_cert extensions.</em></p>
</div>
<div class="paragraph">
<p><em>If DTLS 1.2 is claimed in FCS_DTLSC_EXT.1.1 the extended_master_secret extension is claimed in accordance with RFC 7627.    If the TSF requires a DTLS 1.2 server to provide the extended_master_secret extension in its Server Hello message the ST author selects 'enforcing'.  If the TSF allows connections to a DTLS 1.2 server that does not provide the extended_master_secret extension in its Server Hello message, the ST author selects 'allow legacy'.</em></p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.5</strong>  The TSF shall be able to [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>verify that a presented identifier of name type: [selection:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>DNS name type according to RFC 6125</em></p>
</li>
<li>
<p><em>URI name type according to RFC 6125</em></p>
</li>
<li>
<p><em>SRV name type according to RFC 6125</em></p>
</li>
<li>
<p><em>Common Name conversion to DNS name according to RFC 6125</em></p>
</li>
<li>
<p><em>Directory name type according to RFC 5280</em></p>
</li>
<li>
<p><em>IPaddress name type according to RFC 5280</em></p>
</li>
<li>
<p><em>rfc822Name type according to RFC 5280</em></p>
</li>
<li>
<p><em>[assignment:  other name type]</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>interface with a client application requesting the DTLS channel to verify that a presented identifier</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>] matches a reference identifier of the requested DTLS server and shall abort the session if no match is found.</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 5</em></strong></p>
</div>
<div class="paragraph">
<p><em>The rules for verification identity are described in Section 6 of RFC 6125 and Section 7 of RFC 5280. The reference identifier is established by the user (e.g., entering a URL into a web browser or clicking a link), by configuration (e.g., configuring the name of a mail or authentication server), or by an application (e.g., a parameter of an API) depending on the product service. The client establishes all acceptable reference identifiers and interfaces with the DTLS implementation to provide acceptable reference identifiers, or to accept the presented identifiers as validated in the server’s certificate. If the product performs matching of the reference identifiers to the identifiers provided in the server’s certificate, the first option is claimed and all supported name types are claimed; if the product presents the certificate, or the presented identifiers from the certificate to the application, the second option is claimed.</em></p>
</div>
<div class="paragraph">
<p><em>In most cases where DTLS servers are represented by DNS-type names, the preferred method for verification is the Subject Alternative Name using DNS, URI, or Service Names. Verification using a conversion of the Common Name relative distinguished name from a DNS name type in the subject field is allowed for the purposes of backward compatibility.</em></p>
</div>
<div class="paragraph">
<p><em>The client should avoid constructing reference identifiers using wildcards. However, if the presented identifiers include wildcards, the client must follow the best practices regarding matching; these best practices are captured in the evaluation activity. If the TSF supports wildcards, and allows names with DNS portions containing internationalized names, the internationalized name does not match any wildcard, in accordance with RFC 6125 section 7.2.</em></p>
</div>
<div class="paragraph">
<p><em>Support for other name types is rare, but may be claimed for specific applications. If specified, the assignment includes both the RFC describing normalization and matching rules, and any refinements necessary to resolve options available in the RFC.</em></p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.6</strong>  The TSF shall not establish a trusted channel if the server certificate is invalid [selection:
<em>with no exceptions, except when override is authorized in the case where valid revocation information is not available</em>].</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 6</em></strong></p>
</div>
<div class="paragraph">
<p><em>A certificate used in a manner that does not support revocation checking should not advertise revocation information locations. Common methods to address this include revoking the issuing CA, resetting certificate pinning mechanisms, or removing entries from trust stores. Thus, a certificate that does not advertise revocation status information is considered to be not revoked and does not need to be processed via override mechanisms. Override mechanisms are for use with certificates with published revocation status information that is not accessible, whether temporarily or because the information cannot be accessed during the state of the TOE (e.g., for verifying signatures on boot code). The circumstances should be described by the ST author, who should indicate the override mechanism and conditions that apply to the override, including system state, user or admin actions, etc.</em></p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.7</strong>  The TSF shall [selection: <em>terminate the DTLS session, silently discard the record</em>] if a message received contains an invalid MAC or if decryption fails in the case of GCM and other AEAD ciphersuites.</p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_DTLSC_EXT.1</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall check the description of the implementation of this protocol in the TSS to ensure the supported DTLS versions, features, ciphersuites, and extensions are specified in accordance with RFC 6347 (DTLS 1.2) RFC 9147 (DTLS 1.3 and updates to DTLS 1.2) and as refined in DFCS_TLSC_EXT.1 as appropriate.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall verify that ciphersuites indicated in FCS_DTLSC_EXT.1.2 are included in the description, and that none of the following ciphersuites are supported: ciphersuites indicating 'NULL,' 'RC2,' 'RC4,' 'DES,' 'IDEA,' or 'TDES' in the encryption algorithm component, indicating 'anon,' or indicating MD5 or SHA in the message digest algorithm component.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall verify that the TLS implementation description includes the extensions as required in FCS_DTLSC_EXT.1.4.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall verify that the ST describes applications that use the DTLS functions and how they establish reference identifiers.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall verify that the ST includes a description of matching methods used for each supported name type to the supported application defined reference identifiers. The evaluator shall verify that the ST includes a description of wildcards recognized for each name type claimed in FCS_DTLSC_EXT.1.5 and shall verify that the matching rules meet or exceed best practices. In particular, the evaluator shall ensure that the matching rules are as restrictive as, or more restrictive than the following:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>DNS names: The ‘ * ’ character used in the complete leftmost label of a DNS name represents any valid name that has the same number of labels, and</em>
<em>that matches all remaining labels. The ‘ * ’ character must only be used in the leftmost complete label of a properly formatted DNS name. The ‘ * ’</em>  <em>must not be used to represent a public suffix, or in the leftmost label immediately following a public suffix.</em></p>
</li>
<li>
<p><em>URI or SRV names: The ‘ * ’ character can only occur in the domain name portion of the name represented as a DNS name. All restrictions for</em>
<em>wildcards in DNS names apply to the DNS portion of the name. URI host names presented as an IP address are matched according to IP address</em>
<em>matching rules – see best practices for IP addresses below. In accordance with RFC 6125, it is preferred that such URIs are presented a matching</em> <em>name of type IP address in the SAN.</em></p>
</li>
<li>
<p><em>IP addresses: RFC 5280 does not support IP address ranges as presented names, but indicates that presented names may be compared to IP address</em>
<em>ranges present in name constraints. If the TSF supports IP address ranges as reference identifiers, the reference identifier matches if the</em>
<em>presented name is in the range.  IP ranges in name constraints (including reference identifiers) should be presented in CIDR format.</em></p>
</li>
<li>
<p><em>RFC 2822 names: RFC 5280 and updates RFC 8398 and RFC 8399 do not support special indicators representing more than a single mailbox as a</em>
<em>presented name, but indicates that presented names may be compared to a single mailbox, ‘any’ email address at a host, or ‘any’ email address on</em>
<em>a domain (e.g., “example.com” matches any email address on the host example.com and “.example.com” matches any email address in the domain</em>
<em>example.com, but does not match email addresses at the host “example.com”). Such matching is prohibited for internationalized RFC 2822 names.</em></p>
</li>
<li>
<p><em>Embedded CN name types: The CN relative distinguished name of a DNS name type included in the subject field is not strongly typed. Attempts to</em>
 <em>match both the name type and wildcard specifications can result in matches not intended, and therefore, not authoritatively asserted by a</em> <em>certification authority. It is preferred that no matching of CN embedded names be supported, but if necessary for backward compatibility, the</em>
 <em>description should clearly indicate how different name types are interpreted in the matching algorithm. In particular, the ‘*’ character in a</em>
 <em>CN is not to be interpreted as representing more than a single entity unless the entirety of the RDN is properly formatted as a</em>
<em>DNS, URI, or SVR name, and represents a wildcard meeting best practices as described above.</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>The evaluator shall verify that the TSS describes the actions that take place if a message received from the DTLS server fails the integrity check. If both selections are chosen in FCS_DTLSC_EXT.1.7, the evaluator shall verify that the TSS describes when each method is used and whether the behavior is configurable.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall check the operational guidance to ensure that it contains instructions on configuring the product so that DTLS conforms to the description in the TSS and that it includes any instructions on configuring the version, ciphersuites, or optional extensions that are supported.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall verify that all configurable features for matching identifiers in certificates presented in the DTLS handshake to application specific reference identifiers are described.</em></p>
</div>
<div class="paragraph">
<p><em>If the ST indicates the behavior of the TSF on receiving a message from the DTLS server that fails the MAC integrity check is configurable, the evaluator shall verify that the guidance documentation describes instructions for configuring the behavior.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall perform the following tests:</em></p>
</div>
<div class="paragraph">
<p><em>Test 1: (supported configurations) For each supported version, and for each supported ciphersuite associated with the version:</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall establish a DTLS connection between the TOE and a test DTLS server that is configured to negotiate the tested version and ciphersuite in accordance with the RFC for the version.</em></p>
</div>
<div class="paragraph">
<p><em>[conditional, if the TSF supports DTLS 1.3 only]</em>
<em>The evaluator shall observe that the TSF presents a client hello with the highest version of DTLS 1.3 and shall observe that the supported version extension is included and contains the value 'fe fc' for DTLS 1.3.</em></p>
</div>
<div class="paragraph">
<p><em>[conditional, if the TSF supports both DTLS 1.3 and DTLS 1.2]</em>
<em>The evaluator shall observe that the TSF presents a client hello with the highest version of DTLS 1.2 or the legacy version (value 'fe fd') and shall observe that the supported version extension is included and contains the value 'fe fc' for DTLS 1.3.</em></p>
</div>
<div class="paragraph">
<p><em>[conditional, if the TSF supports DTLS 1.2 only]</em>
<em>The evaluator shall observe that the TSF presents a client hello with the highest version of DTLS 1.2 or the legacy version (value 'fe fd') and shall observe that the supported version extension is not included for DTLS 1.2.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall observe that the client hello indicates the supported ciphersuites in the order indicated, and that it includes only the extensions supported, with appropriate values, for that version in accordance with the requirement.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall observe that the TOE successfully completes the DTLS handshake.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>TOEs supporting DTLS 1.3, but allowing a server to negotiate DTLS 1.2, should include all ciphersuites and all extensions as required for either version. If such a TOE is configurable to support only DTLS 1.2, DTLS 1.3, or both DTLS 1.2 and DTLS 1.3, the test should be performed in each configuration – with advertised ciphersuites appropriate for the configuration.</em></p>
</div>
<div class="paragraph">
<p><em>The connection in the test may be established as part of the establishment of a higher-level protocol, e.g., as part of an EAP session.</em></p>
</div>
<div class="paragraph">
<p><em>It is sufficient to observe the successful negotiation of a ciphersuite to satisfy the intent of the test; it is not necessary to examine the characteristics of the encrypted traffic in an attempt to discern the ciphersuite being used (for example, that the cryptographic algorithm is 128-bit AES and not 256-bit AES).</em></p>
</div>
<div class="paragraph">
<p><em>Test 2: (obsolete versions) The evaluator shall perform the following tests:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) For each of DTLS version 1.0 and [conditional] DTLS version 1.2, the evaluator shall initiate a connection from the TOE to a test DTLS server that is configured to negotiate the obsolete version and observe that the TSF terminates the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., protocol version, insufficient security) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
<li>
<p><em>B) The evaluator shall attempt to establish a connection with a test DTLS server that is configured to send a server hello message indicating the selected version (referred to as the legacy version in RFC 8446) with a value corresponding to an undefined DTLS (legacy) version (e.g., 'fe fc') and observe that the TSF terminates the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., protocol version) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
<div class="paragraph">
<p><em>This is intended to test the TSF response to non-standard versions, including early proposals for ‘beta DTLS 1.3’ versions. RFC 8446 requires the Legacy version to have the value 'fe fd' and specifies DTLS 1.3 in the supported versions extension with the value 'fe fc'. While not a preferred approach, if continued support for a beta DTLS 1.3 version is desired and the TSF cannot be configured to reject such versions, another value (e.g.,  'fe fb') can be used. Implementations of non-standard versions are not tested.</em></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 3: (ciphersuites) The evaluator shall perform the following tests on handling unexpected ciphersuites using a test DTLS server sending handshake messages compliant with the negotiated version except as indicated in the test:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) (ciphersuite not offered) For each supported version, the evaluator shall attempt to establish a connection with a test DTLS server configured to negotiate the supported version and a ciphersuite not included in the client hello and observe that the TOE rejects the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
<div class="paragraph">
<p><em>This test is intended to test the TSF’s generic ability to recognize non-offered ciphersuites. If the ciphersuites in the client hello are configurable, the evaluator shall configure the TSF to offer a ciphersuite outside those that are supported and use that ciphersuite in the test. If the TSF ciphersuite list is not configurable, it is acceptable to use a named ciphersuite from the IANA TLS protocols associated with the tested version. Additional special cases of this test for special ciphersuites are performed separately.</em></p>
</div>
</li>
<li>
<p><em>B) (version confusion) For each supported version, the evaluator shall attempt to establish a connection with a test DTLS server that is configured to negotiate the supported version and a ciphersuite that is not associated with that version and observe that the TOE rejects the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
<div class="paragraph">
<p><em>This test is intended to test TLS 1.3 ciphersuites for a server negotiating DTLS 1.2. If DTLS 1.3 is supported, the test server negotiating DTLS 1.3 should select a TLS 1.2 ciphersuite supported by the TOE for DTLS 1.2 and matching the client’s supported groups and signature algorithm indicated by extensions in the DTLS 1.3 client hello. If the TOE is configurable to allow both DTLS 1.2 and DTLS 1.3 servers, the test server should use ciphersuites offered by the TSF in its client hello message.</em></p>
</div>
</li>
<li>
<p><em>C) (null ciphersuite) For each supported version, the evaluator shall attempt to establish a connection with a test DTLS server configured to negotiate the null ciphersuite (TLS_NULL_WITH_NULL_NULL) and observe that the TOE rejects the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure, insufficient security) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
<li>
<p><em>D) (anon ciphersuite) [conditional on the TSF supporting DTLS 1.2] The evaluator shall attempt to establish a DTLS 1.2 connection with a test DTLS server configured to negotiate a ciphersuite using the anonymous server authentication method and observe that the TOE rejects the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure, insufficient security) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
<li>
<p><em>E) (deprecated encryption algorithm) [conditional on the TSF supporting DTLS 1.2] For each deprecated encryption algorithm (NULL, RC2, RC4, DES, IDEA, and TDES), the evaluator shall attempt to establish a DTLS 1.2 connection with a test DTLS server configured to negotiate a ciphersuite using the deprecated encryption algorithm and observe that the TOE rejects the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>Test E) should still include a test for RC4 ciphersuites, even though DTLS does not support stream ciphers. The test only verifies that the TSF can reject such a negotiation from a test DTLS server, and does not require the use of the cipher.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure, insufficient security) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
<div class="paragraph">
<p><em>See IANA TLS parameters for available ciphersuites to be tested. The test ciphersuite should use supported cryptographic algorithms for as many of the other components as possible. For example, if the TSF only supports TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384, the test server could select TLS_ECDHE_PSK_WITH_NULL_SHA_384, TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5, TLS_ECDHE_RSA_WITH_RC4_128_SHA, TLS_DHE_DSS_WITH_DES_CBC_SHA, TLS_RSA_WITH_IDEA_CBC_SHA, and TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA.</em></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 4: (extensions) For each supported version indicated in the following tests, the evaluator shall establish a connection from the TOE with a test server negotiating the tested version and providing server handshake messages as indicated when performing the following tests for validating proper extension handling:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) (signature_algorithms) [conditional] If the TSF supports certificate-based server authentication, the evaluator shall perform the following tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>For each supported version, the evaluator shall initiate a DTLS session with a DTLS test server and observe that the TSF’s client hello includes the signature_algorithms extension with values in conformance with the ST.</em></p>
</li>
<li>
<p><em>ii)</em>
<em>[conditional] If DTLS 1.2 is supported and the TSF supports an ECDHE or DHE ciphersuite, the evaluator shall ensure the test DTLS server sends a compliant server hello message selecting DTLS 1.2 and one of the supported ECDHE or DHE ciphersuites, a compliant server certificate message, and a key exchange message signed using a signature algorithm and hash combination not included in the client’s hello message (e.g., RSA with SHA-1). The evaluator shall observe that the TSF terminates the handshake.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure, illegal parameter, decryption error) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
<li>
<p><em>iii)</em>
<em>[conditional] If DTLS 1.3 is supported, the evaluator shall configure the test DTLS server to respond to the TOE with a compliant server hello message selecting DTLS 1.3 and a server certificate message, but then also sends a certificate verification message that uses a signature algorithm method not included in the signature_algorithms extension. The evaluator shall observe that the TSF terminates the DTLS handshake.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure, illegal parameter, bad certificate, decryption error) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
<li>
<p><em>iv)</em>
<em>[conditional] For all supported versions for which signature_algorithms_cert is not supported, the evaluator shall ensure the test DTLS server sends a compliant server hello message for the tested version and a server certificate message containing a valid certificate that represents the test DTLS server, but which is signed using a signature and hash combination not included in the TSF’s signature_algorithms extension (e.g., a certificate signed using RSA and SHA-1). The evaluator shall observe that the TSF terminates the DTLS session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., unsupported certificate, bad certificate, decryption error, handshake failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
<div class="paragraph">
<p><em>Certificate-based server authentication is required unless the TSF only supports DTLS with shared PSK.  For DTLS 1.2, this is the case if only TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 8442, TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 5487, TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 8442, or TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 5487, are supported. For DTLS 1.3, this is the case if only PSK handshakes are supported.</em></p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>B) (signature_algorithms_cert) [conditional] If signature_algorithms_cert is supported, then for each version that uses the signature_algorithms_cert extension, the evaluator shall ensure that the test DTLS server sends a compliant server hello message selecting the tested version and indicating certificate-based server authentication.</em></p>
<div class="paragraph">
<p><em>The evaluator shall ensure that the test DTLS server forwards a certificate message containing a valid certificate that represents the test DTLS server, but which is signed by a valid Certification Authority using a signature and hash combination not included in the TSF&#8217;s signature_algorithms_cert extension (e.g., a certificate signed using RSA and SHA-1). The evaluator shall confirm the TSF terminates the session.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>Support for certificate-based authentication is assumed if the signature_algorithms_cert is supported. For DTLS 1.2, a non-PSK ciphersuite, or one of TLS_RSA_PSK_WITH_AES_256_GCM_SHA384 or TLS_RSA_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 5487 is used to indicate certificate-based server authentication. For DTLS 1.3, the test server completes a full handshake, even if a PSK is offered to indicate certificate-based server authentication. If the TSF only supports shared PSK authentication, this test is not performed.</em></p>
</div>
<div class="paragraph">
<p><em>For DTLS 1.3, the server certificate message is encrypted. The evaluator will configure the test DTLS server with the indicated certificate and ensure that the certificate is indeed sent by observing the buffer of messages to be encrypted, or by inspecting one or both sets of logs from the TSF and test DTLS server.</em></p>
</div>
<div class="paragraph">
<p><em>It is preferred that the TSF sends a fatal error alert message (e.g., unsupported certificate, bad certificate, decryption error, handshake failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
<li>
<p><em>C) (TLS 1.2 extended master secret extension) [conditional] If the TSF supports DTLS 1.2 the evaluator shall perform the following tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>The evaluator shall initiate a DTLS 1.2 session with a test DTLS server.  The evaluator shall observe that the TSF’s client hello includes the extended master secret extension in accordance with RFC 7627.</em></p>
</li>
<li>
<p><em>ii)</em>
<em>[conditional]</em>
<em>If the ST author selected 'enforcing server' support, the evaluator shall initiate a DTLS 1.2 session with a test DTLS server configured to compute a master secret according to RFC 5246, section 8. The evaluator shall verify the test DTLS server does not include the extended master secret extension in its server hello. The evaluator shall observe that the TSF terminates the session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>D) (supported_groups) (DTLS 1.2 only – for DTLS 1.3, testing is combined with testing of the keyshare extension)</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>For each supported group, the evaluator shall initiate DTLS session with a compliant test DTLS 1.2 server supporting RFC 7919. The evaluator shall ensure that the test DTLS server is configured to select DTLS 1.2 and a ciphersuite using the supported group. The evaluator shall observe that the TSF’s client hello lists the supported groups as indicated in the ST, and that the TSF successfully establishes the DTLS session.</em></p>
</li>
<li>
<p><em>ii)</em>
<em>[conditional on DTLS 1.2 support for ECDHE ciphersuites] The evaluator shall initiate a DTLS session with a test DTLS server that is configured to use an explicit version of a named EC group supported by the client. The evaluator shall ensure that the test DTLS server key exchange message includes the explicit formulation of the group in its key exchange message as indicated in RFC 4492 section 5.4. The evaluator shall confirm that the TSF terminates the session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., illegal parameter) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 5: (DTLS 1.3 extensions) [conditional] If the TSF supports DTLS 1.3, the evaluator shall perform the following tests. For each test, the evaluator shall observe that the TSF’s client hello includes the supported versions extension with the value 'fe fc' indicating DTLS 1.3:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) (supported versions) The evaluator shall initiate DTLS 1.3 sessions in turn from the TOE to a test DTLS server configured as indicated in the sub-tests below:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>The evaluator shall configure the test DTLS server to include the supported versions extension in the server hello containing the value '03 03.' The evaluator shall observe that the TSF terminates the DTLS session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., illegal parameter, handshake failure, protocol version) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall  observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
<li>
<p><em>ii)</em>
<em>The evaluator shall configure the test DTLS server to include the supported versions extension in the server hello containing the value 'fe fc' and complete a compliant DTLS 1.3 handshake. The evaluator shall observe that the TSF completes the DTLS 1.3 handshake successfully.</em></p>
</li>
<li>
<p><em>iii)</em>
<em>[conditional] If the TSF is configurable to support both DTLS 1.2 and DTLS 1.3, the evaluator shall follow operational guidance to configure this behavior. The evaluator shall ensure that the test DTLS server sends a DTLS 1.2 compliant server handshake and observe that the server random does not incidentally include any downgrade messaging. The evaluator shall observe that the TSF completes the DTLS 1.2 handshake successfully.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>Enhanced downgrade protection defined in RFC 8446 is optional, and if supported, is tested separately. The evaluator may configure the test server’s random, or may repeat the test until the server’s random does not match a downgrade indicator.</em></p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>B) (supported groups, key shares) The evaluator shall initiate DTLS 1.3 sessions in turn with a test DTLS server configured as indicated in the following sub-tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>For each supported group, the evaluator shall configure the compliant test DTLS 1.3 server to select a ciphersuite using the group. The evaluator shall observe that the TSF sends an element of the group in its client hello key shares extension (after a hello retry message from the test server, if the key share for the group is not included in the initial client hello). The evaluator shall ensure the test DTLS server sends an element of the group in its server hello and observes that the TSF completes the DTLS handshake successfully.</em></p>
</li>
<li>
<p><em>ii)</em>
<em>For each supported group, the evaluator shall modify the server hello sent by the test DTLS server to include an invalid key share value claiming to be an element the group indicated in the supported groups extension. The evaluator shall observe that the TSF terminates the DTLS session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., illegal parameter) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
<div class="paragraph">
<p><em>For DHE ciphersuites, a zero value, or a value greater or equal to the modulus is not a valid element. For ECDHE groups, an invalid point contains x and y coordinates of the correct size, but represents a point not on the curve. The evaluator can construct such an invalid point by modifying a byte in the y coordinate of a valid point and verify that the coordinates do not satisfy the curve equation.</em></p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>A) (PSK support) [conditional] If the TSF supports pre-shared keys, the evaluator shall follow the operational guidance to use pre-shared keys, shall establish a pre-shared key between the TSF and the test DTLS server, and initiate DTLS 1.3 sessions in turn between the TSF and the test DTLS server configured as indicated in the following sub-tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>The evaluator shall configure the TSF to use the pre-shared key and ensure that the test DTLS server functions as a compliant DTLS 1.3 server. The evaluator shall observe that the TSF’s client hello includes the pre_shared_key extension with the valid PSK indicator shared with the test server. The evaluator shall also observe that the TSF’s client hello also includes the psk_key_exchange_mode and the post_handshake_auth extensions and that the psk_key_exchange_mode indicates one or more of DHE or ECDHE modes but does not include the PSK-only mode. The evaluator shall observe that the TSF completes the DTLS 1.3 handshake successfully in accordance with RFC 8446, to include the TSF sending appropriate key shares for one or more of the supported groups.</em></p>
<div class="paragraph">
<p><em>Once the handshake is successful, the evaluator shall cause the test DTLS server to send a certificate request and observe that the TSF provides a certificate message and certificate verify message.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It may be necessary to complete a standard handshake and send a new-ticket message from the test DTLS server to establish a pre-shared key, or it might be possible to configure the pre-shared key manually via out-of-band mechanisms. This can be performed in conjunction with other testing that is not tested as part of this SFR. It is not required at this time to support emerging standards on establishing PSK, but as such standards are finalized, this FP may be updated to require such support.</em></p>
</div>
<div class="paragraph">
<p><em>DTLS messages after the handshake are encrypted so it may not be possible to observe the certificate and certificate verify messages sent by the TSF directly. The evaluator may need to configure the test DTLS server to use an application that requires post-handshake client authentication and terminates the session or otherwise has an observable effect if the certificate is not provided.</em></p>
</div>
</li>
<li>
<p><em>ii)</em>
<em>The evaluator shall attempt to configure the TSF to send early data. If there is no indication from the TSF that this is blocked, the evaluator shall repeat test i) with the TSF so configured and observe that the TSF does not send application data prior to receiving the server hello.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>Early data will be encrypted under the PSK and received by the test DTLS server prior to it sending a server hello message.</em></p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 6: (corrupt finished message) For each supported version, the evaluator shall initiate a DTLS session from the TOE to a test DTLS server that sends a compliant set of server handshake messages, except for sending a modified finished message (modify a byte of the finished message that would have been sent by a compliant server). The evaluator shall observe that the TSF terminates the session and does not complete the handshake by observing that the TSF does not send application data provided to the DTLS channel.</em></p>
</div>
<div class="paragraph">
<p><em>Test 7: (missing finished message) For each supported version, the evaluator shall initiate a session from the TOE to a test DTLS server providing a compliant handshake, except for sending a random DTLS message (the five byte header indicates a correct DTLS message for the negotiated version, but not indicating a finished message) as the final message. The evaluator shall observe that the TSF terminates the session and does not send application data.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., decryption error) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
<div class="paragraph">
<p><em>For DTLS 1.2, the modified message is sent after the change_cipher_spec message. For DTLS 1.3, the modified message is sent as the last message of the server’s second flight of messages.</em></p>
</div>
<div class="paragraph">
<p><em>Test 8: (unexpected/corrupt signatures within handshake) The evaluator shall perform the following tests, according to the versions supported.</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) [conditional] If DTLS 1.2 is supported and the TSF supports ECDSA or DSA ciphersuites, the evaluator shall initiate a DTLS session with a compliant test DTLS server and modify the signature in the server key exchange. The evaluator shall observe that the TSF terminates the session with a fatal alert message (e.g., decrypt error, handshake error).</em></p>
</li>
<li>
<p><em>B) [conditional] If DTLS 1.3 is supported the evaluator shall initiate a DTLS session between the TOE and a test DTLS server that is configured to send a compliant server hello message, encrypted extension message, and certificate message, but will send a certificate verify message with an invalid signature (e.g., by modifying a byte from a valid signature). The evaluator shall confirm that the TSF terminates the session with a fatal error alert message (e.g., bad certificate, decrypt error, handshake error).</em></p>
</li>
<li>
<p><em>C) [conditional] If DTLS 1.2 is included in the ST and the TSF supports both RSA and ECDSA methods in the signature_algorithm (or, if supported, the signature_algorithms_cert) extension, and if the TSF supports one or more DTLS 1.2 ciphersuites indicating each of the RSA and ECDSA methods in its signature components, the evaluator shall choose two ciphersuites: one indicating RSA signature (cipher 1) and one indicating an ECDSA signature (cipher 2). The evaluator shall then establish two certificates that are trusted by the TOE: one representing the test DTLS 1.2 server using an RSA signature (cert 1) and one representing the test DTLS 1.2 server using an ECDSA signature (cert 2). The evaluator shall initiate a DTLS session between the TOE and the test DTLS 1.2 server that is configured to select cipher 1 and to send cert 2. The evaluator shall verify that the TSF terminates this DTLS session. The evaluator shall then initiate a DTLS session between the TOE and the test DTLS 1.2 server that is configured to select cipher 2 and to send cert 1. The evaluator shall verify that the TSF also terminates this DTLS session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., bad certificate, decryption error, handshake failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 9: [conditional] If the TSF supports certificate-based server authentication, then for each supported version, the evaluator will initiate a DTLS session from the TOE to the compliant test DTLS server configured to negotiate the tested version, and to authenticate using a certificate trusted by the TSF as specified in the following:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) (certificate extended key usage purpose) The evaluator shall send a server certificate that contains the Server Authentication purpose in the ExtendedKeyUsage extension and verify that a connection is established. The evaluator shall repeat this test using a different certificate that is otherwise valid and trusted but lacks the Server Authentication purpose in the ExtendedKeyUsage extension and observe the TSF terminates the session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>This test may be performed as part of certificate validation testing FIA_X509_EXT.1/Rev or FIA_X509_EXT.1/ITT.</em></p>
</div>
<div class="paragraph">
<p><em>It is preferred that the TSF sends a fatal error alert message (e.g., bad certificate, decryption error, handshake failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
<div class="paragraph">
<p><em>Ideally, the two certificates should be similar in regards to structure, the types of identifiers used, and the chain of trust.</em></p>
</div>
</li>
<li>
<p><em>B) (certificate identifiers) For each supported method of matching presented identifiers, and for each name type for which the TSF parses the presented identifiers from the server certificate for the method, the evaluator shall establish a valid certificate trusted by the TSF to represent the test server using only the tested name type. The evaluator shall perform the following sub-tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>The evaluator shall prepare the TSF as necessary to use the matching method and establish reference identifiers for the test server for the tested name type. The evaluator shall ensure the test DTLS server sends a certificate with a matching name of the tested name type and observe that the TSF completes the connection.</em></p>
</li>
<li>
<p><em>ii)</em>
<em>The evaluator shall prepare the TSF as necessary to use the matching method and establish reference identifiers that do not match the name representing the test server. The evaluator shall ensure the test DTLS server sends a certificate with a name of the type tested, and observe the TSF terminates the session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., bad certificate, unknown certificate) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
<li>
<p><em>iii)</em>
<em>[conditional] If the TSF supports wildcards for a DNS, URI, or SVR name type, the evaluator shall prepare the TSF as necessary to use the matching method for the name type, and establish a reference identifier.  The evaluator shall establish a certificate for the test server that includes a wildcard name for the DNS portion of the appropriate name type which matches the reference identifier. The evaluator shall ensure the DTLS server sends the certificate containing the wildcard name of the type tested, and observe that the TSF completes the connection.</em></p>
</li>
<li>
<p><em>iv)</em>
<em>[conditional] If the TSF supports a DNS, URI, or SVR name type, but does not support wildcards (in general, or specifically for internationalized names of the specified type), the evaluator shall prepare the TSF as necessary to use the matching method and establish a reference identifier that matches a wildcard name for the DNS portion of the appropriate name type, in accordance with the appropriate RFC, in a certificate representing the server. The evaluator shall ensure the DTLS server sends the certificate containing the wildcard name of the type tested, and observe that the TSF terminates the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>If the TSF&#8217;s ability to support wildcard certificates is configurable, both iii) iv) and  are performed under the appropriate configuration. This test is required if the TSF supports internationalized names of the specified type – in this case, the reference identifier only includes an internationalized encoding in the leftmost label. The certificate used is intended to match the certificate as if wildcards were supported and if the wildcard extended to internationalized names.</em></p>
</div>
</li>
<li>
<p><em>v)</em>
<em>[conditional] If the TSF supports wildcards for a DNS, URI, or SVR name type, the evaluator shall prepare the TSF as necessary to use the matching method. The evaluator shall establish a reference identifier and a certificate for the server as indicated in each of the subtests described below. The evaluator shall in turn, ensure the DTLS server sends the certificate associated with the reference identifier and observe that the TSF terminates the session.</em></p>
<div class="ulist">
<ul>
<li>
<p><em>1)</em>
<em>The reference identifier contains a DNS portion with two labels, and the certificate includes a name whose DNS portion includes a matching rightmost label and a wildcard in the leftmost label.</em></p>
</li>
<li>
<p><em>2)</em>
<em>The reference identifier contains a DNS portion with four labels, and the certificate includes a name whose DNS portion includes two rightmost labels matching the reference identifier, and a wildcard in the third (leftmost) label.</em></p>
</li>
<li>
<p><em>3)</em>
<em>The reference identifier contains a DNS portion with three labels, and the certificate includes a name whose DNS portion includes two rightmost labels matching the reference identifier, and a wildcard in the third (leftmost) label.</em></p>
</li>
</ul>
</div>
</li>
<li>
<p><em>vi)</em>
<em>[conditional] If the TSF supports wildcards and supports embedded DNS, URI, or SVR name types in the CN, then for each supported name type, the evaluator shall repeat iii), iv) and v) using certificates with the prescribed name embedded in the CN.</em></p>
</li>
<li>
<p><em>vii)</em>
<em>[conditional] If the TSF supports IP addresses as an embedded name type in the CN, the evaluator shall establish an IP address as a reference identifier and establish a certificate with a valid DNS name in the subject field, including a CN whose value is the digital formatting of the octets of the reference identifier. The evaluator shall ensure the server sends the certificate and observe that TSF successfully completes the session.</em></p>
</li>
<li>
<p><em>viii)</em>
<em>[conditional] If the TSF supports IP addresses and any embedded name type in the CN, the evaluator shall establish an IP address as a reference identifier and establish a certificate with a valid DNS name in the subject field, including a CN whose value is the digital formatting of the octets of the reference identifier (as in vii) except that one of the octets is replaced by the ‘*’ character. The evaluator shall ensure the server sends the certificate and observe that the TSF terminates the session.</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 10: (mixed identifiers)[conditional] If the TSF supports a name matching method where the TSF performs matching of both CN-encoded name types and SAN names of the same type, then for each such method, and for each such name type, the evaluator shall establish a valid certificate trusted by the TSF to represent the test server using one name for the CN-encoded name type and a different name for the SAN name type The evaluator shall perform the following tests:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>The evaluator shall follow the operational guidance to configure the TSF to use the name matching method and establish reference identifiers matching only the SAN. The evaluator shall ensure that the test server sends the certificate with the matching SAN and non-matching CN-encoded name, and observe that the TSF completes the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>Configuration of the TSF may depend on the application using DTLS.</em></p>
</div>
</li>
<li>
<p><em>ii)</em>
<em>The evaluator shall follow the operational guidance to configure the TSF to use the name matching method and establish reference identifiers matching only the CN-encoded name. The evaluator shall ensure that the test server sends the certificate with the matching SAN name and non-matching CN-encoded name, and observe that the TSF terminates the session.</em></p>
<div class="paragraph">
<p><em>It is preferred that the TSF sends a fatal error alert message (e.g., bad certificate, unknown certificate) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert)</em></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 11: (empty certificate) The evaluator shall configure the test DTLS server to supply an empty certificate message and verify that the TSF terminates the session.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., bad certificate, unknown certificate) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
<div class="paragraph">
<p><em>Test 12: (invalid certificate) [conditional] If validity exceptions are supported, then for each exception for certificate validity supported, the evaluator shall configure the TSF to allow the exception and ensure the test DTLS server sends a certificate that is valid and trusted, except for the allowed exception. The evaluator shall observe that the TSF completes the session.</em></p>
</div>
<div class="paragraph">
<p><em>Without modifying the TSF configuration, the evaluator shall initiate a new session with the test DTLS server that includes an additional validation error, and observe that the TSF terminates the session.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., decode error, bad certificate) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
<div class="paragraph">
<p><em>The intent of this test is to verify the scope of the exception processing. If verifying certificate status information is claimed as an exception, then this test will verify that a DTLS session succeeds when all supported methods for obtaining certificate status information is blocked from the TSF, to include removing any status information that might be cached by the TSF. If the exception is limited to specific certificates (e.g., only leaf certificates are exempt, or only certain leaf certificates are exempt) the additional validation error could be unavailable revocation information for a non-exempt certificate (e.g., revocation status information from an intermediate CA is blocked for the issuing CA of an exempt leaf certificate, or revocation information from the issuing CA is blocked for a non-exempt leaf certificate). If the only option for the exception is for all revocation information for all certificates, another validation error from FIA_X509_EXT.1/Rev or FIA_X509_EXT.1/ITT (e.g., certificate expiration, extended key usage, etc.) may be used.</em></p>
</div>
<div class="paragraph">
<p><em>Test 13: For each version supported, the evaluator shall establish a connection using a compliant handshake negotiating the version. The evaluator will then cause the test server to send application data with at least one byte in a record message modified from what a compliant test server would send, and verify that the client discards the record or terminates the DTLS session as described in the TSS. If multiple behaviors are supported, the evaluator shall repeat the test for each behavior.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>DTLS clients may buffer unexpected application messages, and resend previous messages in response to timeouts for missing messages. It is acceptable for the evaluator to observe the TSF resend its finished message multiple times as an indication that it will not process application messages until the server finished message is received. The evaluator should not resend application messages from the test DTLS server, as this might cause the TSF’s counter to continue to reset.</em></p>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_b_2_2_fcs_dtlsc_ext_2_dtls_client_support_for_mutual_authentication">B.2.2 FCS_DTLSC_EXT.2 DTLS Client Support for Mutual Authentication</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>The inclusion of this selection-based component depends upon selection in FCS_DTLSC_EXT.1.1.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.2 DTLS Client Support for Mutual Authentication</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.2.1</strong> The TSF shall support mutual authentication using X.509v3 certificates during the handshake and [selection: <em>in support of post-handshake authentication requests, at no other time</em>], in accordance with [selection: <em>RFC 5246, section 7.4.4, RFC 8446, section 4.3.2</em>].</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 7</em></strong></p>
</div>
<div class="paragraph">
<p><em>This SFR is claimed if "mutual authentication" is selected in FCS_DTLSC_EXT.1.1.  Clients that support DTLS 1.3 and post-handshake authentication claim ‘in support of post-handshake authentication requests’ in the first selection. The ‘at no other time’ selection is claimed for clients only supporting DTLS 1.2 or for DTLS 1.3 clients that do not support post-handshake authentication.</em></p>
</div>
<div class="paragraph">
<p><em>The certificate request sent by the server specifies the signature algorithms and certification authorities supported by the server. If the client does not possess a matching certificate, it sends an empty certificate message. The structure of the certificate request message is changed in DTLS 1.3 to use the signature_algorithm, signature_algorithms_cert, and certificate_authorities extensions, and RFC 8446 allows for DTLS 1.2 implementations to use the new message structure. The "RFC 8446, section 4.3.2" option is claimed in the second selection if DTLS 1.3 is supported or if the RFC 8446 method is supported for DTLS 1.2 servers. The "RFC 5246, section 7.4.4" option is claimed if the RFC 5246 method is supported for interoperability with DTLS 1.2 servers that do not adopt the RFC 8446 method. When mutual authentication is supported, at least one of these methods must be claimed, per the selection.</em></p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_DTLSC_EXT.2</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall ensure that the TSS description required per FIA_X509_EXT.2.1 includes the use of client-side certificates for DTLS mutual authentication. The evaluator shall also ensure that the TSS describes any factors beyond configuration that are necessary in order for the client to engage in mutual authentication using X.509v3 certificates.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall ensure that the operational guidance includes any instructions necessary to configure the TOE to perform mutual authentication. The evaluator shall also verify that the operational guidance required per FIA_X509_EXT.2.1 includes instructions for configuring the client-side certificates for DTLS mutual authentication.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>For each supported DTLS version, the evaluator shall perform the following tests:</em></p>
</div>
<div class="paragraph">
<p><em>Test 14: The evaluator shall establish a DTLS connection from the TSF to a test DTLS server that negotiates the tested version and which is not configured for mutual authentication (i.e., does not send a Server’s Certificate Request (type 13) message). The evaluator observes negotiation of a DTLS channel and confirms that the
TOE did not send a Client’s Certificate message (type 11) during handshake.</em></p>
</div>
<div class="paragraph">
<p><em>Test 15: The evaluator shall establish a connection to a test DTLS server with a shared trusted root that is configured for mutual authentication (i.e., it sends a Server’s Certificate Request (type 13) message). The evaluator observes negotiation of a DTLS channel and confirms that the TOE responds with a non-empty Client’s Certificate message (type 11) and Certificate Verify (type 15) message.</em></p>
</div>
<div class="paragraph">
<p><em>Test 16:  [conditional] If the TSF supports post-handshake authentication, the evaluator shall establish a pre-shared key between the TSF and a test DTLS 1.3 server. The evaluator shall initiate a DTLS session using the pre-shared key and confirm the TSF and test DTLS 1.3 server successfully complete the DTLS handshake and both support post-handshake authentication. After the session is successfully established, the evaluator shall initiate a certificate request message from the test DTLS 1.3 server. The evaluator shall observe that the TSF receives that authentication request and shall take necessary actions, in accordance with the operational guidance, to complete the authentication request. The evaluator shall confirm that the test DTLS 1.3 server receives certificate and certificate verification messages from the TSF over the channel that authenticates the client.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>DTLS 1.3 certificate requests from the test server and client certificate and certificate verify messages are encrypted. The evaluator confirms that the TSF sends the appropriate messages by examining the messages received at the test DTLS 1.3 server and by inspecting any relevant server logs. The evaluator may also take advantage of the calling application to demonstrate that the TOE receives data configured at the test DTLS server.</em></p>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_b_2_3_fcs_dtlsc_ext_3_dtls_client_downgrade_protection">B.2.3 FCS_DTLSC_EXT.3 DTLS Client Downgrade Protection</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>The inclusion of this selection-based component depends upon selection in FCS_DTLSC_EXT.1.1.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.3 DTLS Client Downgrade Protection</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.3.1</strong> The TSF shall not establish a DTLS channel if the server hello message includes [selection: <em>TLS 1.2 downgrade indicator, TLS 1.1 or below downgrade indicator</em>] in the server random field.</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 8</em></strong></p>
</div>
<div class="paragraph">
<p><em>This SFR is claimed if "supplemental downgrade protection" is selected in FCS_DTLSC_EXT.1.1.</em></p>
</div>
<div class="paragraph">
<p><em>The ST author claims the “TLS 1.2 downgrade indicator” when FCS_DTLSC_EXT.1 indicates support for both DTLS 1.3 and supplemental downgrade protection. This option is not claimed if DTLS 1.3 is not supported. The “TLS 1.1 or below downgrade indicator” option may be claimed regardless of support for DTLS 1.3, but should only be claimed if the TSF is capable of detecting the indicator. As indicated in FCS_DTLSC_EXT.1.1, this FP requires the client to terminate DTLS 1.1 or below sessions. It is acceptable for the TSF to always terminate DTLS 1.1 sessions based on the server hello negotiated version field and ignore any downgrade indicator. However, a product that is capable of detecting the TLS 1.1 or below downgrade indicator may take different actions depending on whether the TLS 1.1 or below downgrade indicator is set.</em></p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_DTLSC_EXT.3</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall review the TSS and confirm that the description of the DTLS client protocol includes the downgrade protection mechanism in accordance with RFC 8446 and identifies any configurable features of the TSF needed to meet the requirements. If the ST claims that the TLS 1.1 and below indicator is processed, the evaluator shall confirm that the TSS indicates which configurations allow processing of the downgrade indicator and the specific response of the TSF when it receives the downgrade indicator as opposed to simply terminating the session for the unsupported version.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall review the operational guidance and confirm that any instructions to configure the TSF to meet the requirements are included.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall perform the following tests to confirm the response to downgrade indicators from a test DTLS 1.3 server:</em></p>
</div>
<div class="paragraph">
<p><em>Test 17:  [conditional] If the TSF supports both DTLS 1.3 and DTLS 1.2, the evaluator shall initiate a DTLS 1.3 session with a test DTLS 1.3 server configured to send a compliant DTLS 1.2 server hello (not including any TLS 1.3 extensions) but including the TLS 1.2 downgrade indicator ‘44 4F 57 4E 47 52 44 01’ in the last eight bytes of the server random field. The evaluator shall confirm that the TSF terminates the session.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF send a fatal error alert message (e.g., illegal parameter), but it is acceptable that the TSF terminate the session without sending an error alert.  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
<div class="paragraph">
<p><em>Test 18:  [conditional] If the TSF supports the TLS 1.1 or below downgrade indicator and if the ST indicates a configuration where the indicator is processed, the evaluator shall follow operational guidance instructions to configure the TSF so it parses a TLS 1.1 handshake to detect and process the TLS downgrade indicator. The evaluator shall initiate a DTLS session between the TOE and a test DTLS server that is configured to send a TLS 1.1 server hello message with the downgrade indicator ‘44 4F 57 4E 47 52 44 00’ in the last eight bytes of the server random field, but which is otherwise compliant with RFC 4346. The evaluator shall observe that the TSF terminates the session as described in the ST.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF send a fatal error alert message (illegal parameter or unsupported version), but it is acceptable that the TSF terminate the session without sending an error alert.  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
<div class="paragraph">
<p><em>Use of the TLS 1.1 and below indicator as a redundant mechanism where there is no configuration that actually processes the value does not require additional testing, since this would be addressed by Test 2 for FCS_DTLSC_EXT.1.1. This test is only required if the TSF responds differently (e.g., a different error alert) when the downgrade indicator is present than when DTLS 1.0 or below is negotiated and the downgrade indicator is not present.</em></p>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_b_2_4_fcs_dtlsc_ext_4_dtls_client_support_for_renegotiation">B.2.4 FCS_DTLSC_EXT.4 DTLS Client Support for Renegotiation</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>The inclusion of this selection-based component depends upon selection in FCS_TLS_EXT.1.1.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.4 DTLS Client Support for Renegotiation</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.4.1</strong> The TSF shall support secure renegotiation through use of [selection: <em>the “renegotiation_info” TLS extension, the TLS_EMPTY_RENEGOTIATION_INFO_SCSV signaling ciphersuite signaling value</em>] in accordance with RFC 5746, and shall terminate the session if an unexpected server hello is received or [selection: <em>hello request message is received, in no other case</em>].</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 9</em></strong></p>
</div>
<div class="paragraph">
<p><em>This SFR is claimed if "DTLS as a client" is selected in FCS_TLS_EXT.1.1.  A client allowing DTLS 1.2 connections may present either the "renegotiation_info" extension or the signaling ciphersuite value TLS_EMPTY_RENEGOTIATION_INFO_SCSV in the initial client hello message to indicate support for secure renegotiation. The ST author claims the methods supported. The TLS_EMPTY_RENEGOTIATION_INFO_SCSV is the preferred mechanism for DTLS 1.2 protection against insecure renegotiation when the client does not renegotiate. The ST author will claim the ‘hello request message is received’ option in the second selection to indicate support for this mechanism.</em></p>
</div>
<div class="paragraph">
<p><em>RFC 5746 allows the client to accept connections with servers that do not support the extension; this FP refines RFC 5746 and requires the client to terminate sessions with such servers. Thus, unexpected server hello messages include an initial server hello negotiating DTLS 1.2 that does not contain a renegotiation_info extension, an initial server hello negotiating DTLS 1.2 that has a renegotiation_info that is non-empty, a subsequent server hello negotiating DTLS 1.2 that does not contain a renegotiation_info extension, and a subsequent server hello negotiating DTLS 1.2 that has a renegotiation_info extension with an incorrect renegotiated_connection value.</em></p>
</div>
<div class="paragraph">
<p><em>DTLS 1.3 provides protection against insecure renegotiation by not allowing renegotiation. If DTLS 1.3 is claimed in FCS_DTLSC_EXT.1.1, the client receives a server hello that attempts to negotiate DTLS 1.3, and the server hello also contains a renegotiation_info extension; the client will terminate the connection.</em></p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_DTLSC_EXT.4</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the ST to ensure that DTLS renegotiation protections are described in accordance with the requirements. The evaluator shall ensure that any configurable features of the renegotiation protections are identified.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the operational guidance to confirm that instructions for any configurable features of the renegotiation protection mechanisms are included.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall perform the following tests as indicated. One or both of "tls-client-accepts-renegotiation" or Test 20 is required, depending on whether the TSF is configurable to reject renegotiation or supports secure renegotiation methods defined for DTLS 1.2. If DTLS 1.3 is supported, Test 20 is required.</em></p>
</div>
<div class="paragraph">
<p><em>Test 19: [conditional] If the TSF supports a configuration to accept renegotiation requests for TLS 1.2, the evaluator shall follow any operational guidance to configure the TSF. The evaluator shall perform the following tests:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) The evaluator shall initiate a DTLS connection with a test server configured to negotiate a compliant DTLS 1.2 handshake. The evaluator shall inspect the messages received by the test DTLS 1.2 server. The evaluator shall observe that either the “renegotiation_info” field or the SCSV ciphersuite is included in the client hello message during the initial handshake.</em></p>
</li>
<li>
<p><em>B) For each of the following sub-tests, the evaluator shall initiate a new DTLS connection with a test DTLS 1.2 server configured to send a renegotiation_info extension as specified, but otherwise complete a compliant DTLS 1.2 session:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>The evaluator shall configure the test DTLS 1.2 server to send a renegotiation_info extension whose value indicates a non-zero length. The evaluator shall confirm that the TSF terminates the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., illegal parameter) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
<li>
<p><em>ii)</em>
<em>The evaluator shall configure the test DTLS 1.2 server to send a compliant renegotiation_info extension and observe the TSF successfully completes the DTLS 1.2 connection.</em></p>
</li>
<li>
<p><em>iii)</em>
<em>The evaluator shall initiate a session renegotiation after completing a successful handshake with a test DTLS 1.2 server that completes a successful DTLS 1.2 handshake (as in Test A)) and then sends a hello reset request from the test DTLS server with a “renegotiation_info” extension that has an unexpected “client_verify_data” or “server_verify_data” value (modify a byte from a compliant response). The evaluator shall verify that the TSF terminates the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., illegal parameter, handshake error) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 20: [conditional] if the TSF supports a configuration that prevents renegotiation, the evaluator shall perform the following tests:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) (DTLS 1.2) [conditional] If the TSF supports a configuration to reject DTLS 1.2 renegotiation, the evaluator shall follow the operational guidance as necessary to prevent renegotiation. The evaluator shall initiate a DTLS session between the so-configured TSF and a test DTLS 1.2 server that is configured to perform a compliant handshake, followed by a hello reset request. The evaluator shall confirm that the TSF completes the initial handshake successfully but terminates the DTLS session after receiving the hello reset request.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., unexpected message) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert). DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
<li>
<p><em>B) [conditional] If the TSF supports DTLS 1.3, the evaluator shall initiate a DTLS session between the TSF and a test DTLS 1.3 server that completes a compliant DTLS 1.3 handshake, followed by a hello reset message. The evaluator shall observe that the TSF completes the initial DTLS 1.3 handshake successfully, but terminates the session on receiving the hello reset message.</em></p>
<div class="paragraph">
<p><em>It is preferred that the TSF sends a fatal error alert message (e.g., unexpected message) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
</ul>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_b_2_5_fcs_dtlsc_ext_5_dtls_client_support_for_session_resumption">B.2.5 FCS_DTLSC_EXT.5 DTLS Client Support for Session Resumption</h4>
<div class="paragraph">
<p><strong><em>The inclusion of this selection-based component depends upon selection in FCS_DTLSC_EXT.1.1.</em></strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.5 DTLS Client Support for Session Resumption</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.5.1</strong>  The TSF shall support session resumption as a client via the use of [selection: <em>session ID in
accordance with RFC 5246, tickets in accordance with RFC 5077, PSK and tickets in accordance with RFC 8446</em>].</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 10</em></strong></p>
</div>
<div class="paragraph">
<p><em>This SFR is claimed if "session resumption" is selected in FCS_DTLSC_EXT.1.1.  The ST author indicates which session resumption mechanisms are supported. One or both of the first two options, "session ID in accordance with RFC 5246" and "tickets in accordance with RFC 5077" are claimed for DTLS 1.2 resumption. If resumption of DTLS 1.3 sessions is supported, "PSK and tickets in accordance with RFC 8446" is selected, and the selection-based SFR FCS_DTLSC_EXT.6 must also be claimed.</em></p>
</div>
<div class="paragraph">
<p><em>While it is possible to perform session resumption using PSK ciphersuites in DTLS 1.2, this is uncommon. Validation of key exchange and session negotiation rules for PSK ciphersuites is independent of the source of the pre-shared key and is covered in FCS_DTLSC_EXT.1.</em></p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_DTLSC_EXT.5</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the ST and confirm that the DTLS client protocol description includes a description of the supported resumption mechanisms.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall ensure the operational guidance describes instructions for any configurable features of the resumption mechanism.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall perform the following tests:</em></p>
</div>
<div class="paragraph">
<p><em>Test 21: For each supported DTLS version and for each supported resumption mechanism that is supported for that version, the evaluator shall establish a new DTLS session between the TSF and a compliant test DTLS server that is configured to negotiate the indicated version and perform resumption using the indicated mechanism. The evaluator shall confirm that the TSF completes the initial DTLS handshake and shall cause the TSF to close the session normally. The evaluator shall then cause the TSF to resume the session with the test DTLS server using the indicated method and observe that the TSF successfully establishes the session.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>For each method, successful establishment refers to proper use of the mechanism, to include compliant extensions and behavior, as indicated in the referenced RFC.</em></p>
</div>
<div class="paragraph">
<p><em>Test 22:  (DTLS 1.3 session id echo) [conditional] If the TSF supports DTLS 1.3, the evaluator shall initiate a new DTLS 1.3 session with a test DTLS server. The evaluator shall cause the test DTLS server to send a DTLS 1.3 server hello message (or a hello retry request if the TSF doesn’t include the key share extension) that contains a different value in the legacy_session_id field, and observe that the TSF terminates the session.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., illegal parameter) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_b_2_6_fcs_dtlsc_ext_6_dtls_client_tls_1_3_resumption_refinements">B.2.6 FCS_DTLSC_EXT.6 DTLS Client TLS 1.3 Resumption Refinements</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>The inclusion of this selection-based component depends upon selection in FCS_DTLSC_EXT.5.1.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.6.1</strong> The TSF shall send a psk_key_exchange_mode extension with the value psk_dhe_ke when DTLS 1.3 session
resumption is offered.</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.6 DTLS Client TLS 1.3 Resumption Refinements</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.6.2</strong>  The TSF shall not send early data in DTLS 1.3 sessions.</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 11</em></strong></p>
</div>
<div class="paragraph">
<p><em>This SFR is claimed if "PSK and tickets in accordance with RFC 8446" is selected in FCS_DTLSC_EXT.5.1.  This SFR is claimed when session resumption is supported for DTLS 1.3. RFC 8446 allows pre-shared keys to be used directly and also allows early data to be protected using only the pre-shared key. This SFR refines the RFC to use PSK only with a supplemental DHE or ECDHE key exchange to ensure perfect forward secrecy for all sessions.</em></p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_DTLSC_EXT.6</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the TSS to verify that the DTLS client protocol description indicates that the PSK exchange requires DHE mode and prohibits sending early data. The evaluator shall examine the TSS to verify it lists all applications that can be secured by DTLS 1.3 using pre-shared keys and describes how each DTLS 1.3 client application ensures data for the application is not sent using early data.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the operational guidance to verify that instructions for any configurable features that are required to meet the requirement are included. The evaluator shall ensure the operational guidance includes any instructions required to configure applications so the DTLS 1.3 client implementation does not send early data.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>Test 23:  [conditional] For each application that is able to be secured via DTLS 1.3 using PSK, the evaluator shall follow operational guidance to configure the application not to send early data. The evaluator shall cause the application to initiate a resumed DTLS 1.3 session between the TSF and a compliant test DTLS 1.3 server as in Test 20 in FCS_DTLSC_EXT.5. The evaluator shall observe that the TSF client hello for DTLS 1.3 includes the psk_mode extension with the value psk_dhe_ke and sends a key share value for a supported group. The evaluator shall confirm that early data is not received by the test DTLS server.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>If no applications supported by the TOE provide data to DTLS 1.3 that can be sent using PSK, this test is omitted.</em></p>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_b_3_1_fcs_dtlss_ext_1_dtls_server_protocol">B.3.1 FCS_DTLSS_EXT.1 DTLS Server Protocol</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>The inclusion of this selection-based component depends upon selection in FCS_TLS_EXT.1.1.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1 DTLS Server Protocol</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.1</strong>  The TSF shall implement [selection: <em>DTLS 1.2 (RFC 6347), DTLS 1.3 (RFC 9147)</em>] and no other DTLS version as a server that supports additional functionality for session renegotiation protection and [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>mutual authentication</em></p>
</li>
<li>
<p><em>supplemental downgrade protection</em></p>
</li>
<li>
<p><em>session resumption</em></p>
</li>
<li>
<p><em>no optional functionality</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>] and shall reject connection attempts from clients supporting all other DTLS versions.</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 12</em></strong></p>
</div>
<div class="paragraph">
<p><em>This SFR is claimed if "DTLS as a server" is selected in FCS_DTLS_EXT.1.1.  These requirements will be revisited as new DTLS versions are standardized by the IETF.</em></p>
</div>
<div class="paragraph">
<p><em>Session renegotiation protection is required for both DTLS 1.2 and DTLS 1.3, and the ST must include the requirements from FCS_DTLSS_EXT.4. Within FCS_DTLSS_EXT.4, options for implementation of secure session renegotiation for DTLS 1.2 or rejecting renegotiation requests are claimed.</em></p>
</div>
<div class="paragraph">
<p><em>If "mutual authentication" is selected, then the ST must additionally include the requirements from FCS_DTLSS_EXT.2.</em></p>
</div>
<div class="paragraph">
<p><em>If "supplemental downgrade protection" is selected, then the ST must additionally include the requirements from FCS_DTLSS_EXT.3. If the TOE provides downgrade protection as indicated in RFC 8446, in particular, if DTLS 1.3 is supported, this selection must be made.</em></p>
</div>
<div class="paragraph">
<p><em>If "session resumption" is selected, then the ST must additionally include the requirements from FCS_DTLSS_EXT.5.</em></p>
</div>
<div class="paragraph">
<p><em>DTLS version numbers are denoted on the wire as the 1’s complement of the corresponding textual DTLS versions as described in Section 4.1 of RFC 6347. DTLS version 1.2 is 0xfefd; DTLS version 1.3 is 0xfefc.</em></p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.2</strong>  The TSF shall be able to support the following TLS 1.2 ciphersuites: [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289 and RFC 8422</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289 and RFC 8422</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</em></p>
</li>
<li>
<p><em>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</em></p>
</li>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_128_CBC_SHA as defined in RFC 5246</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>], the following PP-specific ciphersuites using pre-shared secrets: [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 8442</em></p>
</li>
<li>
<p><em>TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>TLS_RSA_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 8442</em></p>
</li>
<li>
<p><em>TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>TLS_RSA_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>no ciphersuites using pre-shared secrets</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>], and the following TLS 1.3 ciphersuites: [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS_AES_256_GCM_SHA384 as defined in RFC 8446</em></p>
</li>
<li>
<p><em>TLS_AES_128_GCM_SHA256 as defined in RFC 8446</em></p>
</li>
<li>
<p>[<em>assignment: other TLS 1.3 ciphersuites</em>]</p>
</li>
<li>
<p><em>no TLS 1.3 ciphersuites</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>] using a preference order based on [selection: <em>RFC 9151 priority, client hello ordering,
[assignment: additional priority]</em>].</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 13</em></strong></p>
</div>
<div class="paragraph">
<p><em>The ST author should select the ciphersuites that are supported and must select at least one ciphersuite for each DTLS version supported. It is necessary to limit the ciphersuites that can be used in an evaluated configuration administratively on the server in the test environment. If administrative steps need to be taken so that the ciphersuites negotiated by the implementation are limited to those in this requirement, then the appropriate instructions need to be contained in the guidance.</em></p>
</div>
<div class="paragraph">
<p><em>The final selection indicates the TOE’s preference for negotiating a ciphersuite. RFC 9151 indicates the required ciphersuites for NSS systems and ‘RFC 9151 priority’ is claimed if those ciphersuites are selected whenever offered by the client. In general, it is preferred that GCM ciphersuites are selected over CBC ciphersuites, ECDHE is selected over RSA and DHE, and SHA256 or SHA384 is selected over SHA1.</em></p>
</div>
<div class="paragraph">
<p><em>The ‘client hello ordering’ option is claimed if client priority is considered; if both are claimed, the ST author should indicate which is primary and which is secondary, and whether the priority scheme is configurable. If other priority schemes or if tertiary priority is used, the ST author will claim the third option and describe the scheme in the ST.</em></p>
</div>
<div class="paragraph">
<p><em>Support for TLS_RSA_WITH_AES_128_CBC_SHA is not required despite being mandated by RFC 5246.</em></p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.3</strong>  The TSF shall not establish a connection with a client that does not indicate support for at least one of the supported ciphersuites.</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.4</strong>  The TSF shall be able to process the following DTLS client hello message extensions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>signature_algorithms extension (RFC 8446) indicating support for [selection:</p>
<div class="ulist">
<ul>
<li>
<p><em>ecdsa-secp384r1_sha384 (RFC] 8446)</em></p>
</li>
<li>
<p><em>rsa_pkcs1_sha384 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pss_pss_sha384 (RFC 8603)</em></p>
</li>
<li>
<p><em>rsa_pss_rsae_sha384 (RFC 8603)</em></p>
</li>
<li>
<p>[assignment: <em>other non-deprecated signature algorithms</em>]</p>
</li>
<li>
<p><em>no other signature algorithms</em></p>
<div class="paragraph">
<p>]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>the following other extensions: [selection:</p>
<div class="ulist">
<ul>
<li>
<p><em>signature_algorithms_cert extension (RFC 8446) indicating support for [selection:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>ecdsa-secp384r1_sha384 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pkcs1_sha384 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pss_pss_sha384 (RFC 8603)</em></p>
</li>
<li>
<p><em>rsa_pss_rsae_sha384 (RFC 8603)</em></p>
</li>
<li>
<p><em>rsa_pkcs1_sha256 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pss_rsae_sha256 (RFC 8446)</em></p>
</li>
<li>
<p>[assignment: <em>other non-deprecated signature algorithms</em>]</p>
</li>
<li>
<p><em>no other signature algorithms</em></p>
<div class="paragraph">
<p>]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>supported_versions extension (RFC 8446) indicating support for DTLS 1.3</em></p>
</li>
<li>
<p><em>supported_groups extension (RFC 7919, RFC 8446) indicating support for [selection:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>secp256r1</em></p>
</li>
<li>
<p><em>secp384r1</em></p>
</li>
<li>
<p><em>secp521r1</em></p>
</li>
<li>
<p><em>ffdhe2048(256)</em></p>
</li>
<li>
<p><em>ffdhe3072(257)</em></p>
</li>
<li>
<p><em>ffdhe4096(258)</em></p>
</li>
<li>
<p><em>ffdhe6144(259)</em></p>
</li>
<li>
<p><em>ffdhe8192(260)</em></p>
<div class="paragraph">
<p>]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>key_share extension (RFC 8446)</em></p>
</li>
<li>
<p><em>extended_master_secret extension (RFC 7627) [selection: enforcing, allow legacy] client support</em></p>
</li>
<li>
<p><em>no other extensions</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>].</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 14</em></strong></p>
</div>
<div class="paragraph">
<p><em>If support for DTLS 1.3 is claimed in FCS_DTLSS_EXT.1.1, the selections for supported_versions, supported_groups, and key_share are claimed. Even if support for DTLS 1.3 is not claimed, if ECDHE ciphersuites are claimed in FCS_DTLSS_EXT.1.2, the entry for supported_groups is claimed. Support for additional extensions is acceptable. For signature_algorithms and signature_algorithms_certs (if supported), at least one of the signature schemes presented in the first sub-selection is claimed.</em></p>
</div>
<div class="paragraph">
<p><em>If DTLS 1.2 is claimed in FCS_DTLSS_EXT.1.1 the extended_master_secret extension is claimed in accordance with RFC 7627.    If the TSF requires a DTLS 1.2 client to provide the extended_master_secret extension in its Client Hello message the ST author selects 'enforcing'.  If the TSF allows connections to a DTLS 1.2 client that does not provide the extended_master_secret extension in its Client Hello message, the ST author selects 'allow legacy'.</em></p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.5</strong>  The TSF shall perform key establishment for DTLS using [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>RSA with size [selection: [2048, 3072, 4096] bits and no other sizes</em></p>
</li>
<li>
<p><em>Diffie-Hellman parameters with size [selection: [2048, 3072, 4096, 6144, 8192 ] bits and no other sizes</em></p>
</li>
<li>
<p><em>Diffie-Hellman groups [selection: [ffdhe2048, ffdhe3072, ffdhe4096, ffdhe6144, ffdhe8192] and no other groups, consistent with the client&#8217;s supported groups extension and [selection: [key share, no other] extension</em></p>
</li>
<li>
<p><em>ECDHE parameters using elliptic curves [selection: secp256r1, secp384r1, secp521r1] and no other curves, consistent with the client&#8217;s supported groups extension and [selection: [key share, no other] extension and using non-compressed formatting for points</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>].</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 15</em></strong></p>
</div>
<div class="paragraph">
<p><em>DTLS 1.2 and DTLS 1.3 perform key exchange using different mechanisms. In DTLS 1.2, the requirements apply to the key exchange messages received by the server and optionally (for DHE or ECDHE ciphersuites) sent by the server. In DTLS 1.3, the requirements apply to the values of the key share extension contained in the client and server hello messages. The options depend on the supported ciphersuites. For each session, the key exchange method is consistent with the selected ciphersuite (DTLS 1.2), the supported groups extension (DTLS 1.3 and conditionally, DTLS 1.2), or the key share extension (DTLS 1.3).</em></p>
</div>
<div class="paragraph">
<p><em>If the ST lists an RSA ciphersuite in FCS_DTLSS_EXT.1.2, the ST must include the RSA selection in the requirement.</em></p>
</div>
<div class="paragraph">
<p><em>If the ST lists a DHE ciphersuite in FCS_DTLSS_EXT.1.2, the ST must include the Diffie-Hellman selection for parameters of a certain size, the Diffie-Hellman groups selection in support of DTLS 1.2 exchanges, or both. The selection for "Diffie-Hellman parameters" refers to the method defined by RFC 5246, section 7.4.3 where the server provides Diffie-Hellman parameters to the client. The “Diffie-Hellman groups” selection indicates key exchange negotiation in accordance with RFC 7919 using the supported groups extension. RFC 7919 identifies particular Diffie-Hellman groups, which are listed in the following selection. This option is the preferred mechanism for DTLS 1.2, and must be claimed if TLS 1.3 FFDHE groups (e.g., ffdhe2048) are supported.</em></p>
</div>
<div class="paragraph">
<p><em>If the ST lists an ECDHE ciphersuite in FCS_DTLSS_EXT.1.2, the ST must include the selection for ECDHE using elliptic curves in the requirement, consistent with the support indicated for the supported groups extension in FCS_DTLSS_EXT.1.4.</em></p>
</div>
<div class="paragraph">
<p><em>When DTLS 1.3 is negotiated (if supported), the supported group negotiated (a supported DHE or ECDHE group) agrees with one of the client’s supported groups and the supplied key share element, and the product’s key share element is a member of the selected group. If the DTLS 1.3 client does not initially provide a key share element for a group supported by both the product and the client, the TOE is expected to send a hello retry request message indicating the selected group; the requirement for matching the group indicated in the client’s hello message applies to the client’s hello message received in response to the hello retry request message.</em></p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_DTLSS_EXT.1</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall check the description of the implementation of this protocol in the TSS to ensure the supported DTLS versions, features, ciphersuites, and extensions, are specified in accordance with RFC 6347 (DTLS 1.2) and RFC 9147 (DTLS 1.3 and updates to DTLS 1.2) as appropriate. The evaluator shall check the description to see if beta DTLS 1.3 versions are supported.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall verify that ciphersuites indicated in FCS_DTLSS_EXT.1.2 are included in the description, and that none of the following ciphersuites are supported: ciphersuites indicating 'NULL,' 'RC2,' 'RC4,' 'DES,' 'IDEA,' or 'TDES' in the encryption algorithm component, indicating 'anon,' or indicating MD5 or SHA in the message digest algorithm component.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall verify that the DTLS implementation description includes the extensions as required in FCS_DTLSS_EXT.1.4.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall confirm that the DTLS description includes the number and types of certificates that can be installed to represent the TOE</em>.</p>
</div>
<div class="paragraph">
<p><em>The evaluator shall verify that the TSS describes how the DTLS client IP address is validated prior to issuing a server hello message.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall check the operational guidance to ensure that it contains instructions on configuring the product so that the TSF conforms to the requirements. If the ST indicates that beta versions of DTLS 1.3 are supported for backward compatibility, the evaluator shall ensure that the operational guidance provides instructions for disabling these versions.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall review the operational guidance to ensure instructions on installing certificates representing the TOE are provided.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall perform the following tests:</em></p>
</div>
<div class="paragraph">
<p><em>Test 24:  (supported DTLS 1.2 configurations) The evaluator shall perform the following tests:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) For each supported TLS 1.2 ciphersuite, the evaluator shall send a compliant DTLS 1.2 client hello with the highest version or legacy version of 1.2 (value '03 03'), a single entry in the ciphersuites field consisting of the specific ciphersuite, and no supported version extension or key share extension. The evaluator shall observe the TSF]’s server hello indicates DTLS 1.2 in the highest version or legacy version field, does not include a supported version or key share extension, and indicates the specific ciphersuite in the ciphersuite field. If the ciphersuite requires certificate-based authentication, the evaluator shall observe that the TSF sends a valid certificate representing the TOE and successfully completes the DTLS handshake.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>The ciphersuites TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 8442, TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 5487, TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 8442, and TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 5487, if supported, do not require certificate-based authentication of the server.</em></p>
</div>
</li>
<li>
<p><em>B) (DTLS 1.2 support for DTLS 1.3 clients) [conditional] If the TSF is configurable to support only DTLS 1.2 (or if DTLS 1.3 is not supported), and if the TSF supports DHE or ECDHE ciphersuites, the evaluator shall follow any operational guidance instructions necessary to configure the TSF to only support DTLS 1.2. For each supported DTLS 1.2 ciphersuite with DHE or ECDHE indicated as the key exchange method, the evaluator shall send a client hello with the highest version or legacy version of 1.2 (value 'fe fd'), a list of ciphersuites consisting of one or more TLS 1.3 ciphersuites followed by the specific TLS 1.2 ciphersuite and no other TLS 1.2 ciphersuites in the ciphersuites field, and including a TLS 1.3 supported group and key share extension with consistent values. The evaluator shall observe that the TSF’s server hello indicates DTLS 1.2 in the highest version or legacy version field, does not include a supported version or key share extension, and indicates the specific TLS 1.2 ciphersuite in the ciphersuite field. The evaluator shall observe that the TSF completes the DTLS 1.2 handshake successfully.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>Supported ciphersuites using RSA key exchange should not be included in this test. The supported groups extension sent by the test DTLS client should be consistent with the TLS 1.2 ciphersuite (e.g., it should be an EC group if the ciphersuite is ECDHE).</em></p>
</div>
</li>
<li>
<p><em>C) (DTLS 1.3 support) [conditional] If the TSF supports DTLS 1.3, then for each supported TLS 1.3 ciphersuite and key exchange group, the evaluator shall send a compliant DTLS 1.3 client hello indicating a list of one or more TLS 1.2 ciphersuites followed by the specific TLS 1.3 ciphersuite and no other ciphersuites in the ciphersuites field, a supported version extension indicating DTLS 1.3 (value 'fe fc') only, a supported groups extension indicating the selected group, and a key share extension containing a value representing an element of the specific group. The evaluator shall observe the TSF’s server hello contains the supported versions extension indicating DTLS 1.3, the specific ciphersuite in the selected ciphersuite field, and a key share extension containing an element of the specific supported group. The evaluator shall observe that the TSF completes the DTLS 1.3 handshake successfully.</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>The connections in Test A. may be established as part of the establishment of a higher-level protocol, e.g., as part of an EAP session.</em></p>
</div>
<div class="paragraph">
<p><em>It is sufficient to observe the successful negotiation of a ciphersuite to satisfy the intent of the test; it is not necessary to examine the characteristics of the encrypted traffic in an attempt to discern the ciphersuite being used (for example, that the cryptographic algorithm is 128-bit AES and not 256-bit AES).</em></p>
</div>
<div class="paragraph">
<p><em>It is not necessary to pair every supported ciphersuite with every supported group. It is sufficient to use a set of ciphersuite and supported group pairs such that each ciphersuite and each supported group are included in this set.</em></p>
</div>
<div class="paragraph">
<p><em>TLS 1.3 includes the supported_groups extension in the encrypted_extensions message. This message may be observed at the test client after it is decrypted to help verify the key_share is actually a member of the supported group requested.</em></p>
</div>
<div class="paragraph">
<p><em>Test 25:  (obsolete versions) The evaluator shall perform the following tests:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) For each of DTLS version 1.0 and [conditional] DTLS version 1.2, the evaluator shall send a client hello to the TSF indicating the selected version as the highest version. The evaluator shall observe the TSF terminates the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., protocol version, insufficient security) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
<li>
<p><em>B) The evaluator shall follow the operational guidance to configure the TSF to ensure any supported beta DTLS 1.3 versions are disabled, as necessary. The evaluator shall send the TSF a client hello message indicating the supported version (referred to as the legacy version in RFC 8446) with the value '03 04' but without including the supported_versions extension and observe that the TSF responds with a server hello indicating the highest version supported.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>Test B) is intended to test the TSF response to non-standard versions, including beta versions of DTLS 1.3. If the TSF supports such beta versions, the evaluator shall follow the operational guidance instructions to disable them prior to conducting Test B)</em></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 26:  (ciphersuites) The evaluator shall perform the following tests on handling unexpected ciphersuites using a test DTLS client sending handshake messages compliant with the negotiated version except as indicated in the test:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A)  (ciphersuite not supported) For each supported version, the evaluator shall follow the operational guidance, if available, to configure the TSF to disable a supported ciphersuite. The evaluator shall send a compliant client hello to the TSF indicating support for the specific version and a ciphersuites field containing this single disabled ciphersuite. The evaluator shall observe that the TOE rejects the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
<div class="paragraph">
<p><em>If the TSF’s ciphersuites are not configurable, it is acceptable to use a named ciphersuite from the IANA TLS protocols associated with the tested version. Additional special cases of this test for special ciphersuites are performed separately.</em></p>
</div>
</li>
<li>
<p><em>B)   (version confusion) For each supported version, the evaluator shall send a client hello that is compliant for the specific version that includes a list of ciphersuites consisting of a single ciphersuite not associated with that version. The evaluator shall observe that the TOE rejects the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
<div class="paragraph">
<p><em>It is preferred that Test B) use DTLS 1.3 ciphersuites for a server negotiating DTLS 1.2. If DTLS 1.3 is supported, Test B) also includes a server negotiating DTLS 1.3 with a TLS 1.2 ciphersuite – in this case, the negotiated ciphersuite should be chosen to be one supported by the TOE if negotiating DTLS 1.2. If the TOE is configurable to allow both DTLS 1.2 and DTLS 1.3 clients (or does so by default), this configuration is used for both the DTLS 1.2 and DTLS 1.3 iteration of this test; otherwise the TOE is configured to support the negotiated version in each iteration.</em></p>
</div>
</li>
<li>
<p><em>C)   (null ciphersuite) For each supported version, the evaluator shall send a client hello indicating support for the version and include a ciphersuite list consisting of only the null ciphersuite (TLS_NULL_WITH_NULL_NULL, with the value '00 00') and observe that the TOE rejects the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure, insufficient security) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
<li>
<p><em>D) (anon ciphersuite) [conditional on the TSF supporting DTLS 1.2] The evaluator shall send the TSF a DTLS 1.2 handshake that is compliant, except that the ciphersuites field includes a ciphersuite list consisting only of ciphersuites using the anonymous server authentication method and observe that the TOE rejects the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure, insufficient security) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
<div class="paragraph">
<p><em>See IANA TLS parameters for available ciphersuites to be included in the client hello. The test ciphersuites list should include ciphersuites using supported cryptographic algorithms in as many of the other components as possible. For example, if the TSF supports the ciphersuite TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384, the evaluator should include TLS_DH_ANON_WITH_AES_256_GCM_SHA_384.</em></p>
</div>
</li>
<li>
<p><em>E) (deprecated encryption algorithm) [conditional on the TSF supporting DTLS 1.2] The evaluator shall send the TSF a DTLS 1.2 client hello that is compliant, except that the ciphersuites field is a list consisting only of ciphersuites indicating a deprecated encryption algorithm, including at least one each of NULL, RC2, RC4, DES, IDEA, and TDES. The evaluator shall observe that the TOE rejects the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>Test E) should still include a test for RC4 ciphersuites, even though DTLS does not support stream ciphers. The test only verifies that the TSF can reject such a negotiation from a test DTLS server, and does not require the use of the cipher.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure, insufficient security) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
<div class="paragraph">
<p><em>See IANA TLS parameters for available ciphersuites to be included. The test ciphersuite should use supported cryptographic algorithms for as many of the other components as possible. For example, if the TSF supports TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384, the test could include TLS_ECDHE_PSK_WITH_NULL_SHA_384, TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5, TLS_ECDHE_RSA_WITH_RC4_128_SHA, TLS_DHE_DSS_WITH_DES_CBC_SHA, TLS_RSA_WITH_IDEA_CBC_SHA, and TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA.</em></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 27:  (extensions)</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A)  (signature algorithms) [conditional] If the TSF supports certificate-based authentication, then for each supported signature algorithm indicated in the ST, the evaluator shall perform the following sub-tests with certificates that represent the TOE. For each sub-test, the evaluator shall establish a certificate representing the TOE and using a public-private key pair suitable for the specific signature algorithm value, and signed by a certification\ authority that uses the same signature algorithm.</em></p>
<div class="paragraph">
<p><em>If the TSF also supports the signature_algorithms_cert extension, then for each value of the signature_algorithms_cert extension, the evaluator shall repeat the sub-tests using a certificate representing the TOE and using a key pair consistent with the signature algorithm, but signed by a certification authority using the signature algorithm specified in the signature_algorithms_cert extension.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>The TSF supports certificate-based server authentication if the TLS 1.2 supported ciphersuites include ciphersuites other than TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 8442, TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 5487, TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 8442, and TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 5487. If these are the only supported ciphersuites, this test is omitted. For TLS 1.3, certificate-based server authentication, the client hello should not include the PSK extension.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall follow operational guidance instructions to provision the TSF with one or more of these certificates as indicated in the following sub-tests:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>(DTLS 1.2) For each supported value of the signature_algorithms extension, the evaluator shall provision a certificate with a key pair compatible with the specific signature_algorithm value and send the TSF a DTLS 1.2 client hello that indicates all supported ciphersuites and has a signature_algorithms extension consisting of a single value matching the specific signature algorithm.</em></p>
<div class="paragraph">
<p><em>If the TSF supports signature_algorithms_cert extension, the client hello also contains the value consistent with the previsioned certificate.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall observe that the TSF negotiates DTLS 1.2 with a DTLS 1.2 ciphersuite that is compatible with the signature algorithm, and that it sends a certificate message containing the provisioned certificate with a key pair that is consistent with the specific signature_algorithm value (and signed using the signature_algorithms_cert extension value, if supported).</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>For DTLS 1.2, the ciphersuite describes the signature algorithm as RSA or ECDSA and is compatible with the certificate used if the signature algorithm component of the ciphersuite is of the same type as the signature value of the signature_algorithms extension.</em></p>
</div>
</li>
<li>
<p><em>ii)</em>
<em>[conditional] If the TSF supports DTLS 1.3, then for each supported value of the signature_algorithm, the evaluator shall provision a certificate with a key pair that is compatible with the specific signature_algorithm value, send a DTLS 1.3 client hello that indicates a supported ciphersuite and has a signature_algorithms extension consisting of a single value matching the specific signature algorithm.</em></p>
<div class="paragraph">
<p><em>If the TSF supports the signature_algorithms_cert extension, the client hello also contains a signature_algorithms_cert extension with a value consistent with the provisioned certificate.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall observe that the TSF sends a certificate message containing the provisioned certificate consistent with the specific signature_algorithm value (and signed using the signature_algorithms_cert extension value) and a certificate verify message using the signature_algorithms extension value.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>For DTLS 1.3, the certificate message and certificate verify is encrypted. The evaluator confirms the values of these messages as received at the test DTLS client, using logs, or using a test DTLS client designed to expose the certificates after they are decrypted.</em></p>
</div>
<div class="paragraph">
<p><em>It is not necessary to manually verify the signature used in the key exchange message (DTLS 1.2) or certificate verify message (DTLS 1.3).</em></p>
</div>
</li>
<li>
<p><em>iii)</em>
<em>[conditional] If the ST indicates that the TSF supports provisioning of multiple certificates, the evaluator shall conduct the following sub-tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>1)</em>
<em>The evaluator shall repeat Test i) with both the provisioned certificate indicated for Test i) and a provisioned certificate using a public key that is not consistent with the signature_algorithm value, but signed by a CA using the signature algorithm specified in the client hello. The evaluator shall observe that the TSF’s certificate message does not include the certificate that does not match the signature_algorithm value in the client hello.</em></p>
</li>
<li>
<p><em>2)</em>
<em>[conditional] If the ST also indicates support for DTLS 1.3, the evaluator shall similarly repeat Test ii) with both the provisioned certificate indicated for Test ii) and a provisioned certificate with public keys that are not consistent with the signature_algorithm value but which are signed by a CA using the signature_algorithm value specified in the client hello, and observe that the certificate message sent by the TSF does not include the certificate that does not match the value of the signature_algorithm entry in the client hello.</em></p>
</li>
<li>
<p><em>3)</em>
<em>[conditional] If the ST also indicates support for the signature_algorithms_cert extension, the evaluator shall repeat Test i) and Test ii) and (if DTLS 1.3 is supported) using additional provisioned certificates representing the TOE that use public keys consistent with the signature_algorithm value, but which are signed by CAs using signature algorithms that do not match the value of the signature_algorithms_cert in the client hello and observe that the TSF’s certificate message does not include the certificate that does not match the signature_algorithms_cert values in the client hello.</em></p>
</li>
</ul>
</div>
</li>
<li>
<p><em>iv)</em>
<em>(DTLS 1.2) The evaluator shall provision a certificate as in Test i) but shall send a client hello that only offers ciphersuites whose signature component does not match the value of the signature_algorithms extension. The evaluator shall observe that the TSF terminates the handshake.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure, illegal parameter) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>B)  (TLS 1.2 extended master secret) [conditional] If the TSF supports DTLS 1.2 the evaluator shall perform the following tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>The evaluator shall initiate a DTLS 1.2 session from a test DTLS client that includes the extended master secret extension in its client hello.  The evaluator shall observe that the TSF’s server hello includes the extended master secret extension in accordance with RFC 7627.</em></p>
</li>
<li>
<p><em>ii)</em>
<em>[conditional]</em>
<em>If the ST author selected 'enforcing client' support, the evaluator shall initiate a DTLS 1.2 session from a test DTLS client configured to compute a master secret according to RFC 5246, section 8. The evaluator shall verify the test DTLS client does not include the extended master secret extension in its client hello. The evaluator shall observe that the TSF terminates the session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake error) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 28:  (key exchange) The evaluator shall perform the following tests to confirm compliant key exchange:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A)</em>
<em>(DTLS 1.2 RSA key exchange) [conditional] If any of the supported TLS 1.2 ciphersuites in the ST includes RSA for the key exchange method, the evaluator shall perform the following sub-tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>For each supported RSA key size, the evaluator shall provision the TSF with a valid certificate that has an RSA public key of that size. The evaluator shall initiate a valid DTLS 1.2 handshake from a compliant test DTLS 1.2 client and observe that the server certificate message matches the provisioned certificate.</em></p>
</li>
<li>
<p><em>ii)</em>
<em>For each supported RSA key size, the evaluator shall send the TSF a compliant DTLS 1.2 client hello, but in place of the client’s key exchange message the evaluator shall send the TSF a (non-compliant) key exchange message that is properly formatted but uses an invalid EncryptedPreMasterSecret field in the DTLS handshake (e.g., modify a byte of a properly computed value). The evaluator shall attempt to complete the handshake using compliant client change cipher spec and finished messages and verify that the TSF terminates the handshake in a manner that is indistinguishable from a finished message error and does not send application data.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>Mitigations for oracle attacks described in RFC 5246 Appendix D require the TSF to exhibit the same behavior for key exchange failures as it does for finished message failures. It is preferred that the TSF send a fatal decrypt failure error alert at the end of the handshake in both this case and for a finished message error, but it is acceptable that the TSF terminate the session with another error alert, or without sending an error alert in either case. If the failure error alert is not for a decryption failure, the evaluator shall note that the TSF’s response agrees with the response observed in the DTLS 1.2 iteration of Test B.)</em></p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>B)  For each supported version, the evaluator shall initiate a compliant handshake up through the (implied for DTLS 1.3) change cipher spec message. The evaluator shall then send a (non-compliant) client finished handshake message with an invalid ‘verify data’ value and verify that the server terminates the session and does not send any application data.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>DTLS 1.2 handshakes include explicit change cipher spec messages, but DTLS 1.3 omits the change cipher spec message. If DTLS 1.3 is supported, the modified finished message is sent as the final message from the client after receiving the server’s second flight of handshake messages [encrypted extensions, (new ticket), (certificate, certificate verify), (certificate request)]</em></p>
</div>
<div class="paragraph">
<p><em>It is preferred that the TSF send a fatal decryption failure error alert, but it is acceptable that the TSF terminate the session using another error alert or without sending an error alert.  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
<div class="paragraph">
<p><em>The finished message is encrypted. The invalid ‘verify data’ can be constructed by modifying a byte of a compliant finished message payload.</em></p>
</div>
</li>
<li>
<p><em>C) (DTLS 1.2 DHE or ECDHE key exchange) [conditional] If the ST indicates support for DHE or ECDHE ciphersuites for TLS 1.2, then the evaluator shall perform the following sub-tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>[conditional] If the TSF supports DHE ciphersuites and supports DHE parameters that are not specified in the supported groups extension, then for each supported DHE parameter set, the evaluator shall follow the operational guidance to configure the TSF to use the DHE parameters in its key exchange. The evaluator shall then initiate a DTLS 1.2 handshake from a test client with a client hello indicating a single DHE ciphersuite. The evaluator shall observe that the TSF key exchange message indicates the configured parameters and ensure that the client key exchange is a valid point for the parameter set. The evaluator shall confirm that the TSF successfully completes the session.</em></p>
<div class="paragraph">
<p><em>The evaluator shall close the session and resend the client hello. After the TSF responds with a valid key exchange message, the evaluator shall send an empty client key exchange message and observe that the TSF terminates the session.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., decryption failure, illegal parameter, handshake error) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
<li>
<p><em>ii)</em>
<em>[conditional] If the TSF supports DHE ciphersuites and supports DHE groups in the supported groups extension, then for each supported DHE group, the evaluator shall send the TSF a compliant DTLS 1.2 client hello indicating a single ciphersuite that is compatible with the group and indicating the group in the supported groups extension. The evaluator shall observe that the TSF negotiates DTLS 1.2 using the indicated ciphersuite and that the server key exchange message indicates the specific group. The evaluator shall send the TOE a client key exchange with a valid point in the group and observe that the TSF successfully completes the session.</em></p>
<div class="paragraph">
<p><em>The evaluator shall close the session and resend the client hello. After the TSF responds with a valid key exchange message, the evaluator shall send the TSF a client key exchange with the public key value '0.' The evaluator shall observe that the TSF terminates the session.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall send a new client hello including the same ciphersuite but indicating a group not supported by the TSF in the supported groups extension. The evaluator shall observe that the TSF terminates the session.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., decryption failure, illegal parameter, handshake error) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
<li>
<p><em>iii)</em>
<em>[conditional] If the TSF supports ECDHE ciphersuites (and therefore supports ECDHE groups in the supported groups extension), the evaluator shall send a client hello message indicating a single supported ECDHE ciphersuite and including the supported ECDHE group in the supported groups extension. The evaluator shall observe that the TSF sends a key exchange message with a valid point of the specified group. The evaluator shall send the TSF a client key exchange message to the TSF consisting of a valid element in the supported group and observe that the TSF successfully completes the session.</em></p>
<div class="paragraph">
<p><em>The evaluator shall close the session and resend the client hello. After the TSF sends the valid key exchange message, the evaluator shall send a client key exchange message consisting of an invalid element of the supported group and observe that the TSF terminates the handshake</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall send a third client hello to the TSF indicating the supported ECDHE ciphersuite and including an ECDHE group that is not supported. The evaluator shall observe that the TSF terminates the session.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., decryption failure, illegal parameter, handshake error, insufficient security) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
<div class="paragraph">
<p><em>An invalid ECDSA point consists of properly formatted x and y components, but for which the equation of the curve is not satisfied. To obtain an invalid point, the evaluator can modify a byte of the y coordinate value of a valid point and confirm that the point is not on the curve.</em></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>The IANA TLS parameters website lists registered ECDHE groups for use in selecting a non-supported group. If the TSF supports all registered ECDHE groups, it is acceptable to send the client hello without a supported groups extension. The TSF should reject such a client hello, but it is acceptable for the TSF to default to a supported group. In this case, the TSF passes the test.</em></p>
</div>
</li>
<li>
<p><em>D)</em>
<em>(DTLS 1.3 key exchange) [conditional] If the TSF supports DTLS 1.3, then for each supported group the evaluator shall perform the following sub-tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>The evaluator shall send the TSF a compliant DTLS 1.3 client hello indicating a single key share value from the supported group and shall observe that the server hello includes valid elements of the supported group.</em></p>
</li>
<li>
<p><em>ii)</em>
<em>The evaluator shall send the TSF a DTLS 1.3 client hello indicating a supported groups value supported by the TSF but containing a key share extension indicating an element claiming to be in the supported group that does not represent a valid element of the group. The evaluator shall observe that the TSF
terminates the session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>DTLS messages include an epoch field that changes with each change_cipher_spec message. This can be used in DTLS 1.3 to indicate the internal change of state corresponding to the implied message.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., illegal parameter, handshake failure, decryption failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>For DHE groups, the invalid element may be of the wrong length; for ECDHE groups, the invalid element has coordinates (x and y) that do not satisfy the equation of the elliptic curve. To obtain an invalid ECDHE point, the evaluator can modify a byte of the y coordinate value of a valid point and confirm that the point is not on the curve.</em></p>
</div>
</li>
<li>
<p><em>E)</em>
<em>For each supported version, the evaluator shall initiate a DTLS handshake from a test DTLS client with compliant handshake messages negotiating the version and supported parameters to include the change cipher spec message (implied for DTLS 1.3), but which omits the finished message and instead sends an application message containing random data. The evaluator shall observe that the TSF terminates the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>A DTLS server may buffer unexpected application messages, and resend previous messages in response to timeouts for missing messages. It is acceptable for the evaluator to observe the TSF resend its final flight multiple times as an indication that it will not process application messages until the client finished message is received. The evaluator should not resend application messages from the test DTLS client, as this might cause the TSF’s counter to continue to reset.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., decryption failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
<div class="paragraph">
<p><em>Application data is indicated by the TLSCipherText ContentType field having value 23 (application data). The legacy record version '03 03' and length fields should match a valid TLSCipherText message of the same size.</em></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 29: The evaluator shall send a DTLS 1.2 client hello message from a test client and observe that the TSF sends a HelloVerifyRequest message. The evaluator shall modify at least one byte in the cookie from the server&#8217;s HelloVerifyRequest message and include the modified value as a cookie in the test client’s second client hello message. The evaluator shall verify that the server rejects the client&#8217;s handshake message.</em></p>
</div>
<div class="paragraph">
<p><em>Test 30: [conditional] If the TSF supports DTLS 1.3, the evaluator shall send a DTLS 1.3 client hello message from a test client and observe that the TSF sends a HelloRetryRequest message. The evaluator shall modify at least one byte in the cookie from the server&#8217;s HelloRetryRequest message and include the modified value as a cookie in the test client’s second client hello message. The evaluator shall verify that the server rejects the client&#8217;s handshake message.</em></p>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_b_3_2_fcs_dtlss_ext_2_dtls_server_support_for_mutual_authentication">B.3.2 FCS_DTLSS_EXT.2 DTLS Server Support for Mutual Authentication</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>The inclusion of this selection-based component depends upon selection in FCS_DTLSS_EXT.1.1.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.2 DTLS Server Support for Mutual Authentication</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.2.1</strong> The TSF shall support authentication of DTLS clients using X.509v3 certificates during the DTLS handshake and [selection: <em>during post-handshake requests, at no other time</em>] using the certificate types indicated in the client’s signature_algorithms and [selection: <em>signature_algorithms_cert, no other</em>] extension.</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 16</em></strong></p>
</div>
<div class="paragraph">
<p><em>This SFR is claimed if "mutual authentication" is selected in FCS_DTLSS_EXT.1.1. DTLS 1.3 supports authentication after completing the abbreviated handshake with pre-shared keys. A server may send a client a certificate request after the finished message whenever the client includes the post-handshake authentication extension. The ST author claims ‘during post-handshake request’ if this feature is supported. If DTLS 1.3 is not supported, or if the DTLS post-handshake request extension is not recognized in a DTLS 1.3 handshake, the ST author selects ‘at no other time’.</em></p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.2.2</strong> The TSF shall support authentication of DTLS clients using X.509v3 certificates in accordance with [selection: <em>FIA_X509_EXT.1/Rev, FIA_X509_EXT.1/ITT</em>].</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.2.3</strong> The TSF shall be able to reject the establishment of a trusted channel if the requested client certificate is invalid and [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>continue establishment of a server-only authenticated DTLS channel in accordance with FCS_DTLSS_EXT.1 in support of [selection: all applications, [assignment: list of calling applications that accept both authenticated and unauthenticated client sessions] ] when an empty certificate message is provided by the client</em></p>
</li>
<li>
<p><em>continue establishment of a mutually authenticated DTLS channel when revocation status information for the [selection: client&#8217;s leaf certificate, [assignment: specific intermediate CA certificates], any non-trust store certificate in the certificate chain] is not available in support of [selection: all applications, [assignment: list of calling applications configurable to perform certificate status information bypass processing] ] as [selection: configured by an administrator, confirmed by the application user, a default for [assignment: subset of applications] ]</em></p>
</li>
<li>
<p><em>no other processing options for missing or invalid client certificates</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>].</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 17</em></strong></p>
</div>
<div class="paragraph">
<p><em>The ST author claims any certificate processing exceptions that are allowed for specific calling applications. The ‘continue establishment of a server-only authenticated DTLS channel…’ selection is claimed if the DTLS product supports applications that can provide services to unauthenticated users if the user does not possess an appropriate certificate. Within this selection, the ST author indicates which applications are able to support both authenticated and unauthenticated users.</em></p>
</div>
<div class="paragraph">
<p><em>The ST author claims ‘continue establishment of a mutually authenticated DTLS channel…’ if there is an administrator configuration or user confirmation that revocation status information is not available for one or more of the certificates in the client’s certificate chain. If claimed, the ST author will describe in the assignment for intermediate values which CA certificates are included in the exception (for example, “all intermediates but the issuing CA” or “specific end-entity certificates as configured”). Within this selection, the ST author specifies which applications are impacted and which authorized user is allowed to approve continuing with the session when revocation information is not available. If an administrator configures whether a user may accept a certificate without status information, both selections are claimed. The ‘as a default’ should only be selected for applications that do not have access to revocation information. Methods for obtaining revocation information are included in FIA_X509_EXT.1/Rev and FIA_X509_EXT.1/ITT.</em></p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.2.4</strong> The TSF shall be able to [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>not establish a DTLS session if an entry of the Distinguished Name or a [selection: ,rfc822_name, dns_name,[assignment: supported name types] ] in the Subject Alternate Name extension contained in the client certificate does not match one of the expected identifiers for the client in accordance with [selection: RFC 2822, RFC 6125, RFC 5280, [assignment: RFC for the supported name type] ] matching rules</em></p>
</li>
<li>
<p><em>pass the [selection: validated certificate, RFC 2822 name normalized according to RFC 2822, DNS name normalized according to RFC 6125, [assignment: list of RFC 5280 name types and normalization rules], [assignment: list of 'other' name types and standard normalization rules] ] to [assignment: list of calling applications capable of making access decisions]</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>].</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 18</em></strong></p>
</div>
<div class="paragraph">
<p><em>Authorization for services provided by the applications that are protected by the DTLS session is determined either by the application establishing a set of reference identifiers or by passing the received identifiers to the application. The ST author indicates the methods supported and, for each method supported, indicates all name types supported; at least one name type is required. In the assignment of the first option, the ST author indicates all name types and the corresponding method for matching in the sub-selections. In the second method option, the ST author indicates which name type normalizations the product supports. If the product passes the entire validated certificate to the application,
no normalization of the names contained in the certificate is expected.</em></p>
</div>
<div class="paragraph">
<p><em>If name normalization is claimed, care should be taken regarding wildcards and IP addresses. IP addresses embedded in DNS host names and in Directory Name CN components have been observed to include non-standard wildcard designations including the ‘*’ character. Any embedded IP addresses should use standard CIDR notation and should not include nonstandard encoding.</em></p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_DTLSS_EXT.2</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall ensure that the TSS description required per FIA_X509_EXT.2.1 includes the use of client-side certificates for DTLS mutual authentication, and that the description includes any certificate validation exception rules and the name types supported for matching to reference identifiers for all applications that use DTLS. The evaluator shall
examine the TSS to ensure that any CN-embedded name types that are used include a description of the encoding and matching rules.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall verify that the operational guidance includes instructions for configuring trust stores for client-side certificates used in DTLS mutual authentication. The evaluator shall ensure that the operational guidance includes instructions for configuring the server to require mutual authentication of clients using these certificates and for configuring any certificate validation exception rules. The evaluator shall ensure that the operational guidance includes instructions for configuring reference identifiers normalized or matched by the TSF and matching rules for
the supported name types.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall use DTLS as a function to verify that the validation rules in FIA_X509_EXT.1/Rev or FIA_X509_EXT.1/ITT are adhered to and shall perform the tests listed below. The evaluator shall apply the operational guidance to configure the server to require DTLS mutual authentication of clients for these tests unless overridden by instructions in the test activity.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>DTLS 1.3 is a fundamentally different protocol than DTLS 1.2, so even though the certificate validation and name checking tests are identical for both versions, it is likely that early deployments of DTLS 1.3 may use a different code-base that warrants independent testing. If DTLS 1.3 is supported and the evaluator can verify that the TSF uses the same code-base for certificate validation and name checking for both DTLS 1.3 and DTLS 1.2, it is acceptable that testing be performed for only one version for these tests.</em></p>
</div>
<div class="paragraph">
<p><em>Test 31:  For each supported version, the evaluator shall follow the operational guidance to configure the TOE to require valid client authentication with no exceptions and initiate a DTLS session from a compliant DTLS test client supporting that version. The evaluator shall ensure that the test client sends a certificate_list structure which has a length of zero. The evaluator shall verify the TSF terminates the session and no application data flows.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure, bad certificate, unknown certificate, unknown CA) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
<div class="paragraph">
<p><em>Test 32:  [conditional] If the ST indicates that the TSF supports establishment of a DTLS session for missing or invalid certificates, then for each supported version, and for each supported response option for a missing or invalid certificate indicated in FCS_DTLSS_EXT.2.3, the evaluator shall configure the TSF according to the operational guidance to respond as indicated for the calling application. The evaluator shall send client handshake messages from a test DTLS client as indicated for each sub-test. The evaluator shall perform the following sub-tests:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) [conditional] If the TSF supports non-authenticated session establishment when receiving an empty certificate message, the evaluator shall initiate a DTLS handshake from a compliant test DTLS client supporting the version and providing a certificate message containing a certificate_list structure of length zero. The evaluator shall confirm that the TSF notifies the calling application that the user is unauthenticated.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>Specific procedures for determining that the calling application is notified will vary based on the application. If an API to the calling application is not available, the evaluator may attempt to configure the calling application to provide a different response (e.g., require authentication for flagged data) for authenticated and non-authenticated users and make a request at the test client that results in a response indicating the application is treating the client as non-authenticated.</em></p>
</div>
</li>
<li>
<p>B) <em>[conditional] If the TSF supports exceptions for when revocation status information is unavailable, then the evaluator shall follow the operational guidance to attempt to establish a narrowly defined exception for which both exempt and non-exempt certificates can be established. The evaluator shall establish a primary certificate chain for the test client that only exhibits the allowed exception and one or more alternate certificate chains for the test client that do not pass the exception rule, as necessary to test the boundaries of the exception rules.</em></p>
<div class="paragraph">
<p><em>The evaluator shall follow the operational guidance to remove any cached revocation status information for the test client’s primary certificate chain. The evaluator shall initiate a valid DTLS session from the test client that presents the primary certificate for the test client, provide any feedback requested by the TSF to confirm the exception, and observe that the TSF allows the certificate and completes the DTLS handshake successfully.</em></p>
</div>
<div class="paragraph">
<p><em>For each alternate certificate chain, the evaluator shall repeat the session initiation from the test client but present the alternate certificate chain and observe that the TSF terminates the session.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., bad certificate, unknown certificate, access denied, handshake error) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
<div class="paragraph">
<p><em>The alternate certificate chains are intended to test the boundaries of the exception rules. For example, if the exception rule indicates that only leaf certificates are exempt, the evaluator will include an alternate certificate chain for which a CA certificate’s revocation information is advertised but is not available; if the exception can be configured for an explicit leaf certificate, or particular subjects, an alternate chain will be included that does not include an excepted certificate or subject. If the exception rules can be configured for all certificates having advertised revocation information, an alternate certificate chain can include an expired certificate – only one additional validity failure (e.g., expired certificate) is required in this case. More comprehensive validity failure handling is addressed by testing for FIA_X509_EXT.1/Rev and FIA_X509_EXT.1/ITT.</em></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 33: For each supported version, the evaluator shall configure the TSF to negotiate the version and require client authentication and perform the following steps:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) For each supported name matching method indicated in the outer selection of FCS_DTLSS_EXT.2.4, and for each name type supported by the matching method as indicated in the inner-selections claimed in each outer selection, the evaluator shall establish a valid primary certificate chain with single names for a test client containing only the supported name types and a valid alternate certificate chain with single names indicating a different name of the same type.</em></p>
</li>
<li>
<p>B) <em>[conditional] If any of the supported name types include CN encoding of a name type also supported as a SAN entry, the evaluator shall establish additional certificate chains:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>The evaluator shall establish a primary certificate chain with multiple names, to include a leaf certificate with:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>a SAN entry that matches the name in the primary certificate chain with single names, of the same SAN name type; and</em></p>
</li>
<li>
<p><em>a CN entry encoding the same SAN type which matches the name in the alternate certificate chain with single names of the CN encoding of the same SAN name type;</em></p>
</li>
</ul>
</div>
</li>
<li>
<p><em>The evaluator shall establish an alternate certificate chain with multiple names, to include a leaf certificate with:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>A SAN entry that matches the name in the alternate certificate chain with single names, of the same SAN name type; and</em></p>
</li>
<li>
<p><em>a CN entry encoding the same SAN type which matches the name in the primary certificate chain with single names, of the CN encoding of the same SAN name type.</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>C) <em>[conditional] If any of the supported name types include CN encoding, the evaluator shall follow the operational guidance to configure the TSF, establishing trust in the root CA for all primary and alternate certificate chains. The evaluator shall configure the TSF and any relevant TOE applications that use DTLS for client authentication as necessary to establish reference identifiers that match the names in the client’s primary certificate chains with single names, but not matching any of the names in the alternate certificate chains with single names.</em></p>
</li>
<li>
<p><em>For each primary certificate chain (with single or multiple names), the evaluator shall initiate a DTLS session from the test DTLS client that is configured to present the primary certificate chain in a certificate message and a valid certificate verify message in response to the server’s certificate request message. The evaluator shall confirm that the TSF accepts the certificate and completes the authenticated DTLS session successfully.</em></p>
</li>
<li>
<p><em>For each alternate certificate chain (with single or multiple names), the evaluator shall initiate a DTLS session from the test DTLS client that is configured to present the alternate certificate chain in a certificate message and a valid certificate verify message in response to the server’s certificate request message. The evaluator shall confirm that the TSF terminates the session.</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., access denied) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
<div class="paragraph">
<p><em>The intent of this test is to confirm that for each method that the TSF uses to match name types presented in validated certificates, it is able to recognize both matching and non-matching names. Names of special types implicitly encoded in the CN entry of the certificate subject name are especially prone to error since they may only be validated by the issuing CA as a directory name (RDN) type, especially if the issuing CA is unaware of the intended encoding as a different name type. It is a best practice that when the CN is interpreted as an embedded name type other than RDN, an explicitly encoded SAN entry should take precedence.</em></p>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_b_3_3_fcs_dtlss_ext_3_dtls_server_downgrade_protection">B.3.3 FCS_DTLSS_EXT.3 DTLS Server Downgrade Protection</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>The inclusion of this selection-based component depends upon selection in FCS_DTLSS_EXT.1.1.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.3 DTLS Server Downgrade Protection</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.3.1</strong> The TSF shall set the server hello extension to a random value concatenated with the TLS 1.2 downgrade indicator when negotiating TLS 1.2 as indicated in RFC 8446 section 4.1.3.</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 19</em></strong></p>
</div>
<div class="paragraph">
<p><em>This SFR is claimed if "supplemental downgrade protection" is selected in FCS_DTLSS_EXT.1.1.</em></p>
</div>
<div class="paragraph">
<p><em>RFC 8446 requires both the TLS 1.2 downgrade indicator as well as an indicator for TLS 1.1 and below. This FP requires the server to reject attempts to establish TLS 1.1 and below, making this mechanism redundant. However, products may still implement both indicators to be compliant with the RFC.</em></p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_DTLSS_EXT.3</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the ST and confirm that the DTLS description includes details on the session downgrade protections that are supported.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the operational guidance to confirm that instructions are included to configure the TSF to
support only DTLS 1.3 and to provide the associated downgrade indications.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>Test 34: The evaluator shall follow the operational guidance as necessary to configure the TSF to negotiate only DTLS 1.3 and to provide the associated downgrade indications. The evaluator shall send a DTLS client hello to the TOE that indicates support for only DTLS 1.2. The evaluator shall observe that the TSF sends a server hello with the last eight bytes of the server random value equal to 44 4F 57 4E 47 52 44 01.</em></p>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_b_3_4_fcs_dtlss_ext_4_dtls_server_support_for_renegotiation">B.3.4 FCS_DTLSS_EXT.4 DTLS Server Support for Renegotiation</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>The inclusion of this selection-based component depends upon selection in FCS_TLS_EXT.1.1.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>B.3.4 FCS_DTLSS_EXT.4 DTLS Server Support for Renegotiation</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.4.1</strong> The TSF shall support secure renegotiation through the use of [selection: the "renegotiation_info" TLS extension, not allowing session renegotiation] in accordance with RFC 5746.</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.4.2</strong>  The TSF shall, when negotiating a DTLS 1.2 session, [selection: include the renegotiation_info extension in server hello messages when a client hello with the renegotiation_info extension is received and shall
terminate a session if neither of the renegotiation_info or TLS_EMPTY_RENEGOTIATION_INFO_SCSV signaling ciphersuites are indicated in the client hello, not allow renegotiation].</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.4.3</strong>  The TSF shall terminate the session if an unexpected client hello is received during an active DTLS session.</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 20</em></strong></p>
</div>
<div class="paragraph">
<p><em>This SFR is claimed if "DTLS as a server" is selected in FCS_DTLS_EXT.1.1. RFC 5746 defines an extension to DTLS 1.2 that binds renegotiation handshakes to the cryptography in the original handshake. As a refinement of the RFC, servers that support renegotiation and negotiating DTLS 1.2 will terminate a session if neither of the methods described in RFC 5746 are offered by the client. RFC 5746 indicates that a server negotiating DTLS 1.2 is required to terminate the session if the conditions for secure renegotiation are not met. Alternatively, a DTLS server may negotiate DTLS 1.2 without any RFC 5746 client renegotiation indicators if it always terminates an existing session when a new client hello is received, similar to the implementation of DTLS 1.3.</em></p>
</div>
<div class="paragraph">
<p><em>DTLS 1.3 does not allow renegotiation. Termination, as indicated in FCS_DTLSS_EXT.4.3, covers DTLS 1.3 sessions as well as DTLS 1.2 sessions where the client hello received does not comply with RFC 5746, or when configured to reject renegotiation (if the product is configurable).</em></p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_DTLSS_EXT.4</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the ST to confirm that the DTLS description includes details on session renegotiation protection methods supported, to include when renegotiation is prohibited.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the operational guidance to confirm that any instructions that are needed to meet the requirements are included. If support for DTLS 1.2 is configurable to use RFC 5746 methods or to deny renegotiation, the evaluator shall ensure that the operational guidance includes instructions for configuring the TSF in this manner.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall perform the following tests, as indicated for each version supported, using a test DTLS client able to construct the indicated messages and expose messages received from the TSF:</em></p>
</div>
<div class="paragraph">
<p><em>Test 35: (RFC 5746 compliant DTLS 1.2 initial handshake) [conditional] If the TSF supports renegotiation, the evaluator shall follow the operational guidance as necessary to configure the TSF to enforce RFC 5746 methods. The evaluator shall initiate a DTLS 1.2 session from a test DTLS client for each of the following sub-tests:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) The evaluator shall send an initial client hello without the renegotiation_info extension and without including the signaling ciphersuite value, TLS_EMPTY_RENEGOTIATION_INFO_SCSV. The evaluator shall observe that the TSF terminates the session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
<li>
<p><em>B) The evaluator shall send an initial client hello with the renegotiation_info extension indicating a renegotiated_connection length greater than zero. The evaluator shall observe that the TSF terminates the session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 36: (renegotiation attempt) For each of the following sub-tests, the evaluator shall establish a compliant DTLS channel with an initial handshake that uses the indicated secure renegotiation method for the version indicated. Without closing the session, the evaluator shall send a second client hello within the channel specific to the version as indicated:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) [conditional] If the TSF allows renegotiation, the evaluator shall configure the TSF to support RFC 5746 methods, send an initial handshake with a valid renegotiation extension, send a new DTLS 1.2 client hello on the DTLS 1.2 channel containing the renegotiation_info extension indicating valid client_verify_data, and observe the TSF successfully completes the handshake.</em></p>
</li>
<li>
<p><em>B) [conditional] If the TSF allows renegotiation, the evaluator shall send an initial client hello containing a valid renegotiation extension, send a new DTLS 1.2 client hello on the DTLS 1.2 channel with the signaling ciphersuite value, TLS_EMPTY_RENEGOTIATION_INFO_SCSV, and observe that the TSF terminates the session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em>  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires._</p>
</div>
</li>
<li>
<p><em>C) [conditional] If the TSF allows renegotiation, for each DTLS 1.2 renegotiation method claimed in accordance with RFC 5746, the evaluator shall send an initial client hello indicating the method, send a new DTLS 1.2 client hello on the DTLS 1.2 channel without a renegotiation_info extension, and observe that the TSF terminates the session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., unexpected message) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
<li>
<p><em>D) [conditional]: If the TSF allows renegotiation, for each DTLS 1.2 renegotiation method claimed in accordance with RFC 5746, the evaluator shall send an initial client hello indicating the method, send a new DTLS 1.2 client hello on the DTLS 1.2 channel with a renegotiation_info extension indicating an invalid client_verify_data value (modify a byte of a valid value), and observe that the TSF terminates the session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., unexpected message) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
<li>
<p><em>E) [conditional] If the TSF supports DTLS 1.3, or if the TSF rejects renegotiation for DTLS 1.2, then for each such version, the evaluator shall follow the operational guidance as necessary to configure the TSF to negotiate the version and reject renegotiation. The evaluator shall initiate a valid initial session for the specified version, send a valid client hello on the non-renegotiable DTLS channel, and observe that the TSF terminates the session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., unexpected message) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
</li>
</ul>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_b_3_5_fcs_dtlss_ext_5_dtls_server_support_for_session_resumption">B.3.5 FCS_DTLSS_EXT.5 DTLS Server Support for Session Resumption</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>The inclusion of this selection-based component depends upon selection in FCS_DTLSS_EXT.1.1.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.5 DTLS Server Support for Session Resumption</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.5.1</strong> The TSF shall support session resumption as a server via the use of [selection: <em>session ID in accordance with RFC 5246, tickets in accordance with RFC 5077, PSK and tickets in accordance with RFC 8446</em>].</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 21</em></strong></p>
</div>
<div class="paragraph">
<p><em>This SFR is claimed if "session resumption" is selected in FCS_DTLSS_EXT.1.1.  The ST author indicates which session resumption mechanisms are supported. One or both of the first two options, "session ID in accordance with RFC 5246" and "tickets in accordance with RFC 5077" are claimed for DTLS 1.2 resumption. If resumption of DTLS 1.3 sessions is supported, "PSK and tickets in accordance with RFC 8446" is selected, and the selection-based SFR FCS_DTLSS_EXT.6 must also be claimed.</em></p>
</div>
<div class="paragraph">
<p><em>While it is possible to perform session resumption using PSK ciphersuites in DTLS 1.2, this is uncommon. Validation of
key exchange and session negotiation rules for PSK ciphersuites is independent of the source of the pre-shared key and is covered in FCS_DTLSS_EXT.1.</em></p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_DTLSS_EXT.5</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the ST and confirm that the DTLS server protocol description includes a description of the supported resumption mechanisms.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall ensure the operational guidance describes instructions for any configurable features of the resumption mechanism.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall perform the following tests:</em></p>
</div>
<div class="paragraph">
<p><em>Test 37:  The evaluator shall perform the following tests, according to the session resumption mechanism supported:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) [conditional]  If the TSF supports session resumption via "session ID in accordance with RFC 5246" the evaluator shall perform the following tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>The evaluator shall establish a compliant initial DTLS session with the TOE and capture the TOE-generated session ID in the Server Hello message. The evaluator shall close the successful session and then initiate a new DTLS connection and send the previously captured session ID to show that the TOE resumed the previous session by responding with ServerHello containing the same SessionID immediately followed by ChangeCipherSpec and Finished messages (as shown in Figure 2 of RFC 4346 or RFC 5246).</em></p>
</li>
<li>
<p><em>ii)</em>
<em>The evaluator shall establish a compliant initial DTLS session with the TOE and capture the TOE-generated session ID in the Server Hello message.  The evaluator shall then, within the same handshake, generate or force an unencrypted fatal Alert message immediately before the test DTLS client would otherwise send its ChangeCipherSpec message thereby disrupting the handshake. The evaluator shall then initiate resumption with a new Client Hello using the previously captured session ID, and verify that the server (1) implicitly rejects the session ID by sending a ServerHello containing a different SessionID and performing a full handshake (as shown in figure 1 of RFC 4346 or RFC 5246), or (2) terminates the connection in some way that prevents the flow of application data.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>If multiple contexts are supported for session resumption, for each of the above test cases, the session ID may be obtained in one context for resumption in another context. There is no requirement that the session ID be obtained and replayed within the same context subject to the description provided in the TSS. All contexts that can reuse a session ID constructed in another context must be tested. It is not mandated that the session establishment and session resumption share context. For example, it is acceptable for a control channel to establish and application channel to resume the session.</em></p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>B) [conditional]  If the TSF supports session resumption via "tickets in accordance with RFC 5077" the evaluator shall perform the following tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>The evaluator shall establish a compliant initial DTLS session with the TOE in which a session ticket is exchanged with the test DTLS client.  The evaluator shall close the successful session.  The evaluator shall then initiate resumption with the session ticket in the ClientHello. The evaluator shall confirm that the TOE responds with an abbreviated handshake described in section 3.1 of RFC 5077 and illustrated with an example in figure 2. Of particular note: if the server successfully verifies the client’s ticket, then it may renew the ticket by including a NewSessionTicket handshake message after the ServerHello in the abbreviated handshake (which is shown in figure 2). This is not required, however as further clarified in section 3.3 of RFC 5077.</em></p>
</li>
<li>
<p><em>ii)</em>
<em>The evaluator shall establish a compliant initial DTLS session with the TOE in which a session ticket is exchanged with the test DTLS client and then close the successful session.  The evaluator shall modify a byte of the session ticket.  The evaluator shall then initiate resumption with the altered session ticket in the ClientHello. The evaluator shall confirm that the TOE either (1) implicitly rejects the session ticket by performing a full handshake (as shown in figure 3 or 4 of RFC 5077), or (2) terminates the connection in some way that prevents the flow of application data.</em></p>
</li>
</ul>
</div>
</li>
<li>
<p><em>C) [conditional]  If the TSF supports session resumption via "PSK and tickets in accordance with RFC 8446" the evaluator shall perform the following tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>The evaluator shall establish a compliant initial DTLS session with the TOE in which a session ticket is exchanged with the test DTLS client.  The evaluator shall close the successful session.  The evaluator shall then initiate resumption with the session ticket in the ClientHello.  The evaluator shall confirm that the TOE responds similarly to figure 3 of RFC 8446 after successfully reusing the pre-shared-key to resume the session. Specifically, the server must not send back a Certificate message if the session is correctly resumed. When the session is resumed, the evaluator shall verify on the DTLS Client used for performing this test, that the TOE (DTLS Server) has not advertised support for the early data extension.</em></p>
</li>
<li>
<p><em>ii)</em>
<em>The evaluator shall establish a compliant initial DTLS session with the TOE in which a session ticket is exchanged with the test DTLS client and then close the successful session.  The evaluator shall modify a byte of the session ticket.  The evaluator shall then initiate resumption with the altered session ticket in the pre-shared-key of the ClientHello. The evaluator shall confirm that the TOE either (1) implicitly rejects the session ticket by performing a full handshake, or (2) terminates the connection in some way that prevents the flow of application data.</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_b_3_6_fcs_dtlss_ext_6_dtls_server_dtls_1_3_resumption_refinements">B.3.6 FCS_DTLSS_EXT.6 DTLS Server DTLS 1.3 Resumption Refinements</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>The inclusion of this selection-based component depends upon selection in FCS_DTLSS_EXT.5.1.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.6 DTLS Server DTLS 1.3 Resumption Refinements</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.6.1</strong> The TSF shall support DTLS 1.3 resumption using PSK with psk_key_exchange_mode extension with the value
psk_dhe_ke.</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.6.2</strong> The TSF shall ignore early data received in DTLS 1.3 sessions.</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 22</em></strong></p>
</div>
<div class="paragraph">
<p><em>This SFR is claimed if "PSK and tickets in accordance with RFC 8446" is selected in FCS_DTLSS_EXT.5.1.</em></p>
</div>
<div class="paragraph">
<p><em>RFC 8446 allows pre-shared keys to be used directly and also allows early data to be protected using only the pre-shared key. This SFR refines the RFC to use PSK only with a supplemental DHE or ECDHE key exchange to ensure perfect forward secrecy for all sessions.</em></p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_DTLSS_EXT.6</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the ST to confirm that the DTLS description includes details on session resumption for DTLS 1.3, describes each application capable of using DTLS 1.3 with PSK, and describes how the TSF and application respond to client attempts to use early data (including via logging or observable responses). The evaluator shall confirm that the DTLS description shows that only the psk_dhe_ke psk_key_exchange_mode is supported and that early information is ignored.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the operational guidance to verify that instructions for any configurable features that are required to meet the requirement are included.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall follow the operational guidance to configure the TSF to negotiate DTLS 1.3 and shall perform the following tests:</em></p>
</div>
<div class="paragraph">
<p><em>Test 38:  The evaluator shall attempt a resumed session (as for Test 37 in Test FCS_DTLSS_EXT.5.1) but using psk_ke mode as the value for the psk_key_exchange_mode in the resumption client hello. The evaluator shall observe that the TSF refuses to resume the session, either by completing a full DTLS 1.3 handshake or by terminating the session.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., illegal parameter) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).  DTLS clients may silently drop flawed or unexpected messages from a DTLS test server. Therefore, it might be necessary to resend the message multiple times from the DTLS test server according to the appropriate DTLS RFC to get the desired response.  DTLS clients do not send fatal error alerts, but should generate them for diagnostics if the test DTLS server repeatedly sends the flawed messages indicated in the tests. If the product generates alerts, the evaluator may observe them in logs of the TSF rather than observing them on the line. Otherwise, the evaluator shall observe the termination of a session (connection state) by verifying that the TSF does not continue to resend messages after the last timeout expires.</em></p>
</div>
<div class="paragraph">
<p><em>Test 39:  The evaluator shall establish a valid DTLS 1.3 session with the TOE and send the data as application data after the finished messages have been verified, and observe the response. The evaluator shall then configure the TOE to clear the response and initiate a resumed session (as for Test 37 in FCS_DTLSS_EXT.5.1) with a test DTLS 1.3 client attempting to provide the same data in early data. The evaluator shall observe that the TSF does not react to the early data as it did when presented as application data after the finished messages, indicating that the data was ignored.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>The specific early data used may depend on the applications calling the DTLS session and should be selected to initiate an observable response in the TSF or calling application as described in the ST. For HTTPS, for example, the early data can be an HTTP POST that updates data at the TOE, which can then be observed via a user interface for the application if the data was posted or via application logging indicating that the operation failed.</em></p>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_b_4_1_fcs_tlsc_ext_1_tls_client_protocol">B.4.1 FCS_TLSC_EXT.1 TLS Client Protocol</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>The inclusion of this selection-based component depends upon selection in FCS_TLS_EXT.1.1.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1 TLS Client Protocol</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.1</strong>  The TSF shall implement [selection: <em>TLS 1.2 (RFC 5246), TLS 1.3 (RFC 8446)</em>]
and no other TLS version as a client that supports additional functionality for session renegotiation protection and [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>mutual authentication</em></p>
</li>
<li>
<p><em>supplemental downgrade protection</em></p>
</li>
<li>
<p><em>session resumption</em></p>
</li>
<li>
<p><em>no optional functionality</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>] and shall abort attempts by a server to negotiate all other TLS or SSL versions.</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 23</em></strong></p>
</div>
<div class="paragraph">
<p><em>This SFR is claimed if "TLS as a client" is selected in FCS_TLS_EXT.1.1.  Session renegotiation protection is required for both TLS 1.2 and TLS 1.3, and the ST must include the requirements from FCS_TLSC_EXT.4. Within FCS_TLSC_EXT.4 options for implementation of secure session renegotiation for TLS 1.2, or rejecting renegotiation requests are claimed.</em></p>
</div>
<div class="paragraph">
<p><em>The ST author will claim TLS 1.3 functionality if supported, and optional functionality as appropriate for the claimed versions.</em></p>
</div>
<div class="paragraph">
<p><em>If "mutual authentication" is selected, then the ST must additionally include the requirements from FCS_TLSC_EXT.2.</em></p>
</div>
<div class="paragraph">
<p><em>If "supplemental downgrade protection" is selected, then the ST must additionally include the requirements from FCS_TLSC_EXT.3.  This is claimed if TLS 1.3 is supported, or if the product supports TLS 1.1 or below downgrade protection using the mechanism described in RFC 8446.</em></p>
</div>
<div class="paragraph">
<p><em>If "session resumption" is selected, then the ST must additionally include the requirements from FCS_TLSC_EXT.5.</em></p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.2</strong> The TSF shall be able to support the following TLS 1.2 ciphersuites: [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289 and RFC 8422</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 8422</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</em></p>
</li>
<li>
<p><em>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</em></p>
</li>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined RFC 5289</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_128_CBC_SHA as defined in RFC 5246</em></p>
</li>
<li>
<p><em>no TLS 1.2 ciphersuites</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>], the following PP-specific ciphersuites using pre-shared secrets: [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 8442</em></p>
</li>
<li>
<p><em>TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>TLS_RSA_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 8442</em></p>
</li>
<li>
<p><em>TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>TLS_RSA_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>no ciphersuites using pre-shared secrets</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>], and the following TLS 1.3 ciphersuites: [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS_AES_256_GCM_SHA384 as defined in RFC 8446</em></p>
</li>
<li>
<p><em>TLS_AES_128_GCM_SHA256 as defined in RFC 8446</em></p>
</li>
<li>
<p><em>[assignment: other TLS 1.3 ciphersuites]</em></p>
</li>
<li>
<p><em>no TLS 1.3 ciphersuites</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>offering the supported ciphersuites in a client hello message in preference order: [<em>assignment: list of supported ciphersuites</em>].</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 24</em></strong></p>
</div>
<div class="paragraph">
<p><em>The ST author should select the ciphersuites that are supported, and must select at least one ciphersuite for each TLS version supported. The ciphersuites to be tested in the evaluated configuration are limited by this requirement. However, this requirement does not restrict the TOE&#8217;s ability to propose additional non-deprecated ciphersuites beyond the ones listed in this requirement in its client hello message as indicated in the ST. That is, the TOE may propose any ciphersuite not excluded by this element, but the evaluation will only test ciphersuites from the above list. It is necessary to limit the ciphersuites that can be used in an evaluated configuration administratively on the server in the test environment.</em></p>
</div>
<div class="paragraph">
<p><em>TLS 1.3 ciphersuites are claimed if support for TLS 1.3 is claimed in FCS_TLSC_EXT.1.1. The assignment of preference order provides an ordered list of all supported ciphersuites with the most preferred ciphersuites listed first. Ciphersuites listed in RFC 9151, “Commercial National Security Algorithm (CNSA) Suite Profile for TLS and DTLS 1.2 and 1.3” are preferred over all other ciphersuites, GCM ciphersuites are preferred over CBC ciphersuites, ECDHE preferred over RSA and DHE, and SHA-256 or SHA-384 over SHA-1.</em></p>
</div>
<div class="paragraph">
<p><em>Ciphersuites for TLS 1.2 are of the form TLS</em>(key exchange algorithm)<em>WITH</em>(encryption algorithm)<em>(message digest algorithm}, and are listed in the TLS parameters section of the internet assignments at iana.org.</em></p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.3</strong>  The TSF shall not offer ciphersuites indicating the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the null encryption component</p>
</li>
<li>
<p>support for anonymous servers</p>
</li>
<li>
<p>use of deprecated or export-grade cryptography including DES, 3DES, RC2, RC4, or IDEA for encryption</p>
</li>
<li>
<p>use of MD</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>and shall abort sessions where a server attempts to negotiate ciphersuites not enumerated in the client hello message.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.4</strong>  The TSF shall be able to support the following TLS client hello message extensions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>signature_algorithms extension (RFC 8446) indicating support for [selection:</p>
<div class="ulist">
<ul>
<li>
<p><em>ecdsa-secp384r1_sha384 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pkcs1_sha384 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pss_pss_sha384 (RFC8603)</em></p>
</li>
<li>
<p><em>rsa_pss_rsae_sha384 (RFC 8603)</em></p>
</li>
<li>
<p><em>[assignment: other non-deprecated signature algorithms]</em></p>
</li>
<li>
<p><em>no other signature algorithms</em></p>
<div class="paragraph">
<p>]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>the following other extensions: [selection:</p>
<div class="ulist">
<ul>
<li>
<p><em>signature_algorithms_cert extension (RFC 8446) indicating support for [selection:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>ecdsa-secp384r1_sha384 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pkcs1_sha384 (RFC8446)</em></p>
</li>
<li>
<p><em>rsa_pss_pss_sha384 (RFC 8603)</em></p>
</li>
<li>
<p><em>rsa_pss_rsae_sha384 (RFC 8603)</em></p>
</li>
<li>
<p><em>rsa_pkcs1_sha256 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pss_rsae_sha256 (RFC 8446)</em></p>
</li>
<li>
<p><em>[assignment: other non-deprecated signature algorithms]</em></p>
</li>
<li>
<p><em>no other signature algorithms</em></p>
<div class="paragraph">
<p>]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>supported_versions extension (RFC 8446) indicating support for TLS 1.3</em></p>
</li>
<li>
<p><em>supported_groups extension (RFC 7919, RFC 8446) indicating support for [selection:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>secp256r1</em></p>
</li>
<li>
<p><em>secp384r1</em></p>
</li>
<li>
<p><em>secp521r1</em></p>
</li>
<li>
<p><em>ffdhe2048(256)</em></p>
</li>
<li>
<p><em>ffdhe3072(257)</em></p>
</li>
<li>
<p><em>ffdhe4096(258)</em></p>
</li>
<li>
<p><em>ffdhe6144(259)</em></p>
</li>
<li>
<p><em>ffdhe8192(260)</em></p>
<div class="paragraph">
<p>]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>key_share extension (RFC 8446)</em></p>
</li>
<li>
<p><em>post_handshake_auth (RFC 8446), pre_shared_key (RFC 8446), and psk_key_exchange_mode (RFC 8446) indicating DHE or ECDHE mode</em></p>
</li>
<li>
<p><em>extended_master_secret extension (RFC 7627) [selection: enforcing, allow legacy] server support</em></p>
</li>
<li>
<p><em>no other extensions</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>] and shall not send the following extensions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>early_data</em></p>
</li>
<li>
<p><em>psk_key_exchange_mode indicating PSK only mode.</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong><em>Application Note 25</em></strong></p>
</div>
<div class="paragraph">
<p><em>If TLS 1.3 is claimed in FCS_TLSC_EXT.1.1, supported_versions, supported_groups, and key_share extensions are claimed in accordance with RFC 8446. If TLS 1.3 is not claimed, supported_versions and key_share extensions are not claimed.  Other extensions may be supported; certain extensions may need to be claimed based on other SFR claims made.</em></p>
</div>
<div class="paragraph">
<p><em>If ECDHE ciphersuites are claimed in FCS_TLSC_EXT.1.2, the supported_groups extension is claimed here with appropriate secp groups claimed. If DHE ciphersuites are claimed in FCS_TLSC_EXT.1.2, it is preferred that the appropriate ffdhe groups be claimed here. In a subsequent version of this FP, support for ffdhe groups will be required whenever DHE ciphersuites are claimed.</em></p>
</div>
<div class="paragraph">
<p><em>When ‘other non-deprecated signature algorithms’ is claimed, the assignment will describe the standard signature and hash algorithms supported. MD5 and SHA-1 hashes are deprecated and are not included in the signature_algorithms or signature_algorithms_cert extensions.</em></p>
</div>
<div class="paragraph">
<p><em>If TLS 1.2 is claimed in FCS_TLSC_EXT.1.1 the extended_master_secret extension is claimed in accordance with RFC 7627.    If the TSF requires a TLS 1.2 server to provide the extended_master_secret extension in its Server Hello message the ST author selects 'enforcing'.  If the TSF allows connections to a TLS 1.2 server that does not provide the extended_master_secret extension in its Server Hello message, the ST author selects 'allow legacy'.</em></p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.5</strong>  The TSF shall be able to [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>verify that a presented identifier of name type: [selection:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>DNS name type according to RFC 6125</em></p>
</li>
<li>
<p><em>URI name type according to RFC 6125</em></p>
</li>
<li>
<p><em>SRV name type according to RFC 6125</em></p>
</li>
<li>
<p><em>Common Name conversion to DNS name according to RFC 6125</em></p>
</li>
<li>
<p><em>Directory name type according to RFC 5280</em></p>
</li>
<li>
<p><em>IPaddress name type according to RFC 5280</em></p>
</li>
<li>
<p><em>rfc822Name type according to RFC 5280</em></p>
</li>
<li>
<p><em>[assignment:  other name type]</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>interface with a client application requesting the TLS channel to verify that a presented identifier</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>] matches a reference identifier of the requested TLS server and shall abort the session if no match is found.</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 26</em></strong></p>
</div>
<div class="paragraph">
<p><em>The rules for verification identity are described in Section 6 of RFC 6125 and Section 7 of RFC 5280. The reference identifier is established by the user (e.g., entering a URL into a web browser or clicking a link), by configuration (e.g., configuring the name of a mail or authentication server),
or by an application (e.g., a parameter of an API) depending on the product service. The client establishes all acceptable reference identifiers and
interfaces with the TLS implementation to provide acceptable reference identifiers, or to accept the presented identifiers as validated in the
server’s certificate. If the product performs matching of the reference identifiers to the identifiers provided in the server’s certificate, the
first option is claimed and all supported name types are claimed; if the product presents the certificate, or the presented identifiers from the
certificate to the application, the second option is claimed.</em></p>
</div>
<div class="paragraph">
<p><em>In most cases where TLS servers are represented by DNS-type names, the preferred method for verification is the Subject Alternative Name using DNS, URI, or Service Names. Verification using a conversion of the Common Name relative distinguished name from a DNS name type in the subject field is allowed for the purposes of backward compatibility.</em></p>
</div>
<div class="paragraph">
<p><em>The client should avoid constructing reference identifiers using wildcards. However, if the presented identifiers include wildcards, the
client must follow the best practices regarding matching; these best practices are captured in the evaluation activity. If the TSF supports wildcards, and allows names with DNS portions containing internationalized names, the internationalized name does not match any wildcard, in accordance with
RFC 6125 section 7.2.</em></p>
</div>
<div class="paragraph">
<p><em>Support for other name types is rare, but may be claimed for specific applications. If specified, the assignment includes both the RFC describing normalization and matching rules, and any refinements necessary to resolve options available in the RFC.</em></p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.6</strong>  The TSF shall not establish a trusted channel if the server certificate is invalid [selection:
<em>with no exceptions, except when override is authorized in the case where valid revocation information is not available</em>].</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 27</em></strong></p>
</div>
<div class="paragraph">
<p><em>A certificate used in a manner that does not support revocation checking should not advertise revocation information locations. Common methods to
address this include revoking the issuing CA, resetting certificate pinning mechanisms, or removing entries from trust stores. Thus, a certificate that does not advertise revocation status information is considered to be not revoked and does not need to be processed via override mechanisms. Override mechanisms are for use with certificates with published revocation status information that is not accessible, whether temporarily or because the information cannot be accessed during the state of the TOE (e.g., for verifying signatures on boot code). The circumstances should be described by the ST author, who should indicate the override mechanism and conditions that apply to the override, including system state, user or admin actions, etc.</em></p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_TLSC_EXT.1</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall check the description of the implementation of this protocol in the TSS to ensure the supported TLS versions, features, ciphersuites, and extensions are specified in accordance with RFC 5246 (TLS 1.2) RFC 8446 (TLS 1.3 and updates to TLS 1.2) and as refined in FCS_TLSC_EXT.1 as appropriate.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall verify that ciphersuites indicated in FCS_TLSC_EXT.1.2 are included in the description, and that none of the following ciphersuites are supported: ciphersuites indicating 'NULL,' 'RC2,' 'RC4,' 'DES,' 'IDEA,' or 'TDES' in the encryption algorithm component, indicating 'anon,' or indicating MD5 or SHA in the message digest algorithm component.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall verify that the TLS implementation description includes the extensions as required in FCS_TLSC_EXT.1.4.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall verify that the ST describes applications that use the TLS functions and how they establish reference identifiers.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall verify that the ST includes a description of matching methods used for each supported name type to the
supported application defined reference identifiers. The evaluator shall verify that the ST includes a description of wildcards
recognized for each name type claimed in FCS_TLSC_EXT.1.5 and shall verify that the matching rules meet or exceed best practices. In particular, the
evaluator shall ensure that the matching rules are as restrictive as, or more restrictive than the following:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>DNS names: The ‘ * ’ character used in the complete leftmost label of a DNS name represents any valid name that has the same number of labels, and</em>
<em>that matches all remaining labels. The ‘ * ’ character must only be used in the leftmost complete label of a properly formatted DNS name. The ‘ * ’</em>  <em>must not be used to represent a public suffix, or in the leftmost label immediately following a public suffix.</em></p>
</li>
<li>
<p><em>URI or SRV names: The ‘ * ’ character can only occur in the domain name portion of the name represented as a DNS name. All restrictions for</em>
<em>wildcards in DNS names apply to the DNS portion of the name. URI host names presented as an IP address are matched according to IP address</em>
<em>matching rules – see best practices for IP addresses below. In accordance with RFC 6125, it is preferred that such URIs are presented a matching</em> <em>name of type IP address in the SAN.</em></p>
</li>
<li>
<p><em>IP addresses: RFC 5280 does not support IP address ranges as presented names, but indicates that presented names may be compared to IP address</em>
<em>ranges present in name constraints. If the TSF supports IP address ranges as reference identifiers, the reference identifier matches if the</em>
<em>presented name is in the range.  IP ranges in name constraints (including reference identifiers) should be presented in CIDR format.</em></p>
</li>
<li>
<p><em>RFC 2822 names: RFC 5280 and updates RFC 8398 and RFC 8399 do not support special indicators representing more than a single mailbox as a</em>
<em>presented name, but indicates that presented names may be compared to a single mailbox, ‘any’ email address at a host, or ‘any’ email address on</em>
<em>a domain (e.g., “example.com” matches any email address on the host example.com and “.example.com” matches any email address in the domain</em>
<em>example.com, but does not match email addresses at the host “example.com”). Such matching is prohibited for internationalized RFC 2822 names.</em></p>
</li>
<li>
<p><em>Embedded CN name types: The CN relative distinguished name of a DNS name type included in the subject field is not strongly typed. Attempts to</em>
 <em>match both the name type and wildcard specifications can result in matches not intended, and therefore, not authoritatively asserted by a</em> <em>certification authority. It is preferred that no matching of CN embedded names be supported, but if necessary for backward compatibility, the</em>
 <em>description should clearly indicate how different name types are interpreted in the matching algorithm. In particular, the ‘*’ character in a</em>
 <em>CN is not to be interpreted as representing more than a single entity unless the entirety of the RDN is properly formatted as a</em>
<em>DNS, URI, or SVR name, and represents a wildcard meeting best practices as described above.</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall check the operational guidance to ensure that it contains instructions on configuring the product so that TLS conforms to the description in the TSS and that it includes any instructions on configuring the version, ciphersuites, or optional extensions that are supported.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall verify that all configurable features for matching identifiers in certificates presented in the TLS handshake to application specific reference identifiers are described.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall perform the following tests:</em></p>
</div>
<div class="paragraph">
<p><em>Test 40: (supported configurations) For each supported version, and for each supported ciphersuite associated with the version:</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall establish a TLS connection between the TOE and a test TLS server that is configured to negotiate the tested version and ciphersuite in accordance with the RFC for the version.</em></p>
</div>
<div class="paragraph">
<p><em>[conditional, if the TSF supports TLS 1.3 only]</em>
<em>The evaluator shall observe that the TSF presents a client hello with the highest version of TLS 1.3 and shall observe that the supported version extension is included and contains the value '03 04' for TLS 1.3.</em></p>
</div>
<div class="paragraph">
<p><em>[conditional, if the TSF supports both TLS 1.3 and TLS 1.2]</em>
<em>The evaluator shall observe that the TSF presents a client hello with the highest version of TLS 1.2 or the legacy version (value '03 03') and shall observe that the supported version extension is included and contains the value '03 04' for TLS 1.3.</em></p>
</div>
<div class="paragraph">
<p><em>[conditional, if the TSF supports TLS 1.2 only]</em>
<em>The evaluator shall observe that the TSF presents a client hello with the highest version of TLS 1.2 or the legacy version (value '03 03') and shall observe that the supported version extension is not included for TLS 1.2.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall observe that the client hello indicates the supported ciphersuites in the order indicated, and that it includes only the extensions supported, with appropriate values, for that version in accordance with the requirement.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall observe that the TOE successfully completes the TLS handshake.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>TOEs supporting TLS 1.3, but allowing a server to negotiate TLS 1.2, should include all ciphersuites and all extensions as required for either version. If such a TOE is configurable to support only TLS 1.2, TLS 1.3, or both TLS 1.2 and TLS 1.3, the test should be performed in each configuration – with advertised ciphersuites appropriate for the configuration.</em></p>
</div>
<div class="paragraph">
<p><em>The connection in the test may be established as part of the establishment of a higher-level protocol, e.g., as part of an EAP session.</em></p>
</div>
<div class="paragraph">
<p><em>It is sufficient to observe the successful negotiation of a ciphersuite to satisfy the intent of the test; it is not necessary to examine the characteristics of the encrypted traffic in an attempt to discern the ciphersuite being used (for example, that the cryptographic algorithm is 128-bit AES and not 256-bit AES).</em></p>
</div>
<div class="paragraph">
<p><em>Test 41: (obsolete versions) The evaluator shall perform the following tests:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) For each of SSL version 2, SSL version 3, TLS version 1.0, TLS version 1.1, and [conditional] TLS version 1.2, the evaluator shall initiate a connection from the TOE to a test TLS server that is configured to negotiate the obsolete version and observe that the TSF terminates the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., protocol version, insufficient security) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
<li>
<p><em>B) The evaluator shall attempt to establish a connection with a test TLS server that is configured to send a server hello message indicating the selected version (referred to as the legacy version in RFC 8446) with a value corresponding to an undefined TLS (legacy) version (e.g., '03 04') and observe that the TSF terminates the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., protocol version) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
<div class="paragraph">
<p><em>This is intended to test the TSF response to non-standard versions, including early proposals for ‘beta TLS 1.3’ versions. RFC 8446 requires the Legacy version to have the value '03 03' and specifies TLS 1.3 in the supported versions extension with the value '03 04'. While not a preferred approach, if continued support for a beta TLS 1.3 version is desired and the TSF cannot be configured to reject such versions, another value (e.g.,  '03 05') can be used. Implementations of non-standard versions are not tested.</em></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 42: (ciphersuites) The evaluator shall perform the following tests on handling unexpected ciphersuites using a test TLS server sending handshake messages compliant with the negotiated version except as indicated in the test:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) (ciphersuite not offered) For each supported version, the evaluator shall attempt to establish a connection with a test TLS server configured to negotiate the supported version and a ciphersuite not included in the client hello and observe that the TOE rejects the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure) in response to this, but it is
acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
<div class="paragraph">
<p><em>This test is intended to test the TSF’s generic ability to recognize non-offered ciphersuites. If the ciphersuites in the client hello are configurable, the evaluator shall configure the TSF to offer a ciphersuite outside those that are supported and use that ciphersuite in the test. If the TSF ciphersuite list is not configurable, it is acceptable to use a named ciphersuite from the IANA TLS protocols associated with the tested version. Additional special cases of this test for special ciphersuites are performed separately.</em></p>
</div>
</li>
<li>
<p><em>B) (version confusion) For each supported version, the evaluator shall attempt to establish a connection with a test TLS server that is configured to negotiate the supported version and a ciphersuite that is not associated with that version and observe that the TOE rejects the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
<div class="paragraph">
<p><em>This test is intended to test TLS 1.3 ciphersuites for a server negotiating TLS 1.2. If TLS 1.3 is supported, the test server negotiating TLS 1.3 should select a TLS 1.2 ciphersuite supported by the TOE for TLS 1.2 and matching the client’s supported groups and signature algorithm indicated by extensions in the TLS 1.3 client hello. If the TOE is configurable to allow both TLS 1.2 and TLS 1.3 servers, the test server should use ciphersuites offered by the TSF in its client hello message.</em></p>
</div>
</li>
<li>
<p><em>C) (null ciphersuite) For each supported version, the evaluator shall attempt to establish a connection with a test TLS server configured to negotiate the null ciphersuite (TLS_NULL_WITH_NULL_NULL) and observe that the TOE rejects the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure, insufficient security) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
<li>
<p><em>D) (anon ciphersuite) [conditional on the TSF supporting TLS 1.2] The evaluator shall attempt to establish a TLS 1.2 connection with a test TLS server configured to negotiate a ciphersuite using the anonymous server authentication method and observe that the TOE rejects the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure, insufficient security) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
<li>
<p><em>E) (deprecated encryption algorithm) [conditional on the TSF supporting TLS 1.2] For each deprecated encryption algorithm (NULL, RC2, RC4, DES, IDEA, and TDES), the evaluator shall attempt to establish a TLS 1.2 connection with a test TLS server configured to negotiate a ciphersuite using the deprecated encryption algorithm and observe that the TOE rejects the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure, insufficient security) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
<div class="paragraph">
<p><em>See IANA TLS parameters for available ciphersuites to be tested. The test ciphersuite should use supported cryptographic algorithms for as many of the other components as possible. For example, if the TSF only supports TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384, the test server could select TLS_ECDHE_PSK_WITH_NULL_SHA_384, TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5, TLS_ECDHE_RSA_WITH_RC4_128_SHA, TLS_DHE_DSS_WITH_DES_CBC_SHA, TLS_RSA_WITH_IDEA_CBC_SHA, and TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA.</em></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 43: (extensions) For each supported version indicated in the following tests, the evaluator shall establish a connection from the TOE with a test server negotiating the tested version and providing server handshake messages as indicated when performing the following tests for validating proper extension handling:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) (signature_algorithms) [conditional] If the TSF supports certificate-based server authentication, the evaluator shall perform the following tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>For each supported version, the evaluator shall initiate a TLS session with a TLS test server and observe that the TSF’s client hello includes the signature_algorithms extension with values in conformance with the ST.</em></p>
</li>
<li>
<p><em>ii)</em>
<em>[conditional] If TLS 1.2 is supported and the TSF supports an ECDHE or DHE ciphersuite, the evaluator shall ensure the test TLS server sends a compliant server hello message selecting TLS 1.2 and one of the supported ECDHE or DHE ciphersuites, a compliant server certificate message, and a key exchange message signed using a signature algorithm and hash combination not included in the client’s hello message (e.g., RSA with SHA-1). The evaluator shall observe that the TSF terminates the handshake.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure, illegal parameter, decryption error) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
<li>
<p><em>iii)</em>
<em>[conditional] If TLS 1.3 is supported, the evaluator shall configure the test TLS server to respond to the TOE with a compliant server hello message selecting TLS 1.3 and a server certificate message, but then also sends a certificate verification message that uses a signature algorithm method not included in the signature_algorithms extension. The evaluator shall observe that the TSF terminates the TLS handshake.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure, illegal parameter, bad certificate, decryption error) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
<li>
<p><em>iv)</em>
<em>[conditional] For all supported versions for which signature_algorithms_cert is not supported, the evaluator shall ensure the test TLS server sends a compliant server hello message for the tested version and a server certificate message containing a valid certificate that represents the test TLS server, but which is signed using a signature and hash combination not included in the TSF’s signature_algorithms extension (e.g., a certificate signed using RSA and SHA-1). The evaluator shall observe that the TSF terminates the TLS session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., unsupported certificate, bad certificate, decryption error, handshake failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
<div class="paragraph">
<p><em>Certificate-based server authentication is required unless the TSF only supports TLS with shared PSK.  For TLS 1.2, this is the case if only TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 8442, TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 5487, TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 8442, or TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 5487, are supported. For TLS 1.3, this is the case if only PSK handshakes are supported.</em></p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>B) (signature_algorithms_cert) [conditional] If signature_algorithms_cert is supported, then for each version that uses the signature_algorithms_cert extension, the evaluator shall ensure that the test TLS server sends a compliant server hello message selecting the tested version and indicating certificate-based server authentication.</em></p>
<div class="paragraph">
<p><em>The evaluator shall ensure that the test TLS server forwards a certificate message containing a valid certificate that represents the test TLS server, but which is signed by a valid Certification Authority using a signature and hash combination not included in the TSF&#8217;s signature_algorithms_cert extension (e.g., a certificate signed using RSA and SHA-1). The evaluator shall confirm the TSF terminates the session.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>Support for certificate-based authentication is assumed if the signature_algorithms_cert is supported. For TLS 1.2, a non-PSK ciphersuite, or one of TLS_RSA_PSK_WITH_AES_256_GCM_SHA384 or TLS_RSA_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 5487 is used to indicate certificate-based server authentication. For TLS 1.3, the test server completes a full handshake, even if a PSK is offered to indicate certificate-based server authentication. If the TSF only supports shared PSK authentication, this test is not performed.</em></p>
</div>
<div class="paragraph">
<p><em>For TLS 1.3, the server certificate message is encrypted. The evaluator will configure the test TLS server with the indicated certificate and ensure that the certificate is indeed sent by observing the buffer of messages to be encrypted, or by inspecting one or both sets of logs from the TSF and test TLS server.</em></p>
</div>
<div class="paragraph">
<p><em>It is preferred that the TSF sends a fatal error alert message (e.g., unsupported certificate, bad certificate, decryption error, handshake failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
<li>
<p><em>C) (TLS 1.2 extended master secret extension) [conditional] If the TSF supports TLS 1.2 the evaluator shall perform the following tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>The evaluator shall initiate a TLS 1.2 session with a test TLS server.  The evaluator shall observe that the TSF’s client hello includes the extended master secret extension in accordance with RFC 7627.</em></p>
</li>
<li>
<p><em>ii)</em>
<em>[conditional]</em>
<em>If the ST author selected 'enforcing server' support, the evaluator shall initiate a TLS 1.2 session with a test TLS server configured to compute a master secret according to RFC 5246, section 8. The evaluator shall verify the test TLS server does not include the extended master secret extension in its server hello. The evaluator shall observe that the TSF terminates the session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>D) (supported_groups) (TLS 1.2 only – for TLS 1.3, testing is combined with testing of the keyshare extension)</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>For each supported group, the evaluator shall initiate TLS session with a compliant test TLS 1.2 server supporting RFC 7919. The evaluator shall ensure that the test TLS server is configured to select TLS 1.2 and a ciphersuite using the supported group. The evaluator shall observe that the TSF’s client hello lists the supported groups as indicated in the ST, and that the TSF successfully establishes the TLS session.</em></p>
</li>
<li>
<p><em>ii)</em>
<em>[conditional on TLS 1.2 support for ECDHE ciphersuites] The evaluator shall initiate a TLS session with a test TLS server that is configured to use an explicit version of a named EC group supported by the client. The evaluator shall ensure that the test TLS server key exchange message includes the explicit formulation of the group in its key exchange message as indicated in RFC 4492 section 5.4. The evaluator shall confirm that the TSF terminates the session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., illegal parameter) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 44: (TLS 1.3 extensions) [conditional] If the TSF supports TLS 1.3, the evaluator shall perform the following tests. For each test, the evaluator shall observe that the TSF’s client hello includes the supported versions extension with the value '03 04' indicating TLS 1.3:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) (supported versions) The evaluator shall initiate TLS 1.3 sessions in turn from the TOE to a test TLS server configured as indicated in the sub-tests below:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>The evaluator shall configure the test TLS server to include the supported versions extension in the server hello containing the value '03 03.' The evaluator shall observe that the TSF terminates the TLS session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., illegal parameter, handshake failure, protocol version) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
<li>
<p><em>ii)</em>
<em>The evaluator shall configure the test TLS server to include the supported versions extension in the server hello containing the value '03 04' and complete a compliant TLS 1.3 handshake. The evaluator shall observe that the TSF completes the TLS 1.3 handshake successfully.</em></p>
</li>
<li>
<p><em>iii)</em>
<em>[conditional] If the TSF is configurable to support both TLS 1.2 and TLS 1.3, the evaluator shall follow operational guidance to configure this behavior. The evaluator shall ensure that the test TLS server sends a TLS 1.2 compliant server handshake and observe that the server random does not incidentally include any downgrade messaging. The evaluator shall observe that the TSF completes the TLS 1.2 handshake successfully.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>Enhanced downgrade protection defined in RFC 8446 is optional, and if supported, is tested separately. The evaluator may configure the test server’s random, or may repeat the test until the server’s random does not match a downgrade indicator.</em></p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>B) (supported groups, key shares) The evaluator shall initiate TLS 1.3 sessions in turn with a test TLS server configured as indicated in the following sub-tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>For each supported group, the evaluator shall configure the compliant test TLS 1.3 server to select a ciphersuite using the group. The evaluator shall observe that the TSF sends an element of the group in its client hello key shares extension (after a hello retry message from the test server, if the key share for the group is not included in the initial client hello). The evaluator shall ensure the test TLS server sends an element of the group in its server hello and observes that the TSF completes the TLS handshake successfully.</em></p>
</li>
<li>
<p><em>ii)</em>
<em>For each supported group, the evaluator shall modify the server hello sent by the test TLS server to include an invalid key share value claiming to be an element the group indicated in the supported groups extension. The evaluator shall observe that the TSF terminates the TLS session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., illegal parameter) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
<div class="paragraph">
<p><em>For DHE ciphersuites, a zero value, or a value greater or equal to the modulus is not a valid element. For ECDHE groups, an invalid point contains x and y coordinates of the correct size, but represents a point not on the curve. The evaluator can construct such an invalid point by modifying a byte in the y coordinate of a valid point and verify that the coordinates do not satisfy the curve equation.</em></p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>A) (PSK support) [conditional] If the TSF supports pre-shared keys, the evaluator shall follow the operational guidance to use pre-shared keys, shall establish a pre-shared key between the TSF and the test TLS server, and initiate TLS 1.3 sessions in turn between the TSF and the test TLS server configured as indicated in the following sub-tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>The evaluator shall configure the TSF to use the pre-shared key and ensure that the test TLS server functions as a compliant TLS 1.3 server. The evaluator shall observe that the TSF’s client hello includes the pre_shared_key extension with the valid PSK indicator shared with the test server. The evaluator shall also observe that the TSF’s client hello also includes the psk_key_exchange_mode and the post_handshake_auth extensions and that the psk_key_exchange_mode indicates one or more of DHE or ECDHE modes but does not include the PSK-only mode. The evaluator shall observe that the TSF completes the TLS 1.3 handshake successfully in accordance with RFC 8446, to include the TSF sending appropriate key shares for one or more of the supported groups.</em></p>
<div class="paragraph">
<p><em>Once the handshake is successful, the evaluator shall cause the test TLS server to send a certificate request and observe that the TSF provides a certificate message and certificate verify message.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It may be necessary to complete a standard handshake and send a new-ticket message from the test TLS server to establish a pre-shared key, or it might be possible to configure the pre-shared key manually via out-of-band mechanisms. This can be performed in conjunction with other testing that is not tested as part of this SFR. It is not required at this time to support emerging standards on establishing PSK, but as such standards are finalized, this FP may be updated to require such support.</em></p>
</div>
<div class="paragraph">
<p><em>TLS messages after the handshake are encrypted so it may not be possible to observe the certificate and certificate verify messages sent by the TSF directly. The evaluator may need to configure the test TLS server to use an application that requires post-handshake client authentication and terminates the session or otherwise has an observable effect if the certificate is not provided.</em></p>
</div>
</li>
<li>
<p><em>ii)</em>
<em>The evaluator shall attempt to configure the TSF to send early data. If there is no indication from the TSF that this is blocked, the evaluator shall repeat test i) with the TSF so configured and observe that the TSF does not send application data prior to receiving the server hello.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>Early data will be encrypted under the PSK and received by the test TLS server prior to it sending a server hello message.</em></p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 45: (corrupt finished message) For each supported version, the evaluator shall initiate a TLS session from the TOE to a test TLS server that sends a compliant set of server handshake messages, except for sending a modified finished message (modify a byte of the finished message that would have been sent by a compliant server). The evaluator shall observe that the TSF terminates the session and does not complete the handshake by observing that the TSF does not send application data provided to the TLS channel.</em></p>
</div>
<div class="paragraph">
<p><em>Test 46: (missing finished message) For each supported version, the evaluator shall initiate a session from the TOE to a test TLS server providing a compliant handshake, except for sending a random TLS message (the five byte header indicates a correct TLS message for the negotiated version, but not indicating a finished message) as the final message. The evaluator shall observe that the TSF terminates the session and does not send application data.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., decryption error) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
<div class="paragraph">
<p><em>For TLS 1.2, the modified message is sent after the change_cipher_spec message. For TLS 1.3, the modified message is sent as the last message of the server’s second flight of messages.</em></p>
</div>
<div class="paragraph">
<p><em>Test 47: (unexpected/corrupt signatures within handshake) The evaluator shall perform the following tests, according to the versions supported.</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) [conditional] If TLS 1.2 is supported and the TSF supports ECDSA or DSA ciphersuites, the evaluator shall initiate a TLS session with a compliant test TLS server and modify the signature in the server key exchange. The evaluator shall observe that the TSF terminates the session with a fatal alert message (e.g., decrypt error, handshake error).</em></p>
</li>
<li>
<p><em>B) [conditional] If TLS 1.3 is supported the evaluator shall initiate a TLS session between the TOE and a test TLS server that is configured to send a compliant server hello message, encrypted extension message, and certificate message, but will send a certificate verify message with an invalid signature (e.g., by modifying a byte from a valid signature). The evaluator shall confirm that the TSF terminates the session with a fatal error alert message (e.g., bad certificate, decrypt error, handshake error).</em></p>
</li>
<li>
<p><em>C) [conditional] If TLS 1.2 is included in the ST and the TSF supports both RSA and ECDSA methods in the signature_algorithm (or, if supported, the signature_algorithms_cert) extension, and if the TSF supports one or more TLS 1.2 ciphersuites indicating each of the RSA and ECDSA methods in its signature components, the evaluator shall choose two ciphersuites: one indicating RSA signature (cipher 1) and one indicating an ECDSA signature (cipher 2). The evaluator shall then establish two certificates that are trusted by the TOE: one representing the test TLS 1.2 server using an RSA signature (cert 1) and one representing the test TLS 1.2 server using an ECDSA signature (cert 2). The evaluator shall initiate a TLS session between the TOE and the test TLS 1.2 server that is configured to select cipher 1 and to send cert 2. The evaluator shall verify that the TSF terminates this TLS session. The evaluator shall then initiate a TLS session between the TOE and the test TLS 1.2 server that is configured to select cipher 2 and to send cert 1. The evaluator shall verify that the TSF also terminates this TLS session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., bad certificate, decryption error, handshake failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 48: [conditional] If the TSF supports certificate-based server authentication, then for each supported version, the evaluator will initiate a TLS session from the TOE to the compliant test TLS server configured to negotiate the tested version, and to authenticate using a certificate trusted by the TSF as specified in the following:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) (certificate extended key usage purpose) The evaluator shall send a server certificate that contains the Server Authentication purpose in the ExtendedKeyUsage extension and verify that a connection is established. The evaluator shall repeat this test using a different certificate that is otherwise valid and trusted but lacks the Server Authentication purpose in the ExtendedKeyUsage extension and observe the TSF terminates the session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>This test may be performed as part of certificate validation testing FIA_X509_EXT.1/Rev or FIA_X509_EXT.1/ITT.</em></p>
</div>
<div class="paragraph">
<p><em>It is preferred that the TSF sends a fatal error alert message (e.g., bad certificate, decryption error, handshake failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
<div class="paragraph">
<p><em>Ideally, the two certificates should be similar in regards to structure, the types of identifiers used, and the chain of trust.</em></p>
</div>
</li>
<li>
<p><em>B) (certificate identifiers) For each supported method of matching presented identifiers, and for each name type for which the TSF parses the presented identifiers from the server certificate for the method, the evaluator shall establish a valid certificate trusted by the TSF to represent the test server using only the tested name type. The evaluator shall perform the following sub-tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>The evaluator shall prepare the TSF as necessary to use the matching method and establish reference identifiers for the test server for the tested name type. The evaluator shall ensure the test TLS server sends a certificate with a matching name of the tested name type and observe that the TSF completes the connection.</em></p>
</li>
<li>
<p><em>ii)</em>
<em>The evaluator shall prepare the TSF as necessary to use the matching method and establish reference identifiers that do not match the name representing the test server. The evaluator shall ensure the test TLS server sends a certificate with a name of the type tested, and observe the TSF terminates the session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., bad certificate, unknown certificate) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
<li>
<p><em>iii)</em>
<em>[conditional] If the TSF supports wildcards for a DNS, URI, or SVR name type, the evaluator shall prepare the TSF as necessary to use the matching method for the name type, and establish a reference identifier.  The evaluator shall establish a certificate for the test server that includes a wildcard name for the DNS portion of the appropriate name type which matches the reference identifier. The evaluator shall ensure the TLS server sends the certificate containing the wildcard name of the type tested, and observe that the TSF completes the connection.</em></p>
</li>
<li>
<p><em>iv)</em>
<em>[conditional] If the TSF supports a DNS, URI, or SVR name type, but does not support wildcards (in general, or specifically for internationalized names of the specified type), the evaluator shall prepare the TSF as necessary to use the matching method and establish a reference identifier that matches a wildcard name for the DNS portion of the appropriate name type, in accordance with the appropriate RFC, in a certificate representing the server. The evaluator shall ensure the TLS server sends the certificate containing the wildcard name of the type tested, and observe that the TSF terminates the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>If the TSF&#8217;s ability to support wildcard certificates is configurable, both iii) iv) and  are performed under the appropriate configuration. This test is required if the TSF supports internationalized names of the specified type – in this case, the reference identifier only includes an internationalized encoding in the leftmost label. The certificate used is intended to match the certificate as if wildcards were supported and if the wildcard extended to internationalized names.</em></p>
</div>
</li>
<li>
<p><em>v)</em>
<em>[conditional] If the TSF supports wildcards for a DNS, URI, or SVR name type, the evaluator shall prepare the TSF as necessary to use the matching method. The evaluator shall establish a reference identifier and a certificate for the server as indicated in each of the subtests described below. The evaluator shall in turn, ensure the TLS server sends the certificate associated with the reference identifier and observe that the TSF terminates the session.</em></p>
<div class="ulist">
<ul>
<li>
<p><em>1)</em>
<em>The reference identifier contains a DNS portion with two labels, and the certificate includes a name whose DNS portion includes a matching rightmost label and a wildcard in the leftmost label.</em></p>
</li>
<li>
<p><em>2)</em>
<em>The reference identifier contains a DNS portion with four labels, and the certificate includes a name whose DNS portion includes two rightmost labels matching the reference identifier, and a wildcard in the third (leftmost) label.</em></p>
</li>
<li>
<p><em>3)</em>
<em>The reference identifier contains a DNS portion with three labels, and the certificate includes a name whose DNS portion includes two rightmost labels matching the reference identifier, and a wildcard in the third (leftmost) label.</em></p>
</li>
</ul>
</div>
</li>
<li>
<p><em>vi)</em>
<em>[conditional] If the TSF supports wildcards and supports embedded DNS, URI, or SVR name types in the CN, then for each supported name type, the evaluator shall repeat iii), iv) and v) using certificates with the prescribed name embedded in the CN.</em></p>
</li>
<li>
<p><em>vii)</em>
<em>[conditional] If the TSF supports IP addresses as an embedded name type in the CN, the evaluator shall establish an IP address as a reference identifier and establish a certificate with a valid DNS name in the subject field, including a CN whose value is the digital formatting of the octets of the reference identifier. The evaluator shall ensure the server sends the certificate and observe that TSF successfully completes the session.</em></p>
</li>
<li>
<p><em>viii)</em>
<em>[conditional] If the TSF supports IP addresses and any embedded name type in the CN, the evaluator shall establish an IP address as a reference identifier and establish a certificate with a valid DNS name in the subject field, including a CN whose value is the digital formatting of the octets of the reference identifier (as in vii) except that one of the octets is replaced by the ‘*’ character. The evaluator shall ensure the server sends the certificate and observe that the TSF terminates the session.</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 49: (mixed identifiers)[conditional] If the TSF supports a name matching method where the TSF performs matching of both CN-encoded name types and SAN names of the same type, then for each such method, and for each such name type, the evaluator shall establish a valid certificate trusted by the TSF to represent the test server using one name for the CN-encoded name type and a different name for the SAN name type The evaluator shall perform the following tests:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>The evaluator shall follow the operational guidance to configure the TSF to use the name matching method and establish reference identifiers matching only the SAN. The evaluator shall ensure that the test server sends the certificate with the matching SAN and non-matching CN-encoded name, and observe that the TSF completes the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>Configuration of the TSF may depend on the application using TLS.</em></p>
</div>
</li>
<li>
<p><em>ii)</em>
<em>The evaluator shall follow the operational guidance to configure the TSF to use the name matching method and establish reference identifiers matching only the CN-encoded name. The evaluator shall ensure that the test server sends the certificate with the matching SAN name and non-matching CN-encoded name, and observe that the TSF terminates the session.</em></p>
<div class="paragraph">
<p><em>It is preferred that the TSF sends a fatal error alert message (e.g., bad certificate, unknown certificate) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert)</em></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 50: (empty certificate) The evaluator shall configure the test TLS server to supply an empty certificate message and verify that the TSF terminates the session.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., bad certificate, unknown certificate) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
<div class="paragraph">
<p><em>Test 51: (invalid certificate) [conditional] If validity exceptions are supported, then for each exception for certificate validity supported, the evaluator shall configure the TSF to allow the exception and ensure the test TLS server sends a certificate that is valid and trusted, except for the allowed exception. The evaluator shall observe that the TSF completes the session.</em></p>
</div>
<div class="paragraph">
<p><em>Without modifying the TSF configuration, the evaluator shall initiate a new session with the test TLS server that includes an additional validation error, and observe that the TSF terminates the session.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., decode error, bad certificate) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
<div class="paragraph">
<p><em>The intent of this test is to verify the scope of the exception processing. If verifying certificate status information is claimed as an exception, then this test will verify that a TLS session succeeds when all supported methods for obtaining certificate status information is blocked from the TSF, to include removing any status information that might be cached by the TSF. If the exception is limited to specific certificates (e.g., only leaf certificates are exempt, or only certain leaf certificates are exempt) the additional validation error could be unavailable revocation information for a non-exempt certificate (e.g., revocation status information from an intermediate CA is blocked for the issuing CA of an exempt leaf certificate, or revocation information from the issuing CA is blocked for a non-exempt leaf certificate). If the only option for the exception is for all revocation information for all certificates, another validation error from FIA_X509_EXT.1/Rev or FIA_X509_EXT.1/ITT (e.g., certificate expiration, extended key usage, etc.) may be used.</em></p>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_b_4_2_fcs_tlsc_ext_2_tls_client_support_for_mutual_authentication">B.4.2 FCS_TLSC_EXT.2 TLS Client Support for Mutual Authentication</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>The inclusion of this selection-based component depends upon selection in FCS_TLSC_EXT.1.1.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.2 TLS Client Support for Mutual Authentication</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.2.1</strong> The TSF shall support mutual authentication using X.509v3 certificates during the handshake and [selection: <em>in support of post-handshake authentication requests, at no other time</em>], in accordance with [selection: <em>RFC 5246, section 7.4.4, RFC 8446, section 4.3.2</em>].</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 28</em></strong></p>
</div>
<div class="paragraph">
<p><em>This SFR is claimed if "mutual authentication" is selected in FCS_TLSC_EXT.1.1.  Clients that support TLS 1.3 and post-handshake authentication claim ‘in support of post-handshake authentication requests’ in the first selection. The ‘at no other time’ selection is claimed for clients only supporting TLS 1.2 or for TLS 1.3 clients that do not support post-handshake authentication.</em></p>
</div>
<div class="paragraph">
<p><em>The certificate request sent by the server specifies the signature algorithms and certification authorities supported by the server. If the client does not possess a matching certificate, it sends an empty certificate message. The structure of the certificate request message is changed in TLS 1.3 to use the signature_algorithm, signature_algorithms_cert, and certificate_authorities extensions, and RFC 8446 allows for TLS 1.2 implementations to use the new message structure. The "RFC 8446, section 4.3.2" option is claimed in the second selection if TLS 1.3 is supported or if the RFC 8446 method is supported for TLS 1.2 servers. The "RFC 5246, section 7.4.4" option is claimed if the RFC 5246 method is supported for interoperability with TLS 1.2 servers that do not adopt the RFC 8446 method. When mutual authentication is supported, at least one of these methods must be claimed, per the selection.</em></p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_TLSC_EXT.2</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall ensure that the TSS description required per FIA_X509_EXT.2.1 includes the use of client-side certificates for TLS mutual authentication. The evaluator shall also ensure that the TSS describes any factors beyond configuration that are necessary in order for the client to engage in mutual authentication using X.509v3 certificates.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall ensure that the operational guidance includes any instructions necessary to configure the TOE to perform mutual authentication. The evaluator shall also verify that the operational guidance required per FIA_X509_EXT.2.1 includes instructions for configuring the client-side certificates for TLS mutual authentication.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>For each supported TLS version, the evaluator shall perform the following tests:</em></p>
</div>
<div class="paragraph">
<p><em>Test 52: The evaluator shall establish a TLS connection from the TSF to a test TLS server that negotiates the tested version and which is not configured for mutual authentication (i.e., does not send a Server’s Certificate Request (type 13) message). The evaluator observes negotiation of a TLS channel and confirms that the
TOE did not send a Client’s Certificate message (type 11) during handshake.</em></p>
</div>
<div class="paragraph">
<p><em>Test 53: The evaluator shall establish a connection to a test TLS server with a shared trusted root that is configured for mutual authentication (i.e., it sends a Server’s Certificate Request (type 13) message). The evaluator observes negotiation of a TLS channel and confirms that the TOE responds with a non-empty Client’s Certificate message (type 11) and Certificate Verify (type 15) message.</em></p>
</div>
<div class="paragraph">
<p><em>Test 54:  [conditional] If the TSF supports post-handshake authentication, the evaluator shall establish a pre-shared key between the TSF and a test TLS 1.3 server. The evaluator shall initiate a TLS session using the pre-shared key and confirm the TSF and test TLS 1.3 server successfully complete the TLS handshake and both support post-handshake authentication. After the session is successfully established, the evaluator shall initiate a certificate request message from the test TLS 1.3 server. The evaluator shall observe that the TSF receives that authentication request and shall take necessary actions, in accordance with the operational guidance, to complete the authentication request. The evaluator shall confirm that the test TLS 1.3 server receives certificate and certificate verification messages from the TSF over the channel that authenticates the client.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>TLS 1.3 certificate requests from the test server and client certificate and certificate verify messages are encrypted. The evaluator confirms that the TSF sends the appropriate messages by examining the messages received at the test TLS 1.3 server and by inspecting any relevant server logs. The evaluator may also take advantage of the calling application to demonstrate that the TOE receives data configured at the test TLS server.</em></p>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_b_4_3_fcs_tlsc_ext_3_tls_client_downgrade_protection">B.4.3 FCS_TLSC_EXT.3 TLS Client Downgrade Protection</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>The inclusion of this selection-based component depends upon selection in FCS_TLSC_EXT.1.1.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.3 TLS Client Downgrade Protection</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.3.1</strong> The TSF shall not establish a TLS channel if the server hello message includes [selection: <em>TLS 1.2 downgrade indicator, TLS 1.1 or below downgrade indicator</em>] in the server random field.</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 29</em></strong></p>
</div>
<div class="paragraph">
<p><em>This SFR is claimed if "supplemental downgrade protection" is selected in FCS_TLSC_EXT.1.1.</em></p>
</div>
<div class="paragraph">
<p><em>The ST author claims the “TLS 1.2 downgrade indicator” when FCS_TLSC_EXT.1 indicates support for both TLS 1.3 and supplemental downgrade protection. This option is not claimed if TLS 1.3 is not supported. The “TLS 1.1 or below downgrade indicator” option may be claimed regardless of support for TLS 1.3, but should only be claimed if the TSF is capable of detecting the indicator. As indicated in FCS_TLSC_EXT.1.1, this FP requires the client to terminate TLS 1.1 or below sessions. It is acceptable for the TSF to always terminate TLS 1.1 sessions based on the server hello negotiated version field and ignore any downgrade indicator. However, a product that is capable of detecting the TLS 1.1 or below downgrade indicator may take different actions depending on whether the TLS 1.1 or below downgrade indicator is set.</em></p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_TLSC_EXT.3</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall review the TSS and confirm that the description of the TLS client protocol includes the downgrade protection mechanism in accordance with RFC 8446 and identifies any configurable features of the TSF needed to meet the requirements. If the ST claims that the TLS 1.1 and below indicator is processed, the evaluator shall confirm that the TSS indicates which configurations allow processing of the downgrade indicator and the specific response of the TSF when it receives the downgrade indicator as opposed to simply terminating the session for the unsupported version.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall review the operational guidance and confirm that any instructions to configure the TSF to meet the requirements are included.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall perform the following tests to confirm the response to downgrade indicators from a test TLS 1.3 server:</em></p>
</div>
<div class="paragraph">
<p><em>Test 55:  [conditional] If the TSF supports both TLS 1.3 and TLS 1.2, the evaluator shall initiate a TLS 1.3 session with a test TLS 1.3 server configured to send a compliant TLS 1.2 server hello (not including any TLS 1.3 extensions) but including the TLS 1.2 downgrade indicator ‘44 4F 57 4E 47 52 44 01’ in the last eight bytes of the server random field. The evaluator shall confirm that the TSF terminates the session.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF send a fatal error alert message (e.g., illegal parameter), but it is acceptable that the TSF terminate the session without sending an error alert.</em></p>
</div>
<div class="paragraph">
<p><em>Test 56:  [conditional] If the TSF supports the TLS 1.1 or below downgrade indicator and if the ST indicates a configuration where the indicator is processed, the evaluator shall follow operational guidance instructions to configure the TSF so it parses a TLS 1.1 handshake to detect and process the TLS downgrade indicator. The evaluator shall initiate a TLS session between the TOE and a test TLS server that is configured to send a TLS 1.1 server hello message with the downgrade indicator ‘44 4F 57 4E 47 52 44 00’ in the last eight bytes of the server random field, but which is otherwise compliant with RFC 4346. The evaluator shall observe that the TSF terminates the session as described in the ST.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF send a fatal error alert message (illegal parameter or unsupported version), but it is acceptable that the TSF terminate the session without sending an error alert.</em></p>
</div>
<div class="paragraph">
<p><em>Use of the TLS 1.1 and below indicator as a redundant mechanism where there is no configuration that actually processes the value does not require additional testing, since this would be addressed by Test 2 for FCS_TLSC_EXT.1.1. This test is only required if the TSF responds differently (e.g., a different error alert) when the downgrade indicator is present than when TLS 1.1 or below is negotiated and the downgrade indicator is not present.</em></p>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_b_4_4_fcs_tlsc_ext_4_tls_client_support_for_renegotiation">B.4.4 FCS_TLSC_EXT.4 TLS Client Support for Renegotiation</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>The inclusion of this selection-based component depends upon selection in FCS_TLS_EXT.1.1.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.4 TLS Client Support for Renegotiation</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.4.1</strong> The TSF shall support secure renegotiation through use of [selection: <em>the “renegotiation_info” TLS extension, the TLS_EMPTY_RENEGOTIATION_INFO_SCSV signaling ciphersuite signaling value</em>] in accordance with RFC 5746, and shall terminate the session if an unexpected server hello is received or [selection: <em>hello request message is received, in no other case</em>].</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 30</em></strong></p>
</div>
<div class="paragraph">
<p><em>This SFR is claimed if "TLS as a client" is selected in FCS_TLS_EXT.1.1.  A client allowing TLS 1.2 connections may present either the "renegotiation_info" extension or the signaling ciphersuite value TLS_EMPTY_RENEGOTIATION_INFO_SCSV in the initial client hello message to indicate support for secure renegotiation. The ST author claims the methods supported. The TLS_EMPTY_RENEGOTIATION_INFO_SCSV is the preferred mechanism for TLS 1.2 protection against insecure renegotiation when the client does not renegotiate. The ST author will claim the ‘hello request message is received’ option in the second selection to indicate support for this mechanism.</em></p>
</div>
<div class="paragraph">
<p><em>RFC 5746 allows the client to accept connections with servers that do not support the extension; this FP refines RFC 5746 and requires the client to terminate sessions with such servers. Thus, unexpected server hello messages include an initial server hello negotiating TLS 1.2 that does not contain a renegotiation_info extension, an initial server hello negotiating TLS 1.2 that has a renegotiation_info that is non-empty, a subsequent server hello negotiating TLS 1.2 that does not contain a renegotiation_info extension, and a subsequent server hello negotiating TLS 1.2 that has a renegotiation_info extension with an incorrect renegotiated_connection value.</em></p>
</div>
<div class="paragraph">
<p><em>TLS 1.3 provides protection against insecure renegotiation by not allowing renegotiation. If TLS 1.3 is claimed in FCS_TLSC_EXT.1.1, the client receives a server hello that attempts to negotiate TLS 1.3, and the server hello also contains a renegotiation_info extension; the client will terminate the connection.</em></p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_TLSC_EXT.4</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the ST to ensure that TLS renegotiation protections are described in accordance with the requirements. The evaluator shall ensure that any configurable features of the renegotiation protections are identified.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the operational guidance to confirm that instructions for any configurable features of the renegotiation protection mechanisms are included.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall perform the following tests as indicated. One or both of "tls-client-accepts-renegotiation" or Test 20 is required, depending on whether the TSF is configurable to reject renegotiation or supports secure renegotiation methods defined for TLS 1.2. If TLS 1.3 is supported, Test 20 is required.</em></p>
</div>
<div class="paragraph">
<p><em>Test 57: [conditional] If the TSF supports a configuration to accept renegotiation requests for TLS 1.2, the evaluator shall follow any operational guidance to configure the TSF. The evaluator shall perform the following tests:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) The evaluator shall initiate a TLS connection with a test server configured to negotiate a compliant TLS 1.2 handshake. The evaluator shall inspect the messages received by the test TLS 1.2 server. The evaluator shall observe that either the “renegotiation_info” field or the SCSV ciphersuite is included in the client hello message during the initial handshake.</em></p>
</li>
<li>
<p><em>B) For each of the following sub-tests, the evaluator shall initiate a new TLS connection with a test TLS 1.2 server configured to send a renegotiation_info extension as specified, but otherwise complete a compliant TLS 1.2 session:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>The evaluator shall configure the test TLS 1.2 server to send a renegotiation_info extension whose value indicates a non-zero length. The evaluator shall confirm that the TSF terminates the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., illegal parameter) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
<li>
<p><em>ii)</em>
<em>The evaluator shall configure the test TLS 1.2 server to send a compliant renegotiation_info extension and observe the TSF successfully completes the TLS 1.2 connection.</em></p>
</li>
<li>
<p><em>iii)</em>
<em>The evaluator shall initiate a session renegotiation after completing a successful handshake with a test TLS 1.2 server that completes a successful TLS 1.2 handshake (as in Test A)) and then sends a hello reset request from the test TLS server with a “renegotiation_info” extension that has an unexpected “client_verify_data” or “server_verify_data” value (modify a byte from a compliant response). The evaluator shall verify that the TSF terminates the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., illegal parameter, handshake error) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 58: [conditional] if the TSF supports a configuration that prevents renegotiation, the evaluator shall perform the following tests:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) (TLS 1.2) [conditional] If the TSF supports a configuration to reject TLS 1.2 renegotiation, the evaluator shall follow the operational guidance as necessary to prevent renegotiation. The evaluator shall initiate a TLS session between the so-configured TSF and a test TLS 1.2 server that is configured to perform a compliant handshake, followed by a hello reset request. The evaluator shall confirm that the TSF completes the initial handshake successfully but terminates the TLS session after receiving the hello reset request.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., unexpected message) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
<li>
<p><em>B) [conditional] If the TSF supports TLS 1.3, the evaluator shall initiate a TLS session between the TSF and a test TLS 1.3 server that completes a compliant TLS 1.3 handshake, followed by a hello reset message. The evaluator shall observe that the TSF completes the initial TLS 1.3 handshake successfully, but terminates the session on receiving the hello reset message.</em></p>
<div class="paragraph">
<p><em>It is preferred that the TSF sends a fatal error alert message (e.g., unexpected message) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
</ul>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_b_4_5_fcs_tlsc_ext_5_tls_client_support_for_session_resumption">B.4.5 FCS_TLSC_EXT.5 TLS Client Support for Session Resumption</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>The inclusion of this selection-based component depends upon selection in FCS_TLSC_EXT.1.1.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.5 TLS Client Support for Session Resumption</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.5.1</strong>  The TSF shall support session resumption as a client via the use of [selection: <em>session ID in
accordance with RFC 5246, tickets in accordance with RFC 5077, PSK and tickets in accordance with RFC 8446</em>].</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 31</em></strong></p>
</div>
<div class="paragraph">
<p><em>This SFR is claimed if "session resumption" is selected in FCS_TLSC_EXT.1.1.  The ST author indicates which session resumption mechanisms are supported. One or both of the first two options, "session ID in accordance with RFC 5246" and "tickets in accordance with RFC 5077" are claimed for TLS 1.2 resumption. If resumption of TLS 1.3 sessions is supported, "PSK and tickets in accordance with RFC 8446" is selected, and the selection-based SFR FCS_TLSC_EXT.6 must also be claimed.</em></p>
</div>
<div class="paragraph">
<p><em>While it is possible to perform session resumption using PSK ciphersuites in TLS 1.2, this is uncommon. Validation of key exchange and session negotiation rules for PSK ciphersuites is independent of the source of the pre-shared key and is covered in FCS_TLSC_EXT.1.</em></p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_TLSC_EXT.5</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the ST and confirm that the TLS client protocol description includes a description of the supported resumption mechanisms.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall ensure the operational guidance describes instructions for any configurable features of the resumption mechanism.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall perform the following tests:</em></p>
</div>
<div class="paragraph">
<p><em>Test 59: For each supported TLS version and for each supported resumption mechanism that is supported for that version, the evaluator shall establish a new TLS session between the TSF and a compliant test TLS server that is configured to negotiate the indicated version and perform resumption using the indicated mechanism. The evaluator shall confirm that the TSF completes the initial TLS handshake and shall cause the TSF to close the session normally. The evaluator shall then cause the TSF to resume the session with the test TLS server using the indicated method and observe that the TSF successfully establishes the session.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>For each method, successful establishment refers to proper use of the mechanism, to include compliant extensions and behavior, as indicated in the referenced RFC.</em></p>
</div>
<div class="paragraph">
<p><em>Test 60:  (TLS 1.3 session id echo) [conditional] If the TSF supports TLS 1.3, the evaluator shall initiate a new TLS 1.3 session with a test TLS server. The evaluator shall cause the test TLS server to send a TLS 1.3 server hello message (or a hello retry request if the TSF doesn’t include the key share extension) that contains a different value in the legacy_session_id field, and observe that the TSF terminates the session.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., illegal parameter) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_b_4_6_fcs_tlsc_ext_6_tls_client_tls_1_3_resumption_refinements">B.4.6 FCS_TLSC_EXT.6 TLS Client TLS 1.3 Resumption Refinements</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>The inclusion of this selection-based component depends upon selection in FCS_TLSC_EXT.5.1.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.6 TLS Client TLS 1.3 Resumption Refinements</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.6.1</strong> The TSF shall send a psk_key_exchange_mode extension with the value psk_dhe_ke when TLS 1.3 session
resumption is offered.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.6.2</strong>  The TSF shall not send early data in TLS 1.3 sessions.</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 32</em></strong></p>
</div>
<div class="paragraph">
<p><em>This SFR is claimed if "PSK and tickets in accordance with RFC 8446" is selected in FCS_TLSC_EXT.5.1.  This SFR is claimed when session resumption is supported for TLS 1.3. RFC 8446 allows pre-shared keys to be used directly and also allows early data to be protected using only the pre-shared key. This SFR refines the RFC to use PSK only with a supplemental DHE or ECDHE key exchange to ensure perfect forward secrecy for all sessions.</em></p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_TLSC_EXT.6</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the TSS to verify that the TLS client protocol description indicates that the PSK exchange requires DHE mode and prohibits sending early data. The evaluator shall examine the TSS to verify it lists all applications that can be secured by TLS 1.3 using pre-shared keys and describes how each TLS 1.3 client application ensures data for the application is not sent using early data.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the operational guidance to verify that instructions for any configurable features that are required to meet the requirement are included. The evaluator shall ensure the operational guidance includes any instructions required to configure applications so the TLS 1.3 client implementation does not send early data.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>Test 61:  [conditional] For each application that is able to be secured via TLS 1.3 using PSK, the evaluator shall follow operational guidance to configure the application not to send early data. The evaluator shall cause the application to initiate a resumed TLS 1.3 session between the TSF and a compliant test TLS 1.3 server as in Test 20 in FCS_TLSC_EXT.5. The evaluator shall observe that the TSF client hello for TLS 1.3 includes the psk_mode extension with the value psk_dhe_ke and sends a key share value for a supported group. The evaluator shall confirm that early data is not received by the test TLS server.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>If no applications supported by the TOE provide data to TLS 1.3 that can be sent using PSK, this test is omitted.</em></p>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_b_5_1_fcs_tlss_ext_1_tls_server_protocol">B.5.1. FCS_TLSS_EXT.1 TLS Server Protocol</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>The inclusion of this selection-based component depends upon selection in FCS_TLS_EXT.1.1.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1 TLS Server Protocol</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.1</strong>  The TSF shall implement [selection: <em>TLS 1.2 (RFC 5246), TLS 1.3 (RFC 8446)</em>] and no other TLS version as a server that supports additional functionality for session renegotiation protection and [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>mutual authentication</em></p>
</li>
<li>
<p><em>supplemental downgrade protection</em></p>
</li>
<li>
<p><em>session resumption</em></p>
</li>
<li>
<p><em>no optional functionality</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>] and shall reject connection attempts from clients supporting all other TLS or SSL versions.</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 33</em></strong></p>
</div>
<div class="paragraph">
<p><em>This SFR is claimed if "TLS as a server" is selected in FCS_TLS_EXT.1.1.  These requirements will be revisited as new TLS versions are standardized by the IETF.</em></p>
</div>
<div class="paragraph">
<p><em>Session renegotiation protection is required for both TLS 1.2 and TLS 1.3, and the ST must include the requirements from FCS_TLSS_EXT.4. Within FCS_TLSS_EXT.4, options for implementation of secure session renegotiation for TLS 1.2 or rejecting renegotiation requests are claimed.</em></p>
</div>
<div class="paragraph">
<p><em>If "mutual authentication" is selected, then the ST must additionally include the requirements from FCS_TLSS_EXT.2.</em></p>
</div>
<div class="paragraph">
<p><em>If "supplemental downgrade protection" is selected, then the ST must additionally include the requirements from FCS_TLSS_EXT.3. If the TOE provides downgrade protection as indicated in RFC 8446, in particular, if TLS 1.3 is supported, this selection must be made.</em></p>
</div>
<div class="paragraph">
<p><em>If "session resumption" is selected, then the ST must additionally include the requirements from FCS_TLSS_EXT.5.</em></p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.2</strong>  The TSF shall be able to support the following TLS 1.2 ciphersuites: [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289 and RFC 8422</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289 and RFC 8422</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</em></p>
</li>
<li>
<p><em>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</em></p>
</li>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_128_CBC_SHA as defined in RFC 5246</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>], the following PP-specific ciphersuites using pre-shared secrets: [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 8442</em></p>
</li>
<li>
<p><em>TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>TLS_RSA_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 8442</em></p>
</li>
<li>
<p><em>TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>TLS_RSA_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>no ciphersuites using pre-shared secrets</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>], and the following TLS 1.3 ciphersuites: [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS_AES_256_GCM_SHA384 as defined in RFC 8446</em></p>
</li>
<li>
<p><em>TLS_AES_128_GCM_SHA256 as defined in RFC 8446</em></p>
</li>
<li>
<p>[<em>assignment: other TLS 1.3 ciphersuites</em>]</p>
</li>
<li>
<p><em>no TLS 1.3 ciphersuites</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>] using a preference order based on [selection: <em>RFC 9151 priority, client hello ordering,
[assignment: additional priority]</em>].</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 34</em></strong></p>
</div>
<div class="paragraph">
<p><em>The ST author should select the ciphersuites that are supported and must select at least one ciphersuite for each TLS version supported. It is necessary to limit the ciphersuites that can be used in an evaluated configuration administratively on the server in the test environment. If administrative steps need to be taken so that the ciphersuites negotiated by the implementation are limited to those in this requirement, then the appropriate instructions need to be contained in the guidance.</em></p>
</div>
<div class="paragraph">
<p><em>The final selection indicates the TOE’s preference for negotiating a ciphersuite. RFC 9151 indicates the required ciphersuites for NSS systems and ‘RFC 9151 priority’ is claimed if those ciphersuites are selected whenever offered by the client. In general, it is preferred that GCM ciphersuites are selected over CBC ciphersuites, ECDHE is selected over RSA and DHE, and SHA256 or SHA384 is selected over SHA1.</em></p>
</div>
<div class="paragraph">
<p><em>The ‘client hello ordering’ option is claimed if client priority is considered; if both are claimed, the ST author should indicate which is primary and which is secondary, and whether the priority scheme is configurable. If other priority schemes or if tertiary priority is used, the ST author will claim the third option and describe the scheme in the ST.</em></p>
</div>
<div class="paragraph">
<p><em>Support for TLS_RSA_WITH_AES_128_CBC_SHA is not required despite being mandated by RFC 5246.</em></p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.3</strong>  The TSF shall not establish a connection with a client that does not indicate support for at least one of the supported ciphersuites.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.4</strong>  The TSF shall be able to process the following TLS client hello message extensions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>signature_algorithms extension (RFC 8446) indicating support for [selection:</p>
<div class="ulist">
<ul>
<li>
<p><em>ecdsa-secp384r1_sha384 (RFC] 8446)</em></p>
</li>
<li>
<p><em>rsa_pkcs1_sha384 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pss_pss_sha384 (RFC 8603)</em></p>
</li>
<li>
<p><em>rsa_pss_rsae_sha384 (RFC 8603)</em></p>
</li>
<li>
<p>[assignment: <em>other non-deprecated signature algorithms</em>]</p>
</li>
<li>
<p><em>no other signature algorithms</em></p>
<div class="paragraph">
<p>]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>the following other extensions: [selection:</p>
<div class="ulist">
<ul>
<li>
<p><em>signature_algorithms_cert extension (RFC 8446) indicating support for [selection:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>ecdsa-secp384r1_sha384 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pkcs1_sha384 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pss_pss_sha384 (RFC 8603)</em></p>
</li>
<li>
<p><em>rsa_pss_rsae_sha384 (RFC 8603)</em></p>
</li>
<li>
<p><em>rsa_pkcs1_sha256 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pss_rsae_sha256 (RFC 8446)</em></p>
</li>
<li>
<p>[assignment: <em>other non-deprecated signature algorithms</em>]</p>
</li>
<li>
<p><em>no other signature algorithms</em></p>
<div class="paragraph">
<p>]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>supported_versions extension (RFC 8446) indicating support for TLS 1.3</em></p>
</li>
<li>
<p><em>supported_groups extension (RFC 7919, RFC 8446) indicating support for [selection:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>secp256r1</em></p>
</li>
<li>
<p><em>secp384r1</em></p>
</li>
<li>
<p><em>secp521r1</em></p>
</li>
<li>
<p><em>ffdhe2048(256)</em></p>
</li>
<li>
<p><em>ffdhe3072(257)</em></p>
</li>
<li>
<p><em>ffdhe4096(258)</em></p>
</li>
<li>
<p><em>ffdhe6144(259)</em></p>
</li>
<li>
<p><em>ffdhe8192(260)</em></p>
<div class="paragraph">
<p>]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>key_share extension (RFC 8446)</em></p>
</li>
<li>
<p><em>extended_master_secret extension (RFC 7627) [selection: enforcing, allow legacy] client support</em></p>
</li>
<li>
<p><em>no other extensions</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>].</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 35</em></strong></p>
</div>
<div class="paragraph">
<p><em>If support for TLS 1.3 is claimed in FCS_TLSS_EXT.1.1, the selections for supported_versions, supported_groups, and key_share are claimed. Even if support for TLS 1.3 is not claimed, if ECDHE ciphersuites are claimed in FCS_TLSS_EXT.1.2, the entry for supported_groups is claimed. Support for additional extensions is acceptable. For signature_algorithms and signature_algorithms_certs (if supported), at least one of the signature schemes presented in the first sub-selection is claimed.</em></p>
</div>
<div class="paragraph">
<p><em>If TLS 1.2 is claimed in FCS_TLSS_EXT.1.1 the extended_master_secret extension is claimed in accordance with RFC 7627.    If the TSF requires a TLS 1.2 client to provide the extended_master_secret extension in its Client Hello message the ST author selects 'enforcing'.  If the TSF allows connections to a TLS 1.2 client that does not provide the extended_master_secret extension in its Client Hello message, the ST author selects 'allow legacy'.</em></p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.5</strong>  The TSF shall perform key establishment for TLS using [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>RSA with size [selection: [2048, 3072, 4096] bits and no other sizes</em></p>
</li>
<li>
<p><em>Diffie-Hellman parameters with size [selection: [2048, 3072, 4096, 6144, 8192 ] bits and no other sizes</em></p>
</li>
<li>
<p><em>Diffie-Hellman groups [selection: [ffdhe2048, ffdhe3072, ffdhe4096, ffdhe6144, ffdhe8192] and no other groups, consistent with the client&#8217;s supported groups extension and [selection: [key share, no other] extension</em></p>
</li>
<li>
<p><em>ECDHE parameters using elliptic curves [selection: secp256r1, secp384r1, secp521r1] and no other curves, consistent with the client&#8217;s supported groups extension and [selection: [key share, no other] extension and using non-compressed formatting for points</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>].</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 36</em></strong></p>
</div>
<div class="paragraph">
<p><em>TLS 1.2 and TLS 1.3 perform key exchange using different mechanisms. In TLS 1.2, the requirements apply to the key exchange messages received by the server and optionally (for DHE or ECDHE ciphersuites) sent by the server. In TLS 1.3, the requirements apply to the values of the key share extension contained in the client and server hello messages. The options depend on the supported ciphersuites. For each session, the key exchange method is consistent with the selected ciphersuite (TLS 1.2), the supported groups extension (TLS 1.3 and conditionally, TLS 1.2), or the key share extension (TLS 1.3).</em></p>
</div>
<div class="paragraph">
<p><em>If the ST lists an RSA ciphersuite in FCS_TLSS_EXT.1.2, the ST must include the RSA selection in the requirement.</em></p>
</div>
<div class="paragraph">
<p><em>If the ST lists a DHE ciphersuite in FCS_TLSS_EXT.1.2, the ST must include the Diffie-Hellman selection for parameters of a certain size, the Diffie-Hellman groups selection in support of TLS 1.2 exchanges, or both. The selection for "Diffie-Hellman parameters" refers to the method defined by RFC 5246, section 7.4.3 where the server provides Diffie-Hellman parameters to the client. The “Diffie-Hellman groups” selection indicates key exchange negotiation in accordance with RFC 7919 using the supported groups extension. RFC 7919 identifies particular Diffie-Hellman groups, which are listed in the following selection. This option is the preferred mechanism for TLS 1.2, and must be claimed if TLS 1.3 FFDHE groups (e.g., ffdhe2048) are supported.</em></p>
</div>
<div class="paragraph">
<p><em>If the ST lists an ECDHE ciphersuite in FCS_TLSS_EXT.1.2, the ST must include the selection for ECDHE using elliptic curves in the requirement, consistent with the support indicated for the supported groups extension in FCS_TLSS_EXT.1.4.</em></p>
</div>
<div class="paragraph">
<p><em>When TLS 1.3 is negotiated (if supported), the supported group negotiated (a supported DHE or ECDHE group) agrees with one of the client’s supported groups and the supplied key share element, and the product’s key share element is a member of the selected group. If the TLS 1.3 client does not initially provide a key share element for a group supported by both the product and the client, the TOE is expected to send a hello retry request message indicating the selected group; the requirement for matching the group indicated in the client’s hello message applies to the client’s hello message received in response to the hello retry request message.</em></p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_TLSS_EXT.1</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall check the description of the implementation of this protocol in the TSS to ensure the supported TLS versions, features, ciphersuites, and extensions, are specified in accordance with RFC 5246 (TLS 1.2) and RFC 8446 (TLS 1.3 and updates to TLS 1.2) as appropriate. The evaluator shall check the description to see if beta TLS 1.3 versions are supported.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall verify that ciphersuites indicated in FCS_TLSS_EXT.1.2 are included in the description, and that none of the following ciphersuites are supported: ciphersuites indicating 'NULL,' 'RC2,' 'RC4,' 'DES,' 'IDEA,' or 'TDES' in the encryption algorithm component, indicating 'anon,' or indicating MD5 or SHA in the message digest algorithm component.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall verify that the TLS implementation description includes the extensions as required in FCS_TLSS_EXT.1.4.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall confirm that the TLS description includes the number and types of certificates that can be installed to represent the TOE</em>.</p>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall check the operational guidance to ensure that it contains instructions on configuring the product so that the TSF conforms to the requirements. If the ST indicates that beta versions of TLS 1.3 are supported for backward compatibility, the evaluator shall ensure that the operational guidance provides instructions for disabling these versions.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall review the operational guidance to ensure instructions on installing certificates representing the TOE are provided.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall perform the following tests:</em></p>
</div>
<div class="paragraph">
<p><em>Test 62:  (supported TLS 1.2 configurations) The evaluator shall perform the following tests:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) For each supported TLS 1.2 ciphersuite, the evaluator shall send a compliant TLS 1.2 client hello with the highest version or legacy version of 1.2 (value '03 03'), a single entry in the ciphersuites field consisting of the specific ciphersuite, and no supported version extension or key share extension. The evaluator shall observe the TSF]’s server hello indicates TLS 1.2 in the highest version or legacy version field, does not include a supported version or key share extension, and indicates the specific ciphersuite in the ciphersuite field. If the ciphersuite requires certificate-based authentication, the evaluator shall observe that the TSF sends a valid certificate representing the TOE and successfully completes the TLS handshake.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>The ciphersuites TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 8442, TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 5487, TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 8442, and TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 5487, if supported, do not require certificate-based authentication of the server.</em></p>
</div>
</li>
<li>
<p><em>B) (TLS 1.2 support for TLS 1.3 clients) [conditional] If the TSF is configurable to support only TLS 1.2 (or if TLS 1.3 is not supported), and if the TSF supports DHE or ECDHE ciphersuites, the evaluator shall follow any operational guidance instructions necessary to configure the TSF to only support TLS 1.2. For each supported TLS 1.2 ciphersuite with DHE or ECDHE indicated as the key exchange method, the evaluator shall send a client hello with the highest version or legacy version of 1.2 (value '03 03'), a list of ciphersuites consisting of one or more TLS 1.3 ciphersuites followed by the specific TLS 1.2 ciphersuite and no other TLS 1.2 ciphersuites in the ciphersuites field, and including a TLS 1.3 supported group and key share extension with consistent values. The evaluator shall observe that the TSF’s server hello indicates TLS 1.2 in the highest version or legacy version field, does not include a supported version or key share extension, and indicates the specific TLS 1.2 ciphersuite in the ciphersuite field. The evaluator shall observe that the TSF completes the TLS 1.2 handshake successfully.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>Supported ciphersuites using RSA key exchange should not be included in this test. The supported groups extension sent by the test TLS client should be consistent with the TLS 1.2 ciphersuite (e.g., it should be an EC group if the ciphersuite is ECDHE).</em></p>
</div>
</li>
<li>
<p><em>C) (TLS 1.3 support) [conditional] If the TSF supports TLS 1.3, then for each supported TLS 1.3 ciphersuite and key exchange group, the evaluator shall send a compliant TLS 1.3 client hello indicating a list of one or more TLS 1.2 ciphersuites followed by the specific TLS 1.3 ciphersuite and no other ciphersuites in the ciphersuites field, a supported version extension indicating TLS 1.3 (value '03 04') only, a supported groups extension indicating the selected group, and a key share extension containing a value representing an element of the specific group. The evaluator shall observe the TSF’s server hello contains the supported versions extension indicating TLS 1.3, the specific ciphersuite in the selected ciphersuite field, and a key share extension containing an element of the specific supported group. The evaluator shall observe that the TSF completes the TLS 1.3 handshake successfully.</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>The connections in Test A. may be established as part of the establishment of a higher-level protocol, e.g., as part of an EAP session.</em></p>
</div>
<div class="paragraph">
<p><em>It is sufficient to observe the successful negotiation of a ciphersuite to satisfy the intent of the test; it is not necessary to examine the characteristics of the encrypted traffic in an attempt to discern the ciphersuite being used (for example, that the cryptographic algorithm is 128-bit AES and not 256-bit AES).</em></p>
</div>
<div class="paragraph">
<p><em>It is not necessary to pair every supported ciphersuite with every supported group. It is sufficient to use a set of ciphersuite and supported group pairs such that each ciphersuite and each supported group are included in this set.</em></p>
</div>
<div class="paragraph">
<p><em>TLS 1.3 includes the supported_groups extension in the encrypted_extensions message. This message may be observed at the test client after it is decrypted to help verify the key_share is actually a member of the supported group requested.</em></p>
</div>
<div class="paragraph">
<p><em>Test 63:  (obsolete versions) The evaluator shall perform the following tests:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) For each of SSL version 2, SSL version 3, TLS version 1.0, and TLS version 1.1, and [conditional] TLS version 1.2, the evaluator shall send a client hello to the TSF indicating the selected version as the highest version. The evaluator shall observe the TSF terminates the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., protocol version, insufficient security) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
<li>
<p><em>B) The evaluator shall follow the operational guidance to configure the TSF to ensure any supported beta TLS 1.3 versions are disabled, as necessary. The evaluator shall send the TSF a client hello message indicating the supported version (referred to as the legacy version in RFC 8446) with the value '03 04' but without including the supported_versions extension and observe that the TSF responds with a server hello indicating the highest version supported.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>Test B) is intended to test the TSF response to non-standard versions, including beta versions of TLS 1.3. If the TSF supports such beta versions, the evaluator shall follow the operational guidance instructions to disable them prior to conducting Test B)</em></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 64:  (ciphersuites) The evaluator shall perform the following tests on handling unexpected ciphersuites using a test TLS client sending handshake messages compliant with the negotiated version except as indicated in the test:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A)  (ciphersuite not supported) For each supported version, the evaluator shall follow the operational guidance, if available, to configure the TSF to disable a supported ciphersuite. The evaluator shall send a compliant client hello to the TSF indicating support for the specific version and a ciphersuites field containing this single disabled ciphersuite. The evaluator shall observe that the TOE rejects the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
<div class="paragraph">
<p><em>If the TSF’s ciphersuites are not configurable, it is acceptable to use a named ciphersuite from the IANA TLS protocols associated with the tested version. Additional special cases of this test for special ciphersuites are performed separately.</em></p>
</div>
</li>
<li>
<p><em>B)   (version confusion) For each supported version, the evaluator shall send a client hello that is compliant for the specific version that includes a list of ciphersuites consisting of a single ciphersuite not associated with that version. The evaluator shall observe that the TOE rejects the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
<div class="paragraph">
<p><em>It is preferred that Test B) use TLS 1.3 ciphersuites for a server negotiating TLS 1.2. If TLS 1.3 is supported, Test B) also includes a server negotiating TLS 1.3 with a TLS 1.2 ciphersuite – in this case, the negotiated ciphersuite should be chosen to be one supported by the TOE if negotiating TLS 1.2. If the TOE is configurable to allow both TLS 1.2 and TLS 1.3 clients (or does so by default), this configuration is used for both the TLS 1.2 and TLS 1.3 iteration of this test; otherwise the TOE is configured to support the negotiated version in each iteration.</em></p>
</div>
</li>
<li>
<p><em>C)   (null ciphersuite) For each supported version, the evaluator shall send a client hello indicating support for the version and include a ciphersuite list consisting of only the null ciphersuite (TLS_NULL_WITH_NULL_NULL, with the value '00 00') and observe that the TOE rejects the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure, insufficient security) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
<li>
<p><em>D) (anon ciphersuite) [conditional on the TSF supporting TLS 1.2] The evaluator shall send the TSF a TLS 1.2 handshake that is compliant, except that the ciphersuites field includes a ciphersuite list consisting only of ciphersuites using the anonymous server authentication method and observe that the TOE rejects the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure, insufficient security) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
<div class="paragraph">
<p><em>See IANA TLS parameters for available ciphersuites to be included in the client hello. The test ciphersuites list should include ciphersuites using supported cryptographic algorithms in as many of the other components as possible. For example, if the TSF supports the ciphersuite TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384, the evaluator should include TLS_DH_ANON_WITH_AES_256_GCM_SHA_384.</em></p>
</div>
</li>
<li>
<p><em>E) (deprecated encryption algorithm) [conditional on the TSF supporting TLS 1.2] The evaluator shall send the TSF a TLS 1.2 client hello that is compliant, except that the ciphersuites field is a list consisting only of ciphersuites indicating a deprecated encryption algorithm, including at least one each of NULL, RC2, RC4, DES, IDEA, and TDES. The evaluator shall observe that the TOE rejects the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure, insufficient security) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
<div class="paragraph">
<p><em>See IANA TLS parameters for available ciphersuites to be included. The test ciphersuite should use supported cryptographic algorithms for as many of the other components as possible. For example, if the TSF supports TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384, the test could include TLS_ECDHE_PSK_WITH_NULL_SHA_384, TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5, TLS_ECDHE_RSA_WITH_RC4_128_SHA, TLS_DHE_DSS_WITH_DES_CBC_SHA, TLS_RSA_WITH_IDEA_CBC_SHA, and TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA.</em></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 65:  (extensions)</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A)  (signature algorithms) [conditional] If the TSF supports certificate-based authentication, then for each supported signature algorithm indicated in the ST, the evaluator shall perform the following sub-tests with certificates that represent the TOE. For each sub-test, the evaluator shall establish a certificate representing the TOE and using a public-private key pair suitable for the specific signature algorithm value, and signed by a certification\ authority that uses the same signature algorithm.</em></p>
<div class="paragraph">
<p><em>If the TSF also supports the signature_algorithms_cert extension, then for each value of the signature_algorithms_cert extension, the evaluator shall repeat the sub-tests using a certificate representing the TOE and using a key pair consistent with the signature algorithm, but signed by a certification authority using the signature algorithm specified in the signature_algorithms_cert extension.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>The TSF supports certificate-based server authentication if the TLS 1.2 supported ciphersuites include ciphersuites other than TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 8442, TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 5487, TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 8442, and TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 5487. If these are the only supported ciphersuites, this test is omitted. For TLS 1.3, certificate-based server authentication, the client hello should not include the PSK extension.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall follow operational guidance instructions to provision the TSF with one or more of these certificates as indicated in the following sub-tests:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>(TLS 1.2) For each supported value of the signature_algorithms extension, the evaluator shall provision a certificate with a key pair compatible with the specific signature_algorithm value and send the TSF a TLS 1.2 client hello that indicates all supported ciphersuites and has a signature_algorithms extension consisting of a single value matching the specific signature algorithm.</em></p>
<div class="paragraph">
<p><em>If the TSF supports signature_algorithms_cert extension, the client hello also contains the value consistent with the previsioned certificate.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall observe that the TSF negotiates TLS 1.2 with a TLS 1.2 ciphersuite that is compatible with the signature algorithm, and that it sends a certificate message containing the provisioned certificate with a key pair that is consistent with the specific signature_algorithm value (and signed using the signature_algorithms_cert extension value, if supported).</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>For TLS 1.2, the ciphersuite describes the signature algorithm as RSA or ECDSA and is compatible with the certificate used if the signature algorithm component of the ciphersuite is of the same type as the signature value of the signature_algorithms extension.</em></p>
</div>
</li>
<li>
<p><em>ii)</em>
<em>[conditional] If the TSF supports TLS 1.3, then for each supported value of the signature_algorithm, the evaluator shall provision a certificate with a key pair that is compatible with the specific signature_algorithm value, send a TLS 1.3 client hello that indicates a supported ciphersuite and has a signature_algorithms extension consisting of a single value matching the specific signature algorithm.</em></p>
<div class="paragraph">
<p><em>If the TSF supports the signature_algorithms_cert extension, the client hello also contains a signature_algorithms_cert extension with a value consistent with the provisioned certificate.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall observe that the TSF sends a certificate message containing the provisioned certificate consistent with the specific signature_algorithm value (and signed using the signature_algorithms_cert extension value) and a certificate verify message using the signature_algorithms extension value.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>For TLS 1.3, the certificate message and certificate verify is encrypted. The evaluator confirms the values of these messages as received at the test TLS client, using logs, or using a test TLS client designed to expose the certificates after they are decrypted.</em></p>
</div>
<div class="paragraph">
<p><em>It is not necessary to manually verify the signature used in the key exchange message (TLS 1.2) or certificate verify message (TLS 1.3).</em></p>
</div>
</li>
<li>
<p><em>iii)</em>
<em>[conditional] If the ST indicates that the TSF supports provisioning of multiple certificates, the evaluator shall conduct the following sub-tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>1)</em>
<em>The evaluator shall repeat Test i) with both the provisioned certificate indicated for Test i) and a provisioned certificate using a public key that is not consistent with the signature_algorithm value, but signed by a CA using the signature algorithm specified in the client hello. The evaluator shall observe that the TSF’s certificate message does not include the certificate that does not match the signature_algorithm value in the client hello.</em></p>
</li>
<li>
<p><em>2)</em>
<em>[conditional] If the ST also indicates support for TLS 1.3, the evaluator shall similarly repeat Test ii) with both the provisioned certificate indicated for Test ii) and a provisioned certificate with public keys that are not consistent with the signature_algorithm value but which are signed by a CA using the signature_algorithm value specified in the client hello, and observe that the certificate message sent by the TSF does not include the certificate that does not match the value of the signature_algorithm entry in the client hello.</em></p>
</li>
<li>
<p><em>3)</em>
<em>[conditional] If the ST also indicates support for the signature_algorithms_cert extension, the evaluator shall repeat Test i) and Test ii) and (if TLS 1.3 is supported) using additional provisioned certificates representing the TOE that use public keys consistent with the signature_algorithm value, but which are signed by CAs using signature algorithms that do not match the value of the signature_algorithms_cert in the client hello and observe that the TSF’s certificate message does not include the certificate that does not match the signature_algorithms_cert values in the client hello.</em></p>
</li>
</ul>
</div>
</li>
<li>
<p><em>iv)</em>
<em>(TLS 1.2) The evaluator shall provision a certificate as in Test i) but shall send a client hello that only offers ciphersuites whose signature component does not match the value of the signature_algorithms extension. The evaluator shall observe that the TSF terminates the handshake.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure, illegal parameter) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>B)  (TLS 1.2 extended master secret) [conditional] If the TSF supports TLS 1.2 the evaluator shall perform the following tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>The evaluator shall initiate a TLS 1.2 session from a test TLS client that includes the extended master secret extension in its client hello.  The evaluator shall observe that the TSF’s server hello includes the extended master secret extension in accordance with RFC 7627.</em></p>
</li>
<li>
<p><em>ii)</em>
<em>[conditional]</em>
<em>If the ST author selected 'enforcing client' support, the evaluator shall initiate a TLS 1.2 session from a test TLS client configured to compute a master secret according to RFC 5246, section 8. The evaluator shall verify the test TLS client does not include the extended master secret extension in its client hello. The evaluator shall observe that the TSF terminates the session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake error) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 66:  (key exchange) The evaluator shall perform the following tests to confirm compliant key exchange:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A)</em>
<em>(TLS 1.2 RSA key exchange) [conditional] If any of the supported TLS 1.2 ciphersuites in the ST includes RSA for the key exchange method, the evaluator shall perform the following sub-tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>For each supported RSA key size, the evaluator shall provision the TSF with a valid certificate that has an RSA public key of that size. The evaluator shall initiate a valid TLS 1.2 handshake from a compliant test TLS 1.2 client and observe that the server certificate message matches the provisioned certificate.</em></p>
</li>
<li>
<p><em>ii)</em>
<em>For each supported RSA key size, the evaluator shall send the TSF a compliant TLS 1.2 client hello, but in place of the client’s key exchange message the evaluator shall send the TSF a (non-compliant) key exchange message that is properly formatted but uses an invalid EncryptedPreMasterSecret field in the TLS handshake (e.g., modify a byte of a properly computed value). The evaluator shall attempt to complete the handshake using compliant client change cipher spec and finished messages and verify that the TSF terminates the handshake in a manner that is indistinguishable from a finished message error and does not send application data.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>Mitigations for oracle attacks described in RFC 5246 Appendix D require the TSF to exhibit the same behavior for key exchange failures as it does for finished message failures. It is preferred that the TSF send a fatal decrypt failure error alert at the end of the handshake in both this case and for a finished message error, but it is acceptable that the TSF terminate the session with another error alert, or without sending an error alert in either case. If the failure error alert is not for a decryption failure, the evaluator shall note that the TSF’s response agrees with the response observed in the TLS 1.2 iteration of Test B.)</em></p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>B)  For each supported version, the evaluator shall initiate a compliant handshake up through the (implied for TLS 1.3) change cipher spec message. The evaluator shall then send a (non-compliant) client finished handshake message with an invalid ‘verify data’ value and verify that the server terminates the session and does not send any application data.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>TLS 1.2 handshakes include explicit change cipher spec messages, but TLS 1.3 omits the change cipher spec message. If TLS 1.3 is supported, the modified finished message is sent as the final message from the client after receiving the server’s second flight of handshake messages [encrypted extensions, (new ticket), (certificate, certificate verify), (certificate request)]</em></p>
</div>
<div class="paragraph">
<p><em>It is preferred that the TSF send a fatal decryption failure error alert, but it is acceptable that the TSF terminate the session using another error alert or without sending an error alert.</em></p>
</div>
<div class="paragraph">
<p><em>The finished message is encrypted. The invalid ‘verify data’ can be constructed by modifying a byte of a compliant finished message payload.</em></p>
</div>
</li>
<li>
<p><em>C) (TLS 1.2 DHE or ECDHE key exchange) [conditional] If the ST indicates support for DHE or ECDHE ciphersuites for TLS 1.2, then the evaluator shall perform the following sub-tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>[conditional] If the TSF supports DHE ciphersuites and supports DHE parameters that are not specified in the supported groups extension, then for each supported DHE parameter set, the evaluator shall follow the operational guidance to configure the TSF to use the DHE parameters in its key exchange. The evaluator shall then initiate a TLS 1.2 handshake from a test client with a client hello indicating a single DHE ciphersuite. The evaluator shall observe that the TSF key exchange message indicates the configured parameters and ensure that the client key exchange is a valid point for the parameter set. The evaluator shall confirm that the TSF successfully completes the session.</em></p>
<div class="paragraph">
<p><em>The evaluator shall close the session and resend the client hello. After the TSF responds with a valid key exchange message, the evaluator shall send an empty client key exchange message and observe that the TSF terminates the session.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., decryption failure, illegal parameter, handshake error) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
<li>
<p><em>ii)</em>
<em>[conditional] If the TSF supports DHE ciphersuites and supports DHE groups in the supported groups extension, then for each supported DHE group, the evaluator shall send the TSF a compliant TLS 1.2 client hello indicating a single ciphersuite that is compatible with the group and indicating the group in the supported groups extension. The evaluator shall observe that the TSF negotiates TLS 1.2 using the indicated ciphersuite and that the server key exchange message indicates the specific group. The evaluator shall send the TOE a client key exchange with a valid point in the group and observe that the TSF successfully completes the session.</em></p>
<div class="paragraph">
<p><em>The evaluator shall close the session and resend the client hello. After the TSF responds with a valid key exchange message, the evaluator shall send the TSF a client key exchange with the public key value '0.' The evaluator shall observe that the TSF terminates the session.</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall send a new client hello including the same ciphersuite but indicating a group not supported by the TSF in the supported groups extension. The evaluator shall observe that the TSF terminates the session.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., decryption failure, illegal parameter, handshake error) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
<li>
<p><em>iii)</em>
<em>[conditional] If the TSF supports ECDHE ciphersuites (and therefore supports ECDHE groups in the supported groups extension), the evaluator shall send a client hello message indicating a single supported ECDHE ciphersuite and including the supported ECDHE group in the supported groups extension. The evaluator shall observe that the TSF sends a key exchange message with a valid point of the specified group. The evaluator shall send the TSF a client key exchange message to the TSF consisting of a valid element in the supported group and observe that the TSF successfully completes the session.</em></p>
<div class="paragraph">
<p><em>The evaluator shall close the session and resend the client hello. After the TSF sends the valid key exchange message, the evaluator shall send a client key exchange message consisting of an invalid element of the supported group and observe that the TSF terminates the handshake</em></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall send a third client hello to the TSF indicating the supported ECDHE ciphersuite and including an ECDHE group that is not supported. The evaluator shall observe that the TSF terminates the session.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., decryption failure, illegal parameter, handshake error, insufficient security) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
<div class="paragraph">
<p><em>An invalid ECDSA point consists of properly formatted x and y components, but for which the equation of the curve is not satisfied. To obtain an invalid point, the evaluator can modify a byte of the y coordinate value of a valid point and confirm that the point is not on the curve.</em></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>The IANA TLS parameters website lists registered ECDHE groups for use in selecting a non-supported group. If the TSF supports all registered ECDHE groups, it is acceptable to send the client hello without a supported groups extension. The TSF should reject such a client hello, but it is acceptable for the TSF to default to a supported group. In this case, the TSF passes the test.</em></p>
</div>
</li>
<li>
<p><em>D)</em>
<em>(TLS 1.3 key exchange) [conditional] If the TSF supports TLS 1.3, then for each supported group the evaluator shall perform the following sub-tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>The evaluator shall send the TSF a compliant TLS 1.3 client hello indicating a single key share value from the supported group and shall observe that the server hello includes valid elements of the supported group.</em></p>
</li>
<li>
<p><em>ii)</em>
<em>The evaluator shall send the TSF a TLS 1.3 client hello indicating a supported groups value supported by the TSF but containing a key share extension indicating an element claiming to be in the supported group that does not represent a valid element of the group. The evaluator shall observe that the TSF
terminates the session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., illegal parameter, handshake failure, decryption failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>For DHE groups, the invalid element may be of the wrong length; for ECDHE groups, the invalid element has coordinates (x and y) that do not satisfy the equation of the elliptic curve. To obtain an invalid ECDHE point, the evaluator can modify a byte of the y coordinate value of a valid point and confirm that the point is not on the curve.</em></p>
</div>
</li>
<li>
<p><em>E)</em>
<em>For each supported version, the evaluator shall initiate a TLS handshake from a test TLS client with compliant handshake messages negotiating the version and supported parameters to include the change cipher spec message (implied for TLS 1.3), but which omits the finished message and instead sends an application message containing random data. The evaluator shall observe that the TSF terminates the connection.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., decryption failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
<div class="paragraph">
<p><em>Application data is indicated by the TLSCipherText ContentType field having value 23 (application data). The legacy record version '03 03' and length fields should match a valid TLSCipherText message of the same size.</em></p>
</div>
</li>
</ul>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_b_5_2_fcs_tlss_ext_2_tls_server_support_for_mutual_authentication">B.5.2 FCS_TLSS_EXT.2 TLS Server Support for Mutual Authentication</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>The inclusion of this selection-based component depends upon selection in FCS_TLSS_EXT.1.1.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.2 TLS Server Support for Mutual Authentication</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.2.1</strong> The TSF shall support authentication of TLS clients using X.509v3 certificates during the TLS handshake and [selection: <em>during post-handshake requests, at no other time</em>] using the certificate types indicated in the client’s signature_algorithms and [selection: <em>signature_algorithms_cert, no other</em>] extension.</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 37</em></strong></p>
</div>
<div class="paragraph">
<p><em>This SFR is claimed if "mutual authentication" is selected in FCS_TLSS_EXT.1.1. TLS 1.3 supports authentication after completing the abbreviated handshake with pre-shared keys. A server may send a client a certificate request after the finished message whenever the client includes the post-handshake authentication extension. The ST author claims ‘during post-handshake request’ if this feature is supported. If TLS 1.3 is not supported, or if the TLS post-handshake request extension is not recognized in a TLS 1.3 handshake, the ST author selects ‘at no other time’.</em></p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.2.2</strong> The TSF shall support authentication of TLS clients using X.509v3 certificates in accordance with [selection: <em>FIA_X509_EXT.1/Rev, FIA_X509_EXT.1/ITT</em>].</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.2.3</strong> The TSF shall be able to reject the establishment of a trusted channel if the requested client certificate is invalid and [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>continue establishment of a server-only authenticated TLS channel in accordance with FCS_TLSS_EXT.1 in support of [selection: all applications, [assignment: list of calling applications that accept both authenticated and unauthenticated client sessions] ] when an empty certificate message is provided by the client</em></p>
</li>
<li>
<p><em>continue establishment of a mutually authenticated TLS channel when revocation status information for the [selection: client&#8217;s leaf certificate, [assignment: specific intermediate CA certificates], any non-trust store certificate in the certificate chain] is not available in support of [selection: all applications, [assignment: list of calling applications configurable to perform certificate status information bypass processing] ] as [selection: configured by an administrator, confirmed by the application user, a default for [assignment: subset of applications] ]</em></p>
</li>
<li>
<p><em>no other processing options for missing or invalid client certificates</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>].</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 38</em></strong></p>
</div>
<div class="paragraph">
<p><em>The ST author claims any certificate processing exceptions that are allowed for specific calling applications. The ‘continue establishment of a server-only authenticated TLS channel…’ selection is claimed if the TLS product supports applications that can provide services to unauthenticated users if the user does not possess an appropriate certificate. Within this selection, the ST author indicates which applications are able to support both authenticated and unauthenticated users.</em></p>
</div>
<div class="paragraph">
<p><em>The ST author claims ‘continue establishment of a mutually authenticated TLS channel…’ if there is an administrator configuration or user confirmation that revocation status information is not available for one or more of the certificates in the client’s certificate chain. If claimed, the ST author will describe in the assignment for intermediate values which CA certificates are included in the exception (for example, “all intermediates but the issuing CA” or “specific end-entity certificates as configured”). Within this selection, the ST author specifies which applications are impacted and which authorized user is allowed to approve continuing with the session when revocation information is not available. If an administrator configures whether a user may accept a certificate without status information, both selections are claimed. The ‘as a default’ should only be selected for applications that do not have access to revocation information. Methods for obtaining revocation information are included in FIA_X509_EXT.1/Rev and FIA_X509_EXT.1/ITT.</em></p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.2.4</strong> The TSF shall be able to [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>not establish a TLS session if an entry of the Distinguished Name or a [selection: ,rfc822_name, dns_name,[assignment: supported name types] ] in the Subject Alternate Name extension contained in the client certificate does not match one of the expected identifiers for the client in accordance with [selection: RFC 2822, RFC 6125, RFC 5280, [assignment: RFC for the supported name type] ] matching rules</em></p>
</li>
<li>
<p><em>pass the [selection: validated certificate, RFC 2822 name normalized according to RFC 2822, DNS name normalized according to RFC 6125, [assignment: list of RFC 5280 name types and normalization rules], [assignment: list of 'other' name types and standard normalization rules] ] to [assignment: list of calling applications capable of making access decisions]</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>].</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 39</em></strong></p>
</div>
<div class="paragraph">
<p><em>Authorization for services provided by the applications that are protected by the TLS session is determined either by the application establishing a set of reference identifiers or by passing the received identifiers to the application. The ST author indicates the methods supported and, for each method supported, indicates all name types supported; at least one name type is required. In the assignment of the first option, the ST author indicates all name types and the corresponding method for matching in the sub-selections. In the second method option, the ST author indicates which name type normalizations the product supports. If the product passes the entire validated certificate to the application,
no normalization of the names contained in the certificate is expected.</em></p>
</div>
<div class="paragraph">
<p><em>If name normalization is claimed, care should be taken regarding wildcards and IP addresses. IP addresses embedded in DNS host names and in Directory Name CN components have been observed to include non-standard wildcard designations including the ‘*’ character. Any embedded IP addresses should use standard CIDR notation and should not include nonstandard encoding.</em></p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_TLSS_EXT.2</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall ensure that the TSS description required per FIA_X509_EXT.2.1 includes the use of client-side certificates for TLS mutual authentication, and that the description includes any certificate validation exception rules and the name types supported for matching to reference identifiers for all applications that use TLS. The evaluator shall
examine the TSS to ensure that any CN-embedded name types that are used include a description of the encoding and matching rules.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall verify that the operational guidance includes instructions for configuring trust stores for client-side certificates used in TLS mutual authentication. The evaluator shall ensure that the operational guidance includes instructions for configuring the server to require mutual authentication of clients using these certificates and for configuring any certificate validation exception rules. The evaluator shall ensure that the operational guidance includes instructions for configuring reference identifiers normalized or matched by the TSF and matching rules for
the supported name types.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall use TLS as a function to verify that the validation rules in FIA_X509_EXT.1/Rev or FIA_X509_EXT.1/ITT are adhered to and shall perform the tests listed below. The evaluator shall apply the operational guidance to configure the server to require TLS mutual authentication of clients for these tests unless overridden by instructions in the test activity.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>TLS 1.3 is a fundamentally different protocol than TLS 1.2, so even though the certificate validation and name checking tests are identical for both versions, it is likely that early deployments of TLS 1.3 may use a different code-base that warrants independent testing. If TLS 1.3 is supported and the evaluator can verify that the TSF uses the same code-base for certificate validation and name checking for both TLS 1.3 and TLS 1.2, it is acceptable that testing be performed for only one version for these tests.</em></p>
</div>
<div class="paragraph">
<p><em>Test 67:  For each supported version, the evaluator shall follow the operational guidance to configure the TOE to require valid client authentication with no exceptions and initiate a TLS session from a compliant TLS test client supporting that version. The evaluator shall ensure that the test client sends a certificate_list structure which has a length of zero. The evaluator shall verify the TSF terminates the session and no application data flows.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure, bad certificate, unknown certificate, unknown CA) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
<div class="paragraph">
<p><em>Test 68:  [conditional] If the ST indicates that the TSF supports establishment of a TLS session for missing or invalid certificates, then for each supported version, and for each supported response option for a missing or invalid certificate indicated in FCS_TLSS_EXT.2.3, the evaluator shall configure the TSF according to the operational guidance to respond as indicated for the calling application. The evaluator shall send client handshake messages from a test TLS client as indicated for each sub-test. The evaluator shall perform the following sub-tests:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) [conditional] If the TSF supports non-authenticated session establishment when receiving an empty certificate message, the evaluator shall initiate a TLS handshake from a compliant test TLS client supporting the version and providing a certificate message containing a certificate_list structure of length zero. The evaluator shall confirm that the TSF notifies the calling application that the user is unauthenticated.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>Specific procedures for determining that the calling application is notified will vary based on the application. If an API to the calling application is not available, the evaluator may attempt to configure the calling application to provide a different response (e.g., require authentication for flagged data) for authenticated and non-authenticated users and make a request at the test client that results in a response indicating the application is treating the client as non-authenticated.</em></p>
</div>
</li>
<li>
<p>B) <em>[conditional] If the TSF supports exceptions for when revocation status information is unavailable, then the evaluator shall follow the operational guidance to attempt to establish a narrowly defined exception for which both exempt and non-exempt certificates can be established. The evaluator shall establish a primary certificate chain for the test client that only exhibits the allowed exception and one or more alternate certificate chains for the test client that do not pass the exception rule, as necessary to test the boundaries of the exception rules.</em></p>
<div class="paragraph">
<p><em>The evaluator shall follow the operational guidance to remove any cached revocation status information for the test client’s primary certificate chain. The evaluator shall initiate a valid TLS session from the test client that presents the primary certificate for the test client, provide any feedback requested by the TSF to confirm the exception, and observe that the TSF allows the certificate and completes the TLS handshake successfully.</em></p>
</div>
<div class="paragraph">
<p><em>For each alternate certificate chain, the evaluator shall repeat the session initiation from the test client but present the alternate certificate chain and observe that the TSF terminates the session.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., bad certificate, unknown certificate, access denied, handshake error) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
<div class="paragraph">
<p><em>The alternate certificate chains are intended to test the boundaries of the exception rules. For example, if the exception rule indicates that only leaf certificates are exempt, the evaluator will include an alternate certificate chain for which a CA certificate’s revocation information is advertised but is not available; if the exception can be configured for an explicit leaf certificate, or particular subjects, an alternate chain will be included that does not include an excepted certificate or subject. If the exception rules can be configured for all certificates having advertised revocation information, an alternate certificate chain can include an expired certificate – only one additional validity failure (e.g., expired certificate) is required in this case. More comprehensive validity failure handling is addressed by testing for FIA_X509_EXT.1/Rev and FIA_X509_EXT.1/ITT.</em></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 69: For each supported version, the evaluator shall configure the TSF to negotiate the version and require client authentication and perform the following steps:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) For each supported name matching method indicated in the outer selection of FCS_TLSS_EXT.2.4, and for each name type supported by the matching method as indicated in the inner-selections claimed in each outer selection, the evaluator shall establish a valid primary certificate chain with single names for a test client containing only the supported name types and a valid alternate certificate chain with single names indicating a different name of the same type.</em></p>
</li>
<li>
<p>B) <em>[conditional] If any of the supported name types include CN encoding of a name type also supported as a SAN entry, the evaluator shall establish additional certificate chains:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>The evaluator shall establish a primary certificate chain with multiple names, to include a leaf certificate with:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>a SAN entry that matches the name in the primary certificate chain with single names, of the same SAN name type; and</em></p>
</li>
<li>
<p><em>a CN entry encoding the same SAN type which matches the name in the alternate certificate chain with single names of the CN encoding of the same SAN name type;</em></p>
</li>
</ul>
</div>
</li>
<li>
<p><em>The evaluator shall establish an alternate certificate chain with multiple names, to include a leaf certificate with:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>A SAN entry that matches the name in the alternate certificate chain with single names, of the same SAN name type; and</em></p>
</li>
<li>
<p><em>a CN entry encoding the same SAN type which matches the name in the primary certificate chain with single names, of the CN encoding of the same SAN name type.</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>C) <em>[conditional] If any of the supported name types include CN encoding, the evaluator shall follow the operational guidance to configure the TSF, establishing trust in the root CA for all primary and alternate certificate chains. The evaluator shall configure the TSF and any relevant TOE applications that use TLS for client authentication as necessary to establish reference identifiers that match the names in the client’s primary certificate chains with single names, but not matching any of the names in the alternate certificate chains with single names.</em></p>
</li>
<li>
<p><em>For each primary certificate chain (with single or multiple names), the evaluator shall initiate a TLS session from the test TLS client that is configured to present the primary certificate chain in a certificate message and a valid certificate verify message in response to the server’s certificate request message. The evaluator shall confirm that the TSF accepts the certificate and completes the authenticated TLS session successfully.</em></p>
</li>
<li>
<p><em>For each alternate certificate chain (with single or multiple names), the evaluator shall initiate a TLS session from the test TLS client that is configured to present the alternate certificate chain in a certificate message and a valid certificate verify message in response to the server’s certificate request message. The evaluator shall confirm that the TSF terminates the session.</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., access denied) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
<div class="paragraph">
<p><em>The intent of this test is to confirm that for each method that the TSF uses to match name types presented in validated certificates, it is able to recognize both matching and non-matching names. Names of special types implicitly encoded in the CN entry of the certificate subject name are especially prone to error since they may only be validated by the issuing CA as a directory name (RDN) type, especially if the issuing CA is unaware of the intended encoding as a different name type. It is a best practice that when the CN is interpreted as an embedded name type other than RDN, an explicitly encoded SAN entry should take precedence.</em></p>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_b_5_3_fcs_tlss_ext_3_tls_server_downgrade_protection">B.5.3 FCS_TLSS_EXT.3 TLS Server Downgrade Protection</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>The inclusion of this selection-based component depends upon selection in FCS_TLSS_EXT.1.1.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.3 TLS Server Downgrade Protection</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.3.1</strong> The TSF shall set the server hello extension to a random value concatenated with the TLS 1.2 downgrade indicator when negotiating TLS 1.2 as indicated in RFC 8446 section 4.1.3.</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 40</em></strong></p>
</div>
<div class="paragraph">
<p><em>This SFR is claimed if "supplemental downgrade protection" is selected in FCS_TLSS_EXT.1.1.</em></p>
</div>
<div class="paragraph">
<p><em>RFC 8446 requires both the TLS 1.2 downgrade indicator as well as an indicator for TLS 1.1 and below. This FP requires the server to reject attempts to establish TLS 1.1 and below, making this mechanism redundant. However, products may still implement both indicators to be compliant with the RFC.</em></p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_TLSS_EXT.3</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the ST and confirm that the TLS description includes details on the session downgrade protections that are supported.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the operational guidance to confirm that instructions are included to configure the TSF to
support only TLS 1.3 and to provide the associated downgrade indications.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>Test 70: The evaluator shall follow the operational guidance as necessary to configure the TSF to negotiate only TLS 1.3 and to provide the associated downgrade indications. The evaluator shall send a TLS client hello to the TOE that indicates support for only TLS 1.2. The evaluator shall observe that the TSF sends a server hello with the last eight bytes of the server random value equal to 44 4F 57 4E 47 52 44 01.</em></p>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_b_5_4_fcs_tlss_ext_4_tls_server_support_for_renegotiation">B.5.4 FCS_TLSS_EXT.4 TLS Server Support for Renegotiation</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>The inclusion of this selection-based component depends upon selection in FCS_TLS_EXT.1.1.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.4 TLS Server Support for Renegotiation</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.4.1</strong> The TSF shall support secure renegotiation through the use of [selection: the "renegotiation_info" TLS extension, not allowing session renegotiation] in accordance with RFC 5746.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.4.2</strong>  The TSF shall, when negotiating a TLS 1.2 session, [selection: include the renegotiation_info extension in server hello messages when a client hello with the renegotiation_info extension is received and shall
terminate a session if neither of the renegotiation_info or TLS_EMPTY_RENEGOTIATION_INFO_SCSV signaling ciphersuites are indicated in the client hello, not allow renegotiation].</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.4.3</strong>  The TSF shall terminate the session if an unexpected client hello is received during an active TLS session.</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 41</em></strong></p>
</div>
<div class="paragraph">
<p><em>This SFR is claimed if "TLS as a server" is selected in FCS_TLS_EXT.1.1. RFC 5746 defines an extension to TLS 1.2 that binds renegotiation handshakes to the cryptography in the original handshake. As a refinement of the RFC, servers that support renegotiation and negotiating TLS 1.2 will terminate a session if neither of the methods described in RFC 5746 are offered by the client. RFC 5746 indicates that a server negotiating TLS 1.2 is required to terminate the session if the conditions for secure renegotiation are not met. Alternatively, a TLS server may negotiate TLS 1.2 without any RFC 5746 client renegotiation indicators if it always terminates an existing session when a new client hello is received, similar to the implementation of TLS 1.3.</em></p>
</div>
<div class="paragraph">
<p><em>TLS 1.3 does not allow renegotiation. Termination, as indicated in FCS_TLSS_EXT.4.3, covers TLS 1.3 sessions as well as TLS 1.2 sessions where the client hello received does not comply with RFC 5746, or when configured to reject renegotiation (if the product is configurable).</em></p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_TLSS_EXT.4</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the ST to confirm that the TLS description includes details on session renegotiation protection methods supported, to include when renegotiation is prohibited.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the operational guidance to confirm that any instructions that are needed to meet the requirements are included. If support for TLS 1.2 is configurable to use RFC 5746 methods or to deny renegotiation, the evaluator shall ensure that the operational guidance includes instructions for configuring the TSF in this manner.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall perform the following tests, as indicated for each version supported, using a test TLS client able to construct the indicated messages and expose messages received from the TSF:</em></p>
</div>
<div class="paragraph">
<p><em>Test 71: (RFC 5746 compliant TLS 1.2 initial handshake) [conditional] If the TSF supports renegotiation, the evaluator shall follow the operational guidance as necessary to configure the TSF to enforce RFC 5746 methods. The evaluator shall initiate a TLS 1.2 session from a test TLS client for each of the following sub-tests:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) The evaluator shall send an initial client hello without the renegotiation_info extension and without including the signaling ciphersuite value, TLS_EMPTY_RENEGOTIATION_INFO_SCSV. The evaluator shall observe that the TSF terminates the session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
<li>
<p><em>B) The evaluator shall send an initial client hello with the renegotiation_info extension indicating a renegotiated_connection length greater than zero. The evaluator shall observe that the TSF terminates the session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Test 72: (renegotiation attempt) For each of the following sub-tests, the evaluator shall establish a compliant TLS channel with an initial handshake that uses the indicated secure renegotiation method for the version indicated. Without closing the session, the evaluator shall send a second client hello within the channel specific to the version as indicated:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) [conditional] If the TSF allows renegotiation, the evaluator shall configure the TSF to support RFC 5746 methods, send an initial handshake with a valid renegotiation extension, send a new TLS 1.2 client hello on the TLS 1.2 channel containing the renegotiation_info extension indicating valid client_verify_data, and observe the TSF successfully completes the handshake.</em></p>
</li>
<li>
<p><em>B) [conditional] If the TSF allows renegotiation, the evaluator shall send an initial client hello containing a valid renegotiation extension, send a new TLS 1.2 client hello on the TLS 1.2 channel with the signaling ciphersuite value, TLS_EMPTY_RENEGOTIATION_INFO_SCSV, and observe that the TSF terminates the session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., handshake failure) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
<li>
<p><em>C) [conditional] If the TSF allows renegotiation, for each TLS 1.2 renegotiation method claimed in accordance with RFC 5746, the evaluator shall send an initial client hello indicating the method, send a new TLS 1.2 client hello on the TLS 1.2 channel without a renegotiation_info extension, and observe that the TSF terminates the session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., unexpected message) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
<li>
<p><em>D) [conditional]: If the TSF allows renegotiation, for each TLS 1.2 renegotiation method claimed in accordance with RFC 5746, the evaluator shall send an initial client hello indicating the method, send a new TLS 1.2 client hello on the TLS 1.2 channel with a renegotiation_info extension indicating an invalid client_verify_data value (modify a byte of a valid value), and observe that the TSF terminates the session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., unexpected message) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
<li>
<p><em>E) [conditional] If the TSF supports TLS 1.3, or if the TSF rejects renegotiation for TLS 1.2, then for each such version, the evaluator shall follow the operational guidance as necessary to configure the TSF to negotiate the version and reject renegotiation. The evaluator shall initiate a valid initial session for the specified version, send a valid client hello on the non-renegotiable TLS channel, and observe that the TSF terminates the session.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., unexpected message) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
</li>
</ul>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_b_5_5_fcs_tlss_ext_5_tls_server_support_for_session_resumption">B.5.5 FCS_TLSS_EXT.5 TLS Server Support for Session Resumption</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>The inclusion of this selection-based component depends upon selection in FCS_TLSS_EXT.1.1.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.5 TLS Server Support for Session Resumption</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.5.1</strong> The TSF shall support session resumption as a server via the use of [selection: <em>session ID in accordance with RFC 5246, tickets in accordance with RFC 5077, PSK and tickets in accordance with RFC 8446</em>].</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 42</em></strong></p>
</div>
<div class="paragraph">
<p><em>This SFR is claimed if "session resumption" is selected in FCS_TLSS_EXT.1.1.  The ST author indicates which session resumption mechanisms are supported. One or both of the first two options, "session ID in accordance with RFC 5246" and "tickets in accordance with RFC 5077" are claimed for TLS 1.2 resumption. If resumption of TLS 1.3 sessions is supported, "PSK and tickets in accordance with RFC 8446" is selected, and the selection-based SFR FCS_TLSS_EXT.6 must also be claimed.</em></p>
</div>
<div class="paragraph">
<p><em>While it is possible to perform session resumption using PSK ciphersuites in TLS 1.2, this is uncommon. Validation of
key exchange and session negotiation rules for PSK ciphersuites is independent of the source of the pre-shared key and is covered in FCS_TLSS_EXT.1.</em></p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_TLSS_EXT.5</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the ST and confirm that the TLS server protocol description includes a description of the supported resumption mechanisms.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall ensure the operational guidance describes instructions for any configurable features of the resumption mechanism.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall perform the following tests:</em></p>
</div>
<div class="paragraph">
<p><em>Test 73:  The evaluator shall perform the following tests, according to the session resumption mechanism supported:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>A) [conditional]  If the TSF supports session resumption via "session ID in accordance with RFC 5246" the evaluator shall perform the following tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>The evaluator shall establish a compliant initial TLS session with the TOE and capture the TOE-generated session ID in the Server Hello message. The evaluator shall close the successful session and then initiate a new TLS connection and send the previously captured session ID to show that the TOE resumed the previous session by responding with ServerHello containing the same SessionID immediately followed by ChangeCipherSpec and Finished messages (as shown in Figure 2 of RFC 4346 or RFC 5246).</em></p>
</li>
<li>
<p><em>ii)</em>
<em>The evaluator shall establish a compliant initial TLS session with the TOE and capture the TOE-generated session ID in the Server Hello message.  The evaluator shall then, within the same handshake, generate or force an unencrypted fatal Alert message immediately before the test TLS client would otherwise send its ChangeCipherSpec message thereby disrupting the handshake. The evaluator shall then initiate resumption with a new Client Hello using the previously captured session ID, and verify that the server (1) implicitly rejects the session ID by sending a ServerHello containing a different SessionID and performing a full handshake (as shown in figure 1 of RFC 4346 or RFC 5246), or (2) terminates the connection in some way that prevents the flow of application data.</em></p>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>If multiple contexts are supported for session resumption, for each of the above test cases, the session ID may be obtained in one context for resumption in another context. There is no requirement that the session ID be obtained and replayed within the same context subject to the description provided in the TSS. All contexts that can reuse a session ID constructed in another context must be tested. It is not mandated that the session establishment and session resumption share context. For example, it is acceptable for a control channel to establish and application channel to resume the session.</em></p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>B) [conditional]  If the TSF supports session resumption via "tickets in accordance with RFC 5077" the evaluator shall perform the following tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>The evaluator shall establish a compliant initial TLS session with the TOE in which a session ticket is exchanged with the test TLS client.  The evaluator shall close the successful session.  The evaluator shall then initiate resumption with the session ticket in the ClientHello. The evaluator shall confirm that the TOE responds with an abbreviated handshake described in section 3.1 of RFC 5077 and illustrated with an example in figure 2. Of particular note: if the server successfully verifies the client’s ticket, then it may renew the ticket by including a NewSessionTicket handshake message after the ServerHello in the abbreviated handshake (which is shown in figure 2). This is not required, however as further clarified in section 3.3 of RFC 5077.</em></p>
</li>
<li>
<p><em>ii)</em>
<em>The evaluator shall establish a compliant initial TLS session with the TOE in which a session ticket is exchanged with the test TLS client and then close the successful session.  The evaluator shall modify a byte of the session ticket.  The evaluator shall then initiate resumption with the altered session ticket in the ClientHello. The evaluator shall confirm that the TOE either (1) implicitly rejects the session ticket by performing a full handshake (as shown in figure 3 or 4 of RFC 5077), or (2) terminates the connection in some way that prevents the flow of application data.</em></p>
</li>
</ul>
</div>
</li>
<li>
<p><em>C) [conditional]  If the TSF supports session resumption via "PSK and tickets in accordance with RFC 8446" the evaluator shall perform the following tests:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>i)</em>
<em>The evaluator shall establish a compliant initial TLS session with the TOE in which a session ticket is exchanged with the test TLS client.  The evaluator shall close the successful session.  The evaluator shall then initiate resumption with the session ticket in the ClientHello.  The evaluator shall confirm that the TOE responds similarly to figure 3 of RFC 8446 after successfully reusing the pre-shared-key to resume the session. Specifically, the server must not send back a Certificate message if the session is correctly resumed. When the session is resumed, the evaluator shall verify on the TLS Client used for performing this test, that the TOE (TLS Server) has not advertised support for the early data extension.</em></p>
</li>
<li>
<p><em>ii)</em>
<em>The evaluator shall establish a compliant initial TLS session with the TOE in which a session ticket is exchanged with the test TLS client and then close the successful session.  The evaluator shall modify a byte of the session ticket.  The evaluator shall then initiate resumption with the altered session ticket in the pre-shared-key of the ClientHello. The evaluator shall confirm that the TOE either (1) implicitly rejects the session ticket by performing a full handshake, or (2) terminates the connection in some way that prevents the flow of application data.</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_b_5_6_fcs_tlss_ext_6_tls_server_tls_1_3_resumption_refinements">B.5.6 FCS_TLSS_EXT.6 TLS Server TLS 1.3 Resumption Refinements</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>The inclusion of this selection-based component depends upon selection in FCS_TLSS_EXT.5.1.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.6 TLS Server TLS 1.3 Resumption Refinements</strong></p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.6.1</strong> The TSF shall support TLS 1.3 resumption using PSK with psk_key_exchange_mode extension with the value
psk_dhe_ke.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.6.2</strong> The TSF shall ignore early data received in TLS 1.3 sessions.</p>
</div>
<div class="paragraph">
<p><strong><em>Application Note 43</em></strong></p>
</div>
<div class="paragraph">
<p><em>This SFR is claimed if "PSK and tickets in accordance with RFC 8446" is selected in FCS_TLSS_EXT.5.1.</em></p>
</div>
<div class="paragraph">
<p><em>RFC 8446 allows pre-shared keys to be used directly and also allows early data to be protected using only the pre-shared key. This SFR refines the RFC to use PSK only with a supplemental DHE or ECDHE key exchange to ensure perfect forward secrecy for all sessions.</em></p>
</div>
<details>
<summary class="title"><strong>Evaluation Activities</strong></summary>
<div class="content">
<div class="paragraph">
<p>FCS_TLSS_EXT.6</p>
</div>
<div class="paragraph">
<p><strong><em>TSS</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the ST to confirm that the TLS description includes details on session resumption for TLS 1.3, describes each application capable of using TLS 1.3 with PSK, and describes how the TSF and application respond to client attempts to use early data (including via logging or observable responses). The evaluator shall confirm that the TLS description shows that only the psk_dhe_ke psk_key_exchange_mode is supported and that early information is ignored.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Guidance</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall examine the operational guidance to verify that instructions for any configurable features that are required to meet the requirement are included.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Tests</em></strong></p>
</div>
<div class="paragraph">
<p><em>The evaluator shall follow the operational guidance to configure the TSF to negotiate TLS 1.3 and shall perform the following tests:</em></p>
</div>
<div class="paragraph">
<p><em>Test 74:  The evaluator shall attempt a resumed session (as for Test 34 in Test FCS_TLSS_EXT.5.1) but using psk_ke mode as the value for the psk_key_exchange_mode in the resumption client hello. The evaluator shall observe that the TSF refuses to resume the session, either by completing a full TLS 1.3 handshake or by terminating the session.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>It is preferred that the TSF sends a fatal error alert message (e.g., illegal parameter) in response to this, but it is acceptable that the TSF terminates the connection silently (i.e., without sending a fatal error alert).</em></p>
</div>
<div class="paragraph">
<p><em>Test 75:  The evaluator shall establish a valid TLS 1.3 session with the TOE and send the data as application data after the finished messages have been verified, and observe the response. The evaluator shall then configure the TOE to clear the response and initiate a resumed session (as for Test 34 in FCS_TLSS_EXT.5.1) with a test TLS 1.3 client attempting to provide the same data in early data. The evaluator shall observe that the TSF does not react to the early data as it did when presented as application data after the finished messages, indicating that the data was ignored.</em></p>
</div>
<div class="paragraph">
<p><strong><em>Note:</em></strong> <em>The specific early data used may depend on the applications calling the TLS session and should be selected to initiate an observable response in the TSF or calling application as described in the ST. For HTTPS, for example, the early data can be an HTTP POST that updates data at the TOE, which can then be observed via a user interface for the application if the data was posted or via application logging indicating that the operation failed.</em></p>
</div>
</div>
</details>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_appendix_c_extended_component_definitions">Appendix C - Extended Component Definitions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This PP-Package defines the following extended components as part of the FCS class originally defined by CC Part 2:</p>
</div>
<div class="paragraph">
<p>(Note: formatting conventions for selections and assignments in this Appendix are those in [CC2].)</p>
</div>
<div class="sect3">
<h4 id="_c_1_cryptographic_support_fcs">C.1 Cryptographic Support (FCS)</h4>

</div>
<div class="sect2">
<h3 id="_c_1_1_fcs_tls_ext_tls_protocol">C.1.1 FCS_TLS_EXT TLS Protocol</h3>
<div class="paragraph">
<p><strong>Family Behaviour</strong></p>
</div>
<div class="paragraph">
<p>This family defines the TLS claims that can be made by a conformant TOE.</p>
</div>
<div class="paragraph">
<p><strong>Component levelling</strong></p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="data:image/png;base64,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" alt="FCS TLS EXT">
</div>
</div>
<div class="paragraph">
<p>FCS_TLS_EXT.1, TLS Protocol, requires the TSF to specify whether it implements TLS or DTLS as a client or as a server.</p>
</div>
<div class="paragraph">
<p><strong>Management: FCS_TLS_EXT.1</strong></p>
</div>
<div class="paragraph">
<p>No specific management functions are identified.</p>
</div>
<div class="paragraph">
<p><strong>Audit: FCS_TLS_EXT.1</strong></p>
</div>
<div class="paragraph">
<p>There are no auditable events foreseen.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLS_EXT.1 TLS Protocol</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:	No dependencies.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLS_EXT.1.1</strong></p>
</div>
<div class="paragraph">
<p>The TSF shall implement [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS as a client</em></p>
</li>
<li>
<p><em>TLS as a server</em></p>
</li>
<li>
<p><em>DTLS as a client</em></p>
</li>
<li>
<p><em>DTLS as a server</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>].</p>
</div>
<div class="sect3">
<h4 id="_c_2_1_fcs_dtlsc_ext_dtls_client_protocol">C.2.1 FCS_DTLSC_EXT DTLS Client Protocol</h4>
<div class="paragraph">
<p><strong>Family Behaviour</strong></p>
</div>
<div class="paragraph">
<p>The component in this family addresses the ability for a client to use DTLS to protect data between the client and a server using the DTLS protocol. This is a new family defined for the FCS class.</p>
</div>
<div class="paragraph">
<p><strong>Component levelling</strong></p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="data:image/png;base64,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" alt="FCS DTLSC EXT">
</div>
</div>
<div class="paragraph">
<p>FCS_DTLSC_EXT.1, DTLS Client Protocol, requires the TSF to implement DTLS as a client in the specified manner.</p>
</div>
<div class="paragraph">
<p>FCS_DTLSC_EXT.2, DTLS Client Support for Mutual Authentication, requires the TSF to support mutually-authenticated DTLS when acting as a DTLS client.</p>
</div>
<div class="paragraph">
<p>FCS_DTLSC_EXT.3, DTLS Client Downgrade Protection, requires the TSF to implement version downgrade protection when acting as a DTLS client.</p>
</div>
<div class="paragraph">
<p>FCS_DTLSC_EXT.4, DTLS Client Support for Renegotiation, requires the TSF to support session renegotiation when acting as a DTLS client.</p>
</div>
<div class="paragraph">
<p>FCS_DTLSC_EXT.5, DTLS Client Support for Session Resumption, requires the TSF to support session resumption when acting as a DTLS client.</p>
</div>
<div class="paragraph">
<p>FCS_DTLSC_EXT.6, DTLS Client DTLS 1.3 Resumption Refinements, requires the TSF to support session resumption behavior specific to DTLS 1.3 when acting as a DTLS client.</p>
</div>
<div class="paragraph">
<p><strong>Management: FCS_DTLSC_EXT.1</strong></p>
</div>
<div class="paragraph">
<p>No specific management functions are identified.</p>
</div>
<div class="paragraph">
<p><strong>Audit: FCS_DTLSC_EXT.1</strong></p>
</div>
<div class="paragraph">
<p>The following actions should be auditable if FAU_GEN Security Audit Data Generation is included in the PP, PP-Module, functional package, or ST:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Esbalishment and termination of a DTLS session</p>
</li>
<li>
<p>Failure to establish a DTLS session</p>
</li>
<li>
<p>Failure to verify presented identifier</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1 DTLS Client Protocol</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>FCS_CKM.1 Cryptographic Key Generation</p>
</li>
<li>
<p>FCS_CKM.2 Cryptographic Key Derivation</p>
</li>
<li>
<p>FCS_COP.1 Cryptographic Operation</p>
</li>
<li>
<p>FCS_RBG.1 Random Bit Generation</p>
</li>
<li>
<p>FIA_X509_EXT.1/Rev X.509 Certificate Validation</p>
</li>
<li>
<p>FIA_X509_EXT.1/ITT X.509 Certificate Validation</p>
</li>
<li>
<p>FIA_X509_EXT.2 X.509 Certificate Authentication</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.1</strong>  The TSF shall implement [selection: <em>DTLS 1.2 (RFC 6347), DTLS 1.3 (RFC 9147)</em>]
and no other DTLS version as a client that supports additional functionality for session renegotiation protection and [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>mutual authentication</em></p>
</li>
<li>
<p><em>supplemental downgrade protection</em></p>
</li>
<li>
<p><em>session resumption</em></p>
</li>
<li>
<p><em>no optional functionality</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>] and shall abort attempts by a server to negotiate all other DTLS versions.</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.2</strong> The TSF shall be able to support the following TLS 1.2 ciphersuites: [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289 and RFC 8422</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 8422</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</em></p>
</li>
<li>
<p><em>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</em></p>
</li>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined RFC 5289</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_128_CBC_SHA as defined in RFC 5246</em></p>
</li>
<li>
<p><em>no TLS 1.2 ciphersuites</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>], the following PP-specific ciphersuites using pre-shared secrets: [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 8442</em></p>
</li>
<li>
<p><em>TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>TLS_RSA_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 8442</em></p>
</li>
<li>
<p><em>TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>TLS_RSA_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>no ciphersuites using pre-shared secrets</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>], and the following TLS 1.3 ciphersuites: [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS_AES_256_GCM_SHA384 as defined in RFC 8446</em></p>
</li>
<li>
<p><em>TLS_AES_128_GCM_SHA256 as defined in RFC 8446</em></p>
</li>
<li>
<p><em>[assignment: other TLS 1.3 ciphersuites]</em></p>
</li>
<li>
<p><em>no TLS 1.3 ciphersuites</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>offering the supported ciphersuites in a client hello message in preference order: [<em>assignment: list of supported ciphersuites</em>].</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.3</strong>  The TSF shall not offer ciphersuites indicating the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the null encryption component</p>
</li>
<li>
<p>support for anonymous servers</p>
</li>
<li>
<p>use of deprecated or export-grade cryptography including DES, 3DES, RC2, RC4, or IDEA for encryption</p>
</li>
<li>
<p>use of MD</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>and shall abort sessions where a server attempts to negotiate ciphersuites not enumerated in the client hello message.</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.4</strong>  The TSF shall be able to support the following DTLS client hello message extensions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>signature_algorithms extension (RFC 8446) indicating support for [selection:</p>
<div class="ulist">
<ul>
<li>
<p><em>ecdsa-secp384r1_sha384 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pkcs1_sha384 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pss_pss_sha384 (RFC8603)</em></p>
</li>
<li>
<p><em>rsa_pss_rsae_sha384 (RFC 8603)</em></p>
</li>
<li>
<p><em>[assignment: other non-deprecated signature algorithms]</em></p>
</li>
<li>
<p><em>no other signature algorithms</em></p>
<div class="paragraph">
<p>]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>the following other extensions: [selection:</p>
<div class="ulist">
<ul>
<li>
<p><em>signature_algorithms_cert extension (RFC 8446) indicating support for [selection:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>ecdsa-secp384r1_sha384 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pkcs1_sha384 (RFC8446)</em></p>
</li>
<li>
<p><em>rsa_pss_pss_sha384 (RFC 8603)</em></p>
</li>
<li>
<p><em>rsa_pss_rsae_sha384 (RFC 8603)</em></p>
</li>
<li>
<p><em>rsa_pkcs1_sha256 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pss_rsae_sha256 (RFC 8446)</em></p>
</li>
<li>
<p><em>[assignment: other non-deprecated signature algorithms]</em></p>
</li>
<li>
<p><em>no other signature algorithms</em></p>
<div class="paragraph">
<p>]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>supported_versions extension (RFC 8446) indicating support for TLS 1.3</em></p>
</li>
<li>
<p><em>supported_groups extension (RFC 7919, RFC 8446) indicating support for [selection:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>secp256r1</em></p>
</li>
<li>
<p><em>secp384r1</em></p>
</li>
<li>
<p><em>secp521r1</em></p>
</li>
<li>
<p><em>ffdhe2048(256)</em></p>
</li>
<li>
<p><em>ffdhe3072(257)</em></p>
</li>
<li>
<p><em>ffdhe4096(258)</em></p>
</li>
<li>
<p><em>ffdhe6144(259)</em></p>
</li>
<li>
<p><em>ffdhe8192(260)</em></p>
<div class="paragraph">
<p>]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>key_share extension (RFC 8446)</em></p>
</li>
<li>
<p><em>post_handshake_auth (RFC 8446), pre_shared_key (RFC 8446), and psk_key_exchange_mode (RFC 8446) indicating DHE or ECDHE mode</em></p>
</li>
<li>
<p><em>extended_master_secret extension (RFC 7627) [selection: enforcing, allow legacy] server support</em></p>
</li>
<li>
<p><em>no other extensions</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>] and shall not send the following extensions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>early_data</em></p>
</li>
<li>
<p><em>psk_key_exchange_mode indicating PSK only mode.</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.5</strong>  The TSF shall be able to [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>verify that a presented identifier of name type: [selection:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>DNS name type according to RFC 6125</em></p>
</li>
<li>
<p><em>URI name type according to RFC 6125</em></p>
</li>
<li>
<p><em>SRV name type according to RFC 6125</em></p>
</li>
<li>
<p><em>Common Name conversion to DNS name according to RFC 6125</em></p>
</li>
<li>
<p><em>Directory name type according to RFC 5280</em></p>
</li>
<li>
<p><em>IPaddress name type according to RFC 5280</em></p>
</li>
<li>
<p><em>rfc822Name type according to RFC 5280</em></p>
</li>
<li>
<p><em>[assignment:  other name type]</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>interface with a client application requesting the DTLS channel to verify that a presented identifier</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>] matches a reference identifier of the requested DTLS server and shall abort the session if no match is found.</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.6</strong>  The TSF shall not establish a trusted channel if the server certificate is invalid [selection:
<em>with no exceptions, except when override is authorized in the case where valid revocation information is not available</em>].</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.7</strong>  The TSF shall [selection: <em>terminate the DTLS session, silently discard the record</em>] if a message received contains an invalid MAC or if decryption fails in the case of GCM and other AEAD ciphersuites.</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.2 DTLS Client Support for Mutual Authentication</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:	FCS_DTLSC_EXT.1 DTLS Client Protocol</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.2.1</strong> The TSF shall support mutual authentication using X.509v3 certificates during the handshake and [selection: <em>in support of post-handshake authentication requests, at no other time</em>], in accordance with [selection: <em>RFC 5246, section 7.4.4, RFC 8446, section 4.3.2</em>].</p>
</div>
<div class="paragraph">
<p><strong>Management: FCS_DTLSC_EXT.3</strong></p>
</div>
<div class="paragraph">
<p>No specific management functions are identified.</p>
</div>
<div class="paragraph">
<p><strong>Audit: FCS_DTLSC_EXT.3</strong></p>
</div>
<div class="paragraph">
<p>There are no auditable events foreseen.</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.3 DTLS Client Downgrade Protection</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:	FCS_DTLSC_EXT.1 DTLS Client Protocol</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.3.1</strong> The TSF shall not establish a DTLS channel if the server hello message includes [selection: <em>TLS 1.2 downgrade indicator, TLS 1.1 or below downgrade indicator</em>] in the server random field.</p>
</div>
<div class="paragraph">
<p><strong>Management: FCS_DTLSC_EXT.4</strong></p>
</div>
<div class="paragraph">
<p>No specific management functions are identified.</p>
</div>
<div class="paragraph">
<p><strong>Audit: FCS_DTLSC_EXT.4</strong></p>
</div>
<div class="paragraph">
<p>There are no auditable events foreseen.</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.4 DTLS Client Support for Renegotiation</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:	FCS_DTLSC_EXT.1 DTLS Client Protocol</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.4.1</strong> The TSF shall support secure renegotiation through use of [selection: <em>the “renegotiation_info” TLS extension, the TLS_EMPTY_RENEGOTIATION_INFO_SCSV signaling ciphersuite signaling value</em>] in accordance with RFC 5746, and shall terminate the session if an unexpected server hello is received or [selection: <em>hello request message is received, in no other case</em>].</p>
</div>
<div class="paragraph">
<p><strong>Management: FCS_DTLSC_EXT.5</strong></p>
</div>
<div class="paragraph">
<p>No specific management functions are identified.</p>
</div>
<div class="paragraph">
<p><strong>Audit: FCS_DTLSC_EXT.5</strong></p>
</div>
<div class="paragraph">
<p>There are no auditable events foreseen.</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.5 DTLS Client Support for Session Resumption</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:	FCS_DTLSC_EXT.1 DTLS Client Protocol</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.5.1</strong>  The TSF shall support session resumption as a client via the use of [selection: <em>session ID in
accordance with RFC 5246, tickets in accordance with RFC 5077, PSK and tickets in accordance with RFC 8446</em>].</p>
</div>
<div class="paragraph">
<p><strong>Management: FCS_DTLSC_EXT.6</strong></p>
</div>
<div class="paragraph">
<p>No specific management functions are identified.</p>
</div>
<div class="paragraph">
<p><strong>Audit: FCS_DTLSC_EXT.6</strong></p>
</div>
<div class="paragraph">
<p>There are no auditable events foreseen.</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.6 DTLS Client DTLS 1.3 Resumption Refinements</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>FCS_DTLSC_EXT.1 DTLS Client Protocol</p>
</li>
<li>
<p>FCS_DTLSC_EXT.5 DTLS Client Support for Session Resumption</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.6.1</strong> The TSF shall send a psk_key_exchange_mode extension with the value psk_dhe_ke when DTLS 1.3 session
resumption is offered.</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.6.2</strong>  The TSF shall not send early data in DTLS 1.3 sessions.</p>
</div>
</div>
<div class="sect3">
<h4 id="_c_2_1_fcs_dtlss_ext_dtls_server_protocol">C.2.1 FCS_DTLSS_EXT DTLS Server Protocol</h4>
<div class="paragraph">
<p><strong>Family Behaviour</strong></p>
</div>
<div class="paragraph">
<p>This family defines requirements for implementation of DTLS as a server.</p>
</div>
<div class="paragraph">
<p><strong>Component levelling</strong></p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="data:image/png;base64,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" alt="FCS DTLSS EXT">
</div>
</div>
<div class="paragraph">
<p>FCS_DTLSS_EXT.1, DTLS Server Protocol, requires the TSF to implement DTLS as a server in the specified manner.</p>
</div>
<div class="paragraph">
<p>FCS_DTLSS_EXT.2, DTLS Server Support for Mutual Authentication, requires the TSF to support mutually-authenticated DTLS when acting as a DTLS server.</p>
</div>
<div class="paragraph">
<p>FCS_DTLSS_EXT.3, DTLS Server Downgrade Protection, requires the TSF to implement version downgrade protection when acting as a DTLS server.</p>
</div>
<div class="paragraph">
<p>FCS_DTLSS_EXT.4, DTLS Server Support for Renegotiation, requires the TSF to support session renegotiation when acting as a DTLS server.</p>
</div>
<div class="paragraph">
<p>FCS_DTLSS_EXT.5, DTLS Server Support for Session Resumption, requires the TSF to support session resumption when acting as a DTLS server.</p>
</div>
<div class="paragraph">
<p>FCS_DTLSS_EXT.6, DTLS Server DTLS 1.3 Resumption Refinements, requires the TSF to support session resumption behavior specific to DTLS 1.3 when acting as a DTLS server</p>
</div>
<div class="paragraph">
<p><strong>Management: FCS_DTLSS_EXT.1</strong></p>
</div>
<div class="paragraph">
<p>No specific management functions are identified.</p>
</div>
<div class="paragraph">
<p><strong>Audit: FCS_DTLSS_EXT.1</strong></p>
</div>
<div class="paragraph">
<p>The following actions should be auditable if FAU_GEN Security Audit Data Generation is included in the PP, PP-Module, functional package, or ST:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Failure to establish a DTLS session</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1 DTLS Server Protocol</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>FCS_CKM.1 Cryptographic Key Generation</p>
</li>
<li>
<p>FCS_CKM.2 Cryptographic Key Derivation</p>
</li>
<li>
<p>FCS_COP.1 Cryptographic Operation</p>
</li>
<li>
<p>FCS_RBG.1 Random Bit Generation</p>
</li>
<li>
<p>FIA_X509_EXT.1/Rev X.509 Certificate Validation</p>
</li>
<li>
<p>FIA_X509_EXT.1/ITT X.509 Certificate Validation</p>
</li>
<li>
<p>FIA_X509_EXT.2 X.509 Certificate Authentication</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.1</strong>  The TSF shall implement [selection: <em>DTLS 1.2 (RFC 6347), DTLS 1.3 (RFC 9147)</em>] and no other DTLS version as a server that supports additional functionality for session renegotiation protection and [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>mutual authentication</em></p>
</li>
<li>
<p><em>supplemental downgrade protection</em></p>
</li>
<li>
<p><em>session resumption</em></p>
</li>
<li>
<p><em>no optional functionality</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>] and shall reject connection attempts from clients supporting all other DTLS versions.</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.2</strong>  The TSF shall be able to support the following TLS 1.2 ciphersuites: [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289 and RFC 8422</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289 and RFC 8422</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</em></p>
</li>
<li>
<p><em>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</em></p>
</li>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_128_CBC_SHA as defined in RFC 5246</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>], the following PP-specific ciphersuites using pre-shared secrets: [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 8442</em></p>
</li>
<li>
<p><em>TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>TLS_RSA_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 8442</em></p>
</li>
<li>
<p><em>TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>TLS_RSA_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>no ciphersuites using pre-shared secrets</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>], and the following TLS 1.3 ciphersuites: [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS_AES_256_GCM_SHA384 as defined in RFC 8446</em></p>
</li>
<li>
<p><em>TLS_AES_128_GCM_SHA256 as defined in RFC 8446</em></p>
</li>
<li>
<p>[<em>assignment: other TLS 1.3 ciphersuites</em>]</p>
</li>
<li>
<p><em>no TLS 1.3 ciphersuites</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>] using a preference order based on [selection: <em>RFC 9151 priority, client hello ordering,
[assignment: additional priority]</em>].</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.3</strong>  The TSF shall not establish a connection with a client that does not indicate support for at least one of the supported ciphersuites.</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.4</strong>  The TSF shall be able to process the following DTLS client hello message extensions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>signature_algorithms extension (RFC 8446) indicating support for [selection:</p>
<div class="ulist">
<ul>
<li>
<p><em>ecdsa-secp384r1_sha384 (RFC] 8446)</em></p>
</li>
<li>
<p><em>rsa_pkcs1_sha384 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pss_pss_sha384 (RFC 8603)</em></p>
</li>
<li>
<p><em>rsa_pss_rsae_sha384 (RFC 8603)</em></p>
</li>
<li>
<p>[assignment: <em>other non-deprecated signature algorithms</em>]</p>
</li>
<li>
<p><em>no other signature algorithms</em></p>
<div class="paragraph">
<p>]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>the following other extensions: [selection:</p>
<div class="ulist">
<ul>
<li>
<p><em>signature_algorithms_cert extension (RFC 8446) indicating support for [selection:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>ecdsa-secp384r1_sha384 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pkcs1_sha384 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pss_pss_sha384 (RFC 8603)</em></p>
</li>
<li>
<p><em>rsa_pss_rsae_sha384 (RFC 8603)</em></p>
</li>
<li>
<p><em>rsa_pkcs1_sha256 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pss_rsae_sha256 (RFC 8446)</em></p>
</li>
<li>
<p>[assignment: <em>other non-deprecated signature algorithms</em>]</p>
</li>
<li>
<p><em>no other signature algorithms</em></p>
<div class="paragraph">
<p>]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>supported_versions extension (RFC 8446) indicating support for DTLS 1.3</em></p>
</li>
<li>
<p><em>supported_groups extension (RFC 7919, RFC 8446) indicating support for [selection:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>secp256r1</em></p>
</li>
<li>
<p><em>secp384r1</em></p>
</li>
<li>
<p><em>secp521r1</em></p>
</li>
<li>
<p><em>ffdhe2048(256)</em></p>
</li>
<li>
<p><em>ffdhe3072(257)</em></p>
</li>
<li>
<p><em>ffdhe4096(258)</em></p>
</li>
<li>
<p><em>ffdhe6144(259)</em></p>
</li>
<li>
<p><em>ffdhe8192(260)</em></p>
<div class="paragraph">
<p>]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>key_share extension (RFC 8446)</em></p>
</li>
<li>
<p><em>extended_master_secret extension (RFC 7627) [selection: enforcing, allow legacy] client support</em></p>
</li>
<li>
<p><em>no other extensions</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>].</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.5</strong>  The TSF shall perform key establishment for DTLS using [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>RSA with size [selection: [2048, 3072, 4096] bits and no other sizes</em></p>
</li>
<li>
<p><em>Diffie-Hellman parameters with size [selection: [2048, 3072, 4096, 6144, 8192 ] bits and no other sizes</em></p>
</li>
<li>
<p><em>Diffie-Hellman groups [selection: [ffdhe2048, ffdhe3072, ffdhe4096, ffdhe6144, ffdhe8192] and no other groups, consistent with the client&#8217;s supported groups extension and [selection: [key share, no other] extension</em></p>
</li>
<li>
<p><em>ECDHE parameters using elliptic curves [selection: secp256r1, secp384r1, secp521r1] and no other curves, consistent with the client&#8217;s supported groups extension and [selection: [key share, no other] extension and using non-compressed formatting for points</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>].</p>
</div>
<div class="paragraph">
<p><strong>Management: FCS_DTLSS_EXT.2</strong></p>
</div>
<div class="paragraph">
<p>No specific management functions are identified.</p>
</div>
<div class="paragraph">
<p><strong>Audit: FCS_DTLSS_EXT.2</strong></p>
</div>
<div class="paragraph">
<p>There are no auditable events foreseen.</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.2 DTLS Server Support for Mutual Authentication</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:	FCS_DTLSS_EXT.1 DTLS Server Protocol</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.2.1</strong> The TSF shall support authentication of DTLS clients using X.509v3 certificates during the DTLS handshake and [selection: <em>during post-handshake requests, at no other time</em>] using the certificate types indicated in the client’s signature_algorithms and [selection: <em>signature_algorithms_cert, no other</em>] extension.</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.2.2</strong> The TSF shall support authentication of DTLS clients using X.509v3 certificates in accordance with [selection: <em>FIA_X509_EXT.1/Rev, FIA_X509_EXT.1/ITT</em>].</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.2.3</strong> The TSF shall be able to reject the establishment of a trusted channel if the requested client certificate is invalid and [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>continue establishment of a server-only authenticated DTLS channel in accordance with FCS_DTLSS_EXT.1 in support of [selection: all applications, [assignment: list of calling applications that accept both authenticated and unauthenticated client sessions] ] when an empty certificate message is provided by the client</em></p>
</li>
<li>
<p><em>continue establishment of a mutually authenticated DTLS channel when revocation status information for the [selection: client&#8217;s leaf certificate, [assignment: specific intermediate CA certificates], any non-trust store certificate in the certificate chain] is not available in support of [selection: all applications, [assignment: list of calling applications configurable to perform certificate status information bypass processing] ] as [selection: configured by an administrator, confirmed by the application user, a default for [assignment: subset of applications] ]</em></p>
</li>
<li>
<p><em>no other processing options for missing or invalid client certificates</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>].</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.2.4</strong> The TSF shall be able to [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>not establish a DTLS session if an entry of the Distinguished Name or a [selection: ,rfc822_name, dns_name,[assignment: supported name types] ] in the Subject Alternate Name extension contained in the client certificate does not match one of the expected identifiers for the client in accordance with [selection: RFC 2822, RFC 6125, RFC 5280, [assignment: RFC for the supported name type] ] matching rules</em></p>
</li>
<li>
<p><em>pass the [selection: validated certificate, RFC 2822 name normalized according to RFC 2822, DNS name normalized according to RFC 6125, [assignment: list of RFC 5280 name types and normalization rules], [assignment: list of 'other' name types and standard normalization rules] ] to [assignment: list of calling applications capable of making access decisions]</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>].</p>
</div>
<div class="paragraph">
<p><strong>Management: FCS_DTLSS_EXT.3</strong></p>
</div>
<div class="paragraph">
<p>No specific management functions are identified.</p>
</div>
<div class="paragraph">
<p><strong>Audit: FCS_DTLSS_EXT.3</strong></p>
</div>
<div class="paragraph">
<p>There are no auditable events foreseen.</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.3 DTLS Server Downgrade Protection</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:	FCS_DTLSS_EXT.1 DTLS Server Protocol</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.3.1</strong> The TSF shall set the server hello extension to a random value concatenated with the TLS 1.2 downgrade indicator when negotiating TLS 1.2 as indicated in RFC 8446 section 4.1.3.</p>
</div>
<div class="paragraph">
<p><strong>Management: FCS_DTLSS_EXT.4</strong></p>
</div>
<div class="paragraph">
<p>No specific management functions are identified.</p>
</div>
<div class="paragraph">
<p><strong>Audit: FCS_DTLSS_EXT.4</strong></p>
</div>
<div class="paragraph">
<p>There are no auditable events foreseen.</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.4 DTLS Server Support for Renegotiation</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:	FCS_DTLSS_EXT.1 DTLS Server Protocol</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.4.1</strong> The TSF shall support secure renegotiation through the use of [selection: the "renegotiation_info" TLS extension, not allowing session renegotiation] in accordance with RFC 5746.</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.4.2</strong>  The TSF shall, when negotiating a DTLS 1.2 session, [selection: include the renegotiation_info extension in server hello messages when a client hello with the renegotiation_info extension is received and shall
terminate a session if neither of the renegotiation_info or TLS_EMPTY_RENEGOTIATION_INFO_SCSV signaling ciphersuites are indicated in the client hello, not allow renegotiation].</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.4.3</strong>  The TSF shall terminate the session if an unexpected client hello is received during an active DTLS session.</p>
</div>
<div class="paragraph">
<p><strong>Management: FCS_DTLSS_EXT.5</strong></p>
</div>
<div class="paragraph">
<p>No specific management functions are identified.</p>
</div>
<div class="paragraph">
<p><strong>Audit: FCS_DTLSS_EXT.5</strong></p>
</div>
<div class="paragraph">
<p>There are no auditable events foreseen.</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.5 DTLS Server Support for Session Resumption</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:	FCS_DTLSS_EXT.1 DTLS Server Protocol</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.5.1</strong> The TSF shall support session resumption as a server via the use of [selection: <em>session ID in accordance with RFC 5246, tickets in accordance with RFC 5077, PSK and tickets in accordance with RFC 8446</em>].</p>
</div>
<div class="paragraph">
<p><strong>Management: FCS_DTLSS_EXT.6</strong></p>
</div>
<div class="paragraph">
<p>No specific management functions are identified.</p>
</div>
<div class="paragraph">
<p><strong>Audit: FCS_DTLSS_EXT.6</strong></p>
</div>
<div class="paragraph">
<p>There are no auditable events foreseen.</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.6 DTLS Server DTLS 1.3 Resumption Refinements</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>FCS_DTLSS_EXT.1 DTLS Server Protocol</p>
</li>
<li>
<p>FCS_DTLSS_EXT.5 DTLS Server Support for Session Resumption</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.6.1</strong> The TSF shall support DTLS 1.3 resumption using PSK with psk_key_exchange_mode extension with the value
psk_dhe_ke.</p>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.6.2</strong> The TSF shall ignore early data received in DTLS 1.3 sessions.</p>
</div>
</div>
<div class="sect3">
<h4 id="_c_3_1_fcs_tlsc_ext_tls_client_protocol">C.3.1 FCS_TLSC_EXT TLS Client Protocol</h4>
<div class="paragraph">
<p><strong>Family Behaviour</strong></p>
</div>
<div class="paragraph">
<p>The component in this family addresses the ability for a client to use TLS to protect data between the client and a server using the TLS protocol. This is a new family defined for the FCS class.</p>
</div>
<div class="paragraph">
<p><strong>Component levelling</strong></p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="data:image/png;base64,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" alt="FCS TLSC EXT">
</div>
</div>
<div class="paragraph">
<p>FCS_TLSC_EXT.1, TLS Client Protocol, requires the TSF to implement TLS as a client in the specified manner.</p>
</div>
<div class="paragraph">
<p>FCS_TLSC_EXT.2, TLS Client Support for Mutual Authentication, requires the TSF to support mutually-authenticated TLS when acting as a TLS client.</p>
</div>
<div class="paragraph">
<p>FCS_TLSC_EXT.3, TLS Client Downgrade Protection, requires the TSF to implement version downgrade protection when acting as a TLS client.</p>
</div>
<div class="paragraph">
<p>FCS_TLSC_EXT.4, TLS Client Support for Renegotiation, requires the TSF to support session renegotiation when acting as a TLS client.</p>
</div>
<div class="paragraph">
<p>FCS_TLSC_EXT.5, TLS Client Support for Session Resumption, requires the TSF to support session resumption when acting as a TLS client.</p>
</div>
<div class="paragraph">
<p>FCS_TLSC_EXT.6, TLS Client TLS 1.3 Resumption Refinements, requires the TSF to support session resumption behavior specific to TLS 1.3 when acting as a TLS client.</p>
</div>
<div class="paragraph">
<p><strong>Management: FCS_TLSC_EXT.1</strong></p>
</div>
<div class="paragraph">
<p>No specific management functions are identified.</p>
</div>
<div class="paragraph">
<p><strong>Audit: FCS_TLSC_EXT.1</strong></p>
</div>
<div class="paragraph">
<p>The following actions should be auditable if FAU_GEN Security Audit Data Generation is included in the PP, PP-Module, functional package, or ST:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Esbalishment and termination of a TLS session</p>
</li>
<li>
<p>Failure to establish a TLS session</p>
</li>
<li>
<p>Failure to verify presented identifier</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1 TLS Client Protocol</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>FCS_CKM.1 Cryptographic Key Generation</p>
</li>
<li>
<p>FCS_CKM.2 Cryptographic Key Derivation</p>
</li>
<li>
<p>FCS_COP.1 Cryptographic Operation</p>
</li>
<li>
<p>FCS_RBG.1 Random Bit Generation</p>
</li>
<li>
<p>FIA_X509_EXT.1/Rev X.509 Certificate Validation</p>
</li>
<li>
<p>FIA_X509_EXT.1/ITT X.509 Certificate Validation</p>
</li>
<li>
<p>FIA_X509_EXT.2 X.509 Certificate Authentication</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.1</strong>  The TSF shall implement [selection: <em>TLS 1.2 (RFC 5246), TLS 1.3 (RFC 8446)</em>]
and no other TLS version as a client that supports additional functionality for session renegotiation protection and [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>mutual authentication</em></p>
</li>
<li>
<p><em>supplemental downgrade protection</em></p>
</li>
<li>
<p><em>session resumption</em></p>
</li>
<li>
<p><em>no optional functionality</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>] and shall abort attempts by a server to negotiate all other TLS versions.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.2</strong> The TSF shall be able to support the following TLS 1.2 ciphersuites: [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289 and RFC 8422</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 8422</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</em></p>
</li>
<li>
<p><em>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</em></p>
</li>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined RFC 5289</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_128_CBC_SHA as defined in RFC 5246</em></p>
</li>
<li>
<p><em>no TLS 1.2 ciphersuites</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>], the following PP-specific ciphersuites using pre-shared secrets: [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 8442</em></p>
</li>
<li>
<p><em>TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>TLS_RSA_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 8442</em></p>
</li>
<li>
<p><em>TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>TLS_RSA_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>no ciphersuites using pre-shared secrets</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>], and the following TLS 1.3 ciphersuites: [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS_AES_256_GCM_SHA384 as defined in RFC 8446</em></p>
</li>
<li>
<p><em>TLS_AES_128_GCM_SHA256 as defined in RFC 8446</em></p>
</li>
<li>
<p><em>[assignment: other TLS 1.3 ciphersuites]</em></p>
</li>
<li>
<p><em>no TLS 1.3 ciphersuites</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>offering the supported ciphersuites in a client hello message in preference order: [<em>assignment: list of supported ciphersuites</em>].</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.3</strong>  The TSF shall not offer ciphersuites indicating the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the null encryption component</p>
</li>
<li>
<p>support for anonymous servers</p>
</li>
<li>
<p>use of deprecated or export-grade cryptography including DES, 3DES, RC2, RC4, or IDEA for encryption</p>
</li>
<li>
<p>use of MD</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>and shall abort sessions where a server attempts to negotiate ciphersuites not enumerated in the client hello message.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.4</strong>  The TSF shall be able to support the following TLS client hello message extensions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>signature_algorithms extension (RFC 8446) indicating support for [selection:</p>
<div class="ulist">
<ul>
<li>
<p><em>ecdsa-secp384r1_sha384 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pkcs1_sha384 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pss_pss_sha384 (RFC8603)</em></p>
</li>
<li>
<p><em>rsa_pss_rsae_sha384 (RFC 8603)</em></p>
</li>
<li>
<p><em>[assignment: other non-deprecated signature algorithms]</em></p>
</li>
<li>
<p><em>no other signature algorithms</em></p>
<div class="paragraph">
<p>]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>the following other extensions: [selection:</p>
<div class="ulist">
<ul>
<li>
<p><em>signature_algorithms_cert extension (RFC 8446) indicating support for [selection:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>ecdsa-secp384r1_sha384 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pkcs1_sha384 (RFC8446)</em></p>
</li>
<li>
<p><em>rsa_pss_pss_sha384 (RFC 8603)</em></p>
</li>
<li>
<p><em>rsa_pss_rsae_sha384 (RFC 8603)</em></p>
</li>
<li>
<p><em>rsa_pkcs1_sha256 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pss_rsae_sha256 (RFC 8446)</em></p>
</li>
<li>
<p><em>[assignment: other non-deprecated signature algorithms]</em></p>
</li>
<li>
<p><em>no other signature algorithms</em></p>
<div class="paragraph">
<p>]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>supported_versions extension (RFC 8446) indicating support for TLS 1.3</em></p>
</li>
<li>
<p><em>supported_groups extension (RFC 7919, RFC 8446) indicating support for [selection:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>secp256r1</em></p>
</li>
<li>
<p><em>secp384r1</em></p>
</li>
<li>
<p><em>secp521r1</em></p>
</li>
<li>
<p><em>ffdhe2048(256)</em></p>
</li>
<li>
<p><em>ffdhe3072(257)</em></p>
</li>
<li>
<p><em>ffdhe4096(258)</em></p>
</li>
<li>
<p><em>ffdhe6144(259)</em></p>
</li>
<li>
<p><em>ffdhe8192(260)</em></p>
<div class="paragraph">
<p>]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>key_share extension (RFC 8446)</em></p>
</li>
<li>
<p><em>post_handshake_auth (RFC 8446), pre_shared_key (RFC 8446), and psk_key_exchange_mode (RFC 8446) indicating DHE or ECDHE mode</em></p>
</li>
<li>
<p><em>extended_master_secret extension (RFC 7627) [selection: enforcing, allow legacy] server support</em></p>
</li>
<li>
<p><em>no other extensions</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>] and shall not send the following extensions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>early_data</em></p>
</li>
<li>
<p><em>psk_key_exchange_mode indicating PSK only mode.</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.5</strong>  The TSF shall be able to [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>verify that a presented identifier of name type: [selection:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>DNS name type according to RFC 6125</em></p>
</li>
<li>
<p><em>URI name type according to RFC 6125</em></p>
</li>
<li>
<p><em>SRV name type according to RFC 6125</em></p>
</li>
<li>
<p><em>Common Name conversion to DNS name according to RFC 6125</em></p>
</li>
<li>
<p><em>Directory name type according to RFC 5280</em></p>
</li>
<li>
<p><em>IPaddress name type according to RFC 5280</em></p>
</li>
<li>
<p><em>rfc822Name type according to RFC 5280</em></p>
</li>
<li>
<p><em>[assignment:  other name type]</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>]</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>interface with a client application requesting the TLS channel to verify that a presented identifier</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>] matches a reference identifier of the requested TLS server and shall abort the session if no match is found.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.6</strong>  The TSF shall not establish a trusted channel if the server certificate is invalid [selection:
<em>with no exceptions, except when override is authorized in the case where valid revocation information is not available</em>].</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.2 TLS Client Support for Mutual Authentication</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:	FCS_TLSC_EXT.1 TLS Client Protocol</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.2.1</strong> The TSF shall support mutual authentication using X.509v3 certificates during the handshake and [selection: <em>in support of post-handshake authentication requests, at no other time</em>], in accordance with [selection: <em>RFC 5246, section 7.4.4, RFC 8446, section 4.3.2</em>].</p>
</div>
<div class="paragraph">
<p><strong>Management: FCS_TLSC_EXT.3</strong></p>
</div>
<div class="paragraph">
<p>No specific management functions are identified.</p>
</div>
<div class="paragraph">
<p><strong>Audit: FCS_TLSC_EXT.3</strong></p>
</div>
<div class="paragraph">
<p>There are no auditable events foreseen.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.3 TLS Client Downgrade Protection</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:	FCS_TLSC_EXT.1 TLS Client Protocol</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.3.1</strong> The TSF shall not establish TLS channel if the server hello message includes [selection: <em>TLS 1.2 downgrade indicator, TLS 1.1 or below downgrade indicator</em>] in the server random field.</p>
</div>
<div class="paragraph">
<p><strong>Management: FCS_TLSC_EXT.4</strong></p>
</div>
<div class="paragraph">
<p>No specific management functions are identified.</p>
</div>
<div class="paragraph">
<p><strong>Audit: FCS_TLSC_EXT.4</strong></p>
</div>
<div class="paragraph">
<p>There are no auditable events foreseen.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.4 TLS Client Support for Renegotiation</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:	FCS_TLSC_EXT.1 TLS Client Protocol</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.4.1</strong> The TSF shall support secure renegotiation through use of [selection: <em>the “renegotiation_info” TLS extension, the TLS_EMPTY_RENEGOTIATION_INFO_SCSV signaling ciphersuite signaling value</em>] in accordance with RFC 5746, and shall terminate the session if an unexpected server hello is received or [selection: <em>hello request message is received, in no other case</em>].</p>
</div>
<div class="paragraph">
<p><strong>Management: FCS_TLSC_EXT.5</strong></p>
</div>
<div class="paragraph">
<p>No specific management functions are identified.</p>
</div>
<div class="paragraph">
<p><strong>Audit: FCS_TLSC_EXT.5</strong></p>
</div>
<div class="paragraph">
<p>There are no auditable events foreseen.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.5 TLS Client Support for Session Resumption</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:	FCS_TLSC_EXT.1 TLS Client Protocol</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.5.1</strong>  The TSF shall support session resumption as a client via the use of [selection: <em>session ID in
accordance with RFC 5246, tickets in accordance with RFC 5077, PSK and tickets in accordance with RFC 8446</em>].</p>
</div>
<div class="paragraph">
<p><strong>Management: FCS_TLSC_EXT.6</strong></p>
</div>
<div class="paragraph">
<p>No specific management functions are identified.</p>
</div>
<div class="paragraph">
<p><strong>Audit: FCS_TLSC_EXT.6</strong></p>
</div>
<div class="paragraph">
<p>There are no auditable events foreseen.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.6 TLS Client TLS 1.3 Resumption Refinements</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>FCS_TLSC_EXT.1 TLS Client Protocol</p>
</li>
<li>
<p>FCS_TLSC_EXT.5 TLS Client Support for Session Resumption</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.6.1</strong> The TSF shall send a psk_key_exchange_mode extension with the value psk_dhe_ke when TLS 1.3 session
resumption is offered.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.6.2</strong>  The TSF shall not send early data in TLS 1.3 sessions.</p>
</div>
</div>
<div class="sect3">
<h4 id="_c_4_1_fcs_tlss_ext_tls_server_protocol">C.4.1 FCS_TLSS_EXT TLS Server Protocol</h4>
<div class="paragraph">
<p><strong>Family Behaviour</strong></p>
</div>
<div class="paragraph">
<p>This family defines requirements for implementation of TLS as a server.</p>
</div>
<div class="paragraph">
<p><strong>Component levelling</strong></p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="data:image/png;base64,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" alt="FCS TLSS EXT">
</div>
</div>
<div class="paragraph">
<p>FCS_TLSS_EXT.1, TLS Server Protocol, requires the TSF to implement TLS as a server in the specified manner.</p>
</div>
<div class="paragraph">
<p>FCS_TLSS_EXT.2, TLS Server Support for Mutual Authentication, requires the TSF to support mutually-authenticated TLS when acting as a TLS server.</p>
</div>
<div class="paragraph">
<p>FCS_TLSS_EXT.3, TLS Server Downgrade Protection, requires the TSF to implement version downgrade protection when acting as a TLS server.</p>
</div>
<div class="paragraph">
<p>FCS_TLSS_EXT.4, TLS Server Support for Renegotiation, requires the TSF to support session renegotiation when acting as a TLS server.</p>
</div>
<div class="paragraph">
<p>FCS_TLSS_EXT.5, TLS Server Support for Session Resumption, requires the TSF to support session resumption when acting as a TLS server.</p>
</div>
<div class="paragraph">
<p>FCS_TLSS_EXT.6, TLS Server TLS 1.3 Resumption Refinements, requires the TSF to support session resumption behavior specific to TLS 1.3 when acting as a TLS server</p>
</div>
<div class="paragraph">
<p><strong>Management: FCS_TLSS_EXT.1</strong></p>
</div>
<div class="paragraph">
<p>No specific management functions are identified.</p>
</div>
<div class="paragraph">
<p><strong>Audit: FCS_TLSS_EXT.1</strong></p>
</div>
<div class="paragraph">
<p>The following actions should be auditable if FAU_GEN Security Audit Data Generation is included in the PP, PP-Module, functional package, or ST:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Failure to establish a TLS session</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1 TLS Server Protocol</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>FCS_CKM.1 Cryptographic Key Generation</p>
</li>
<li>
<p>FCS_CKM.2 Cryptographic Key Derivation</p>
</li>
<li>
<p>FCS_COP.1 Cryptographic Operation</p>
</li>
<li>
<p>FCS_RBG.1 Random Bit Generation</p>
</li>
<li>
<p>FIA_X509_EXT.1/Rev X.509 Certificate Validation</p>
</li>
<li>
<p>FIA_X509_EXT.1/ITT X.509 Certificate Validation</p>
</li>
<li>
<p>FIA_X509_EXT.2 X.509 Certificate Authentication</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.1</strong>  The TSF shall implement [selection: <em>TLS 1.2 (RFC 5246), TLS 1.3 (RFC 8446)</em>] and no other TLS version as a server that supports additional functionality for session renegotiation protection and [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>mutual authentication</em></p>
</li>
<li>
<p><em>supplemental downgrade protection</em></p>
</li>
<li>
<p><em>session resumption</em></p>
</li>
<li>
<p><em>no optional functionality</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>] and shall reject connection attempts from clients supporting all other TLS versions.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.2</strong>  The TSF shall be able to support the following TLS 1.2 ciphersuites: [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289 and RFC 8422</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289 and RFC 8422</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</em></p>
</li>
<li>
<p><em>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</em></p>
</li>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</em></p>
</li>
<li>
<p><em>TLS_RSA_WITH_AES_128_CBC_SHA as defined in RFC 5246</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>], the following PP-specific ciphersuites using pre-shared secrets: [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 8442</em></p>
</li>
<li>
<p><em>TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>TLS_RSA_PSK_WITH_AES_256_GCM_SHA384 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 8442</em></p>
</li>
<li>
<p><em>TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>TLS_RSA_PSK_WITH_AES_128_GCM_SHA256 as defined in RFC 5487</em></p>
</li>
<li>
<p><em>no ciphersuites using pre-shared secrets</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>], and the following TLS 1.3 ciphersuites: [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>TLS_AES_256_GCM_SHA384 as defined in RFC 8446</em></p>
</li>
<li>
<p><em>TLS_AES_128_GCM_SHA256 as defined in RFC 8446</em></p>
</li>
<li>
<p>[<em>assignment: other TLS 1.3 ciphersuites</em>]</p>
</li>
<li>
<p><em>no TLS 1.3 ciphersuites</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>] using a preference order based on [selection: <em>RFC 9151 priority, client hello ordering,
[assignment: additional priority]</em>].</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.3</strong>  The TSF shall not establish a connection with a client that does not indicate support for at least one of the supported ciphersuites.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.4</strong>  The TSF shall be able to process the following TLS client hello message extensions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>signature_algorithms extension (RFC 8446) indicating support for [selection:</p>
<div class="ulist">
<ul>
<li>
<p><em>ecdsa-secp384r1_sha384 (RFC] 8446)</em></p>
</li>
<li>
<p><em>rsa_pkcs1_sha384 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pss_pss_sha384 (RFC 8603)</em></p>
</li>
<li>
<p><em>rsa_pss_rsae_sha384 (RFC 8603)</em></p>
</li>
<li>
<p>[assignment: <em>other non-deprecated signature algorithms</em>]</p>
</li>
<li>
<p><em>no other signature algorithms</em></p>
<div class="paragraph">
<p>]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>the following other extensions: [selection:</p>
<div class="ulist">
<ul>
<li>
<p><em>signature_algorithms_cert extension (RFC 8446) indicating support for [selection:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>ecdsa-secp384r1_sha384 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pkcs1_sha384 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pss_pss_sha384 (RFC 8603)</em></p>
</li>
<li>
<p><em>rsa_pss_rsae_sha384 (RFC 8603)</em></p>
</li>
<li>
<p><em>rsa_pkcs1_sha256 (RFC 8446)</em></p>
</li>
<li>
<p><em>rsa_pss_rsae_sha256 (RFC 8446)</em></p>
</li>
<li>
<p>[assignment: <em>other non-deprecated signature algorithms</em>]</p>
</li>
<li>
<p><em>no other signature algorithms</em></p>
<div class="paragraph">
<p>]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>supported_versions extension (RFC 8446) indicating support for TLS 1.3</em></p>
</li>
<li>
<p><em>supported_groups extension (RFC 7919, RFC 8446) indicating support for [selection:</em></p>
<div class="ulist">
<ul>
<li>
<p><em>secp256r1</em></p>
</li>
<li>
<p><em>secp384r1</em></p>
</li>
<li>
<p><em>secp521r1</em></p>
</li>
<li>
<p><em>ffdhe2048(256)</em></p>
</li>
<li>
<p><em>ffdhe3072(257)</em></p>
</li>
<li>
<p><em>ffdhe4096(258)</em></p>
</li>
<li>
<p><em>ffdhe6144(259)</em></p>
</li>
<li>
<p><em>ffdhe8192(260)</em></p>
<div class="paragraph">
<p>]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>key_share extension (RFC 8446)</em></p>
</li>
<li>
<p><em>extended_master_secret extension (RFC 7627) [selection: enforcing, allow legacy] client support</em></p>
</li>
<li>
<p><em>no other extensions</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>].</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.5</strong>  The TSF shall perform key establishment for TLS using [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>RSA with size [selection: [2048, 3072, 4096] bits and no other sizes</em></p>
</li>
<li>
<p><em>Diffie-Hellman parameters with size [selection: [2048, 3072, 4096, 6144, 8192 ] bits and no other sizes</em></p>
</li>
<li>
<p><em>Diffie-Hellman groups [selection: [ffdhe2048, ffdhe3072, ffdhe4096, ffdhe6144, ffdhe8192] and no other groups, consistent with the client&#8217;s supported groups extension and [selection: [key share, no other] extension</em></p>
</li>
<li>
<p><em>ECDHE parameters using elliptic curves [selection: secp256r1, secp384r1, secp521r1] and no other curves, consistent with the client&#8217;s supported groups extension and [selection: [key share, no other] extension and using non-compressed formatting for points</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>].</p>
</div>
<div class="paragraph">
<p><strong>Management: FCS_TLSS_EXT.2</strong></p>
</div>
<div class="paragraph">
<p>No specific management functions are identified.</p>
</div>
<div class="paragraph">
<p><strong>Audit: FCS_TLSS_EXT.2</strong></p>
</div>
<div class="paragraph">
<p>There are no auditable events foreseen.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.2 TLS Server Support for Mutual Authentication</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:	FCS_TLSS_EXT.1 TLS Server Protocol</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.2.1</strong> The TSF shall support authentication of TLS clients using X.509v3 certificates during the TLS handshake and [selection: <em>during post-handshake requests, at no other time</em>] using the certificate types indicated in the client’s signature_algorithms and [selection: <em>signature_algorithms_cert, no other</em>] extension.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.2.2</strong> The TSF shall support authentication of TLS clients using X.509v3 certificates in accordance with [selection: <em>FIA_X509_EXT.1/Rev, FIA_X509_EXT.1/ITT</em>].</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.2.3</strong> The TSF shall be able to reject the establishment of a trusted channel if the requested client certificate is invalid and [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>continue establishment of a server-only authenticated TLS channel in accordance with FCS_TLSS_EXT.1 in support of [selection: all applications, [assignment: list of calling applications that accept both authenticated and unauthenticated client sessions] ] when an empty certificate message is provided by the client</em></p>
</li>
<li>
<p><em>continue establishment of a mutually authenticated TLS channel when revocation status information for the [selection: client&#8217;s leaf certificate, [assignment: specific intermediate CA certificates], any non-trust store certificate in the certificate chain] is not available in support of [selection: all applications, [assignment: list of calling applications configurable to perform certificate status information bypass processing] ] as [selection: configured by an administrator, confirmed by the application user, a default for [assignment: subset of applications] ]</em></p>
</li>
<li>
<p><em>no other processing options for missing or invalid client certificates</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>].</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.2.4</strong> The TSF shall be able to [selection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>not establish a TLS session if an entry of the Distinguished Name or a [selection: ,rfc822_name, dns_name,[assignment: supported name types] ] in the Subject Alternate Name extension contained in the client certificate does not match one of the expected identifiers for the client in accordance with [selection: RFC 2822, RFC 6125, RFC 5280, [assignment: RFC for the supported name type] ] matching rules</em></p>
</li>
<li>
<p><em>pass the [selection: validated certificate, RFC 2822 name normalized according to RFC 2822, DNS name normalized according to RFC 6125, [assignment: list of RFC 5280 name types and normalization rules], [assignment: list of 'other' name types and standard normalization rules] ] to [assignment: list of calling applications capable of making access decisions]</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>].</p>
</div>
<div class="paragraph">
<p><strong>Management: FCS_TLSS_EXT.3</strong></p>
</div>
<div class="paragraph">
<p>No specific management functions are identified.</p>
</div>
<div class="paragraph">
<p><strong>Audit: FCS_TLSS_EXT.3</strong></p>
</div>
<div class="paragraph">
<p>There are no auditable events foreseen.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.3 TLS Server Downgrade Protection</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:	FCS_TLSS_EXT.1 TLS Server Protocol</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.3.1</strong> The TSF shall set the server hello extension to a random value concatenated with the TLS 1.2 downgrade indicator when negotiating TLS 1.2 as indicated in RFC 8446 section 4.1.3.</p>
</div>
<div class="paragraph">
<p><strong>Management: FCS_TLSS_EXT.4</strong></p>
</div>
<div class="paragraph">
<p>No specific management functions are identified.</p>
</div>
<div class="paragraph">
<p><strong>Audit: FCS_TLSS_EXT.4</strong></p>
</div>
<div class="paragraph">
<p>There are no auditable events foreseen.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.4 TLS Server Support for Renegotiation</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:	FCS_TLSS_EXT.1 TLS Server Protocol</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.4.1</strong> The TSF shall support secure renegotiation through the use of [selection: the "renegotiation_info" TLS extension, not allowing session renegotiation] in accordance with RFC 5746.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.4.2</strong>  The TSF shall, when negotiating a TLS 1.2 session, [selection: include the renegotiation_info extension in server hello messages when a client hello with the renegotiation_info extension is received and shall
terminate a session if neither of the renegotiation_info or TLS_EMPTY_RENEGOTIATION_INFO_SCSV signaling ciphersuites are indicated in the client hello, not allow renegotiation].</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.4.3</strong>  The TSF shall terminate the session if an unexpected client hello is received during an active TLS session.</p>
</div>
<div class="paragraph">
<p><strong>Management: FCS_TLSS_EXT.5</strong></p>
</div>
<div class="paragraph">
<p>No specific management functions are identified.</p>
</div>
<div class="paragraph">
<p><strong>Audit: FCS_TLSS_EXT.5</strong></p>
</div>
<div class="paragraph">
<p>There are no auditable events foreseen.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.5 TLS Server Support for Session Resumption</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:	FCS_TLSS_EXT.1 TLS Server Protocol</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.5.1</strong> The TSF shall support session resumption as a server via the use of [selection: <em>session ID in accordance with RFC 5246, tickets in accordance with RFC 5077, PSK and tickets in accordance with RFC 8446</em>].</p>
</div>
<div class="paragraph">
<p><strong>Management: FCS_TLSS_EXT.6</strong></p>
</div>
<div class="paragraph">
<p>No specific management functions are identified.</p>
</div>
<div class="paragraph">
<p><strong>Audit: FCS_TLSS_EXT.6</strong></p>
</div>
<div class="paragraph">
<p>There are no auditable events foreseen.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.6 TLS Server TLS 1.3 Resumption Refinements</strong></p>
</div>
<div class="paragraph">
<p>Hierarchical to:	No other components.</p>
</div>
<div class="paragraph">
<p>Dependencies to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>FCS_TLSS_EXT.1 TLS Server Protocol</p>
</li>
<li>
<p>FCS_TLSS_EXT.5 TLS Server Support for Session Resumption</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.6.1</strong> The TSF shall support TLS 1.3 resumption using PSK with psk_key_exchange_mode extension with the value
psk_dhe_ke.</p>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.6.2</strong> The TSF shall ignore early data received in TLS 1.3 sessions.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="acronyms">Appendix D - Acronyms</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Acronym</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Advanced Encryption Standard</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Base-PP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Base Protection Profile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Certificate Authority</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cipher Block Chaining</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Common Criteria</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CEM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Common Evaluation Methodology</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Common Name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cPP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Collaborative Protection Profile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DHE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Diffie-Hellman Ephemeral</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Distinguished Name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DNS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Domain Name Server</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DTLS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Datagram Dransport Layer Security</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EAP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extensible Authentication Protocol</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ECDHE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Elliptic Curve Diffie-Hellman Ephemeral</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ECDSA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Elliptic Curve Digital Signature Algorithm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extended Package</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Functional Package</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GCM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Galois/Counter Mode</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hypertext Transfer Protocol</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IETF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internet Engineering Task Force</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internet Protocol</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NIST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">National Institute of Standards and Technology</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operational Environment</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Protection Profile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PP-Configuration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Protection Profile Configuration</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PP-Module</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Protection Profile Module</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RFC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Request for Comment</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RSA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rivest Shamir Adelman</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SAN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Subject Alternative Name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SAR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security Assurance Requirement</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCSV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Signaling ciphersuite Value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SFR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security Functional Requirement</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SHA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secure Hash Algorithm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security Target</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transmission Control Protocol</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TLS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transport Layer Security</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Target of Evaluation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TSF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[TOE] Security Functionality</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TSFI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[TSF] Interface</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TSS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[TOE] Summary Specification</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UDP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User Datagram Protocol</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">URI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uniform Resource Identifier</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uniform Resource Locator</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_appendix_e_bibliography">Appendix E - Bibliography</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Identifier</th>
<th class="tableblock halign-left valign-top">Title</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">[CC]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Common Criteria for Information Technology Security Evaluation</p>
<p class="tableblock"><a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART1V3.1R5.pdf">Part 1: Introduction and General Model</a> CCMB-2017-04-001, Version 3.1 Revision 5, April 2017.</p>
<p class="tableblock"><a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART2V3.1R5.pdf">Part 2: Security Functional Components</a>, CCMB-2017-04-002, Version 3.1 Revision 5, April 2017.</p>
<p class="tableblock"><a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART3V3.1R5.pdf">Part 3: Security Assurance Components</a>, CCMB-2017-04-003, Version 3.1 Revision 5, April 2017.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2023-09-09 14:45:27 -0400
</div>
</div>
</body>
</html>