:toc:
:toclevels: 3
:toc-title!:
:toc-placement!:
:data-uri:


= Functional Package for Transport Layer Security (TLS)

Version: 2.0 draft +
Date: TBD +

=== Revision History

[cols=",,",]
|===
|Version |Date |Comment

|1.0 |TBD |First publication


|===


=== Contents

toc::[]


[[Introduction]]
== 1 Introduction

[[Overview]]
=== 1.1 Overview

Transport Layer Security (link:#abbr_TLS[TLS]) and the closely-related
Datagram link:#abbr_TLS[TLS] (link:#abbr_DTLS[DTLS]) are cryptographic
protocols designed to provide communications security over
link:#abbr_IP[IP] networks. Several versions of the protocol are in
widespread use in software that provides functionality such as web
browsing, email, instant messaging, and voice-over-IP (VoIP). Major
websites use link:#abbr_TLS[TLS] to protect communications to and from
their servers. link:#abbr_TLS[TLS] is also used to protect
communications between hosts and network infrastructure devices for
administration. The underlying platform, such as an operating system,
often provides the actual link:#abbr_TLS[TLS] implementation. The
primary goal of the link:#abbr_TLS[TLS] protocol is to provide
confidentiality and integrity of data transmitted between two
communicating endpoints, as well as authentication of at least the
server endpoint.

link:#abbr_TLS[TLS] supports many different methods for exchanging keys,
encrypting data, and authenticating message integrity. These methods are
dynamically negotiated between the client and server when the
link:#abbr_TLS[TLS] connection is established. As a result, evaluating
the implementation of both endpoints is typically necessary to provide
assurance for the operating environment.

This "Functional Package for Transport Layer Security" (short name
"link:#abbr_TLS[TLS]-PKG") defines functional requirements for the
implementation of the link:#abbr_TLS[TLS] and link:#abbr_DTLS[DTLS]
protocols. The requirements are intended to improve the security of
products by enabling their evaluation.

[[glossary]]
=== 1.2 Terms

The following sections list Common Criteria and technology terms used in
this document.

[[cc-terms]]
==== 1.2.1 Common Criteria Terms

[width="100%",cols="50%,50%",]
|===
a|
[[Assurance]]
Assurance

|Grounds for confidence that a TOE meets the SFRs link:#bibCC[[CC]].

a|
[[Base_Protection_Profile]]
Base Protection Profile (Base-PP)

|Protection Profile used as a basis to build a PP-Configuration.

a|
[[Collaborative_Protection_Profile]]
Collaborative Protection Profile (cPP)

|A Protection Profile developed by international technical communities
and approved by multiple schemes.

a|
[[Common_Criteria]]
Common Criteria (CC)

|Common Criteria for Information Technology Security Evaluation
(International Standard ISO/IEC 15408).

a|
[[Common_Criteria_Testing_Laboratory]]
Common Criteria Testing Laboratory

|Within the context of the Common Criteria Evaluation and Validation
Scheme (CCEVS), an IT security evaluation facility accredited by the
National Voluntary Laboratory Accreditation Program (NVLAP) and approved
by the NIAP Validation Body to conduct Common Criteria-based
evaluations.

a|
[[Common_Evaluation_Methodology]]
Common Evaluation Methodology (CEM)

|Common Evaluation Methodology for Information Technology Security
Evaluation.

a|
[[Distributed_TOE]]
Distributed TOE

|A TOE composed of multiple components operating as a logical whole.

a|
[[Extended_Package]]
Extended Package (EP)

|A deprecated document form for collecting SFRs that implement a
particular protocol, technology, or functionality. See Functional
Packages.

a|
[[Functional_Package]]
Functional Package (FP)

|A document that collects SFRs for a particular protocol, technology, or
functionality.

a|
[[Operational_Environment]]
Operational Environment (OE)

|Hardware and software that are outside the TOE boundary that support
the TOE functionality and security policy.

a|
[[Protection_Profile]]
Protection Profile (PP)

|An implementation-independent set of security requirements for a
category of products.

a|
[[Protection_Profile_Configuration]]
Protection Profile Configuration (PP-Configuration)

|A comprehensive set of security requirements for a product type that
consists of at least one Base-PP and at least one PP-Module.

a|
[[Protection_Profile_Module]]
Protection Profile Module (PP-Module)

|An implementation-independent statement of security needs for a TOE
type complementary to one or more Base-PPs.

a|
[[Security_Assurance_Requirement]]
Security Assurance Requirement (SAR)

|A requirement to assure the security of the TOE.

a|
[[Security_Functional_Requirement]]
Security Functional Requirement (SFR)

|A requirement for security enforcement by the TOE.

a|
[[Security_Target]]
Security Target (ST)

|A set of implementation-dependent security requirements for a specific
product.

a|
[[Target_of_Evaluation]]
Target of Evaluation (TOE)

|The product under evaluation.

a|
[[TOE_Security_Functionality]]
TOE Security Functionality (TSF)

|The security functionality of the product under evaluation.

a|
[[TOE_Summary_Specification]]
TOE Summary Specification (TSS)

|A description of how a TOE satisfies the SFRs in an ST.
|===

[[tech-terms]]
==== 1.2.2 Technical Terms

[width="100%",cols="50%,50%",]
|===
a|
[[Certificate_Authority]]
Certificate Authority (CA)

|Issuer of digital certificates.

a|
[[Datagram_Transport_Layer_Security]]
Datagram Transport Layer Security (DTLS)

|Cryptographic network protocol, based on TLS, which provides
communications security for datagram protocols.

a|
[[Transport_Layer_Security]]
Transport Layer Security (TLS)

|Cryptographic network protocol for providing communications security
over a TCP/IP network.
|===

[[Compliant_Targets_of_Evaluation]]
=== 1.3 Compliant Targets of Evaluation

The Target of Evaluation (link:#abbr_TOE[TOE]) in this Package is a
product which acts as a (D)link:#abbr_TLS[TLS] client, a
(D)link:#abbr_TLS[TLS] server, or both. This Package describes the
security functionality of link:#abbr_TLS[TLS] and link:#abbr_DTLS[DTLS]
in terms of link:#bibCC[[CC]].

The contents of this Package must be appropriately combined with a
link:#abbr_PP[PP] or link:#abbr_PP-Module[PP-Module]. When this Package
is instantiated by a link:#abbr_PP[PP] or
link:#abbr_PP-Module[PP-Module], the Package must include
selection-based requirements in accordance with the selections or
assignments indicated in the link:#abbr_PP[PP] or
link:#abbr_PP-Module[PP-Module]. These may be expanded by the the
link:#abbr_ST[ST] author.

The link:#abbr_PP[PP] or link:#abbr_PP-Module[PP-Module] which
instantiates this Package must typically include the following
components in order to satisfy dependencies of this Package. It is the
responsibility of the link:#abbr_PP[PP] or
link:#abbr_PP-Module[PP-Module] author who instantiates this Package to
ensure that dependence on these components is satisfied: +

[width="100%",cols="50%,50%",]
|===
|Component |Explanation

|link:#FCS_CKM.1[FCS_CKM.1] |To support link:#abbr_TLS[TLS] ciphersuites
that use link:#abbr_RSA[RSA], link:#abbr_DHE[DHE] or
link:#abbr_ECDHE[ECDHE] for key exchange, the link:#abbr_PP[PP] or
link:#abbr_PP-Module[PP-Module] must include link:#FCS_CKM.1[FCS_CKM.1]
and specify the corresponding key generation algorithm. +

|link:#FCS_CKM.2[FCS_CKM.2] |To support link:#abbr_TLS[TLS] ciphersuites
that use link:#abbr_RSA[RSA], link:#abbr_DHE[DHE] or
link:#abbr_ECDHE[ECDHE] for key exchange, the link:#abbr_PP[PP] or
link:#abbr_PP-Module[PP-Module] must include link:#FCS_CKM.2[FCS_CKM.2]
and specify the corresponding algorithm. +

|link:#FCS_COP.1[FCS_COP.1] |To support link:#abbr_TLS[TLS] ciphersuites
that use link:#abbr_AES[AES] for encryption and decryption, the
link:#abbr_PP[PP] or link:#abbr_PP-Module[PP-Module] must include
link:#FCS_COP.1[FCS_COP.1] (iterating as needed) and specify
link:#abbr_AES[AES] with corresponding key sizes and modes. To support
link:#abbr_TLS[TLS] ciphersuites that use link:#abbr_SHA[SHA] for
hashing, the link:#abbr_PP[PP] or link:#abbr_PP-Module[PP-Module] must
include link:#FCS_COP.1[FCS_COP.1] (iterating as needed) and specify
link:#abbr_SHA[SHA] with corresponding digest sizes. +

|link:#FCS_RBG_EXT.1[FCS_RBG_EXT.1] |To support random bit generation
needed for the link:#abbr_TLS[TLS] handshake, the link:#abbr_PP[PP] or
link:#abbr_PP-Module[PP-Module] must include
link:#FCS_RBG_EXT.1[FCS_RBG_EXT.1]. +

|link:#FIA_X509_EXT.1[FIA_X509_EXT.1] |To support validation of
certificates needed during link:#abbr_TLS[TLS] connection setup, the
link:#abbr_PP[PP] or link:#abbr_PP-Module[PP-Module] must include
link:#FIA_X509_EXT.1[FIA_X509_EXT.1]. +

|link:#FIA_X509_EXT.2[FIA_X509_EXT.2] |To support the use of X509
certificates for authentication in link:#abbr_TLS[TLS] connection setup,
the link:#abbr_PP[PP] or link:#abbr_PP-Module[PP-Module] must include
link:#FIA_X509_EXT.2[FIA_X509_EXT.2]. +
|===

An link:#abbr_ST[ST] must identify the applicable version of the
link:#abbr_PP[PP] or link:#abbr_PP-Module[PP-Module] and this Package in
its conformance claims.

[[Conformance_Claims]]
== 2 Conformance Claims

Conformance Statement::
  An link:#abbr_ST[ST] must claim exact conformance to this
  link:#abbr_PP[PP]-Package, as defined in the link:#abbr_CC[CC] and
  link:#abbr_CEM[CEM] addenda for Exact Conformance, Selection-based
  link:#abbr_SFR[SFRs], and Optional link:#abbr_SFR[SFRs] (dated May
  2017).
CC Conformance Claims::
  This link:#abbr_PP[PP]-Package is conformant to Parts 2 (extended) and
  3 (conformant) of Common Criteria Version 3.1, Revision 5.
PP Claim::
  This link:#abbr_PP[PP]-Package does not claim conformance to any
  Protection Profile.
Package Claim::
  This link:#abbr_PP[PP]-Package does not claim conformance to any
  packages.

[[Security_Functional_Requirements]]
== 3 Security Functional Requirements

This chapter describes the security requirements which have to be
fulfilled by the product under evaluation. Those requirements comprise
functional components from Part 2 of link:#bibCC[[CC]]. The following
conventions are used for the completion of operations:

* *Refinement* operation (denoted by *bold text* or
[line-through]*strikethrough text*): Is used to add details to a
requirement (including replacing an assignment with a more restrictive
selection) or to remove part of the requirement that is made irrelevant
through the completion of another operation, and thus further restricts
a requirement.
* *Selection* (denoted by _italicized text_): Is used to select one or
more options provided by the [link:#abbr_CC[CC]] in stating a
requirement.
* *Assignment* operation (denoted by [.assignable-content]#italicized
text#): Is used to assign a specific value to an unspecified parameter,
such as the length of a password. Showing the value in square brackets
indicates assignment.
* *Iteration* operation: Is indicated by appending the
link:#abbr_SFR[SFR] name with a slash and unique identifier suggesting
the purpose of the operation, e.g. "/EXAMPLE1."

[[Auditable_Events_for_Mandatory_SFRs]]
=== 3.1 Auditable Events for Mandatory SFRs

The auditable events specified in this Functional Package are included
in a Security Target if the incorporating link:#abbr_PP[PP] or
link:#abbr_PP-Module[PP-Module] supports audit event reporting through
FAU_GEN.1 and all other criteria in the incorporating link:#abbr_PP[PP]
or link:#abbr_PP-Module[PP-Module] are met.

.[#t-audit-mandatory .ctr]#Table [.counter]#1##: Auditable Events for
Mandatory Requirements
[cols=",,",]
|===
|Requirement |Auditable Events |Additional Audit Record Contents
|link:#FCS_TLS_EXT.1[FCS_TLS_EXT.1] | |
| | |
|No events specified |N/A |
|===

[[fcs]]
=== 3.2 Cryptographic Support (FCS)

[[FCS_TLS_EXT.1]]
==== FCS_TLS_EXT.1 TLS Protocol

[[FCS_TLS_EXT.1.1]]
link:#FCS_TLS_EXT.1.1[FCS_TLS_EXT.1.1]

The link:#abbr_TSF[TSF] shall implement [*selection*:

* [#tlsc_impl .selectable-content]#link:#abbr_TLS[TLS] as a client#
* [#tlss_impl .selectable-content]#link:#abbr_TLS[TLS] as a server#
* [#dtlsc_impl .selectable-content]#link:#abbr_DTLS[DTLS] as a client#
* [#dtlss_impl .selectable-content]#link:#abbr_DTLS[DTLS] as a server#

].

[.note-header]#Application Note: #[.note]# If _link:#abbr_TLS[TLS] as a
client_ is selected, then the link:#abbr_ST[ST] must include the
requirements from link:#FCS_TLSC_EXT.1[FCS_TLSC_EXT.1] and
link:#FCS_TLSC_EXT.4[FCS_TLSC_EXT.4]. +
If _link:#abbr_TLS[TLS] as a server_ is selected, then the
link:#abbr_ST[ST] must include the requirements from
link:#FCS_TLSS_EXT.1[FCS_TLSS_EXT.1] and
link:#FCS_TLSS_EXT.4[FCS_TLSS_EXT.4]. +
 +
If _link:#abbr_DTLS[DTLS] as a client_ is selected, then the
link:#abbr_ST[ST] must include the requirements from
link:#FCS_DTLSC_EXT.1[FCS_DTLSC_EXT.1] and
link:#FCS_DTLSC_EXT.4[FCS_DTLSC_EXT.4]. +
If _link:#abbr_DTLS[DTLS] as a server_ is selected, then the
link:#abbr_ST[ST] must include the requirements from
link:#FCS_DTLSS_EXT.1[FCS_DTLSS_EXT.1] and
link:#FCS_DTLSS_EXT.4[FCS_DTLSS_EXT.4]. #

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_TLS_EXT.1[FCS_TLS_EXT.1]

link:#abbr_TSS[TSS]

The evaluator shall examine the link:#abbr_TSS[TSS] to verify that the
link:#abbr_TLS[TLS] and link:#abbr_DTLS[DTLS] claims are consistent with
those selected in the link:#abbr_SFR[SFR].

Guidance

The evaluator shall ensure that the selections indicated in the
link:#abbr_ST[ST] are consistent with selections in the dependent
components.

Tests

There are no test activities for this link:#abbr_SFR[SFR]; the following
information is provided as an overview of the expected functionality and
test environment for all subsequent link:#abbr_SFR[SFRs].

*Test Environment:*

Tests for link:#abbr_TLS[TLS] 1.2 and link:#abbr_TLS[TLS] 1.3 include
examination of the handshake messages and behavior of the
link:#abbr_TSF[TSF] when presented with unexpected or invalid messages.
For link:#abbr_TLS[TLS] 1.2 and below, previous versions of this
Functional Package only required visibility of network traffic and the
ability to modify a valid handshake message sent to the
link:#abbr_TSF[TSF].

[[figure-Figure2]]
[#Figure2 .image .placeholder]## +
[.ctr]#Figure [.counter]#1##: Test environment for link:#abbr_TLS[TLS]
1.2 using network traffic visibility and control tools

link:#abbr_TLS[TLS] 1.3 introduces the encryption of handshake messages
subsequent to the server hello exchange which prevents visibility and
control using midpoint capabilities. To achieve equivalent validation of
link:#abbr_TLS[TLS] 1.3 requires the ability to modify the traffic
underlying the encryption applied after the server hello message. This
can be achieved by introducing additional control of the messages sent,
and visibility of messages received by the test link:#abbr_TLS[TLS]
client, (when validating link:#abbr_TLS[TLS] server functionality) or
the test server (when validating link:#abbr_TLS[TLS] client
functionality).

[[figure-Figure3]]
[#Figure3 .image .placeholder]## +
[.ctr]#Figure [.counter]#2##: Test environment for link:#abbr_TLS[TLS]
1.3 using custom endpoint capabilities for visibility and control

Typically, a compliant link:#abbr_TLS[TLS] 1.3 library modified to
provide visibility and control of the handshake messages prior to
encryption suffices for all tests. Such modification will require the
test client, test server, or both to be validated.

Since validations of products supporting only link:#abbr_TLS[TLS] 1.2
are still expected under this Package, the test environment for
link:#abbr_TLS[TLS] 1.2-only validations may include network sniffers
and man-in-the-middle products that do not require such modifications to
a compliant link:#abbr_TLS[TLS] 1.2 library. For consistency, a
compliant link:#abbr_TLS[TLS] client (or link:#abbr_TLS[TLS] server)
together with the network sniffers and man-in-the-middle capabilities
will also be referred to as a test link:#abbr_TLS[TLS] client (or test
link:#abbr_TLS[TLS] server, respectively) in the following evaluation
activities.

[[figure-Figure4]]
[#Figure4 .image .placeholder]## +
[.ctr]#Figure [.counter]#3##: Combined test environment for
link:#abbr_TLS[TLS] 1.2 and link:#abbr_TLS[TLS] 1.3 using both network
tools and custom endpoint capabilities

[[opt-app]]
== Appendix A - Optional Requirements

As indicated in the introduction to this link:#abbr_PP[PP]-Package, the
baseline requirements (those that must be performed by the
link:#abbr_TOE[TOE]) are contained in the body of this
link:#abbr_PP[PP]-Package. This appendix contains three other types of
optional requirements that may be included in the link:#abbr_ST[ST], but
are not required in order to conform to this link:#abbr_PP[PP]-Package.
However, applied modules, packages and/or use cases may refine specific
requirements as mandatory. +
 +
The first type (link:#optional-reqs[A.1 Strictly Optional Requirements])
are strictly optional requirements that are independent of the
link:#abbr_TOE[TOE] implementing any function. If the
link:#abbr_TOE[TOE] fulfills any of these requirements or supports a
certain functionality, the vendor is encouraged to include the
link:#abbr_SFR[SFRs] in the link:#abbr_ST[ST], but are not required in
order to conform to this link:#abbr_PP[PP]-Package. +
 +
The second type (link:#objective-reqs[A.2 Objective Requirements]) are
objective requirements that describe security functionality not yet
widely available in commercial technology. The requirements are not
currently mandated in the body of this link:#abbr_PP[PP]-Package, but
will be included in the baseline requirements in future versions of this
link:#abbr_PP[PP]-Package. Adoption by vendors is encouraged and
expected as soon as possible. +
 +
The third type (link:#feat-based-reqs[A.3 Implementation-based
Requirements]) are dependent on the link:#abbr_TOE[TOE] implementing a
particular function. If the link:#abbr_TOE[TOE] fulfills any of these
requirements, the vendor must either add the related link:#abbr_SFR[SFR]
or disable the functionality for the evaluated configuration.

[[optional-reqs]]
=== A.1 Strictly Optional Requirements

This link:#abbr_PP[PP]-Package does not define any Strictly Optional
requirements.

[[objective-reqs]]
=== A.2 Objective Requirements

This link:#abbr_PP[PP]-Package does not define any Objective
requirements.

[[feat-based-reqs]]
=== A.3 Implementation-based Requirements

This link:#abbr_PP[PP]-Package does not define any Implementation-based
requirements.

[[sel-based-reqs]]
== Appendix B - Selection-based Requirements

[.description]# #

As indicated in the introduction to this link:#abbr_PP[PP]-Package, the
baseline requirements (those that must be performed by the
link:#abbr_TOE[TOE] or its underlying platform) are contained in the
body of this link:#abbr_PP[PP]-Package. There are additional
requirements based on selections in the body of the
link:#abbr_PP[PP]-Package: if certain selections are made, then
additional requirements below must be included.

[[sel-based-reqs-audit]]
=== B.1 Auditable Events for Selection-based Requirements

The auditable events in the table below are included in a Security
Target if both the associated requirement is included and the
incorporating link:#abbr_PP[PP] or link:#abbr_PP-Module[PP-Module]
supports audit event reporting through FAU_GEN.1 and any other criteria
in the incorporating link:#abbr_PP[PP] or
link:#abbr_PP-Module[PP-Module] are met.

.[#t-audit-sel-based .ctr]#Table [.counter]#2##: Auditable Events for
Selection-based Requirements
[cols=",,",]
|===
|Requirement |Auditable Events |Additional Audit Record Contents

|link:#FCS_DTLSC_EXT.1[FCS_DTLSC_EXT.1] | |

| | |

| |*[selection:* _Establishment/termination of a link:#abbr_DTLS[DTLS]
session, None_*]* |Non-TOE endpoint of connection.

| |*[selection:* _Failure to establish a link:#abbr_DTLS[DTLS] session,
None_*]* |Reason for failure.

|*[selection:* _Failure to verify presented identifier, None_*]*
|Presented identifier and reference identifier. |

|link:#FCS_DTLSC_EXT.2[FCS_DTLSC_EXT.2] | |

| | |

|No events specified |N/A |

|link:#FCS_DTLSC_EXT.3[FCS_DTLSC_EXT.3] | |

| | |

|No events specified |N/A |

|link:#FCS_DTLSC_EXT.4[FCS_DTLSC_EXT.4] | |

| | |

|No events specified |N/A |

|link:#FCS_DTLSC_EXT.5[FCS_DTLSC_EXT.5] | |

| | |

|No events specified |N/A |

|link:#FCS_DTLSC_EXT.6[FCS_DTLSC_EXT.6] | |

| | |

|No events specified |N/A |

|link:#FCS_DTLSS_EXT.1[FCS_DTLSS_EXT.1] | |

| | |

|*[selection:* _Failure to establish a link:#abbr_TLS[TLS] session,
None_*]* |Reason for failure |

|link:#FCS_DTLSS_EXT.2[FCS_DTLSS_EXT.2] | |

| | |

|No events specified |N/A |

|link:#FCS_DTLSS_EXT.3[FCS_DTLSS_EXT.3] | |

| | |

|No events specified |N/A |

|link:#FCS_DTLSS_EXT.4[FCS_DTLSS_EXT.4] | |

| | |

|No events specified |N/A |

|link:#FCS_DTLSS_EXT.5[FCS_DTLSS_EXT.5] | |

| | |

|No events specified |N/A |

|link:#FCS_DTLSS_EXT.6[FCS_DTLSS_EXT.6] | |

| | |

|No events specified |N/A |

|link:#FCS_TLSC_EXT.1[FCS_TLSC_EXT.1] | |

| | |

| |*[selection:* _Failure to establish a link:#abbr_TLS[TLS] session,
None_*]* |Reason for failure.

| |*[selection:* _Failure to verify presented identifier, None_*]*
|Presented identifier and reference identifier.

|*[selection:* _Establishment/termination of a link:#abbr_TLS[TLS]
session, None_*]* |Non-TOE endpoint of connection. |

|link:#FCS_TLSC_EXT.2[FCS_TLSC_EXT.2] | |

| | |

|No events specified |N/A |

|link:#FCS_TLSC_EXT.3[FCS_TLSC_EXT.3] | |

| | |

|No events specified |N/A |

|link:#FCS_TLSC_EXT.4[FCS_TLSC_EXT.4] | |

| | |

|No events specified |N/A |

|link:#FCS_TLSC_EXT.5[FCS_TLSC_EXT.5] | |

| | |

|No events specified |N/A |

|link:#FCS_TLSC_EXT.6[FCS_TLSC_EXT.6] | |

| | |

|No events specified |N/A |

|link:#FCS_TLSS_EXT.1[FCS_TLSS_EXT.1] | |

| | |

|*[selection:* _Failure to establish a link:#abbr_TLS[TLS] session,
None_*]* |Reason for failure |

|link:#FCS_TLSS_EXT.2[FCS_TLSS_EXT.2] | |

| | |

|No events specified |N/A |

|link:#FCS_TLSS_EXT.3[FCS_TLSS_EXT.3] | |

| | |

|No events specified |N/A |

|link:#FCS_TLSS_EXT.4[FCS_TLSS_EXT.4] | |

| | |

|No events specified |N/A |

|link:#FCS_TLSS_EXT.5[FCS_TLSS_EXT.5] | |

| | |

|No events specified |N/A |

|link:#FCS_TLSS_EXT.6[FCS_TLSS_EXT.6] | |

| | |

|No events specified |N/A |
|===

[[fcs-sel-based]]
=== B.2 Cryptographic Support (FCS)

[[FCS_DTLSC_EXT.1]]
==== FCS_DTLSC_EXT.1 DTLS Client Protocol

*_The inclusion of this selection-based component depends upon selection
in link:#FCS_TLS_EXT.1.1[FCS_TLS_EXT.1.1]._*

[[FCS_DTLSC_EXT.1.1]]
link:#FCS_DTLSC_EXT.1.1[FCS_DTLSC_EXT.1.1]

The link:#abbr_TSF[TSF] shall implement link:#abbr_DTLS[DTLS] 1.2
(link:#abbr_RFC[RFC] 6347) and [*selection*:
[#_s_5 .selectable-content]#link:#abbr_DTLS[DTLS] 1.3
(link:#abbr_RFC[RFC] 9147)#, [#_s_6 .selectable-content]#no other
link:#abbr_DTLS[DTLS] versions# ] as a client that supports additional
functionality for session renegotiation protection and [*selection*:

* [#dtlsc_mutual_auth .selectable-content]#mutual authentication#
* [#dtlsc_downgrade_protection .selectable-content]#supplemental
downgrade protection#
* [#dtlsc_resumption .selectable-content]#session resumption#
* [#_s_10 .selectable-content]#no optional functionality#

] and shall abort attempts by a server to negotiate all other
link:#abbr_DTLS[DTLS] versions.

[.note-header]#Application Note: #[.note]# #

This link:#abbr_SFR[SFR] is claimed if "link:#abbr_DTLS[DTLS] as a
client" is selected in link:#FCS_TLS_EXT.1.1[FCS_TLS_EXT.1.1].

The link:#abbr_ST[ST] author will claim link:#abbr_DTLS[DTLS] 1.3
functionality if supported, and optional functionality as appropriate
for the claimed versions.

Session renegotiation protection is required for both
link:#abbr_DTLS[DTLS] 1.2 and link:#abbr_DTLS[DTLS] 1.3, and the
link:#abbr_ST[ST] must include the requirements from
link:#FCS_DTLSC_EXT.4[FCS_DTLSC_EXT.4]. Within
link:#FCS_DTLSC_EXT.4[FCS_DTLSC_EXT.4], options for implementation of
secure session renegotiation for link:#abbr_DTLS[DTLS] 1.2 or rejecting
renegotiation requests are claimed.

If "mutual authentication" is selected, then the link:#abbr_ST[ST] must
additionally include the requirements from
link:#FCS_DTLSC_EXT.2[FCS_DTLSC_EXT.2]. If the link:#abbr_TOE[TOE]
implements mutual authentication, this selection must be made.

If "supplemental downgrade protection" is selected, then the
link:#abbr_ST[ST] must additionally include the requirements from
link:#FCS_DTLSC_EXT.3[FCS_DTLSC_EXT.3]. This is claimed if
link:#abbr_DTLS[DTLS] 1.3 is supported, or if the product supports
link:#abbr_TLS[TLS] 1.1 or below downgrade protection using the
mechanism described in link:#abbr_RFC[RFC] 8446. Note that
link:#abbr_TLS[TLS] 1.1 or below downgrade protection in
link:#abbr_DTLS[DTLS] is used to notify a client that the server is
capable of supporting link:#abbr_DTLS[DTLS] 1.2 or link:#abbr_DTLS[DTLS]
1.3, but that it received a client hello indicating maximum support for
link:#abbr_DTLS[DTLS] 1.0 (there is no link:#abbr_DTLS[DTLS] version
1.1).

If "session resumption" is selected, then the link:#abbr_ST[ST] must
additionally include the requirements from
link:#FCS_DTLSC_EXT.5[FCS_DTLSC_EXT.5].

link:#abbr_DTLS[DTLS] version numbers are denoted on the wire as the 1’s
complement of the corresponding textual link:#abbr_DTLS[DTLS] versions
as described in Section 4.1 of link:#abbr_RFC[RFC] 6347.
link:#abbr_DTLS[DTLS] version 1.2 is 0xfefd; link:#abbr_DTLS[DTLS]
version 1.3 is 0xfefc.

[[FCS_DTLSC_EXT.1.2]]
link:#FCS_DTLSC_EXT.1.2[FCS_DTLSC_EXT.1.2]

The link:#abbr_TSF[TSF] shall be able to support the following
link:#abbr_TLS[TLS] 1.2 ciphersuites: [*selection*:

* [#_s_11 .selectable-content]#TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
as defined in link:#abbr_RFC[RFC] 5289 and link:#abbr_RFC[RFC] 8422#
* [#_s_12 .selectable-content]#TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 5289 and link:#abbr_RFC[RFC] 8422#
* [#_s_13 .selectable-content]#TLS_RSA_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 5288#
* [#_s_14 .selectable-content]#TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 5288#
* [#_s_15 .selectable-content]#TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384
as defined in link:#abbr_RFC[RFC] 5289#
* [#_s_16 .selectable-content]#TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as
defined in link:#abbr_RFC[RFC] 5289#
* [#_s_17 .selectable-content]#TLS_RSA_WITH_AES_256_CBC_SHA256 as
defined in link:#abbr_RFC[RFC] 5246#
* [#_s_18 .selectable-content]#TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as
defined in link:#abbr_RFC[RFC] 5246#
* [#_s_19 .selectable-content]#TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
as defined in link:#abbr_RFC[RFC] 5289#
* [#_s_20 .selectable-content]#TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as
defined in link:#abbr_RFC[RFC] 5289#
* [#_s_21 .selectable-content]#TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256
as defined in link:#abbr_RFC[RFC] 5289#
* [#_s_22 .selectable-content]#TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as
defined in link:#abbr_RFC[RFC] 5289#
* [#_s_23 .selectable-content]#TLS_RSA_WITH_AES_128_CBC_SHA256 as
defined in link:#abbr_RFC[RFC] 5246#
* [#_s_24 .selectable-content]#TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as
defined in link:#abbr_RFC[RFC] 5246#
* [#_s_25 .selectable-content]#TLS_RSA_WITH_AES_128_CBC_SHA as defined
in link:#abbr_RFC[RFC] 5246#

], the following link:#abbr_PP[PP]-specific ciphersuites using
pre-shared secrets: [*selection*:

* [#_s_26 .selectable-content]#TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 8442#
* [#_s_27 .selectable-content]#TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 5487#
* [#_s_28 .selectable-content]#TLS_RSA_PSK_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 5487#
* [#_s_29 .selectable-content]#TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as
defined in link:#abbr_RFC[RFC] 8442#
* [#_s_30 .selectable-content]#TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as
defined in link:#abbr_RFC[RFC] 5487#
* [#_s_31 .selectable-content]#TLS_RSA_PSK_WITH_AES_128_GCM_SHA256 as
defined in link:#abbr_RFC[RFC] 5487#
* [#_s_32 .selectable-content]#no ciphersuites using pre-shared secrets#

], and the following link:#abbr_TLS[TLS] 1.3 ciphersuites: [*selection*:

* [#_s_33 .selectable-content]#TLS_AES_256_GCM_SHA384 as defined in
link:#abbr_RFC[RFC] 8446#
* [#_s_34 .selectable-content]#TLS_AES_128_GCM_SHA256 as defined in
link:#abbr_RFC[RFC] 8446#
* [#_s_35 .selectable-content]#[*assignment*:
[.assignable-content]#other link:#abbr_TLS[TLS] 1.3 ciphersuites#]#
* [#_s_36 .selectable-content]#no link:#abbr_TLS[TLS] 1.3 ciphersuites#

] offering the supported ciphersuites in a client hello message in
preference order: [*assignment*: [.assignable-content]#list of supported
ciphersuites#].

[.note-header]#Application Note: #[.note]# #

link:#abbr_DTLS[DTLS] uses link:#abbr_TLS[TLS] ciphersuites. The
link:#abbr_ST[ST] author should select the ciphersuites that are
supported, and must select at least one ciphersuite for each
link:#abbr_DTLS[DTLS] version supported – link:#abbr_TLS[TLS] 1.2
ciphersuites for link:#abbr_DTLS[DTLS] 1.2 and link:#abbr_TLS[TLS] 1.3
ciphersuites for link:#abbr_DTLS[DTLS] 1.3.

The application note for link:#FCS_TLSC_EXT.1.2[FCS_TLSC_EXT.1.2]
applies to this requirement, with
‘link:#FCS_TLSC_EXT.1.1[FCS_TLSC_EXT.1.1]’ replaced by
‘link:#FCS_DTLSC_EXT.1.1[FCS_DTLSC_EXT.1.1].’

[[FCS_DTLSC_EXT.1.3]]
link:#FCS_DTLSC_EXT.1.3[FCS_DTLSC_EXT.1.3]

The link:#abbr_TSF[TSF] shall not offer ciphersuites indicating the
following:

* the null encryption component
* support for anonymous servers
* use of deprecated or export-grade cryptography including DES, 3DES,
RC2, RC4, or IDEA for encryption
* use of MD

and shall abort sessions where a server attempts to negotiate
ciphersuites not enumerated in the client hello message.

[[FCS_DTLSC_EXT.1.4]]
link:#FCS_DTLSC_EXT.1.4[FCS_DTLSC_EXT.1.4]

The link:#abbr_TSF[TSF] shall be able to support the following
link:#abbr_TLS[TLS] client hello message extensions:

* signature_algorithms extension (link:#abbr_RFC[RFC] 8446) indicating
support for [*selection*:
** [#_s_37 .selectable-content]#ecdsa-secp384r1_sha384
(link:#abbr_RFC[RFC] 8446)#
** [#_s_38 .selectable-content]#rsa_pkcs1_sha384 (link:#abbr_RFC[RFC]
8446)#
+
], and [*selection*:
** [#_s_39 .selectable-content]#rsa_pss_pss_sha384 (link:#abbr_RFC[RFC]
8603)#
** [#_s_40 .selectable-content]#rsa_pss_rsae_sha384 (link:#abbr_RFC[RFC]
8603)#
** [#_s_41 .selectable-content]#[*assignment*:
[.assignable-content]#other non-deprecated signature algorithms#]#
** [#_s_42 .selectable-content]#no other signature algorithms#
+
]
* extended_master_secret extension (link:#abbr_RFC[RFC] 7627) enforcing
server support
* the following other extensions: [*selection*:
** [#_s_43 .selectable-content]#signature_algorithms_cert extension
(link:#abbr_RFC[RFC] 8446) indicating support for [*selection*: #
*** [#_s_44 .selectable-content]#ecdsa-secp384r1_sha384
(link:#abbr_RFC[RFC] 8446)#
*** [#_s_45 .selectable-content]#rsa_pkcs1_sha384 (link:#abbr_RFC[RFC]
8446)#
+
], and [*selection*:
*** [#_s_46 .selectable-content]#rsa_pss_pss_sha384 (link:#abbr_RFC[RFC]
8603)#
*** [#_s_47 .selectable-content]#rsa_pss_rsae_sha384
(link:#abbr_RFC[RFC] 8603)#
*** [#_s_48 .selectable-content]#rsa_pkcs1_sha256 (link:#abbr_RFC[RFC]
8446)#
*** [#_s_49 .selectable-content]#rsa_pss_rsae_sha256
(link:#abbr_RFC[RFC] 8446)#
*** [#_s_50 .selectable-content]#[*assignment*:
[.assignable-content]#other non-deprecated signature algorithms#]#
*** [#_s_51 .selectable-content]#no other signature algorithms#
+
]
** [#_s_52 .selectable-content]#supported_versions extension
(link:#abbr_RFC[RFC] 8446) indicating support for link:#abbr_DTLS[DTLS]
1.3#
** [#_s_53 .selectable-content]#supported_groups extension
(link:#abbr_RFC[RFC] 7919, link:#abbr_RFC[RFC] 8446) indicating support
for [*selection*: #
*** [#_s_54 .selectable-content]#secp256r1#
*** [#_s_55 .selectable-content]#secp384r1#
*** [#_s_56 .selectable-content]#secp521r1#
*** [#_s_57 .selectable-content]#ffdhe2048(256)#
*** [#_s_58 .selectable-content]#ffdhe3072(257)#
*** [#_s_59 .selectable-content]#ffdhe4096(258)#
*** [#_s_60 .selectable-content]#ffdhe6144(259)#
*** [#_s_61 .selectable-content]#ffdhe8192(260)#
+
]
** [#_s_62 .selectable-content]#key_share extension (link:#abbr_RFC[RFC]
8446)#
** [#_s_63 .selectable-content]#post_handshake_auth (link:#abbr_RFC[RFC]
8446), pre_shared_key (link:#abbr_RFC[RFC] 8446), and
psk_key_exchange_mode (link:#abbr_RFC[RFC] 8446) indicating
link:#abbr_DHE[DHE] or link:#abbr_ECDHE[ECDHE] mode#
** [#_s_64 .selectable-content]#no other extensions#
+
] and shall not send the following extensions:
** early_data
** psk_key_exchange_mode indicating PSK only mode.

[.note-header]#Application Note: #[.note]# link:#abbr_DTLS[DTLS] uses
link:#abbr_TLS[TLS] extensions. All other application notes for
link:#FCS_TLSC_EXT.1.4[FCS_TLSC_EXT.1.4] apply to this requirement, with
references to link:#abbr_TLS[TLS] and
link:#FCS_TLSC_EXT.1[FCS_TLSC_EXT.1] elements replaced by
link:#abbr_DTLS[DTLS] and the corresponding reference to
link:#FCS_DTLSC_EXT.1[FCS_DTLSC_EXT.1] elements. #

[[FCS_DTLSC_EXT.1.5]]
link:#FCS_DTLSC_EXT.1.5[FCS_DTLSC_EXT.1.5]

The link:#abbr_TSF[TSF] shall be able to [*selection*:

* [#_s_65 .selectable-content]#verify that a presented identifier of
name type: [*selection*: #
** [#_s_66 .selectable-content]#link:#abbr_DNS[DNS] name type according
to link:#abbr_RFC[RFC] 6125#
** [#_s_67 .selectable-content]#link:#abbr_URI[URI] name type according
to link:#abbr_RFC[RFC] 6125#
** [#_s_68 .selectable-content]#SRV name type according to
link:#abbr_RFC[RFC] 6125#
** [#_s_69 .selectable-content]#Common Name conversion to
link:#abbr_DNS[DNS] name according to link:#abbr_RFC[RFC] 6125#
** [#_s_70 .selectable-content]#Directory name type according to
link:#abbr_RFC[RFC] 5280#
** [#_s_71 .selectable-content]#IPaddress name type according to
link:#abbr_RFC[RFC] 5280#
** [#_s_72 .selectable-content]#rfc822Name type according to
link:#abbr_RFC[RFC] 5280#
** [#_s_73 .selectable-content]#[*assignment*:
[.assignable-content]#other name type#]#
+
]
* [#_s_74 .selectable-content]#interface with a client application
requesting the link:#abbr_DTLS[DTLS] channel to verify that a presented
identifier#

] matches a reference identifier of the requested link:#abbr_DTLS[DTLS]
server and shall abort the session if no match is found.

[.note-header]#Application Note: #[.note]# All supported methods for
matching names are claimed. All other application notes for
link:#FCS_TLSC_EXT.1.5[FCS_TLSC_EXT.1.5] apply to this requirement, with
‘link:#abbr_TLS[TLS] Servers’ replaced by ‘link:#abbr_DTLS[DTLS]
Servers.’ #

[[FCS_DTLSC_EXT.1.6]]
link:#FCS_DTLSC_EXT.1.6[FCS_DTLSC_EXT.1.6]

The link:#abbr_TSF[TSF] shall not establish a trusted channel if the
server certificate is invalid [*selection*:
[#_s_75 .selectable-content]#with no exceptions#,
[#_s_76 .selectable-content]#except when override is authorized in the
case where valid revocation information is not available# ].

[.note-header]#Application Note: #[.note]# All override mechanisms
supported are described. All other application notes for
link:#FCS_TLSC_EXT.1.6[FCS_TLSC_EXT.1.6] apply to this requirement, with
references to link:#abbr_TLS[TLS] replaced by appropriate references for
link:#abbr_DTLS[DTLS], as explained in the link:#abbr_DTLS[DTLS] RFCs. #

[[FCS_DTLSC_EXT.1.7]]
link:#FCS_DTLSC_EXT.1.7[FCS_DTLSC_EXT.1.7]

The link:#abbr_TSF[TSF] shall [*selection*:
[#_s_77 .selectable-content]#terminate the link:#abbr_DTLS[DTLS]
session#, [#_s_78 .selectable-content]#silently discard the record# ] if
a message received contains an invalid MAC or if decryption fails in the
case of link:#abbr_GCM[GCM] and other AEAD ciphersuites.

[.note-header]#Application Note: #[.note]# #

All supported responses are claimed; at least one option is claimed.

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_DTLSC_EXT.1[FCS_DTLSC_EXT.1]

The evaluator shall perform all evaluation activities listed for
link:#FCS_TLSC_EXT.1[FCS_TLSC_EXT.1], with the following modifications:

* link:#abbr_DTLS[DTLS] (and not link:#abbr_TLS[TLS]) is used in each
evaluation activity.
* Version indicators are 1’s complement values of the corresponding text
versions (the legacy or supported version value is ‘fe fd’ for
link:#abbr_DTLS[DTLS] 1.2 and ‘fe fc’ for link:#abbr_DTLS[DTLS] 1.3).
* link:#abbr_DTLS[DTLS] clients may silently drop flawed or unexpected
messages from a link:#abbr_DTLS[DTLS] test server. Therefore, it might
be necessary to resend the message multiple times from the
link:#abbr_DTLS[DTLS] test server according to the appropriate
link:#abbr_DTLS[DTLS] link:#abbr_RFC[RFC] to get the desired response.
* link:#abbr_DTLS[DTLS] clients do not send fatal error alerts, but
should generate them for diagnostics if the test link:#abbr_DTLS[DTLS]
server repeatedly sends the flawed messages indicated in the tests. If
the product generates alerts, the evaluator may observe them in logs of
the link:#abbr_TSF[TSF] rather than observing them on the line.
Otherwise, the evaluator observes the termination of a session
(connection state) by verifying that the link:#abbr_TSF[TSF] does not
continue to resend messages after the last timeout expires.
* The equivalent of link:#tls-client-obsolete-versions[Test
FCS_TLSC_EXT.1:2.1] only includes a test for link:#abbr_DTLS[DTLS] 1.0
(version value ‘fe ff’). There are no link:#abbr_DTLS[DTLS] equivalents
of SSL versions or link:#abbr_TLS[TLS] 1.1.
* The equivalent of link:#tls-client-nonstandard-versions[Test
FCS_TLSC_EXT.1:2.2] should use ‘fe’fc’ in the legacy version to test for
responses to link:#abbr_DTLS[DTLS] equivalents to beta
link:#abbr_TLS[TLS] versions, or use ‘fe fb’ to test for undefined
versions.
* The equivalent of link:#tls-client-deprecated-encryption[Test
FCS_TLSC_EXT.1:3.5] should still include a test for RC4 ciphersuites,
even though link:#abbr_DTLS[DTLS] does not support stream ciphers. The
test only verifies that the link:#abbr_TSF[TSF] can reject such a
negotiation from a test link:#abbr_DTLS[DTLS] server, and does not
require the use of the cipher.
* In the equivalent of link:#tls-client-missing-finished[Test
FCS_TLSC_EXT.1:7], link:#abbr_DTLS[DTLS] clients may buffer unexpected
application messages, and resend previous messages in response to
timeouts for missing messages. It is acceptable for the evaluator to
observe the link:#abbr_TSF[TSF] resend its finished message multiple
times as an indication that it will not process application messages
until the server finished message is received. The evaluator should not
resend application messages from the test link:#abbr_DTLS[DTLS] server,
as this might cause the link:#abbr_TSF[TSF]’s counter to continue to
reset.

The evaluator shall also perform the following evaluation activities for
link:#FCS_DTLSC_EXT.1.7[FCS_DTLSC_EXT.1.7]:

link:#abbr_TSS[TSS]

The evaluator shall verify that the link:#abbr_TSS[TSS] describes the
actions that take place if a message received from the
link:#abbr_DTLS[DTLS] server fails the integrity check. If both
selections are chosen in link:#FCS_DTLSC_EXT.1.7[FCS_DTLSC_EXT.1.7], the
evaluator shall verify that the link:#abbr_TSS[TSS] describes when each
method is used and whether the behavior is configurable.

Guidance

If the link:#abbr_ST[ST] indicates the behavior of the
link:#abbr_TSF[TSF] on receiving a message from the
link:#abbr_DTLS[DTLS] server that fails the MAC integrity check is
configurable, the evaluator shall verify that the guidance documentation
describes instructions for configuring the behavior.

Tests

For each version supported, the evaluator shall establish a connection
using a compliant handshake negotiating the version. The evaluator will
then cause the test server to send application data with at least one
byte in a record message modified from what a compliant test server
would send, and verify that the client discards the record or terminates
the link:#abbr_DTLS[DTLS] session as described in the
link:#abbr_TSS[TSS]. If multiple behaviors are supported, the evaluator
shall repeat the test for each behavior.

[[FCS_DTLSC_EXT.2]]
==== FCS_DTLSC_EXT.2 DTLS Client Support for Mutual Authentication

*_The inclusion of this selection-based component depends upon selection
in link:#FCS_DTLSC_EXT.1.1[FCS_DTLSC_EXT.1.1]._*

[[FCS_DTLSC_EXT.2.1]]
link:#FCS_DTLSC_EXT.2.1[FCS_DTLSC_EXT.2.1]

The link:#abbr_TSF[TSF] shall support mutual authentication using
X.509v3 certificates during the handshake and [*selection*:
[#_s_79 .selectable-content]#in support of post-handshake authentication
requests#, [#_s_80 .selectable-content]#at no other time# ], in
accordance with [*selection*:
[#_s_81 .selectable-content]#link:#abbr_RFC[RFC] 5246 section 7.4.4#,
[#_s_82 .selectable-content]#link:#abbr_RFC[RFC] 8446 section 4.3.2# ].

[.note-header]#Application Note: #[.note]# #

This link:#abbr_SFR[SFR] is claimed if "mutual authentication" is
selected in link:#FCS_DTLSC_EXT.1.1[FCS_DTLSC_EXT.1.1].

All application notes for link:#FCS_TLSC_EXT.2.1[FCS_TLSC_EXT.2.1] apply
to this requirement, with references to link:#abbr_TLS[TLS] replaced by
the equivalent reference to link:#abbr_DTLS[DTLS].

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_DTLSC_EXT.2[FCS_DTLSC_EXT.2]

The evaluator shall perform all evaluation activities listed for
link:#FCS_TLSC_EXT.2[FCS_TLSC_EXT.2] while ensuring that
link:#abbr_DTLS[DTLS] (and not link:#abbr_TLS[TLS]) is used in each
evaluation activity.

[[FCS_DTLSC_EXT.3]]
==== FCS_DTLSC_EXT.3 DTLS Client Downgrade Protection

*_The inclusion of this selection-based component depends upon selection
in link:#FCS_DTLSC_EXT.1.1[FCS_DTLSC_EXT.1.1]._*

[[FCS_DTLSC_EXT.3.1]]
link:#FCS_DTLSC_EXT.3.1[FCS_DTLSC_EXT.3.1]

The link:#abbr_TSF[TSF] shall not establish a link:#abbr_DTLS[DTLS]
channel if the server hello message includes a [*selection*:
[#_s_83 .selectable-content]#link:#abbr_TLS[TLS] 1.2 downgrade
indicator#, [#_s_84 .selectable-content]#link:#abbr_TLS[TLS] 1.1 or
below downgrade indicator# ] in the server random field.

[.note-header]#Application Note: #[.note]# #

This link:#abbr_SFR[SFR] is claimed if "supplemental downgrade
protection" is selected in link:#FCS_DTLSC_EXT.1.1[FCS_DTLSC_EXT.1.1].

link:#abbr_DTLS[DTLS] uses the link:#abbr_TLS[TLS] downgrade indicators.
The application notes listed for link:#FCS_TLSC_EXT.3[FCS_TLSC_EXT.3]
also apply to this requirement, with references to link:#abbr_TLS[TLS]
replaced by the equivalent reference to link:#abbr_DTLS[DTLS].

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_DTLSC_EXT.3[FCS_DTLSC_EXT.3]

The evaluator shall perform all evaluation activities listed for
link:#FCS_TLSC_EXT.3[FCS_TLSC_EXT.3], with the following modifications:

* link:#abbr_DTLS[DTLS] (and not link:#abbr_TLS[TLS]) is used in each
evaluation activity
* References to link:#FCS_TLSC_EXT.1.1[FCS_TLSC_EXT.1.1] are replaced
with references to link:#FCS_DTLSC_EXT.1.1[FCS_DTLSC_EXT.1.1].
* link:#abbr_DTLS[DTLS] clients may silently drop flawed or unexpected
messages from a link:#abbr_DTLS[DTLS] test server. Therefore, it might
be necessary to resend the message multiple times from the
link:#abbr_DTLS[DTLS] test server according to the appropriate
link:#abbr_DTLS[DTLS] link:#abbr_RFC[RFC] to get the desired response.
* link:#abbr_DTLS[DTLS] clients do not send fatal error alerts, but
should generate them for diagnostics if the test link:#abbr_DTLS[DTLS]
server repeatedly sends the flawed messages indicated in the tests. If
the product generates alerts, the evaluator may observe them in logs of
the link:#abbr_TSF[TSF] rather than observing them on the line.
Otherwise, the evaluator observes the termination of a session
(connection state) by verifying that the link:#abbr_TSF[TSF] does not
continue to resend messages after the last timeout expires.

[[FCS_DTLSC_EXT.4]]
==== FCS_DTLSC_EXT.4 TLS Client Support for Renegotiation

*_The inclusion of this selection-based component depends upon selection
in link:#FCS_TLS_EXT.1.1[FCS_TLS_EXT.1.1]._*

[[FCS_DTLSC_EXT.4.1]]
link:#FCS_DTLSC_EXT.4.1[FCS_DTLSC_EXT.4.1]

The link:#abbr_TSF[TSF] shall support secure renegotiation through use
of [*selection*: [#_s_85 .selectable-content]#the “renegotiation_info”
link:#abbr_TLS[TLS] extension#, [#_s_86 .selectable-content]#the
TLS_EMPTY_RENEGOTIATION_INFO_SCSV signaling ciphersuite signaling value#
] in accordance with link:#abbr_RFC[RFC] 5746, and shall terminate the
session if an unexpected server hello is received or [*selection*:
[#_s_87 .selectable-content]#hello request message is received#,
[#_s_88 .selectable-content]#in no other case# ].

[.note-header]#Application Note: #[.note]# #

This link:#abbr_SFR[SFR] is claimed if "link:#abbr_DTLS[DTLS] as a
client" is selected in link:#FCS_TLS_EXT.1.1[FCS_TLS_EXT.1.1].

The application notes listed for link:#FCS_TLSC_EXT.4[FCS_TLSC_EXT.4]
apply to this requirement, with references to link:#abbr_TLS[TLS]
replaced by the equivalent reference to link:#abbr_DTLS[DTLS].

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_DTLSC_EXT.4[FCS_DTLSC_EXT.4]

The evaluator shall perform all evaluation activities listed for
link:#FCS_TLSC_EXT.4[FCS_TLSC_EXT.4], with the following modifications:

* link:#abbr_DTLS[DTLS] (and not link:#abbr_TLS[TLS]) is used in each
evaluation activity, with references to link:#abbr_TLS[TLS] replaced by
references to link:#abbr_DTLS[DTLS].
* link:#abbr_DTLS[DTLS] clients may silently drop flawed or unexpected
messages from a link:#abbr_DTLS[DTLS] test server. Therefore, it might
be necessary to resend the message multiple times from the
link:#abbr_DTLS[DTLS] test server according to the appropriate
link:#abbr_DTLS[DTLS] link:#abbr_RFC[RFC] to get the desired response.

[[FCS_DTLSC_EXT.5]]
==== FCS_DTLSC_EXT.5 DTLS Client Support for Session Resumption

*_The inclusion of this selection-based component depends upon selection
in link:#FCS_DTLSC_EXT.1.1[FCS_DTLSC_EXT.1.1]._*

[[FCS_DTLSC_EXT.5.1]]
link:#FCS_DTLSC_EXT.5.1[FCS_DTLSC_EXT.5.1]

The link:#abbr_TSF[TSF] shall support session resumption as a client via
the use of [*selection*: [#_s_89 .selectable-content]#session ID in
accordance with link:#abbr_RFC[RFC] 5246#,
[#_s_90 .selectable-content]#tickets in accordance with
link:#abbr_RFC[RFC] 5077#,
[#dtlsc_v13_resumption .selectable-content]#PSK and tickets in
accordance with link:#abbr_RFC[RFC] 8446# ].

[.note-header]#Application Note: #[.note]# #

This link:#abbr_SFR[SFR] is claimed if "session resumption" is selected
in link:#FCS_DTLSC_EXT.1.1[FCS_DTLSC_EXT.1.1].

The link:#abbr_ST[ST] author indicates which session resumption
mechanisms are supported. One or both of the first two options, "session
ID in accordance with link:#abbr_RFC[RFC] 5246" and "tickets in
accordance with link:#abbr_RFC[RFC] 5077" are claimed for
link:#abbr_DTLS[DTLS] 1.2 resumption. If resumption of
link:#abbr_DTLS[DTLS] 1.3 sessions is supported, "PSK and tickets in
accordance with link:#abbr_RFC[RFC] 8446" is selected, and the
selection-based link:#abbr_SFR[SFR]
link:#FCS_DTLSC_EXT.6[FCS_DTLSC_EXT.6] must also be claimed.

While it is possible to perform session resumption using PSK
ciphersuites in link:#abbr_DTLS[DTLS] 1.2, this is uncommon. Validation
of key exchange and session negotiation rules for PSK ciphersuites is
independent of the source of the pre-shared key and is covered in
link:#FCS_DTLSC_EXT.1[FCS_DTLSC_EXT.1].

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_DTLSC_EXT.5[FCS_DTLSC_EXT.5]

The evaluator shall perform all evaluation activities listed for
link:#FCS_TLSC_EXT.5[FCS_TLSC_EXT.5], with the following modifications:

* link:#abbr_DTLS[DTLS] (and not link:#abbr_TLS[TLS]) is used in each
evaluation activity.
* link:#abbr_DTLS[DTLS] clients may silently drop flawed or unexpected
messages from a link:#abbr_DTLS[DTLS] test server. Therefore, it might
be necessary to resend the message multiple times from the
link:#abbr_DTLS[DTLS] test server according to the appropriate
link:#abbr_DTLS[DTLS] link:#abbr_RFC[RFC] to get the desired response.
* link:#abbr_DTLS[DTLS] clients do not send fatal error alerts, but
should generate them for diagnostics if the test link:#abbr_DTLS[DTLS]
server repeatedly sends the flawed messages indicated in the tests. If
the product generates alerts, the evaluator may observe them in logs of
the link:#abbr_TSF[TSF] rather than observing them on the line.
Otherwise, the evaluator observes the termination of a session
(connection state) by verifying that the link:#abbr_TSF[TSF] does not
continue to resend messages after the last timeout expires.

[[FCS_DTLSC_EXT.6]]
==== FCS_DTLSC_EXT.6 DTLS Client DTLS 1.3 Resumption Refinements

*_The inclusion of this selection-based component depends upon selection
in link:#FCS_DTLSC_EXT.5.1[FCS_DTLSC_EXT.5.1]._*

[[FCS_DTLSC_EXT.6.1]]
link:#FCS_DTLSC_EXT.6.1[FCS_DTLSC_EXT.6.1]

The link:#abbr_TSF[TSF] shall send a psk_key_exchange_mode extension
with value psk_dhe_ke when link:#abbr_DTLS[DTLS] 1.3 session resumption
is offered.

[[FCS_DTLSC_EXT.6.2]]
link:#FCS_DTLSC_EXT.6.2[FCS_DTLSC_EXT.6.2]

The link:#abbr_TSF[TSF] shall not send early data in
link:#abbr_DTLS[DTLS] 1.3 sessions.

[.note-header]#Application Note: #[.note]# #

This link:#abbr_SFR[SFR] is claimed if "PSK and tickets in accordance
with link:#abbr_RFC[RFC] 8446" is selected in
link:#FCS_DTLSC_EXT.5.1[FCS_DTLSC_EXT.5.1].

The application notes listed for link:#FCS_TLSC_EXT.6[FCS_TLSC_EXT.6]
also apply to this requirement, with references to link:#abbr_TLS[TLS]
replaced by the equivalent reference to link:#abbr_DTLS[DTLS].

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_DTLSC_EXT.6[FCS_DTLSC_EXT.6]

The evaluator shall perform all evaluation activities listed for
link:#FCS_TLSC_EXT.6[FCS_TLSC_EXT.6], but ensuring that
link:#abbr_DTLS[DTLS] (and not link:#abbr_TLS[TLS]) is used in each
evaluation activity – ‘link:#abbr_TLS[TLS]’ and
‘link:#FCS_TLSC_EXT.5[FCS_TLSC_EXT.5]’ are replaced by
‘link:#abbr_DTLS[DTLS]’ and ‘link:#FCS_DTLSC_EXT.5[FCS_DTLSC_EXT.5].’

[[FCS_DTLSS_EXT.1]]
==== FCS_DTLSS_EXT.1 DTLS Server Protocol

*_The inclusion of this selection-based component depends upon selection
in link:#FCS_TLS_EXT.1.1[FCS_TLS_EXT.1.1]._*

[[FCS_DTLSS_EXT.1.1]]
link:#FCS_DTLSS_EXT.1.1[FCS_DTLSS_EXT.1.1]

The link:#abbr_TSF[TSF] shall implement link:#abbr_DTLS[DTLS] 1.2
(link:#abbr_RFC[RFC] 6347) and [*selection*:
[#_s_92 .selectable-content]#link:#abbr_DTLS[DTLS] 1.3
(link:#abbr_RFC[RFC] 9147)#, [#_s_93 .selectable-content]#no earlier
link:#abbr_DTLS[DTLS] versions# ] as a server that supports additional
functionality for session renegotiation protection and [*selection*:

* [#dtlss_mutual_auth .selectable-content]#mutual authentication#
* [#dtlss_downgrade_protection .selectable-content]#supplemental
downgrade protection#
* [#dtlss_resumption .selectable-content]#session resumption#
* [#_s_97 .selectable-content]#no optional functionality#

] and shall reject connection attempts from clients supporting only
link:#abbr_DTLS[DTLS] 1.0.

[.note-header]#Application Note: #[.note]# #

This link:#abbr_SFR[SFR] is claimed if "link:#abbr_DTLS[DTLS] as a
server" is selected in link:#FCS_TLS_EXT.1.1[FCS_TLS_EXT.1.1].

The link:#abbr_ST[ST] author will claim link:#abbr_DTLS[DTLS] 1.3
functionality if supported, and optional functionality as appropriate
for the claimed versions.

Session renegotiation protection is required for both
link:#abbr_DTLS[DTLS] 1.2 and link:#abbr_DTLS[DTLS] 1.3, and the
link:#abbr_ST[ST] must include the requirements from
link:#FCS_DTLSS_EXT.4[FCS_DTLSS_EXT.4]. Within
link:#FCS_DTLSS_EXT.4[FCS_DTLSS_EXT.4], options for implementation of
secure session renegotiation for link:#abbr_DTLS[DTLS] 1.2, or rejecting
renegotiation requests are claimed.

If "mutual authentication" is selected, then the link:#abbr_ST[ST] must
additionally include the requirements from
link:#FCS_DTLSS_EXT.2[FCS_DTLSS_EXT.2]. If the link:#abbr_TOE[TOE]
implements mutual authentication, this selection must be made.

If "supplemental downgrade protection" is selected, then the
link:#abbr_ST[ST] must additionally include the requirements from
link:#FCS_DTLSS_EXT.3[FCS_DTLSS_EXT.3]. If the link:#abbr_TOE[TOE]
provides downgrade protection as indicated in link:#abbr_RFC[RFC] 8446,
in particular, if link:#abbr_DTLS[DTLS] 1.3 is supported, this selection
must be made.

If "session resumption" is selected, then the link:#abbr_ST[ST] must
additionally include the requirements from
link:#FCS_DTLSS_EXT.5[FCS_DTLSS_EXT.5].

link:#abbr_DTLS[DTLS] version numbers are denoted on the wire as the 1’s
complement of the corresponding textual link:#abbr_DTLS[DTLS] versions
as described in Section 4.1 of link:#abbr_RFC[RFC] 6347.
link:#abbr_DTLS[DTLS] version 1.2 is 0xfefd; link:#abbr_DTLS[DTLS]
version 1.3 is 0xfefc.

[[FCS_DTLSS_EXT.1.2]]
link:#FCS_DTLSS_EXT.1.2[FCS_DTLSS_EXT.1.2]

The link:#abbr_TSF[TSF] shall be able to support the following
link:#abbr_TLS[TLS] 1.2 ciphersuites: [*selection*:

* [#_s_98 .selectable-content]#TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
as defined in link:#abbr_RFC[RFC] 5289 and link:#abbr_RFC[RFC] 8422#
* [#_s_99 .selectable-content]#TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 5289 and link:#abbr_RFC[RFC] 8422#
* [#_s_100 .selectable-content]#TLS_RSA_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 5288#
* [#_s_101 .selectable-content]#TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 5288#
* [#_s_102 .selectable-content]#TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384
as defined in link:#abbr_RFC[RFC] 5289#
* [#_s_103 .selectable-content]#TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as
defined in link:#abbr_RFC[RFC] 5289#
* [#_s_104 .selectable-content]#TLS_RSA_WITH_AES_256_CBC_SHA256 as
defined in link:#abbr_RFC[RFC] 5246#
* [#_s_105 .selectable-content]#TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as
defined in link:#abbr_RFC[RFC] 5246#
* [#_s_106 .selectable-content]#TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
as defined in link:#abbr_RFC[RFC] 5289#
* [#_s_107 .selectable-content]#TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as
defined in link:#abbr_RFC[RFC] 5289#
* [#_s_108 .selectable-content]#TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256
as defined in link:#abbr_RFC[RFC] 5289#
* [#_s_109 .selectable-content]#TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as
defined in link:#abbr_RFC[RFC] 5289#
* [#_s_110 .selectable-content]#TLS_RSA_WITH_AES_128_CBC_SHA256 as
defined in link:#abbr_RFC[RFC] 5246#
* [#_s_111 .selectable-content]#TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as
defined in link:#abbr_RFC[RFC] 5246#
* [#_s_112 .selectable-content]#TLS_RSA_WITH_AES_128_CBC_SHA as defined
in link:#abbr_RFC[RFC] 5246#

], the following link:#abbr_PP[PP]-specific ciphersuites using
pre-shared secrets: [*selection*:

* [#_s_113 .selectable-content]#TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 8442#
* [#_s_114 .selectable-content]#TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 5487#
* [#_s_115 .selectable-content]#TLS_RSA_PSK_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 5487#
* [#_s_116 .selectable-content]#TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as
defined in link:#abbr_RFC[RFC] 8442#
* [#_s_117 .selectable-content]#TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as
defined in link:#abbr_RFC[RFC] 5487#
* [#_s_118 .selectable-content]#TLS_RSA_PSK_WITH_AES_128_GCM_SHA256 as
defined in link:#abbr_RFC[RFC] 5487#
* [#_s_119 .selectable-content]#no ciphersuites using pre-shared
secrets#

], and the following link:#abbr_TLS[TLS] 1.3 ciphersuites: [*selection*:

* [#_s_120 .selectable-content]#TLS_AES_256_GCM_SHA384 as defined in
link:#abbr_RFC[RFC] 8446#
* [#_s_121 .selectable-content]#TLS_AES_128_GCM_SHA256 as defined in
link:#abbr_RFC[RFC] 8446#
* [#_s_122 .selectable-content]#[*assignment*:
[.assignable-content]#other link:#abbr_TLS[TLS] 1.3 ciphersuites#]#
* [#_s_123 .selectable-content]#no link:#abbr_TLS[TLS] 1.3 ciphersuites#

] using a preference order based on [*selection*:
[#_s_124 .selectable-content]#link:#abbr_RFC[RFC] 9151 priority#,
[#_s_125 .selectable-content]#client hello ordering#,
[#_s_126 .selectable-content]#[*assignment*:
[.assignable-content]#additional priority#]# ].

[.note-header]#Application Note: #[.note]# link:#abbr_DTLS[DTLS]
supports link:#abbr_TLS[TLS] ciphersuites. The link:#abbr_ST[ST] author
should select the ciphersuites that are supported and must select at
least one ciphersuite suitable for each supported link:#abbr_DTLS[DTLS]
version – link:#abbr_TLS[TLS] 1.2 ciphersuites for link:#abbr_DTLS[DTLS]
1.2 and link:#abbr_TLS[TLS] 1.3 ciphersuites for link:#abbr_DTLS[DTLS]
1.3. All other application notes for
link:#FCS_TLSS_EXT.1.2[FCS_TLSS_EXT.1.2] apply to this requirement, with
references to link:#abbr_TLS[TLS] replaced by the equivalent reference
to link:#abbr_DTLS[DTLS]. #

[[FCS_DTLSS_EXT.1.3]]
link:#FCS_DTLSS_EXT.1.3[FCS_DTLSS_EXT.1.3]

The link:#abbr_TSF[TSF] shall not establish a connection with a client
that does not indicate support for at least one of the supported
ciphersuites.

[[FCS_DTLSS_EXT.1.4]]
link:#FCS_DTLSS_EXT.1.4[FCS_DTLSS_EXT.1.4]

The link:#abbr_TSF[TSF] shall be able to process the following
link:#abbr_TLS[TLS] client hello message extensions:

* signature_algorithms extension (link:#abbr_RFC[RFC] 8446) indicating
support for [*selection*:
** [#_s_127 .selectable-content]#ecdsa-secp384r1_sha384
(link:#abbr_RFC[RFC] 8446)#
** [#_s_128 .selectable-content]#rsa_pkcs1_sha384 (link:#abbr_RFC[RFC]
8446)#
+
], and [*selection*:
** [#_s_129 .selectable-content]#rsa_pss_pss_sha384 (link:#abbr_RFC[RFC]
8603)#
** [#_s_130 .selectable-content]#rsa_pss_rsae_sha384
(link:#abbr_RFC[RFC] 8603)#
** [#_s_131 .selectable-content]#[*assignment*:
[.assignable-content]#other non-deprecated signature algorithms#]#
** [#_s_132 .selectable-content]#no other signature algorithms#
+
]
* extended_master_secret extension (link:#abbr_RFC[RFC] 7627) enforcing
client support
* the following other extensions: [*selection*:
** [#_s_133 .selectable-content]#signature_algorithms_cert extension
(link:#abbr_RFC[RFC] 8446) indicating support for [*selection*: #
*** [#_s_134 .selectable-content]#ecdsa-secp384r1_sha384
(link:#abbr_RFC[RFC] 8446)#
*** [#_s_135 .selectable-content]#rsa_pkcs1_sha384 (link:#abbr_RFC[RFC]
8446)#
+
], and [*selection*:
*** [#_s_136 .selectable-content]#rsa_pss_pss_sha384
(link:#abbr_RFC[RFC] 8603)#
*** [#_s_137 .selectable-content]#rsa_pss_rsae_sha384
(link:#abbr_RFC[RFC] 8603)#
*** [#_s_138 .selectable-content]#rsa_pkcs1_sha256 (link:#abbr_RFC[RFC]
8446)#
*** [#_s_139 .selectable-content]#rsa_pss_rsae_sha256
(link:#abbr_RFC[RFC] 8446)#
*** [#_s_140 .selectable-content]#[*assignment*:
[.assignable-content]#other non-deprecated signature algorithms#]#
*** [#_s_141 .selectable-content]#no other signature algorithms#
+
]
** [#_s_142 .selectable-content]#supported_versions extension
(link:#abbr_RFC[RFC] 8446) indicating support for link:#abbr_DTLS[DTLS]
1.3#
** [#_s_143 .selectable-content]#supported_groups extension
(link:#abbr_RFC[RFC] 7919, link:#abbr_RFC[RFC] 8446) indicating support
for [*selection*: #
*** [#_s_144 .selectable-content]#secp256r1#
*** [#_s_145 .selectable-content]#secp384r1#
*** [#_s_146 .selectable-content]#secp521r1#
*** [#_s_147 .selectable-content]#ffdhe2048(256)#
*** [#_s_148 .selectable-content]#ffdhe3072(257)#
*** [#_s_149 .selectable-content]#ffdhe4096(258)#
*** [#_s_150 .selectable-content]#ffdhe6144(259)#
*** [#_s_151 .selectable-content]#ffdhe8192(260)#
+
]
** [#_s_152 .selectable-content]#key_share extension
(link:#abbr_RFC[RFC] 8446)#
** [#_s_153 .selectable-content]#no other extensions#
+
].

[.note-header]#Application Note: #[.note]# link:#abbr_DTLS[DTLS] uses
link:#abbr_TLS[TLS] extensions. If support for link:#abbr_DTLS[DTLS] 1.3
is claimed in link:#FCS_DTLSS_EXT.1.1[FCS_DTLSS_EXT.1.1], the selections
for supported_versions, supported_groups, and key_share are claimed.
Even if support for link:#abbr_DTLS[DTLS] 1.3 is not claimed, if
link:#abbr_ECDHE[ECDHE] ciphersuites are claimed in
link:#FCS_DTLSS_EXT.1.2[FCS_DTLSS_EXT.1.2], the entry for
supported_groups is claimed. Support for additional extensions is
acceptable. For signature_algorithms and signature_algorithms_certs (if
supported), at least one of the signature schemes presented in the first
sub-selection is claimed. #

[[FCS_DTLSS_EXT.1.5]]
link:#FCS_DTLSS_EXT.1.5[FCS_DTLSS_EXT.1.5]

The link:#abbr_TSF[TSF] shall perform key establishment for
link:#abbr_DTLS[DTLS] using [*selection*:

* [#_s_154 .selectable-content]#link:#abbr_RSA[RSA] with size
[*selection*: [#_s_155 .selectable-content]#2048#,
[#_s_156 .selectable-content]#3072#, [#_s_157 .selectable-content]#4096#
] bits and no other sizes#
* [#_s_158 .selectable-content]#Diffie-Hellman parameters with size
[*selection*: [#_s_159 .selectable-content]#2048#,
[#_s_160 .selectable-content]#3072#,
[#_s_161 .selectable-content]#4096#,
[#_s_162 .selectable-content]#6144#, [#_s_163 .selectable-content]#8192#
] bits and no other sizes#
* [#_s_164 .selectable-content]#Diffie-Hellman groups [*selection*:
[#_s_165 .selectable-content]#ffdhe2048#,
[#_s_166 .selectable-content]#ffdhe3072#,
[#_s_167 .selectable-content]#ffdhe4096#,
[#_s_168 .selectable-content]#ffdhe6144#,
[#_s_169 .selectable-content]#ffdhe8192# ] and no other groups,
consistent with the client's supported groups extension and
[*selection*: [#_s_170 .selectable-content]#key share#,
[#_s_171 .selectable-content]#no other# ] extension #
* [#_s_172 .selectable-content]#link:#abbr_ECDHE[ECDHE] parameters using
elliptic curves [*selection*: [#_s_173 .selectable-content]#secp256r1#,
[#_s_174 .selectable-content]#secp384r1#,
[#_s_175 .selectable-content]#secp521r1# ] and no other curves,
consistent with the client's supported groups extension and
[*selection*: [#_s_176 .selectable-content]#key share#,
[#_s_177 .selectable-content]#no other# ] extension and using
non-compressed formatting for points #

].

[.note-header]#Application Note: #[.note]# link:#abbr_DTLS[DTLS] uses
key establishment mechanisms from the equivalent link:#abbr_TLS[TLS]
version. The application notes for
link:#FCS_TLSS_EXT.1.5[FCS_TLSS_EXT.1.5] apply to this requirement, with
‘link:#abbr_TLS[TLS]’ replaced by ‘link:#abbr_DTLS[DTLS]’ and references
to ‘link:#FCS_TLSS_EXT.1[FCS_TLSS_EXT.1]’ elements replaced by the
corresponding element of ‘link:#FCS_DTLSS_EXT.1[FCS_DTLSS_EXT.1].’ #

[[FCS_DTLSS_EXT.1.6]]
link:#FCS_DTLSS_EXT.1.6[FCS_DTLSS_EXT.1.6]

The link:#abbr_TSF[TSF] shall not proceed with a connection handshake
attempt if the link:#abbr_DTLS[DTLS] client fails validation.

[.note-header]#Application Note: #[.note]# The process to validate the
link:#abbr_IP[IP] address of a link:#abbr_DTLS[DTLS] client is specified
in section 4.2.1 of link:#abbr_RFC[RFC] 6347 (link:#abbr_DTLS[DTLS] 1.2)
and in section 5.1 of link:#abbr_RFC[RFC] 9147 (link:#abbr_DTLS[DTLS]
1.3). The server validates the link:#abbr_DTLS[DTLS] client during
connection establishment (handshaking) and prior to sending a server
hello message. After receiving a client hello, a link:#abbr_DTLS[DTLS]
1.2 server sends a HelloVerifyRequest along with a cookie, whereas a
link:#abbr_DTLS[DTLS] 1.3 server sends a HelloRetryRequest message along
with a cookie. In both link:#abbr_TLS[TLS] 1.2 and link:#abbr_TLS[TLS]
1.3, the cookie is a signed message using a keyed hash function. The
link:#abbr_DTLS[DTLS] client then sends another client hello with the
cookie attached. If the link:#abbr_DTLS[DTLS] server successfully
verifies the signed cookie, the client is not using a spoofed
link:#abbr_IP[IP] address. #

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_DTLSS_EXT.1[FCS_DTLSS_EXT.1]

The evaluator shall perform all evaluation activities listed for
link:#FCS_TLSS_EXT.1[FCS_TLSS_EXT.1], with the following modifications:

* link:#abbr_DTLS[DTLS] (and not link:#abbr_TLS[TLS]) is used in each
evaluation activity - ‘link:#abbr_TLS[TLS]’ is replaced with
‘link:#abbr_DTLS[DTLS]’ and references to
link:#FCS_TLSS_EXT.1[FCS_TLSS_EXT.1] elements are replaced with the
corresponding link:#FCS_DTLSS_EXT.1[FCS_DTLSS_EXT.1] element.
* Version indicators are 1’s complement values of the corresponding text
versions (the legacy or supported version value is ‘fe fd’ for
link:#abbr_DTLS[DTLS] 1.2 and ‘fe fc’ for link:#abbr_DTLS[DTLS] 1.3).
* link:#abbr_DTLS[DTLS] servers may silently drop flawed or unexpected
messages from a link:#abbr_DTLS[DTLS] test client. Therefore, it might
be necessary to resend the message multiple times from the
link:#abbr_DTLS[DTLS] test client according to the appropriate
link:#abbr_DTLS[DTLS] link:#abbr_RFC[RFC] to get the desired response.
* link:#abbr_DTLS[DTLS] servers do not send fatal error alerts, but
should generate them for diagnostics if the test link:#abbr_DTLS[DTLS]
client repeatedly sends the flawed messages indicated in the tests. If
the product generates alerts, the evaluator may observe them in logs of
the link:#abbr_TSF[TSF] rather than observing them on the line.
Otherwise, the evaluator observes the termination of a session
(connection state) by verifying that the link:#abbr_TSF[TSF] does not
continue to resend messages after the last timeout expires.
* In addition to descriptions of the link:#abbr_TLS[TLS] mechanisms
described in link:#abbr_TLS[TLS] RFCs used by link:#abbr_DTLS[DTLS], the
evaluator shall ensure that the link:#abbr_DTLS[DTLS] description also
describes the mechanisms unique to link:#abbr_DTLS[DTLS] as indicated in
the link:#abbr_DTLS[DTLS] RFCs.
* The equivalent of link:#tls-server-obsolete-versions[Test
FCS_TLSS_EXT.1:2.1] only includes a test for link:#abbr_DTLS[DTLS] 1.0
(version value ‘fe ff’). There are no link:#abbr_DTLS[DTLS] equivalents
of SSL versions or link:#abbr_TLS[TLS] 1.1.
* The equivalent of link:#tls-server-beta-versions[Test
FCS_TLSS_EXT.1:2.2] should use ‘fe’fc’ in the legacy version to test for
responses to link:#abbr_DTLS[DTLS] equivalents to beta
link:#abbr_TLS[TLS] versions, or use ‘fe fb’ to test for undefined
versions.
* The equivalent of link:#tls-server-deprecated-encryption[Test
FCS_TLSS_EXT.1:3.5] should still include a test for RC4 ciphersuites,
even though link:#abbr_DTLS[DTLS] does not support stream ciphers. The
test only verifies that the link:#abbr_TSF[TSF] can reject such an offer
from a test link:#abbr_DTLS[DTLS] client, and does not require the use
of the cipher.
* In link:#tls-server-key-exchange[Test FCS_TLSS_EXT.1:5],
link:#abbr_DTLS[DTLS] messages include an epoch field that changes with
each change_cipher_spec message. This can be used in
link:#abbr_DTLS[DTLS] 1.3 to indicate the internal change of state
corresponding to the implied message.
* In the equivalent of link:#tls-server-no-finished-msg[Test
FCS_TLSS_EXT.1:5.5], a link:#abbr_DTLS[DTLS] server may buffer
unexpected application messages, and resend previous messages in
response to timeouts for missing messages. It is acceptable for the
evaluator to observe the link:#abbr_TSF[TSF] resend its final flight
multiple times as an indication that it will not process application
messages until the client finished message is received. The evaluator
should not resend application messages from the test
link:#abbr_DTLS[DTLS] client, as this might cause the
link:#abbr_TSF[TSF]’s counter to continue to reset.

The evaluator shall also perform the following evaluation activities for
link:#FCS_DTLSS_EXT.1.6[FCS_DTLSS_EXT.1.6]

link:#abbr_TSS[TSS]

The evaluator shall verify that the link:#abbr_TSS[TSS] describes how
the link:#abbr_DTLS[DTLS] client link:#abbr_IP[IP] address is validated
prior to issuing a server hello message.

Guidance

There are no guidance evaluation activities for this element.

Tests

[.testlist-]##

* link:#_t_1[Test FCS_DTLSS_EXT.1:1]: The evaluator shall send a
link:#abbr_TLS[TLS] 1.2 client hello message from a test client and
observe that the link:#abbr_TSF[TSF] sends a HelloVerifyRequest message.
The evaluator shall modify at least one byte in the cookie from the
server's HelloVerifyRequest message and include the modified value as a
cookie in the test client’s second client hello message. The evaluator
shall verify that the server rejects the client's handshake message.
* link:#_t_2[Test FCS_DTLSS_EXT.1:2]: [conditional] If the
link:#abbr_TSF[TSF] supports link:#abbr_DTLS[DTLS] 1.3, the evaluator
shall send a link:#abbr_TLS[TLS] 1.3 client hello message from a test
client and observe that the link:#abbr_TSF[TSF] sends a
HelloRetryRequest message. The evaluator shall modify at least one byte
in the cookie from the server's HelloRetryRequest message and include
the modified value as a cookie in the test client’s second client hello
message. The evaluator shall verify that the server rejects the client's
handshake message.

[[FCS_DTLSS_EXT.2]]
==== FCS_DTLSS_EXT.2 DTLS Server Support for Mutual Authentication

*_The inclusion of this selection-based component depends upon selection
in link:#FCS_DTLSS_EXT.1.1[FCS_DTLSS_EXT.1.1]._*

[[FCS_DTLSS_EXT.2.1]]
link:#FCS_DTLSS_EXT.2.1[FCS_DTLSS_EXT.2.1]

The link:#abbr_TSF[TSF] shall support authentication of
link:#abbr_DTLS[DTLS] clients using X.509v3 certificates during the
link:#abbr_DTLS[DTLS] handshake and [*selection*:
[#_s_178 .selectable-content]#during post-handshake requests#,
[#_s_179 .selectable-content]#at no other time# ] using the certificate
types indicated in the client’s signature_algorithms and [*selection*:
[#_s_180 .selectable-content]#signature_algorithms_cert#,
[#_s_181 .selectable-content]#no other# ] extension.

[.note-header]#Application Note: #[.note]# #

This link:#abbr_SFR[SFR] is claimed if "mutual authentication" is
selected in link:#FCS_DTLSS_EXT.1.1[FCS_DTLSS_EXT.1.1].

All application notes for link:#FCS_TLSS_EXT.2.1[FCS_TLSS_EXT.2.1] apply
to this requirement, with references to link:#abbr_TLS[TLS] replaced by
the equivalent reference to link:#abbr_DTLS[DTLS].

[[FCS_DTLSS_EXT.2.2]]
link:#FCS_DTLSS_EXT.2.2[FCS_DTLSS_EXT.2.2]

The link:#abbr_TSF[TSF] shall support authentication of
link:#abbr_DTLS[DTLS] clients using X.509v3 certificates in accordance
with [.no-link]#FIA_X509_EXT.1#.

[[FCS_DTLSS_EXT.2.3]]
link:#FCS_DTLSS_EXT.2.3[FCS_DTLSS_EXT.2.3]

The link:#abbr_TSF[TSF] shall be able to reject the establishment of a
trusted channel if the requested client certificate is invalid and
[*selection*:

* [#_s_182 .selectable-content]#continue establishment of a server-only
authenticated link:#abbr_DTLS[DTLS] channel in accordance with
link:#FCS_DTLSS_EXT.1[FCS_DTLSS_EXT.1] in support of [*selection*:
[#_s_183 .selectable-content]#all applications#,
[#_s_184 .selectable-content]#[*assignment*: [.assignable-content]#list
of calling applications that accept both authenticated and
unauthenticated client sessions#]# ] when an empty certificate message
is provided by the client#
* [#_s_185 .selectable-content]#continue establishment of a mutually
authenticated link:#abbr_DTLS[DTLS] channel when revocation status
information for the [*selection*: [#_s_186 .selectable-content]#client's
leaf certificate#, [#_s_187 .selectable-content]#[*assignment*:
[.assignable-content]#specific intermediate link:#abbr_CA[CA]
certificates#]#, [#_s_188 .selectable-content]#any non-trust store
certificate in the certificate chain# ] is not available in support of
[*selection*: [#_s_189 .selectable-content]#all applications#,
[#_s_190 .selectable-content]#[*assignment*: [.assignable-content]#list
of calling applications configurable to perform certificate status
information bypass processing#]# ] as [*selection*:
[#_s_191 .selectable-content]#configured by an administrator#,
[#_s_192 .selectable-content]#confirmed by the application user#,
[#_s_193 .selectable-content]#a default for [*assignment*:
[.assignable-content]#subset of applications#]# ] #
* [#_s_194 .selectable-content]#no other processing options for missing
or invalid client certificates#

].

[.note-header]#Application Note: #[.note]# All application notes for
link:#FCS_TLSS_EXT.2.3[FCS_TLSS_EXT.2.3] apply to this requirement, with
references to link:#abbr_TLS[TLS] replaced by the equivalent reference
to link:#abbr_DTLS[DTLS]. #

[[FCS_DTLSS_EXT.2.4]]
link:#FCS_DTLSS_EXT.2.4[FCS_DTLSS_EXT.2.4]

The link:#abbr_TSF[TSF] shall be able to [*selection*:

* [#_s_195 .selectable-content]#not establish a link:#abbr_DTLS[DTLS]
session if an entry of the Distinguished Name or a [*selection*:
[#_s_196 .selectable-content]#rfc822_name#,
[#_s_197 .selectable-content]#dns_name#,
[#_s_198 .selectable-content]#[*assignment*:
[.assignable-content]#supported name types#]# ] in the Subject Alternate
Name extension contained in the client certificate does not match one of
the expected identifiers for the client in accordance with [*selection*:
[#_s_199 .selectable-content]#link:#abbr_RFC[RFC] 2822#,
[#_s_200 .selectable-content]#link:#abbr_RFC[RFC] 6125#,
[#_s_201 .selectable-content]#link:#abbr_RFC[RFC] 5280#,
[#_s_202 .selectable-content]#[*assignment*:
[.assignable-content]#link:#abbr_RFC[RFC] for the supported name type#]#
] matching rules#
* [#_s_203 .selectable-content]#pass the [*selection*:
[#_s_204 .selectable-content]#validated certificate#,
[#_s_205 .selectable-content]#link:#abbr_RFC[RFC] 2822 name normalized
according to link:#abbr_RFC[RFC] 2822#,
[#_s_206 .selectable-content]#link:#abbr_DNS[DNS] name normalized
according to link:#abbr_RFC[RFC] 6125#,
[#_s_207 .selectable-content]#[*assignment*: [.assignable-content]#list
of link:#abbr_RFC[RFC] 5280 name types and normalization rules#]#,
[#_s_208 .selectable-content]#[*assignment*: [.assignable-content]#list
of 'other' name types and standard normalization rules#]# ] to
[*assignment*: [.assignable-content]#list of calling applications
capable of making access decisions#]#

].

[.note-header]#Application Note: #[.note]# All application notes for
link:#FCS_TLSS_EXT.2.4[FCS_TLSS_EXT.2.4] apply to this requirement, with
references to link:#abbr_TLS[TLS] replaced by the equivalent reference
to link:#abbr_DTLS[DTLS]. #

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_DTLSS_EXT.2[FCS_DTLSS_EXT.2]

The evaluator shall perform all evaluation activities listed for
link:#FCS_TLSS_EXT.2[FCS_TLSS_EXT.2], with the following modifications:

* link:#abbr_DTLS[DTLS] (and not link:#abbr_TLS[TLS]) is used in each
evaluation activity – ‘link:#abbr_TLS[TLS]’ is replaced with
‘link:#abbr_DTLS[DTLS]’ and references to
link:#FCS_TLSS_EXT.2[FCS_TLSS_EXT.2] elements are replaced with the
corresponding reference to the link:#FCS_DTLSS_EXT.2[FCS_DTLSS_EXT.2]
element.
* link:#abbr_DTLS[DTLS] servers may silently drop flawed or unexpected
messages from a link:#abbr_DTLS[DTLS] test client. Therefore, it might
be necessary to resend the message multiple times from the
link:#abbr_DTLS[DTLS] test client according to the appropriate
link:#abbr_DTLS[DTLS] link:#abbr_RFC[RFC] to get the desired response.
* link:#abbr_DTLS[DTLS] servers do not send fatal error alerts, but
should generate them for diagnostics if the test link:#abbr_DTLS[DTLS]
client repeatedly sends the flawed messages indicated in the tests. If
the product generates alerts, the evaluator may observe them in logs of
the link:#abbr_TSF[TSF] rather than observing them on the line.
Otherwise, the evaluator observes the termination of a session
(connection state) by verifying that the link:#abbr_TSF[TSF] does not
continue to resend messages after the last timeout expires.

[[FCS_DTLSS_EXT.3]]
==== FCS_DTLSS_EXT.3 DTLS Server Downgrade Protection

*_The inclusion of this selection-based component depends upon selection
in link:#FCS_DTLSS_EXT.1.1[FCS_DTLSS_EXT.1.1]._*

[[FCS_DTLSS_EXT.3.1]]
link:#FCS_DTLSS_EXT.3.1[FCS_DTLSS_EXT.3.1]

The link:#abbr_TSF[TSF] shall set the server hello extension to a random
value concatenated with the link:#abbr_TLS[TLS] 1.2 downgrade indicator
when negotiating link:#abbr_DTLS[DTLS] 1.2 as indicated in
link:#abbr_RFC[RFC] 8446 section 4.1.3.

[.note-header]#Application Note: #[.note]# #

This link:#abbr_SFR[SFR] is claimed if "supplemental downgrade
protection" is selected in link:#FCS_DTLSS_EXT.1.1[FCS_DTLSS_EXT.1.1].

The application notes listed for link:#FCS_TLSS_EXT.3[FCS_TLSS_EXT.3]
also apply to this requirement, with references to link:#abbr_TLS[TLS]
replaced by the equivalent reference to link:#abbr_DTLS[DTLS].

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_DTLSS_EXT.3[FCS_DTLSS_EXT.3]

The evaluator shall perform the evaluation activities listed for
link:#FCS_TLSS_EXT.3[FCS_TLSS_EXT.3], with references to
link:#abbr_TLS[TLS] replaced by the equivalent reference to
link:#abbr_DTLS[DTLS].

[[FCS_DTLSS_EXT.4]]
==== FCS_DTLSS_EXT.4 DTLS Server Support for Renegotiation

*_The inclusion of this selection-based component depends upon selection
in link:#FCS_TLS_EXT.1.1[FCS_TLS_EXT.1.1]._*

[[FCS_DTLSS_EXT.4.1]]
link:#FCS_DTLSS_EXT.4.1[FCS_DTLSS_EXT.4.1]

The link:#abbr_TSF[TSF] shall support secure renegotiation through the
use of [*selection*: [#_s_209 .selectable-content]#the
"renegotiation_info" link:#abbr_TLS[TLS] extension#,
[#_s_210 .selectable-content]#not allowing session renegotiation# ] in
accordance with link:#abbr_RFC[RFC] 5746.

[[FCS_DTLSS_EXT.4.2]]
link:#FCS_DTLSS_EXT.4.2[FCS_DTLSS_EXT.4.2]

The link:#abbr_TSF[TSF] shall, when negotiating a link:#abbr_DTLS[DTLS]
1.2 session, [*selection*: [#_s_211 .selectable-content]#include the
renegotiation_info extension in server hello messages when a client
hello with the renegotiation_info extension is received and shall
terminate a session if neither of the renegotiation_info or
TLS_EMPTY_RENEGOTIATION_INFO_SCSV signaling ciphersuites are indicated
in the client hello#, [#_s_212 .selectable-content]#not allow
renegotiation# ].

[[FCS_DTLSS_EXT.4.3]]
link:#FCS_DTLSS_EXT.4.3[FCS_DTLSS_EXT.4.3]

The link:#abbr_TSF[TSF] shall terminate the session if an unexpected
client hello is received during an active link:#abbr_DTLS[DTLS] session.

[.note-header]#Application Note: #[.note]# #

This link:#abbr_SFR[SFR] is claimed if "link:#abbr_DTLS[DTLS] as a
server" is selected in link:#FCS_TLS_EXT.1.1[FCS_TLS_EXT.1.1].

The application notes listed for link:#FCS_TLSS_EXT.4[FCS_TLSS_EXT.4]
apply to this requirement, with references to link:#abbr_TLS[TLS]
replaced by the equivalent reference to link:#abbr_DTLS[DTLS].

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_DTLSS_EXT.4[FCS_DTLSS_EXT.4]

The evaluator shall perform all evaluation activities listed for
link:#FCS_TLSS_EXT.4[FCS_TLSS_EXT.4], with the following modifications:

* link:#abbr_DTLS[DTLS] (and not link:#abbr_TLS[TLS]) is used in each
evaluation activity.
* link:#abbr_DTLS[DTLS] clients may silently drop flawed or unexpected
messages from a link:#abbr_DTLS[DTLS] test server. Therefore, it might
be necessary to resend the message multiple times from the
link:#abbr_DTLS[DTLS] test server according to the appropriate
link:#abbr_DTLS[DTLS] link:#abbr_RFC[RFC] to get the desired response.
* link:#abbr_DTLS[DTLS] clients do not send fatal error alerts, but
should generate them for diagnostics if the test link:#abbr_DTLS[DTLS]
server repeatedly sends the flawed messages indicated in the tests. If
the product generates alerts, the evaluator may observe them in logs of
the link:#abbr_TSF[TSF] rather than observing them on the line.
Otherwise, the evaluator observes the termination of a session
(connection state) by verifying that the link:#abbr_TSF[TSF] does not
continue to resend messages after the last timeout expires.

[[FCS_DTLSS_EXT.5]]
==== FCS_DTLSS_EXT.5 DTLS Server Support for Session Resumption

*_The inclusion of this selection-based component depends upon selection
in link:#FCS_DTLSS_EXT.1.1[FCS_DTLSS_EXT.1.1]._*

[[FCS_DTLSS_EXT.5.1]]
link:#FCS_DTLSS_EXT.5.1[FCS_DTLSS_EXT.5.1]

The link:#abbr_TSF[TSF] shall support session resumption as a server via
the use of [*selection*: [#_s_213 .selectable-content]#session ID in
accordance with link:#abbr_RFC[RFC] 5246#,
[#_s_214 .selectable-content]#tickets in accordance with
link:#abbr_RFC[RFC] 5077#,
[#dtlss_v13_resumption .selectable-content]#PSK and tickets in
accordance with link:#abbr_RFC[RFC] 8446# ].

[.note-header]#Application Note: #[.note]# #

This link:#abbr_SFR[SFR] is claimed if "session resumption" is selected
in link:#FCS_DTLSS_EXT.1.1[FCS_DTLSS_EXT.1.1].

The application notes listed for link:#FCS_TLSS_EXT.5[FCS_TLSS_EXT.5]
apply to this requirement, with references to link:#abbr_TLS[TLS]
replaced by the equivalent reference to link:#abbr_DTLS[DTLS].

If resumption of link:#abbr_DTLS[DTLS] 1.3 sessions is supported, "PSK
and tickets in accordance with link:#abbr_RFC[RFC] 8446" is selected,
and the selection-based link:#abbr_SFR[SFR]
link:#FCS_DTLSS_EXT.6[FCS_DTLSS_EXT.6] must also be claimed.

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_DTLSS_EXT.5[FCS_DTLSS_EXT.5]

The evaluator shall perform the evaluation activities listed for
link:#FCS_TLSS_EXT.5[FCS_TLSS_EXT.5], with the following modifications:

* link:#abbr_DTLS[DTLS] (and not link:#abbr_TLS[TLS]) is used in each
evaluation activity.
* link:#abbr_DTLS[DTLS] clients may silently drop flawed or unexpected
messages from a link:#abbr_DTLS[DTLS] test server. Therefore, it might
be necessary to resend the message multiple times from the
link:#abbr_DTLS[DTLS] test server according to the appropriate
link:#abbr_DTLS[DTLS] link:#abbr_RFC[RFC] to get the desired response.
* link:#abbr_DTLS[DTLS] clients do not send fatal error alerts, but
should generate them for diagnostics if the test link:#abbr_DTLS[DTLS]
server repeatedly sends the flawed messages indicated in the tests. If
the product generates alerts, the evaluator may observe them in logs of
the link:#abbr_TSF[TSF] rather than observing them on the line.
Otherwise, the evaluator observes the termination of a session
(connection state) by verifying that the link:#abbr_TSF[TSF] does not
continue to resend messages after the last timeout expires.

[[FCS_DTLSS_EXT.6]]
==== FCS_DTLSS_EXT.6 DTLS Server DTLS 1.3 Resumption Refinements

*_The inclusion of this selection-based component depends upon selection
in link:#FCS_DTLSS_EXT.5.1[FCS_DTLSS_EXT.5.1]._*

[[FCS_DTLSS_EXT.6.1]]
link:#FCS_DTLSS_EXT.6.1[FCS_DTLSS_EXT.6.1]

The link:#abbr_TSF[TSF] shall support link:#abbr_DTLS[DTLS] 1.3
resumption using PSK with psk_key_exchange_mode extension with the value
psk_dhe_ke.

[[FCS_DTLSS_EXT.6.2]]
link:#FCS_DTLSS_EXT.6.2[FCS_DTLSS_EXT.6.2]

The link:#abbr_TSF[TSF] shall ignore early data received in
link:#abbr_DTLS[DTLS] 1.3 sessions.

[.note-header]#Application Note: #[.note]# #

This link:#abbr_SFR[SFR] is claimed if "PSK and tickets in accordance
with link:#abbr_RFC[RFC] 8446" is selected in
link:#FCS_DTLSS_EXT.5.1[FCS_DTLSS_EXT.5.1].

The application notes listed for link:#FCS_TLSS_EXT.6[FCS_TLSS_EXT.6]
also apply to this requirement, with references to link:#abbr_TLS[TLS]
replaced by the equivalent reference to link:#abbr_DTLS[DTLS].

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_DTLSS_EXT.6[FCS_DTLSS_EXT.6]

The evaluator shall perform the evaluation activities listed for
link:#FCS_TLSS_EXT.6[FCS_TLSS_EXT.6], with the following modifications:

* link:#abbr_DTLS[DTLS] (and not link:#abbr_TLS[TLS]) is used in each
evaluation activity.
* References to link:#FCS_TLSS_EXT.5[FCS_TLSS_EXT.5] are replaced by
corresponding references to link:#FCS_DTLSS_EXT.5[FCS_DTLSS_EXT.5].
* link:#abbr_DTLS[DTLS] clients may silently drop flawed or unexpected
messages from a link:#abbr_DTLS[DTLS] test server. Therefore, it might
be necessary to resend the message multiple times from the
link:#abbr_DTLS[DTLS] test server according to the appropriate
link:#abbr_DTLS[DTLS] link:#abbr_RFC[RFC] to get the desired response.
* link:#abbr_DTLS[DTLS] clients do not send fatal error alerts, but
should generate them for diagnostics if the test link:#abbr_DTLS[DTLS]
server repeatedly sends the flawed messages indicated in the tests. If
the product generates alerts, the evaluator may observe them in logs of
the link:#abbr_TSF[TSF] rather than observing them on the line.
Otherwise, the evaluator observes the termination of a session
(connection state) by verifying that the link:#abbr_TSF[TSF] does not
continue to resend messages after the last timeout expires.

[[FCS_TLSC_EXT.1]]
==== FCS_TLSC_EXT.1 TLS Client Protocol

*_The inclusion of this selection-based component depends upon selection
in link:#FCS_TLS_EXT.1.1[FCS_TLS_EXT.1.1]._*

[[FCS_TLSC_EXT.1.1]]
link:#FCS_TLSC_EXT.1.1[FCS_TLSC_EXT.1.1]

The link:#abbr_TSF[TSF] shall implement link:#abbr_TLS[TLS] 1.2
(link:#abbr_RFC[RFC] 5246) and [*selection*:
[#_s_216 .selectable-content]#link:#abbr_TLS[TLS] 1.3
(link:#abbr_RFC[RFC] 8446)#, [#_s_217 .selectable-content]#no other
link:#abbr_TLS[TLS] version# ] as a client that supports additional
functionality for session renegotiation protection and [*selection*:

* [#tlsc_mutual_auth .selectable-content]#mutual authentication#
* [#tlsc_downgrade_protection .selectable-content]#supplemental
downgrade protection#
* [#tlsc_resumption .selectable-content]#session resumption#
* [#_s_221 .selectable-content]#no optional functionality#

] and shall abort attempts by a server to negotiate all other
link:#abbr_TLS[TLS] or SSL versions.

[.note-header]#Application Note: #[.note]# #

This link:#abbr_SFR[SFR] is claimed if "link:#abbr_TLS[TLS] as a client"
is selected in link:#FCS_TLS_EXT.1.1[FCS_TLS_EXT.1.1].

Session renegotiation protection is required for both
link:#abbr_TLS[TLS] 1.2 and link:#abbr_TLS[TLS] 1.3, and the
link:#abbr_ST[ST] must include the requirements from
link:#FCS_TLSC_EXT.4[FCS_TLSC_EXT.4]. Within
link:#FCS_TLSC_EXT.4[FCS_TLSC_EXT.4], options for implementation of
secure session renegotiation for link:#abbr_TLS[TLS] 1.2, or rejecting
renegotiation requests are claimed.

The link:#abbr_ST[ST] author will claim link:#abbr_TLS[TLS] 1.3
functionality if supported, and optional functionality as appropriate
for the claimed versions.

If "mutual authentication" is selected, then the link:#abbr_ST[ST] must
additionally include the requirements from
link:#FCS_TLSC_EXT.2[FCS_TLSC_EXT.2]. If the link:#abbr_TOE[TOE]
implements mutual authentication, this selection must be made.

If "supplemental downgrade protection" is selected, then the
link:#abbr_ST[ST] must additionally include the requirements from
link:#FCS_TLSC_EXT.3[FCS_TLSC_EXT.3]. This is claimed if
link:#abbr_TLS[TLS] 1.3 is supported, or if the product supports
link:#abbr_TLS[TLS] 1.1 or below downgrade protection using the
mechanism described in link:#abbr_RFC[RFC] 8446.

If "session resumption" is selected, then the link:#abbr_ST[ST] must
additionally include the requirements from
link:#FCS_TLSC_EXT.5[FCS_TLSC_EXT.5].

[[FCS_TLSC_EXT.1.2]]
link:#FCS_TLSC_EXT.1.2[FCS_TLSC_EXT.1.2]

The link:#abbr_TSF[TSF] shall be able to support the following
link:#abbr_TLS[TLS] 1.2 ciphersuites: [*selection*:

* [#_s_222 .selectable-content]#TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
as defined in link:#abbr_RFC[RFC] 5289 and link:#abbr_RFC[RFC] 8422#
* [#_s_223 .selectable-content]#TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 5289 and link:#abbr_RFC[RFC] 8422#
* [#_s_224 .selectable-content]#TLS_RSA_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 5288#
* [#_s_225 .selectable-content]#TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 5288#
* [#_s_226 .selectable-content]#TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384
as defined in link:#abbr_RFC[RFC] 5289#
* [#_s_227 .selectable-content]#TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as
defined in link:#abbr_RFC[RFC] 5289#
* [#_s_228 .selectable-content]#TLS_RSA_WITH_AES_256_CBC_SHA256 as
defined in link:#abbr_RFC[RFC] 5246#
* [#_s_229 .selectable-content]#TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as
defined in link:#abbr_RFC[RFC] 5246#
* [#_s_230 .selectable-content]#TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
as defined in link:#abbr_RFC[RFC] 5289#
* [#_s_231 .selectable-content]#TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as
defined in link:#abbr_RFC[RFC] 5289#
* [#_s_232 .selectable-content]#TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256
as defined in link:#abbr_RFC[RFC] 5289#
* [#_s_233 .selectable-content]#TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as
defined in link:#abbr_RFC[RFC] 5289#
* [#_s_234 .selectable-content]#TLS_RSA_WITH_AES_128_CBC_SHA256 as
defined in link:#abbr_RFC[RFC] 5246#
* [#_s_235 .selectable-content]#TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as
defined in link:#abbr_RFC[RFC] 5246#
* [#_s_236 .selectable-content]#TLS_RSA_WITH_AES_128_CBC_SHA as defined
in link:#abbr_RFC[RFC] 5246#

], the following link:#abbr_PP[PP]-specific ciphersuites using
pre-shared secrets: [*selection*:

* [#_s_237 .selectable-content]#TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 8442#
* [#_s_238 .selectable-content]#TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 5487#
* [#_s_239 .selectable-content]#TLS_RSA_PSK_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 5487#
* [#_s_240 .selectable-content]#TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as
defined in link:#abbr_RFC[RFC] 8442#
* [#_s_241 .selectable-content]#TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as
defined in link:#abbr_RFC[RFC] 5487#
* [#_s_242 .selectable-content]#TLS_RSA_PSK_WITH_AES_128_GCM_SHA256 as
defined in link:#abbr_RFC[RFC] 5487#
* [#_s_243 .selectable-content]#no ciphersuites using pre-shared
secrets#

], and the following link:#abbr_TLS[TLS] 1.3 ciphersuites: [*selection*:

* [#_s_244 .selectable-content]#TLS_AES_256_GCM_SHA384 as defined in
link:#abbr_RFC[RFC] 8446#
* [#_s_245 .selectable-content]#TLS_AES_128_GCM_SHA256 as defined in
link:#abbr_RFC[RFC] 8446#
* [#_s_246 .selectable-content]#[*assignment*:
[.assignable-content]#other link:#abbr_TLS[TLS] 1.3 ciphersuites#]#
* [#_s_247 .selectable-content]#no link:#abbr_TLS[TLS] 1.3 ciphersuites#

] offering the supported ciphersuites in a client hello message in
preference order: [*assignment*: [.assignable-content]#list of supported
ciphersuites#].

[.note-header]#Application Note: #[.note]# #

The link:#abbr_ST[ST] author should select the ciphersuites that are
supported, and must select at least one ciphersuite for each
link:#abbr_TLS[TLS] version supported. The ciphersuites to be tested in
the evaluated configuration are limited by this requirement. However,
this requirement does not restrict the link:#abbr_TOE[TOE]'s ability to
propose additional non-deprecated ciphersuites beyond the ones listed in
this requirement in its client hello message as indicated in the
link:#abbr_ST[ST]. That is, the link:#abbr_TOE[TOE] may propose any
ciphersuite not excluded by this element, but the evaluation will only
test ciphersuites from the above list. It is necessary to limit the
ciphersuites that can be used in an evaluated configuration
administratively on the server in the test environment.

link:#abbr_TLS[TLS] 1.3 ciphersuites are claimed if support for
link:#abbr_TLS[TLS] 1.3 is claimed in
link:#FCS_TLSC_EXT.1.1[FCS_TLSC_EXT.1.1]. The assignment of preference
order provides an ordered list of all supported ciphersuites with the
most preferred ciphersuites listed first. Ciphersuites listed in
link:#abbr_RFC[RFC] 9151, “Commercial National Security Algorithm (CNSA)
Suite Profile for link:#abbr_TLS[TLS] and link:#abbr_DTLS[DTLS] 1.2 and
1.3” are preferred over all other ciphersuites, link:#abbr_GCM[GCM]
ciphersuites are preferred over link:#abbr_CBC[CBC] ciphersuites,
link:#abbr_ECDHE[ECDHE] preferred over link:#abbr_RSA[RSA] and
link:#abbr_DHE[DHE], and link:#abbr_SHA[SHA]-256 or
link:#abbr_SHA[SHA]-384 over link:#abbr_SHA[SHA]-1.

Ciphersuites for link:#abbr_TLS[TLS] 1.2 are of the form TLS_(key
exchange algorithm)_WITH_(encryption algorithm)_(message digest
algorithm}, and are listed in the link:#abbr_TLS[TLS] parameters section
of the internet assignments at iana.org.

[[FCS_TLSC_EXT.1.3]]
link:#FCS_TLSC_EXT.1.3[FCS_TLSC_EXT.1.3]

The link:#abbr_TSF[TSF] shall not offer ciphersuites indicating the
following:

* the null encryption component
* support for anonymous servers
* use of deprecated or export-grade cryptography including DES, 3DES,
RC2, RC4, or IDEA for encryption
* use of MD

and shall abort sessions where a server attempts to negotiate
ciphersuites not enumerated in the client hello message.

[[FCS_TLSC_EXT.1.4]]
link:#FCS_TLSC_EXT.1.4[FCS_TLSC_EXT.1.4]

The link:#abbr_TSF[TSF] shall be able to support the following
link:#abbr_TLS[TLS] client hello message extensions:

* signature_algorithms extension (link:#abbr_RFC[RFC] 8446) indicating
support for [*selection*:
** [#_s_248 .selectable-content]#ecdsa-secp384r1_sha384
(link:#abbr_RFC[RFC] 8446)#
** [#_s_249 .selectable-content]#rsa_pkcs1_sha384 (link:#abbr_RFC[RFC]
8446)#
+
], and [*selection*:
** [#_s_250 .selectable-content]#rsa_pss_pss_sha384 (link:#abbr_RFC[RFC]
8603)#
** [#_s_251 .selectable-content]#rsa_pss_rsae_sha384
(link:#abbr_RFC[RFC] 8603)#
** [#_s_252 .selectable-content]#[*assignment*:
[.assignable-content]#other non-deprecated signature algorithms#]#
** [#_s_253 .selectable-content]#no other signature algorithms#
+
]
* extended_master_secret extension (link:#abbr_RFC[RFC] 7627) enforcing
server support
* the following other extensions: [*selection*:
** [#_s_254 .selectable-content]#signature_algorithms_cert extension
(link:#abbr_RFC[RFC] 8446) indicating support for [*selection*: #
*** [#_s_255 .selectable-content]#ecdsa-secp384r1_sha384
(link:#abbr_RFC[RFC] 8446)#
*** [#_s_256 .selectable-content]#rsa_pkcs1_sha384 (link:#abbr_RFC[RFC]
8446)#
+
], and [*selection*:
*** [#_s_257 .selectable-content]#rsa_pss_pss_sha384
(link:#abbr_RFC[RFC] 8603)#
*** [#_s_258 .selectable-content]#rsa_pss_rsae_sha384
(link:#abbr_RFC[RFC] 8603)#
*** [#_s_259 .selectable-content]#rsa_pkcs1_sha256 (link:#abbr_RFC[RFC]
8446)#
*** [#_s_260 .selectable-content]#rsa_pss_rsae_sha256
(link:#abbr_RFC[RFC] 8446)#
*** [#_s_261 .selectable-content]#[*assignment*:
[.assignable-content]#other non-deprecated signature algorithms#]#
*** [#_s_262 .selectable-content]#no other signature algorithms#
+
]
** [#_s_263 .selectable-content]#supported_versions extension
(link:#abbr_RFC[RFC] 8446) indicating support for link:#abbr_TLS[TLS]
1.3#
** [#_s_264 .selectable-content]#supported_groups extension
(link:#abbr_RFC[RFC] 7919, link:#abbr_RFC[RFC] 8446) indicating support
for [*selection*: #
*** [#_s_265 .selectable-content]#secp256r1#
*** [#_s_266 .selectable-content]#secp384r1#
*** [#_s_267 .selectable-content]#secp521r1#
*** [#_s_268 .selectable-content]#ffdhe2048(256)#
*** [#_s_269 .selectable-content]#ffdhe3072(257)#
*** [#_s_270 .selectable-content]#ffdhe4096(258)#
*** [#_s_271 .selectable-content]#ffdhe6144(259)#
*** [#_s_272 .selectable-content]#ffdhe8192(260)#
+
]
** [#_s_273 .selectable-content]#key_share extension
(link:#abbr_RFC[RFC] 8446)#
** [#_s_274 .selectable-content]#post_handshake_auth
(link:#abbr_RFC[RFC] 8446), pre_shared_key (link:#abbr_RFC[RFC] 8446),
and psk_key_exchange_mode (link:#abbr_RFC[RFC] 8446) indicating
link:#abbr_DHE[DHE] or link:#abbr_ECDHE[ECDHE] mode#
** [#_s_275 .selectable-content]#no other extensions#
+
] and shall not send the following extensions:
** early_data
** psk_key_exchange_mode indicating PSK only mode.

[.note-header]#Application Note: #[.note]# #

If link:#abbr_TLS[TLS] 1.3 is claimed in
link:#FCS_TLSC_EXT.1.1[FCS_TLSC_EXT.1.1], supported_versions,
supported_groups, and key_share extensions are claimed in accordance
with link:#abbr_RFC[RFC] 8446. If link:#abbr_TLS[TLS] 1.3 is not
claimed, supported_versions and key_share extensions are not claimed.
Other extensions may be supported; certain extensions may need to be
claimed based on other link:#abbr_SFR[SFR] claims made.

If link:#abbr_ECDHE[ECDHE] ciphersuites are claimed in
link:#FCS_TLSC_EXT.1.2[FCS_TLSC_EXT.1.2], the supported_groups extension
is claimed here with appropriate secp groups claimed. If
link:#abbr_DHE[DHE] ciphersuites are claimed in
link:#FCS_TLSC_EXT.1.2[FCS_TLSC_EXT.1.2], it is preferred that the
appropriate ffdhe groups be claimed here. In a subsequent version of
this link:#abbr_FP[FP], support for ffdhe groups will be required
whenever link:#abbr_DHE[DHE] ciphersuites are claimed.

When ‘other non-deprecated signature algorithms’ is claimed, the
assignment will describe the standard signature and hash algorithms
supported. MD5 and link:#abbr_SHA[SHA]-1 hashes are deprecated and are
not included in the signature_algorithms or signature_algorithms_cert
extensions.

[[FCS_TLSC_EXT.1.5]]
link:#FCS_TLSC_EXT.1.5[FCS_TLSC_EXT.1.5]

The link:#abbr_TSF[TSF] shall be able to [*selection*:

* [#_s_276 .selectable-content]#verify that a presented identifier of
name type: [*selection*: #
** [#_s_277 .selectable-content]#link:#abbr_DNS[DNS] name type according
to link:#abbr_RFC[RFC] 6125#
** [#_s_278 .selectable-content]#link:#abbr_URI[URI] name type according
to link:#abbr_RFC[RFC] 6125#
** [#_s_279 .selectable-content]#SRV name type according to
link:#abbr_RFC[RFC] 6125#
** [#_s_280 .selectable-content]#Common Name conversion to
link:#abbr_DNS[DNS] name according to link:#abbr_RFC[RFC] 6125#
** [#_s_281 .selectable-content]#Directory name type according to
link:#abbr_RFC[RFC] 5280#
** [#_s_282 .selectable-content]#IPaddress name type according to
link:#abbr_RFC[RFC] 5280#
** [#_s_283 .selectable-content]#rfc822Name type according to
link:#abbr_RFC[RFC] 5280#
** [#_s_284 .selectable-content]#[*assignment*:
[.assignable-content]#other name type#]#
+
]
* [#_s_285 .selectable-content]#interface with a client application
requesting the link:#abbr_TLS[TLS] channel to verify that a presented
identifier#

] matches a reference identifier of the requested link:#abbr_TLS[TLS]
server and shall abort the session if no match is found.

[.note-header]#Application Note: #[.note]# #

The rules for verification identity are described in Section 6 of
link:#abbr_RFC[RFC] 6125 and Section 7 of link:#abbr_RFC[RFC] 5280. The
reference identifier is established by the user (e.g., entering a
link:#abbr_URL[URL] into a web browser or clicking a link), by
configuration (e.g., configuring the name of a mail or authentication
server), or by an application (e.g., a parameter of an API) depending on
the product service. The client establishes all acceptable reference
identifiers and interfaces with the link:#abbr_TLS[TLS] implementation
to provide acceptable reference identifiers, or to accept the presented
identifiers as validated in the server’s certificate. If the product
performs matching of the reference identifiers to the identifiers
provided in the server’s certificate, the first option is claimed and
all supported name types are claimed; if the product presents the
certificate, or the presented identifiers from the certificate to the
application, the second option is claimed.

In most cases where link:#abbr_TLS[TLS] servers are represented by
link:#abbr_DNS[DNS]-type names, the preferred method for verification is
the Subject Alternative Name using link:#abbr_DNS[DNS],
link:#abbr_URI[URI], or Service Names. Verification using a conversion
of the Common Name relative distinguished name from a
link:#abbr_DNS[DNS] name type in the subject field is allowed for the
purposes of backward compatibility.

The client should avoid constructing reference identifiers using
wildcards. However, if the presented identifiers include wildcards, the
client must follow the best practices regarding matching; these best
practices are captured in the evaluation activity. If the
link:#abbr_TSF[TSF] supports wildcards, and allows names with
link:#abbr_DNS[DNS] portions containing internationalized names, the
internationalized name does not match any wildcard, in accordance with
link:#abbr_RFC[RFC] 6125 section 7.2.

Support for other name types is rare, but may be claimed for specific
applications. If specified, the assignment includes both the
link:#abbr_RFC[RFC] describing normalization and matching rules, and any
refinements necessary to resolve options available in the
link:#abbr_RFC[RFC].

[[FCS_TLSC_EXT.1.6]]
link:#FCS_TLSC_EXT.1.6[FCS_TLSC_EXT.1.6]

The link:#abbr_TSF[TSF] shall not establish a trusted channel if the
server certificate is invalid [*selection*:
[#_s_286 .selectable-content]#with no exceptions#,
[#_s_287 .selectable-content]#except when override is authorized in the
case where valid revocation information is not available# ].

[.note-header]#Application Note: #[.note]# #

A certificate used in a manner that does not support revocation checking
should not advertise revocation information locations. Common methods to
address this include revoking the issuing link:#abbr_CA[CA], resetting
certificate pinning mechanisms, or removing entries from trust stores.
Thus, a certificate that does not advertise revocation status
information is considered to be not revoked and does not need to be
processed via override mechanisms. Override mechanisms are for use with
certificates with published revocation status information that is not
accessible, whether temporarily or because the information cannot be
accessed during the state of the link:#abbr_TOE[TOE] (e.g., for
verifying signatures on boot code). The circumstances should be
described by the link:#abbr_ST[ST] author, who should indicate the
override mechanism and conditions that apply to the override, including
system state, user or admin actions, etc.

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_TLSC_EXT.1[FCS_TLSC_EXT.1]

link:#abbr_TSS[TSS]

The evaluator shall check the description of the implementation of this
protocol in the link:#abbr_TSS[TSS] to ensure the supported
link:#abbr_TLS[TLS] versions, features, ciphersuites, and extensions are
specified in accordance with link:#abbr_RFC[RFC] 5246
(link:#abbr_TLS[TLS] 1.2) and link:#abbr_RFC[RFC] 8446
(link:#abbr_TLS[TLS] 1.3 and updates to link:#abbr_TLS[TLS] 1.2) and as
refined in link:#FCS_TLSC_EXT.1[FCS_TLSC_EXT.1] as appropriate.

The evaluator shall verify that ciphersuites indicated in
link:#FCS_TLSC_EXT.1.2[FCS_TLSC_EXT.1.2] are included in the
description, and that none of the following ciphersuites are supported:
ciphersuites indicating 'NULL,' 'RC2,' 'RC4,' 'DES,' 'IDEA,' or 'TDES'
in the encryption algorithm component, indicating 'anon,' or indicating
MD5 or link:#abbr_SHA[SHA] in the message digest algorithm component.

The evaluator shall verify that the link:#abbr_TLS[TLS] implementation
description includes the extensions as required in
link:#FCS_TLSC_EXT.1.4[FCS_TLSC_EXT.1.4].

The evaluator shall verify that the link:#abbr_ST[ST] describes
applications that use the link:#abbr_TLS[TLS] functions and how they
establish reference identifiers.

The evaluator shall verify that the link:#abbr_ST[ST] includes a
description of matching methods used for each supported name type to the
supported application defined reference identifiers. The evaluator shall
verify that the link:#abbr_ST[ST] includes a description of wildcards
recognized for each name type claimed in
link:#FCS_TLSC_EXT.1.5[FCS_TLSC_EXT.1.5] and shall verify that the
matching rules meet or exceed best practices. In particular, the
evaluator shall ensure that the matching rules are as restrictive as, or
more restrictive than the following:

* link:#abbr_DNS[DNS] names: The ‘*’ character used in the complete
leftmost label of a link:#abbr_DNS[DNS] name represents any valid name
that has the same number of labels, and that matches all remaining
labels. The ‘*’ character must only be used in the leftmost complete
label of a properly formatted link:#abbr_DNS[DNS] name. The ‘*’ must not
be used to represent a public suffix, or in the leftmost label
immediately following a public suffix.
* link:#abbr_URI[URI] or SRV names: The ‘*’ character can only occur in
the domain name portion of the name represented as a link:#abbr_DNS[DNS]
name. All restrictions for wildcards in link:#abbr_DNS[DNS] names apply
to the link:#abbr_DNS[DNS] portion of the name. link:#abbr_URI[URI] host
names presented as an link:#abbr_IP[IP] address are matched according to
link:#abbr_IP[IP] address matching rules – see best practices for
link:#abbr_IP[IP] addresses below. In accordance with
link:#abbr_RFC[RFC] 6125, it is preferred that such URIs are presented a
matching name of type link:#abbr_IP[IP] address in the
link:#abbr_SAN[SAN].
* link:#abbr_IP[IP] addresses: link:#abbr_RFC[RFC] 5280 does not support
link:#abbr_IP[IP] address ranges as presented names, but indicates that
presented names may be compared to link:#abbr_IP[IP] address ranges
present in name constraints. If the link:#abbr_TSF[TSF] supports
link:#abbr_IP[IP] address ranges as reference identifiers, the reference
identifier matches if the presented name is in the range.
link:#abbr_IP[IP] ranges in name constraints (including reference
identifiers) should be presented in CIDR format.
* link:#abbr_RFC[RFC] 2822 names: link:#abbr_RFC[RFC] 5280 and updates
link:#abbr_RFC[RFC] 8398 and link:#abbr_RFC[RFC] 8399 do not support
special indicators representing more than a single mailbox as a
presented name, but indicates that presented names may be compared to a
single mailbox, ‘any’ email address at a host, or ‘any’ email address on
a domain (e.g., “example.com” matches any email address on the host
example.com and “.example.com” matches any email address in the domain
example.com, but does not match email addresses at the host
“example.com”). Such matching is prohibited for internationalized
link:#abbr_RFC[RFC] 2822 names.
* Embedded link:#abbr_CN[CN] name types: The link:#abbr_CN[CN] relative
distinguished name of a link:#abbr_DNS[DNS] name type included in the
subject field is not strongly typed. Attempts to match both the name
type and wildcard specifications can result in matches not intended, and
therefore, not authoritatively asserted by a certification authority. It
is preferred that no matching of link:#abbr_CN[CN] embedded names be
supported, but if necessary for backward compatibility, the description
should clearly indicate how different name types are interpreted in the
matching algorithm. In particular, the ‘*’ character in a
link:#abbr_CN[CN] is not to be interpreted as representing more than a
single entity unless the entirety of the RDN is properly formatted as a
link:#abbr_DNS[DNS], link:#abbr_URI[URI], or SVR name, and represents a
wildcard meeting best practices as described above.

Guidance

The evaluator shall check the operational guidance to ensure that it
contains instructions on configuring the product so that
link:#abbr_TLS[TLS] conforms to the description in the
link:#abbr_TSS[TSS] and that it includes any instructions on configuring
the version, ciphersuites, or optional extensions that are supported.

The evaluator shall verify that all configurable features for matching
identifiers in certificates presented in the link:#abbr_TLS[TLS]
handshake to application specific reference identifiers are described.

Tests

The evaluator shall perform the following tests: [.testlist-]##

* link:#tls-client-supported-configurations[Test FCS_TLSC_EXT.1:1]:
(supported configurations) For each supported version, and for each
supported ciphersuite associated with the version:
+
The evaluator shall establish a link:#abbr_TLS[TLS] connection between
the link:#abbr_TOE[TOE] and a test link:#abbr_TLS[TLS] server that is
configured to negotiate the tested version and ciphersuite in accordance
with the link:#abbr_RFC[RFC] for the version.
+
The evaluator shall observe that the link:#abbr_TSF[TSF] presents a
client hello with the highest version of link:#abbr_TLS[TLS] 1.2 or the
legacy version (value '03 03') and shall observe that the supported
version extension is not included for link:#abbr_TLS[TLS] 1.2, and, if
link:#abbr_TLS[TLS] 1.3 is supported, is present and contains the value
'03 04' for link:#abbr_TLS[TLS] 1.3.
+
The evaluator shall observe that the client hello indicates the
supported ciphersuites in the order indicated, and that it includes only
the extensions supported, with appropriate values, for that version in
accordance with the requirement.
+
The evaluator shall observe that the link:#abbr_TOE[TOE] successfully
completes the link:#abbr_TLS[TLS] handshake.
+
*Note:* link:#abbr_TOE[TOEs] supporting link:#abbr_TLS[TLS] 1.3, but
allowing a server to negotiate link:#abbr_TLS[TLS] 1.2, should include
all ciphersuites and all extensions as required for either version. If
such a link:#abbr_TOE[TOE] is configurable to support only
link:#abbr_TLS[TLS] 1.2, only link:#abbr_TLS[TLS] 1.3, or both
link:#abbr_TLS[TLS] 1.2 and link:#abbr_TLS[TLS] 1.3,
link:#tls-client-supported-configurations[Test FCS_TLSC_EXT.1:1] should
be performed in each configuration – with advertised ciphersuites
appropriate for the configuration.
+
The connection in link:#tls-client-supported-configurations[Test
FCS_TLSC_EXT.1:1] may be established as part of the establishment of a
higher-level protocol, e.g., as part of an link:#abbr_EAP[EAP] session.
+
It is sufficient to observe the successful negotiation of a ciphersuite
to satisfy the intent of the test; it is not necessary to examine the
characteristics of the encrypted traffic in an attempt to discern the
ciphersuite being used (for example, that the cryptographic algorithm is
128-bit link:#abbr_AES[AES] and not 256-bit link:#abbr_AES[AES]).
* link:#_t_4[Test FCS_TLSC_EXT.1:2]: (obsolete versions) The evaluator
shall perform the following tests: [.testlist-]##
** link:#tls-client-obsolete-versions[Test FCS_TLSC_EXT.1:2.1]: For each
of SSL version 2, SSL version 3, link:#abbr_TLS[TLS] version 1.0, and
link:#abbr_TLS[TLS] version 1.1, the evaluator shall initiate a
link:#abbr_TLS[TLS] connection from the link:#abbr_TOE[TOE] to a test
link:#abbr_TLS[TLS] server that is configured to negotiate the obsolete
version and observe that the link:#abbr_TSF[TSF] terminates the
connection.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., protocol version, insufficient security) in
response to this, but it is acceptable that the link:#abbr_TSF[TSF]
terminates the connection silently (i.e., without sending a fatal error
alert).
** link:#tls-client-nonstandard-versions[Test FCS_TLSC_EXT.1:2.2]: The
evaluator shall attempt to establish a connection with a test
link:#abbr_TLS[TLS] server that is configured to send a server hello
message indicating the selected version (referred to as the legacy
version in link:#abbr_RFC[RFC] 8446) with a value corresponding to an
undefined link:#abbr_TLS[TLS] (legacy) version (e.g., '03 04') and
observe that the link:#abbr_TSF[TSF] terminates the connection.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., protocol version) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).
+
link:#tls-client-nonstandard-versions[Test FCS_TLSC_EXT.1:2.2] is
intended to test the link:#abbr_TSF[TSF] response to non-standard
versions, including early proposals for ‘beta link:#abbr_TLS[TLS] 1.3’
versions. link:#abbr_RFC[RFC] 8446 requires the legacy version to have
the value '03 03' and specifies link:#abbr_TLS[TLS] 1.3 in the supported
versions extension with the value '03 04'. While not a preferred
approach, if continued support for a beta link:#abbr_TLS[TLS] 1.3
version is desired and the link:#abbr_TSF[TSF] cannot be configured to
reject such versions, another value (e.g., '03 05') can be used in
link:#tls-client-nonstandard-versions[Test FCS_TLSC_EXT.1:2.2].
Implementations of non-standard versions are not tested.
* link:#_t_7[Test FCS_TLSC_EXT.1:3]: (ciphersuites) The evaluator shall
perform the following tests on handling unexpected ciphersuites using a
test link:#abbr_TLS[TLS] server sending handshake messages compliant
with the negotiated version except as indicated in the test:
[.testlist-]##
** link:#_t_8[Test FCS_TLSC_EXT.1:3.1]: (ciphersuite not offered) For
each supported version, the evaluator shall attempt to establish a
connection with a test link:#abbr_TLS[TLS] server configured to
negotiate the supported version and a ciphersuite not included in the
client hello and observe that the link:#abbr_TOE[TOE] rejects the
connection.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., handshake failure) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).
+
This test is intended to test the link:#abbr_TSF[TSF]’s generic ability
to recognize non-offered ciphersuites. If the ciphersuites in the client
hello are configurable, the evaluator shall configure the
link:#abbr_TSF[TSF] to offer a ciphersuite outside those that are
supported and use that ciphersuite in the test. If the
link:#abbr_TSF[TSF] ciphersuite list is not configurable, it is
acceptable to use a named ciphersuite from the IANA link:#abbr_TLS[TLS]
protocols associated with the tested version. Additional special cases
of this test for special ciphersuites are performed separately.
** link:#tls-client-version-confusion[Test FCS_TLSC_EXT.1:3.2]: (version
confusion) For each supported version, the evaluator shall attempt to
establish a connection with a test link:#abbr_TLS[TLS] server that is
configured to negotiate the supported version and a ciphersuite that is
not associated with that version and observe that the
link:#abbr_TOE[TOE] rejects the connection.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., handshake failure) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).
+
It is intended that link:#tls-client-version-confusion[Test
FCS_TLSC_EXT.1:3.2] use link:#abbr_TLS[TLS] 1.3 ciphersuites for a
server negotiating link:#abbr_TLS[TLS] 1.2. If link:#abbr_TLS[TLS] 1.3
is supported, the test server negotiating link:#abbr_TLS[TLS] 1.3 should
select a link:#abbr_TLS[TLS] 1.2 ciphersuite supported by the
link:#abbr_TOE[TOE] for link:#abbr_TLS[TLS] 1.2 and matching the
client’s supported groups and signature algorithm indicated by
extensions in the link:#abbr_TLS[TLS] 1.3 client hello. If the
link:#abbr_TOE[TOE] is configurable to allow both link:#abbr_TLS[TLS]
1.2 and link:#abbr_TLS[TLS] 1.3 servers, the test server should use
ciphersuites offered by the link:#abbr_TSF[TSF] in its client hello
message.
** link:#_t_10[Test FCS_TLSC_EXT.1:3.3]: (null ciphersuite) For each
supported version, the evaluator shall attempt to establish a connection
with a test link:#abbr_TLS[TLS] server configured to negotiate the null
ciphersuite (TLS_NULL_WITH_NULL_NULL) and observe that the
link:#abbr_TOE[TOE] rejects the connection.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., handshake failure, insufficient security) in
response to this, but it is acceptable that the link:#abbr_TSF[TSF]
terminates the connection silently (i.e., without sending a fatal error
alert).
** link:#_t_11[Test FCS_TLSC_EXT.1:3.4]: (anon ciphersuite) The
evaluator shall attempt to establish a link:#abbr_TLS[TLS] 1.2
connection with a test link:#abbr_TLS[TLS] server configured to
negotiate a ciphersuite using the anonymous server authentication method
and observe that the link:#abbr_TOE[TOE] rejects the connection.
+
Note: It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., handshake failure, insufficient security) in
response to this, but it is acceptable that the link:#abbr_TSF[TSF]
terminates the connection silently (i.e., without sending a fatal error
alert).
** link:#tls-client-deprecated-encryption[Test FCS_TLSC_EXT.1:3.5]:
(deprecated encryption algorithm) For each deprecated encryption
algorithm (NULL, RC2, RC4, DES, IDEA, and TDES), the evaluator shall
attempt to establish a link:#abbr_TLS[TLS] 1.2 connection with a test
link:#abbr_TLS[TLS] server configured to negotiate a ciphersuite using
the deprecated encryption algorithm and observe that the
link:#abbr_TOE[TOE] rejects the connection.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., handshake failure, insufficient security) in
response to this, but it is acceptable that the link:#abbr_TSF[TSF]
terminates the connection silently (i.e., without sending a fatal error
alert).
+
See IANA link:#abbr_TLS[TLS] parameters for available ciphersuites to be
tested. The test ciphersuite should use supported cryptographic
algorithms for as many of the other components as possible. For example,
if the link:#abbr_TSF[TSF] only supports
TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384, the test server could select
TLS_ECDHE_PSK_WITH_NULL_SHA_384, TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5,
TLS_ECDHE_RSA_WITH_RC4_128_SHA, TLS_DHE_DSS_WITH_DES_CBC_SHA,
TLS_RSA_WITH_IDEA_CBC_SHA, and TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA.
* link:#_t_13[Test FCS_TLSC_EXT.1:4]: (extensions) For each supported
version indicated in the following tests, the evaluator shall establish
a connection from the link:#abbr_TOE[TOE] with a test server negotiating
the tested version and providing server handshake messages as indicated
when performing the following tests for validating proper extension
handling: [.testlist-]##
** link:#_t_14[Test FCS_TLSC_EXT.1:4.1]: (signature_algorithms)
[conditional] If the link:#abbr_TSF[TSF] supports certificate-based
server authentication, the evaluator shall perform the following tests:
[.testlist-]##
*** link:#_t_15[Test FCS_TLSC_EXT.1:4.1.1]: For each supported version,
the evaluator shall initiate a link:#abbr_TLS[TLS] session with a
link:#abbr_TLS[TLS] test server and observe that the
link:#abbr_TSF[TSF]’s client hello includes the signature_algorithms
extension with values in conformance with the link:#abbr_ST[ST].
*** link:#_t_16[Test FCS_TLSC_EXT.1:4.1.2]: (link:#abbr_TLS[TLS] 1.2
only) [conditional] If the link:#abbr_TSF[TSF] supports an
link:#abbr_ECDHE[ECDHE] or link:#abbr_DHE[DHE] ciphersuite, the
evaluator shall ensure the test link:#abbr_TLS[TLS] server sends a
compliant server hello message selecting link:#abbr_TLS[TLS] 1.2 and one
of the supported link:#abbr_ECDHE[ECDHE] or link:#abbr_DHE[DHE]
ciphersuites, a compliant server certificate message, and a key exchange
message signed using a signature algorithm and hash combination not
included in the client’s hello message (e.g., link:#abbr_RSA[RSA] with
link:#abbr_SHA[SHA]-1). The evaluator shall observe that the
link:#abbr_TSF[TSF] terminates the handshake.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., handshake failure, illegal parameter, decryption
error) in response to this, but it is acceptable that the
link:#abbr_TSF[TSF] terminates the connection silently (i.e., without
sending a fatal error alert).
*** link:#_t_17[Test FCS_TLSC_EXT.1:4.1.3]: [conditional] If
link:#abbr_TLS[TLS] 1.3 is supported, the evaluator shall configure the
test link:#abbr_TLS[TLS] server to respond to the link:#abbr_TOE[TOE]
with a compliant server hello message selecting link:#abbr_TLS[TLS] 1.3
and a server certificate message, but then also sends a certificate
verification message that uses a signature algorithm method not included
in the signature_algorithms extension. The evaluator shall observe that
the link:#abbr_TSF[TSF] terminates the link:#abbr_TLS[TLS] handshake.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., handshake failure, illegal parameter, bad
certificate, decryption error) in response to this, but it is acceptable
that the link:#abbr_TSF[TSF] terminates the connection silently (i.e.,
without sending a fatal error alert).
*** link:#_t_18[Test FCS_TLSC_EXT.1:4.1.4]: [conditional] For all
supported versions for which signature_algorithms_cert is not supported,
the evaluator shall ensure the test link:#abbr_TLS[TLS] server sends a
compliant server hello message for the tested version and a server
certificate message containing a valid certificate that represents the
test link:#abbr_TLS[TLS] server, but which is signed using a signature
and hash combination not included in the link:#abbr_TSF[TSF]’s
signature_algorithms extension (e.g., a certificate signed using
link:#abbr_RSA[RSA] and link:#abbr_SHA[SHA]-1). The evaluator shall
observe that the link:#abbr_TSF[TSF] terminates the link:#abbr_TLS[TLS]
session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., unsupported certificate, bad certificate,
decryption error, handshake failure) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).
+
Certificate-based server authentication is required unless the
link:#abbr_TSF[TSF] only supports link:#abbr_TLS[TLS] with shared PSK.
For link:#abbr_TLS[TLS] 1.2, this is the case if only
TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as defined in link:#abbr_RFC[RFC]
8442, TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as defined in
link:#abbr_RFC[RFC] 5487, TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as
defined in link:#abbr_RFC[RFC] 8442, or
TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as defined in link:#abbr_RFC[RFC]
5487, are supported. For link:#abbr_TLS[TLS] 1.3, this is the case if
only PSK handshakes are supported.
** link:#tls-client-signature-algs-cert[Test FCS_TLSC_EXT.1:4.2]:
(signature_algorithms_cert) [conditional] If signature_algorithms_cert
is supported, then for each version that uses the
signature_algorithms_cert extension, the evaluator shall ensure that the
test link:#abbr_TLS[TLS] server sends a compliant server hello message
selecting the tested version and indicating certificate-based server
authentication.
+
The evaluator shall ensure that the test link:#abbr_TLS[TLS] server
forwards a certificate message containing a valid certificate that
represents the test link:#abbr_TLS[TLS] server, but which is signed by a
valid Certification Authority using a signature and hash combination not
included in the link:#abbr_TSF[TSF]’s signature_algorithms_cert
extension (e.g., a certificate signed using link:#abbr_RSA[RSA] and
link:#abbr_SHA[SHA]-1). The evaluator shall confirm the
link:#abbr_TSF[TSF] terminates the session.
+
*Note:* Support for certificate-based authentication is assumed if the
signature_algorithms_cert is supported. For link:#abbr_TLS[TLS] 1.2, a
non-PSK ciphersuite, or one of TLS_RSA_PSK_WITH_AES_256_GCM_SHA384 or
TLS_RSA_PSK_WITH_AES_128_GCM_SHA256 as defined in link:#abbr_RFC[RFC]
5487 is used to indicate certificate-based server authentication. For
link:#abbr_TLS[TLS] 1.3, the test server completes a full handshake,
even if a PSK is offered to indicate certificate-based server
authentication. If the link:#abbr_TSF[TSF] only supports shared PSK
authentication, link:#tls-client-signature-algs-cert[Test
FCS_TLSC_EXT.1:4.2] is not performed.
+
For link:#abbr_TLS[TLS] 1.3, the server certificate message is
encrypted. The evaluator will configure the test link:#abbr_TLS[TLS]
server with the indicated certificate and ensure that the certificate is
indeed sent by observing the buffer of messages to be encrypted, or by
inspecting one or both sets of logs from the link:#abbr_TSF[TSF] and
test link:#abbr_TLS[TLS] server.
+
It is preferred that the link:#abbr_TSF[TSF] sends a fatal error alert
message (e.g., unsupported certificate, bad certificate, decryption
error, handshake failure) in response to this, but it is acceptable that
the link:#abbr_TSF[TSF] terminates the connection silently (i.e.,
without sending a fatal error alert).
** link:#_t_20[Test FCS_TLSC_EXT.1:4.3]: (extended_master_secret)
(link:#abbr_TLS[TLS] 1.2 only) The evaluator shall initiate a
link:#abbr_TLS[TLS] 1.2 session with a test link:#abbr_TLS[TLS] server
configured to compute a master secret according to link:#abbr_RFC[RFC]
5246, section 8.
+
The evaluator shall observe that the link:#abbr_TSF[TSF]’s client hello
includes the extended master secret extension in accordance with
link:#abbr_RFC[RFC] 7627, and ensures that the test link:#abbr_TLS[TLS]
server does not include the extended master secret extension in its
server hello. The evaluator shall observe that the link:#abbr_TSF[TSF]
terminates the session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., handshake failure) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).
** link:#_t_21[Test FCS_TLSC_EXT.1:4.4]: (supported_groups)
(link:#abbr_TLS[TLS] 1.2 only – for link:#abbr_TLS[TLS] 1.3, testing is
combined with testing of the keyshare extension) [.testlist-]##
*** link:#_t_22[Test FCS_TLSC_EXT.1:4.4.1]: For each supported group,
the evaluator shall initiate a link:#abbr_TLS[TLS] session with a
compliant test link:#abbr_TLS[TLS] 1.2 server supporting
link:#abbr_RFC[RFC] 7919. The evaluator shall ensure that the test
link:#abbr_TLS[TLS] server is configured to select link:#abbr_TLS[TLS]
1.2 and a ciphersuite using the supported group. The evaluator shall
observe that the link:#abbr_TSF[TSF]’s client hello lists the supported
groups as indicated in the link:#abbr_ST[ST], and that the
link:#abbr_TSF[TSF] successfully establishes the link:#abbr_TLS[TLS]
session.
*** link:#_t_23[Test FCS_TLSC_EXT.1:4.4.2]: [conditional on
link:#abbr_TLS[TLS] 1.2 support for link:#abbr_ECDHE[ECDHE]
ciphersuites] The evaluator shall initiate a link:#abbr_TLS[TLS] session
with a test link:#abbr_TLS[TLS] server that is configured to use an
explicit version of a named EC group supported by the client. The
evaluator shall ensure that the test link:#abbr_TLS[TLS] server key
exchange message includes the explicit formulation of the group in its
key exchange message as indicated in link:#abbr_RFC[RFC] 4492 section
5.4. The evaluator shall confirm that the link:#abbr_TSF[TSF] terminates
the session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., illegal parameter) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).
* link:#_t_24[Test FCS_TLSC_EXT.1:5]: (link:#abbr_TLS[TLS] 1.3
extensions) [conditional] If the link:#abbr_TSF[TSF] supports
link:#abbr_TLS[TLS] 1.3, the evaluator shall perform the following
tests. For each test, the evaluator shall observe that the
link:#abbr_TSF[TSF]’s client hello includes the supported versions
extension with the value '03 04' indicating link:#abbr_TLS[TLS] 1.3:
[.testlist-]##
** link:#_t_25[Test FCS_TLSC_EXT.1:5.1]: (supported versions) The
evaluator shall initiate link:#abbr_TLS[TLS] 1.3 sessions in turn from
the link:#abbr_TOE[TOE] to a test link:#abbr_TLS[TLS] server configured
as indicated in the sub-tests below: [.testlist-]##
*** link:#_t_26[Test FCS_TLSC_EXT.1:5.1.1]: The evaluator shall
configure the test link:#abbr_TLS[TLS] server to include the supported
versions extension in the server hello containing the value '03 03.' The
evaluator shall observe that the link:#abbr_TSF[TSF] terminates the
link:#abbr_TLS[TLS] session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., illegal parameter, handshake failure, protocol
version) in response to this, but it is acceptable that the
link:#abbr_TSF[TSF] terminates the connection silently (i.e., without
sending a fatal error alert).
*** link:#_t_27[Test FCS_TLSC_EXT.1:5.1.2]: The evaluator shall
configure the test link:#abbr_TLS[TLS] server to include the supported
versions extension in the server hello containing the value '03 04' and
complete a compliant link:#abbr_TLS[TLS] 1.3 handshake. The evaluator
shall observe that the link:#abbr_TSF[TSF] completes the
link:#abbr_TLS[TLS] 1.3 handshake successfully.
*** link:#_t_28[Test FCS_TLSC_EXT.1:5.1.3]: [conditional] If the
link:#abbr_TSF[TSF] is configurable to support both link:#abbr_TLS[TLS]
1.2 and link:#abbr_TLS[TLS] 1.3, the evaluator shall follow operational
guidance to configure this behavior. The evaluator shall ensure that the
test link:#abbr_TLS[TLS] server sends a link:#abbr_TLS[TLS] 1.2
compliant server handshake and observe that the server random does not
incidentally include any downgrade messaging. The evaluator shall
observe that the link:#abbr_TSF[TSF] completes the link:#abbr_TLS[TLS]
1.2 handshake successfully.
+
*Note:* Enhanced downgrade protection defined in link:#abbr_RFC[RFC]
8446 is optional, and if supported, is tested separately. The evaluator
may configure the test server’s random, or may repeat the test until the
server’s random does not match a downgrade indicator.
** link:#_t_29[Test FCS_TLSC_EXT.1:5.2]: (supported groups, key shares)
The evaluator shall initiate link:#abbr_TLS[TLS] 1.3 sessions in turn
with a test link:#abbr_TLS[TLS] server configured as indicated in the
following sub-tests: [.testlist-]##
*** link:#_t_30[Test FCS_TLSC_EXT.1:5.2.1]: For each supported group,
the evaluator shall configure the compliant test link:#abbr_TLS[TLS] 1.3
server to select a ciphersuite using the group. The evaluator shall
observe that the link:#abbr_TSF[TSF] sends an element of the group in
its client hello key shares extension (after a hello retry message from
the test server, if the key share for the group is not included in the
initial client hello). The evaluator shall ensure the test
link:#abbr_TLS[TLS] server sends an element of the group in its server
hello and observes that the link:#abbr_TSF[TSF] completes the
link:#abbr_TLS[TLS] handshake successfully.
*** link:#_t_31[Test FCS_TLSC_EXT.1:5.2.2]: For each supported group,
the evaluator shall modify the server hello sent by the test
link:#abbr_TLS[TLS] server to include an invalid key share value
claiming to be an element the group indicated in the supported groups
extension. The evaluator shall observe that the link:#abbr_TSF[TSF]
terminates the link:#abbr_TLS[TLS] session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., illegal parameter) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).
+
For link:#abbr_DHE[DHE] ciphersuites, a zero value, or a value greater
or equal to the modulus is not a valid element. For
link:#abbr_ECDHE[ECDHE] groups, an invalid point contains x and y
coordinates of the correct size, but represents a point not on the
curve. The evaluator can construct such an invalid point by modifying a
byte in the y coordinate of a valid point and verify that the
coordinates do not satisfy the curve equation.
** link:#_t_32[Test FCS_TLSC_EXT.1:5.3]: (PSK support) [conditional] If
the link:#abbr_TSF[TSF] supports pre-shared keys, the evaluator shall
follow the operational guidance to use pre-shared keys, shall establish
a pre-shared key between the link:#abbr_TSF[TSF] and the test
link:#abbr_TLS[TLS] server, and initiate link:#abbr_TLS[TLS] 1.3
sessions in turn between the link:#abbr_TSF[TSF] and the test
link:#abbr_TLS[TLS] server configured as indicated in the following
sub-tests: [.testlist-]##
*** link:#_t_33[Test FCS_TLSC_EXT.1:5.3.1]: The evaluator shall
configure the link:#abbr_TSF[TSF] to use the pre-shared key and ensure
that the test link:#abbr_TLS[TLS] server functions as a compliant
link:#abbr_TLS[TLS] 1.3 server. The evaluator shall observe that the
link:#abbr_TSF[TSF]’s client hello includes the pre_shared_key extension
with the valid PSK indicator shared with the test server. The evaluator
shall also observe that the link:#abbr_TSF[TSF]’s client hello also
includes the psk_key_exchange_mode and the post_handshake_auth
extensions and that the psk_key_exchange_mode indicates one or more of
link:#abbr_DHE[DHE] or link:#abbr_ECDHE[ECDHE] modes but does not
include the PSK-only mode. The evaluator shall observe that the
link:#abbr_TSF[TSF] completes the link:#abbr_TLS[TLS] 1.3 handshake
successfully in accordance with link:#abbr_RFC[RFC] 8446, to include the
link:#abbr_TSF[TSF] sending appropriate key shares for one or more of
the supported groups.
+
Once the handshake is successful, the evaluator shall cause the test
link:#abbr_TLS[TLS] server to send a certificate request and observe
that the link:#abbr_TSF[TSF] provides a certificate message and
certificate verify message.
+
*Note:* It may be necessary to complete a standard handshake and send a
new-ticket message from the test link:#abbr_TLS[TLS] server to establish
a pre-shared key, or it might be possible to configure the pre-shared
key manually via out-of-band mechanisms. This can be performed in
conjunction with other testing that is not tested as part of this
link:#abbr_SFR[SFR]. It is not required at this time to support emerging
standards on establishing PSK, but as such standards are finalized, this
link:#abbr_FP[FP] may be updated to require such support.
+
link:#abbr_TLS[TLS] messages after the handshake are encrypted so it may
not be possible to observe the certificate and certificate verify
messages sent by the link:#abbr_TSF[TSF] directly. The evaluator may
need to configure the test link:#abbr_TLS[TLS] server to use an
application that requires post-handshake client authentication and
terminates the session or otherwise has an observable effect if the
certificate is not provided.
*** link:#_t_34[Test FCS_TLSC_EXT.1:5.3.2]: The evaluator shall attempt
to configure the link:#abbr_TSF[TSF] to send early data. If there is no
indication from the link:#abbr_TSF[TSF] that this is blocked, the
evaluator shall repeat test 5.3.1 with the link:#abbr_TSF[TSF] so
configured and observe that the link:#abbr_TSF[TSF] does not send
application data prior to receiving the server hello.
+
*Note:* Early data will be encrypted under the PSK and received by the
test link:#abbr_TLS[TLS] server prior to it sending a server hello
message.
* link:#_t_35[Test FCS_TLSC_EXT.1:6]: (corrupt finished message) For
each supported version, the evaluator shall initiate a
link:#abbr_TLS[TLS] session from the link:#abbr_TOE[TOE] to a test
link:#abbr_TLS[TLS] server that sends a compliant set of server
handshake messages, except for sending a modified finished message
(modify a byte of the finished message that would have been sent by a
compliant server). The evaluator shall observe that the
link:#abbr_TSF[TSF] terminates the session and does not complete the
handshake by observing that the link:#abbr_TSF[TSF] does not send
application data provided to the link:#abbr_TLS[TLS] channel.
* link:#tls-client-missing-finished[Test FCS_TLSC_EXT.1:7]: (missing
finished message) For each supported version, the evaluator shall
initiate a session from the link:#abbr_TOE[TOE] to a test
link:#abbr_TLS[TLS] server providing a compliant handshake, except for
sending a random link:#abbr_TLS[TLS] message (the five byte header
indicates a correct link:#abbr_TLS[TLS] message for the negotiated
version, but not indicating a finished message) as the final message.
The evaluator shall observe that the link:#abbr_TSF[TSF] terminates the
session and does not send application data.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., decryption error) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).
+
For link:#abbr_TLS[TLS] 1.2, the modified message is sent after the
change_cipher_spec message. For link:#abbr_TLS[TLS] 1.3, the modified
message is sent as the last message of the server’s second flight of
messages.
* link:#_t_37[Test FCS_TLSC_EXT.1:8]: (unexpected/corrupt signatures
within handshake) The evaluator shall perform the following tests,
according to the versions supported. [.testlist-]##
** link:#_t_38[Test FCS_TLSC_EXT.1:8.1]: (link:#abbr_TLS[TLS] 1.2 only)
[conditional] If the link:#abbr_ST[ST] indicates support for
link:#abbr_ECDSA[ECDSA] or DSA ciphersuites, the evaluator shall
initiate a link:#abbr_TLS[TLS] session with a compliant test
link:#abbr_TLS[TLS] server and modify the signature in the server key
exchange. The evaluator shall observe that the link:#abbr_TSF[TSF]
terminates the session with a fatal alert message (e.g., decrypt error,
handshake error).
** link:#_t_39[Test FCS_TLSC_EXT.1:8.2]: [conditional] If the
link:#abbr_ST[ST] indicates support for link:#abbr_TLS[TLS] 1.3, the
evaluator shall initiate a link:#abbr_TLS[TLS] session between the
link:#abbr_TOE[TOE] and a test link:#abbr_TLS[TLS] server that is
configured to send a compliant server hello message, encrypted extension
message, and certificate message, but will send a certificate verify
message with an invalid signature (e.g., by modifying a byte from a
valid signature). The evaluator shall confirm that the
link:#abbr_TSF[TSF] terminates the session with a fatal error alert
message (e.g., bad certificate, decrypt error, handshake error).
** link:#_t_40[Test FCS_TLSC_EXT.1:8.3]: (link:#abbr_TLS[TLS] 1.2 only)
[conditional] If the link:#abbr_ST[ST] indicates support for both
link:#abbr_RSA[RSA] and link:#abbr_ECDSA[ECDSA] methods in the
signature_algorithm (or, if supported, the signature_algorithms_cert)
extension, and if the link:#abbr_ST[ST] indicates one or more
link:#abbr_TLS[TLS] 1.2 ciphersuites indicating each of the
link:#abbr_RSA[RSA] and link:#abbr_ECDSA[ECDSA] methods in its signature
components, the evaluator shall choose two ciphersuites: one indicating
an link:#abbr_RSA[RSA] signature (cipher 1) and one indictaing an
link:#abbr_ECDSA[ECDSA] signature (cipher 2). The evalutor shall then
establish two certificates that are trusted by the link:#abbr_TOE[TOE]:
one representing the test link:#abbr_TLS[TLS] 1.2 server using an
link:#abbr_RSA[RSA] signature (cert 1) and one representing the test
link:#abbr_TLS[TLS] 1.2 server using an link:#abbr_ECDSA[ECDSA]
signature (cert 2). The evaluator shall initiate a link:#abbr_TLS[TLS]
session between the link:#abbr_TOE[TOE] and the test link:#abbr_TLS[TLS]
1.2 server that is configured to select cipher 1 and to send cert 2. The
evaluator shall verify that the link:#abbr_TSF[TSF] terminates this
link:#abbr_TLS[TLS] session. The evaluator shall then initiate a
link:#abbr_TLS[TLS] session between the link:#abbr_TOE[TOE] and the test
link:#abbr_TLS[TLS] 1.2 server that is configured to select cipher 2 and
to send cert 1. The evaluator shall verify that the link:#abbr_TSF[TSF]
also terminates this link:#abbr_TLS[TLS] session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., bad certificate, decryption error, handshake
failure) in response to this, but it is acceptable that the
link:#abbr_TSF[TSF] terminates the connection silently (i.e., without
sending a fatal error alert).
* link:#_t_41[Test FCS_TLSC_EXT.1:9]: [conditional] If the
link:#abbr_TSF[TSF] supports certificate-based server authentication,
then for each supported version, the evaluator will initiate a
link:#abbr_TLS[TLS] session from the link:#abbr_TOE[TOE] to the
compliant test link:#abbr_TLS[TLS] server configured to negotiate the
tested version, and to authenticate using a certificate trusted by the
link:#abbr_TSF[TSF] as specified in the following: [.testlist-]##
** link:#_t_42[Test FCS_TLSC_EXT.1:9.1]: (certificate extended key usage
purpose) The evaluator shall send a server certificate that contains the
Server Authentication purpose in the ExtendedKeyUsage extension and
verify that a connection is established. The evaluator shall repeat this
test using a different certificate that is otherwise valid and trusted
but lacks the Server Authentication purpose in the ExtendedKeyUsage
extension and observe the link:#abbr_TSF[TSF] terminates the session.
+
Note: This test may be performed as part of certificate validation
testing (link:#FIA_X509_EXT.1[FIA_X509_EXT.1]).
+
It is preferred that the link:#abbr_TSF[TSF] sends a fatal error alert
message (e.g., bad certificate, decryption error, handshake failure) in
response to this, but it is acceptable that the link:#abbr_TSF[TSF]
terminates the connection silently (i.e., without sending a fatal error
alert).
+
Ideally, the two certificates should be similar in regards to structure,
the types of identifiers used, and the chain of trust.
** link:#_t_43[Test FCS_TLSC_EXT.1:9.2]: (certificate identifiers) For
each supported method of matching presented identifiers, and for each
name type for which the link:#abbr_TSF[TSF] parses the presented
identifiers from the server certificate for the method, the evaluator
shall establish a valid certificate trusted by the link:#abbr_TSF[TSF]
to represent the test server using only the tested name type. The
evaluator shall perform the following sub-tests: [.testlist-]##
*** link:#_t_44[Test FCS_TLSC_EXT.1:9.2.1]: The evaluator shall prepare
the link:#abbr_TSF[TSF] as necessary to use the matching method and
establish reference identifiers for the test server for the tested name
type. The evaluator shall ensure the test link:#abbr_TLS[TLS] server
sends a certificate with a matching name of the tested name type and
observe that the link:#abbr_TSF[TSF] completes the connection.
*** link:#_t_45[Test FCS_TLSC_EXT.1:9.2.2]: The evaluator shall prepare
the link:#abbr_TSF[TSF] as necessary to use the matching method and
establish reference identifiers that do not match the name representing
the test server. The evaluator shall ensure the test link:#abbr_TLS[TLS]
server sends a certificate with a name of the type tested, and observe
the link:#abbr_TSF[TSF] terminates the session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., bad certificate, unknown certificate) in response
to this, but it is acceptable that the link:#abbr_TSF[TSF] terminates
the connection silently (i.e., without sending a fatal error alert).
*** link:#tls-client-valid-wildcard[Test FCS_TLSC_EXT.1:9.2.3]:
[conditional] If the link:#abbr_TSF[TSF] supports wildcards for a
link:#abbr_DNS[DNS], link:#abbr_URI[URI], or SVR name type, the
evaluator shall prepare the link:#abbr_TSF[TSF] as necessary to use the
matching method for the name type, and establish a reference identifier.
The evaluator shall establish a certificate for the test server that
includes a wildcard name for the link:#abbr_DNS[DNS] portion of the
appropriate name type which matches the reference identifier. The
evaluator shall ensure the link:#abbr_TLS[TLS] server sends the
certificate containing the wildcard name of the type tested, and observe
that the link:#abbr_TSF[TSF] completes the connection.
*** link:#tls-client-no-wildcard[Test FCS_TLSC_EXT.1:9.2.4]:
[conditional] If the link:#abbr_TSF[TSF] supports a link:#abbr_DNS[DNS],
link:#abbr_URI[URI], or SVR name type, but does not support wildcards
(in general, or specifically for internationalized names of the
specified type), the evaluator shall prepare the link:#abbr_TSF[TSF] as
necessary to use the matching method and establish a reference
identifier that matches a wildcard name for the link:#abbr_DNS[DNS]
portion of the appropriate name type, in accordance with the appropriate
link:#abbr_RFC[RFC], in a certificate representing the server. The
evaluator shall ensure the link:#abbr_TLS[TLS] server sends the
certificate containing the wildcard name of the type tested, and observe
that the link:#abbr_TSF[TSF] terminates the connection.
+
*Note:* If the link:#abbr_TSF[TSF]'s ability to support wildcard
certificates is configurable, both link:#tls-client-valid-wildcard[Test
FCS_TLSC_EXT.1:9.2.3] and link:#tls-client-no-wildcard[Test
FCS_TLSC_EXT.1:9.2.4] are performed under the appropriate configuration.
This test is required if the link:#abbr_TSF[TSF] supports
internationalized names of the specified type – in this case, the
reference identifier only includes an internationalized encoding in the
leftmost label. The certificate used is intended to match the
certificate as if wildcards were supported and if the wildcard extended
to internationalized names.
*** link:#tls-client-invalid-wildcard[Test FCS_TLSC_EXT.1:9.2.5]:
[conditional] If the link:#abbr_TSF[TSF] supports wildcards for a
link:#abbr_DNS[DNS], link:#abbr_URI[URI], or SVR name type, the
evaluator shall prepare the link:#abbr_TSF[TSF] as necessary to use the
matching method. The evaluator shall establish a reference identifier
and a certificate for the server as indicated in each of the subtests
described below. The evaluator shall in turn, ensure the
link:#abbr_TLS[TLS] server sends the certificate associated with the
reference identifier and observe that the link:#abbr_TSF[TSF] terminates
the session. [.testlist-]##
**** link:#_t_49[Test FCS_TLSC_EXT.1:9.2.5.1]: The reference identifier
contains a link:#abbr_DNS[DNS] portion with two labels, and the
certificate includes a name whose link:#abbr_DNS[DNS] portion includes a
matching rightmost label and a wildcard in the leftmost label.
**** link:#_t_50[Test FCS_TLSC_EXT.1:9.2.5.2]: The reference identifier
contains a link:#abbr_DNS[DNS] portion with four labels, and the
certificate includes a name whose link:#abbr_DNS[DNS] portion includes
two rightmost labels matching the reference identifier, and a wildcard
in the third (leftmost) label.
**** link:#_t_51[Test FCS_TLSC_EXT.1:9.2.5.3]: The reference identifier
contains a link:#abbr_DNS[DNS] portion with three labels, and the
certificate includes a name whose link:#abbr_DNS[DNS] portion includes
two rightmost labels matching the reference identifier, and a wildcard
in the third (leftmost) label.
*** link:#_t_52[Test FCS_TLSC_EXT.1:9.2.6]: [conditional] If the
link:#abbr_TSF[TSF] supports wildcards and supports embedded
link:#abbr_DNS[DNS], link:#abbr_URI[URI], or SVR name types in the
link:#abbr_CN[CN], then for each supported name type, the evaluator
shall repeat link:#tls-client-valid-wildcard[Test FCS_TLSC_EXT.1:9.2.3],
link:#tls-client-no-wildcard[Test FCS_TLSC_EXT.1:9.2.4], and
link:#tls-client-invalid-wildcard[Test FCS_TLSC_EXT.1:9.2.5] using
certificates with the prescribed name embedded in the link:#abbr_CN[CN].
*** link:#tls-client-ip-wildcard[Test FCS_TLSC_EXT.1:9.2.7]:
[conditional] If the link:#abbr_TSF[TSF] supports link:#abbr_IP[IP]
addresses as an embedded name type in the link:#abbr_CN[CN], the
evaluator shall establish an link:#abbr_IP[IP] address as a reference
identifier and establish a certificate with a valid link:#abbr_DNS[DNS]
name in the subject field, including a link:#abbr_CN[CN] whose value is
the digital formatting of the octets of the reference identifier. The
evaluator shall ensure the server sends the certificate and observe that
the link:#abbr_TSF[TSF] successfully completes the session.
*** link:#_t_54[Test FCS_TLSC_EXT.1:9.2.8]: [conditional] If the
link:#abbr_TSF[TSF] supports link:#abbr_IP[IP] addresses and any
embedded name type in the link:#abbr_CN[CN], the evaluator shall
establish an link:#abbr_IP[IP] address as a reference identifier and
establish a certificate with a valid link:#abbr_DNS[DNS] name in the
subject field, including a link:#abbr_CN[CN] whose value is the digital
formatting of the octets of the reference identifier (as in
link:#tls-client-ip-wildcard[Test FCS_TLSC_EXT.1:9.2.7]) except that one
of the octets is replaced by the ‘*’ character. The evaluator shall
ensure the server sends the certificate and observe that the
link:#abbr_TSF[TSF] terminates the session.
** link:#_t_55[Test FCS_TLSC_EXT.1:9.3]: (mixed
identifiers)[conditional] If the link:#abbr_TSF[TSF] supports a name
matching method where the link:#abbr_TSF[TSF] performs matching of both
link:#abbr_CN[CN]-encoded name types and link:#abbr_SAN[SAN] names of
the same type, then for each such method, and for each such name type,
the evaluator shall establish a valid certificate trusted by the
link:#abbr_TSF[TSF] to represent the test server using one name for the
link:#abbr_CN[CN]-encoded name type and a different name for the
link:#abbr_SAN[SAN] name type The evaluator shall perform the following
tests: [.testlist-]##
*** link:#_t_56[Test FCS_TLSC_EXT.1:9.3.1]: The evaluator shall follow
the operational guidance to configure the link:#abbr_TSF[TSF] to use the
name matching method and establish reference identifiers matching only
the link:#abbr_SAN[SAN]. The evaluator shall ensure that the test server
sends the certificate with the matching link:#abbr_SAN[SAN] and
non-matching link:#abbr_CN[CN]-encoded name, and observe that the
link:#abbr_TSF[TSF] completes the connection.
+
*Note:* Configuration of the link:#abbr_TSF[TSF] may depend on the
application using link:#abbr_TLS[TLS].
*** link:#_t_57[Test FCS_TLSC_EXT.1:9.3.2]: The evaluator shall follow
the operational guidance to configure the link:#abbr_TSF[TSF] to use the
name matching method and establish reference identifiers matching only
the link:#abbr_CN[CN]-encoded name. The evaluator shall ensure that the
test server sends the certificate with the matching link:#abbr_SAN[SAN]
name and non-matching link:#abbr_CN[CN]-encoded name, and observe that
the link:#abbr_TSF[TSF] terminates the session.
+
It is preferred that the link:#abbr_TSF[TSF] sends a fatal error alert
message (e.g., bad certificate, unknown certificate) in response to
this, but it is acceptable that the link:#abbr_TSF[TSF] terminates the
connection silently (i.e., without sending a fatal error alert).
** link:#_t_58[Test FCS_TLSC_EXT.1:9.4]: (empty certificate) The
evaluator shall configure the test link:#abbr_TLS[TLS] server to supply
an empty certificate message and verify that the link:#abbr_TSF[TSF]
terminates the session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., bad certificate, unknown certificate) in response
to this, but it is acceptable that the link:#abbr_TSF[TSF] terminates
the connection silently (i.e., without sending a fatal error alert).
** link:#_t_59[Test FCS_TLSC_EXT.1:9.5]: (invalid certificate)
[conditional] If validity exceptions are supported, then for each
exception for certificate validity supported, the evaluator shall
configure the link:#abbr_TSF[TSF] to allow the exception and ensure the
test link:#abbr_TLS[TLS] server sends a certificate that is valid and
trusted, except for the allowed exception. The evaluator shall observe
that the link:#abbr_TSF[TSF] completes the session.
+
Without modifying the link:#abbr_TSF[TSF] configuration, the evaluator
shall initiate a new session with the test link:#abbr_TLS[TLS] server
that includes an additional validation error, and observe that the
link:#abbr_TSF[TSF] terminates the session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., decode error, bad certificate) in response to this,
but it is acceptable that the link:#abbr_TSF[TSF] terminates the
connection silently (i.e., without sending a fatal error alert).
+
The intent of this test is to verify the scope of the exception
processing. If verifying certificate status information is claimed as an
exception, then this test will verify that a link:#abbr_TLS[TLS] session
succeeds when all supported methods for obtaining certificate status
information is blocked from the link:#abbr_TSF[TSF], to include removing
any status information that might be cached by the link:#abbr_TSF[TSF].
If the exception is limited to specific certificates (e.g., only leaf
certificates are exempt, or only certain leaf certificates are exempt)
the additional validation error could be unavailable revocation
information for a non-exempt certificate (e.g., revocation status
information from an intermediate link:#abbr_CA[CA] is blocked for the
issuing link:#abbr_CA[CA] of an exempt leaf certificate, or revocation
information from the issuing link:#abbr_CA[CA] is blocked for a
non-exempt leaf certificate). If the only option for the exception is
for all revocation information for all certificates, another validation
error from [.no-link]#FIA_X509_EXT.1# (e.g., certificate expiration,
extended key usage, etc.) may be used.

[[FCS_TLSC_EXT.2]]
==== FCS_TLSC_EXT.2 TLS Client Support for Mutual Authentication

*_The inclusion of this selection-based component depends upon selection
in link:#FCS_TLSC_EXT.1.1[FCS_TLSC_EXT.1.1]._*

[[FCS_TLSC_EXT.2.1]]
link:#FCS_TLSC_EXT.2.1[FCS_TLSC_EXT.2.1]

The link:#abbr_TSF[TSF] shall support mutual authentication using
X.509v3 certificates during the handshake and [*selection*:
[#_s_288 .selectable-content]#in support of post-handshake
authentication requests#, [#_s_289 .selectable-content]#at no other
time# ], in accordance with [*selection*:
[#_s_290 .selectable-content]#link:#abbr_RFC[RFC] 5246, section 7.4.4#,
[#_s_291 .selectable-content]#link:#abbr_RFC[RFC] 8446, section 4.3.2#
].

[.note-header]#Application Note: #[.note]# #

This link:#abbr_SFR[SFR] is claimed if "mutual authentication" is
selected in link:#FCS_TLSC_EXT.1.1[FCS_TLSC_EXT.1.1].

Clients that support link:#abbr_TLS[TLS] 1.3 and post-handshake
authentication claim ‘in support of post-handshake authentication
requests’ in the first selection. The ‘at no other time’ selection is
claimed for clients only supporting link:#abbr_TLS[TLS] 1.2 or for
link:#abbr_TLS[TLS] 1.3 clients that do not support post-handshake
authentication.

The certificate request sent by the server specifies the signature
algorithms and certification authorities supported by the server. If the
client does not possess a matching certificate, it sends an empty
certificate message. The structure of the certificate request message is
changed in link:#abbr_TLS[TLS] 1.3 to use the signature_algorithm,
signature_algorithms_cert, and certificate_authorities extensions, and
link:#abbr_RFC[RFC] 8446 allows for link:#abbr_TLS[TLS] 1.2
implementations to use the new message structure. The
"link:#abbr_RFC[RFC] 8446, section 4.3.2" option is claimed in the
second selection if link:#abbr_TLS[TLS] 1.3 is supported or if the
link:#abbr_RFC[RFC] 8446 method is supported for link:#abbr_TLS[TLS] 1.2
servers. The "link:#abbr_RFC[RFC] 5246, section 7.4.4" option is claimed
if the link:#abbr_RFC[RFC] 5246 method is supported for interoperability
with link:#abbr_TLS[TLS] 1.2 servers that do not adopt the
link:#abbr_RFC[RFC] 8446 method. When mutual authentication is
supported, at least one of these methods must be claimed, per the
selection.

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_TLSC_EXT.2[FCS_TLSC_EXT.2]

link:#abbr_TSS[TSS]

The evaluator shall ensure that the link:#abbr_TSS[TSS] description
required per [.no-link]#FIA_X509_EXT.2.1# includes the use of
client-side certificates for link:#abbr_TLS[TLS] mutual authentication.
The evaluator shall also ensure that the link:#abbr_TSS[TSS] describes
any factors beyond configuration that are necessary in order for the
client to engage in mutual authentication using X.509v3 certificates.

Guidance

The evaluator shall ensure that the operational guidance includes any
instructions necessary to configure the link:#abbr_TOE[TOE] to perform
mutual authentication. The evaluator shall also verify that the
operational guidance required per [.no-link]#FIA_X509_EXT.2.1# includes
instructions for configuring the client-side certificates for
link:#abbr_TLS[TLS] mutual authentication.

Tests

For each supported link:#abbr_TLS[TLS] version, the evaluator shall
perform the following tests: [.testlist-]##

* link:#_t_60[Test FCS_TLSC_EXT.2:1]: The evaluator shall establish a
link:#abbr_TLS[TLS] connection from the link:#abbr_TSF[TSF] to a test
link:#abbr_TLS[TLS] server that negotiates the tested version and which
is not configured for mutual authentication (i.e., does not send a
Server’s Certificate Request (type 13) message). The evaluator observes
negotiation of a link:#abbr_TLS[TLS] channel and confirms that the
link:#abbr_TOE[TOE] did not send a Client’s Certificate message (type
11) during handshake.
* link:#_t_61[Test FCS_TLSC_EXT.2:2]: The evaluator shall establish a
connection to a test link:#abbr_TLS[TLS] server with a shared trusted
root that is configured for mutual authentication (i.e., it sends a
Server’s Certificate Request (type 13) message). The evaluator observes
negotiation of a link:#abbr_TLS[TLS] channel and confirms that the
link:#abbr_TOE[TOE] responds with a non-empty Client’s Certificate
message (type 11) and Certificate Verify (type 15) message.
* link:#_t_62[Test FCS_TLSC_EXT.2:3]: [conditional] If the
link:#abbr_TSF[TSF] supports post-handshake authentication, the
evaluator shall establish a pre-shared key between the
link:#abbr_TSF[TSF] and a test link:#abbr_TLS[TLS] 1.3 server. The
evaluator shall initiate a link:#abbr_TLS[TLS] session using the
pre-shared key and confirm the link:#abbr_TSF[TSF] and test
link:#abbr_TLS[TLS] 1.3 server successfully complete the
link:#abbr_TLS[TLS] handshake and both support post-handshake
authentication. After the session is successfully established, the
evaluator shall initiate a certificate request message from the test
link:#abbr_TLS[TLS] 1.3 server. The evaluator shall observe that the
link:#abbr_TSF[TSF] receives that authentication request and shall take
necessary actions, in accordance with the operational guidance, to
complete the authentication request. The evaluator shall confirm that
the test link:#abbr_TLS[TLS] 1.3 server receives certificate and
certificate verification messages from the link:#abbr_TSF[TSF] over the
channel that authenticates the client.
+
*Note:* link:#abbr_TLS[TLS] 1.3 certificate requests from the test
server and client certificate and certificate verify messages are
encrypted. The evaluator confirms that the link:#abbr_TSF[TSF] sends the
appropriate messages by examining the messages received at the test
link:#abbr_TLS[TLS] 1.3 server and by inspecting any relevant server
logs. The evaluator may also take advantage of the calling application
to demonstrate that the link:#abbr_TOE[TOE] receives data configured at
the test link:#abbr_TLS[TLS] server.

[[FCS_TLSC_EXT.3]]
==== FCS_TLSC_EXT.3 TLS Client Downgrade Protection

*_The inclusion of this selection-based component depends upon selection
in link:#FCS_TLSC_EXT.1.1[FCS_TLSC_EXT.1.1]._*

[[FCS_TLSC_EXT.3.1]]
link:#FCS_TLSC_EXT.3.1[FCS_TLSC_EXT.3.1]

The link:#abbr_TSF[TSF] shall not establish a link:#abbr_TLS[TLS]
channel if the server hello message includes [*selection*:
[#_s_292 .selectable-content]#link:#abbr_TLS[TLS] 1.2 downgrade
indicator#, [#_s_293 .selectable-content]#link:#abbr_TLS[TLS] 1.1 or
below downgrade indicator# ] in the server random field.

[.note-header]#Application Note: #[.note]# #

This link:#abbr_SFR[SFR] is claimed if "supplemental downgrade
protection" is selected in link:#FCS_TLSC_EXT.1.1[FCS_TLSC_EXT.1.1].

The link:#abbr_ST[ST] author claims the “link:#abbr_TLS[TLS] 1.2
downgrade indicator” when link:#FCS_TLSC_EXT.1[FCS_TLSC_EXT.1] indicates
support for both link:#abbr_TLS[TLS] 1.3 and supplemental downgrade
protection. This option is not claimed if link:#abbr_TLS[TLS] 1.3 is not
supported. The “link:#abbr_TLS[TLS] 1.1 or below downgrade indicator”
option may be claimed regardless of support for link:#abbr_TLS[TLS] 1.3,
but should only be claimed if the link:#abbr_TSF[TSF] is capable of
detecting the indicator. As indicated in
link:#FCS_TLSC_EXT.1.1[FCS_TLSC_EXT.1.1], this link:#abbr_FP[FP]
requires the client to terminate link:#abbr_TLS[TLS] 1.1 or below
sessions. It is acceptable for the link:#abbr_TSF[TSF] to always
terminate link:#abbr_TLS[TLS] 1.1 sessions based on the server hello
negotiated version field and ignore any downgrade indicator. However, a
product that is capable of detecting the link:#abbr_TLS[TLS] 1.1 or
below downgrade indicator may take different actions depending on
whether the link:#abbr_TLS[TLS] 1.1 or below downgrade indicator is set.

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_TLSC_EXT.3[FCS_TLSC_EXT.3]

link:#abbr_TSS[TSS]

The evaluator shall review the link:#abbr_TSS[TSS] and confirm that the
description of the link:#abbr_TLS[TLS] client protocol includes the
downgrade protection mechanism in accordance with link:#abbr_RFC[RFC]
8446 and identifies any configurable features of the link:#abbr_TSF[TSF]
needed to meet the requirements. If the link:#abbr_ST[ST] claims that
the link:#abbr_TLS[TLS] 1.1 and below indicator is processed, the
evaluator shall confirm that the link:#abbr_TSS[TSS] indicates which
configurations allow processing of the downgrade indicator and the
specific response of the link:#abbr_TSF[TSF] when it receives the
downgrade indicator as opposed to simply terminating the session for the
unsupported version.

Guidance

The evaluator shall review the operational guidance and confirm that any
instructions to configure the link:#abbr_TSF[TSF] to meet the
requirements are included.

Tests

The evaluator shall perform the following tests to confirm the response
to downgrade indicators from a test link:#abbr_TLS[TLS] 1.3 server:
[.testlist-]##

* link:#_t_63[Test FCS_TLSC_EXT.3:1]: [conditional] If the
link:#abbr_TSF[TSF] supports link:#abbr_TLS[TLS] 1.3, the evaluator
shall initiate a link:#abbr_TLS[TLS] 1.3 session with a test
link:#abbr_TLS[TLS] 1.3 server configured to send a compliant
link:#abbr_TLS[TLS] 1.2 server hello (not including any
link:#abbr_TLS[TLS] 1.3 extensions) but including the
link:#abbr_TLS[TLS] 1.2 downgrade indicator ‘44 4F 57 4E 47 52 44 01’ in
the last eight bytes of the server random field. The evaluator shall
confirm that the link:#abbr_TSF[TSF] terminates the session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] send a fatal error
alert message (e.g., illegal parameter), but it is acceptable that the
link:#abbr_TSF[TSF] terminate the session without sending an error
alert.
* link:#_t_64[Test FCS_TLSC_EXT.3:2]: [conditional] If the
link:#abbr_TSF[TSF] supports the link:#abbr_TLS[TLS] 1.1 or below
downgrade indicator and if the link:#abbr_ST[ST] indicates a
configuration where the indicator is processed, the evaluator shall
follow operational guidance instructions to configure the
link:#abbr_TSF[TSF] so it parses a link:#abbr_TLS[TLS] 1.1 handshake to
detect and process the link:#abbr_TLS[TLS] downgrade indicator. The
evaluator shall initiate a link:#abbr_TLS[TLS] session between the
link:#abbr_TOE[TOE] and a test link:#abbr_TLS[TLS] server that is
configured to send a link:#abbr_TLS[TLS] 1.1 server hello message with
the downgrade indicator ‘44 4F 57 4E 47 52 44 00’ in the last eight
bytes of the server random field, but which is otherwise compliant with
link:#abbr_RFC[RFC] 4346. The evaluator shall observe that the
link:#abbr_TSF[TSF] terminates the session as described in the
link:#abbr_ST[ST].
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] send a fatal error
alert message (illegal parameter or unsupported version), but it is
acceptable that the link:#abbr_TSF[TSF] terminate the session without
sending an error alert.
+
Use of the link:#abbr_TLS[TLS] 1.1 and below indicator as a redundant
mechanism where there is no configuration that actually processes the
value does not require additional testing, since this would be addressed
by link:#tls-client-obsolete-versions[Test FCS_TLSC_EXT.1:2.1] for
link:#FCS_TLSC_EXT.1.1[FCS_TLSC_EXT.1.1]. This test is only required if
the link:#abbr_TSF[TSF] responds differently (e.g., a different error
alert) when the downgrade indicator is present than when
link:#abbr_TLS[TLS] 1.1 or below is negotiated and the downgrade
indicator is not present.

[[FCS_TLSC_EXT.4]]
==== FCS_TLSC_EXT.4 TLS Client Support for Renegotiation

*_The inclusion of this selection-based component depends upon selection
in link:#FCS_TLS_EXT.1.1[FCS_TLS_EXT.1.1]._*

[[FCS_TLSC_EXT.4.1]]
link:#FCS_TLSC_EXT.4.1[FCS_TLSC_EXT.4.1]

The link:#abbr_TSF[TSF] shall support secure renegotiation through use
of [*selection*: [#_s_294 .selectable-content]#the “renegotiation_info”
link:#abbr_TLS[TLS] extension#, [#_s_295 .selectable-content]#the
TLS_EMPTY_RENEGOTIATION_INFO_SCSV signaling ciphersuite signaling value#
] in accordance with link:#abbr_RFC[RFC] 5746, and shall terminate the
session if an unexpected server hello is received or [*selection*:
[#_s_296 .selectable-content]#hello request message is received#,
[#_s_297 .selectable-content]#in no other case# ].

[.note-header]#Application Note: #[.note]# #

This link:#abbr_SFR[SFR] is claimed if "link:#abbr_TLS[TLS] as a client"
is selected in link:#FCS_TLS_EXT.1.1[FCS_TLS_EXT.1.1].

A client allowing link:#abbr_TLS[TLS] 1.2 connections may present either
the "renegotiation_info" extension or the signaling ciphersuite value
TLS_EMPTY_RENEGOTIATION_INFO_SCSV in the initial client hello message to
indicate support for secure renegotiation. The link:#abbr_ST[ST] author
claims the methods supported. The TLS_EMPTY_RENEGOTIATION_INFO_SCSV is
the preferred mechanism for link:#abbr_TLS[TLS] 1.2 protection against
insecure renegotiation when the client does not renegotiate. The
link:#abbr_ST[ST] author will claim the ‘hello request message is
received’ option in the second selection to indicate support for this
mechanism.

link:#abbr_RFC[RFC] 5746 allows the client to accept connections with
servers that do not support the extension; this link:#abbr_FP[FP]
refines link:#abbr_RFC[RFC] 5746 and requires the client to terminate
sessions with such servers. Thus, unexpected server hello messages
include an initial server hello negotiating link:#abbr_TLS[TLS] 1.2 that
does not contain a renegotiation_info extension, an initial server hello
negotiating link:#abbr_TLS[TLS] 1.2 that has a renegotiation_info that
is non-empty, a subsequent server hello negotiating link:#abbr_TLS[TLS]
1.2 that does not contain a renegotiation_info extension, and a
subsequent server hello negotiating link:#abbr_TLS[TLS] 1.2 that has a
renegotiation_info extension with an incorrect renegotiated_connection
value.

link:#abbr_TLS[TLS] 1.3 provides protection against insecure
renegotiation by not allowing renegotiation. If link:#abbr_TLS[TLS] 1.3
is claimed in link:#FCS_TLSC_EXT.1.1[FCS_TLSC_EXT.1.1], the client
receives a server hello that attempts to negotiate link:#abbr_TLS[TLS]
1.3, and the server hello also contains a renegotiation_info extension;
the client will terminate the connection.

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_TLSC_EXT.4[FCS_TLSC_EXT.4]

link:#abbr_TSS[TSS]

The evaluator shall examine the link:#abbr_ST[ST] to ensure that
link:#abbr_TLS[TLS] renegotiation protections are described in
accordance with the requirements. The evaluator shall ensure that any
configurable features of the renegotiation protections are identified.

Guidance

The evaluator shall examine the operational guidance to confirm that
instructions for any configurable features of the renegotiation
protection mechanisms are included.

Tests

The evaluator shall perform the following tests as indicated. One or
both of "tls-client-accepts-renegotiation" or
link:#tls-client-prevents-renegotiation[Test FCS_TLSC_EXT.4:2] is
required, depending on whether the link:#abbr_TSF[TSF] is configurable
to reject renegotiation or supports secure renegotiation methods defined
for link:#abbr_TLS[TLS] 1.2. If link:#abbr_TLS[TLS] 1.3 is supported,
link:#tls-client-prevents-renegotiation[Test FCS_TLSC_EXT.4:2] is
required. [.testlist-]##

* link:#tls-client-accepts-renegotiation[Test FCS_TLSC_EXT.4:1]:
[conditional] If the link:#abbr_TSF[TSF] supports a configuration to
accept renegotiation requests for link:#abbr_TLS[TLS] 1.2, the evaluator
shall follow any operational guidance to configure the
link:#abbr_TSF[TSF]. The evaluator shall perform the following tests:
[.testlist-]##
** link:#tls-client-offers-renegotiation[Test FCS_TLSC_EXT.4:1.1]: The
evaluator shall initiate a link:#abbr_TLS[TLS] connection with a test
server configured to negotiate a compliant link:#abbr_TLS[TLS] 1.2
handshake. The evaluator shall inspect the messages received by the test
link:#abbr_TLS[TLS] 1.2 server. The evaluator shall observe that either
the “renegotiation_info” field or the link:#abbr_SCSV[SCSV] ciphersuite
is included in the client hello message during the initial handshake.
** link:#_t_67[Test FCS_TLSC_EXT.4:1.2]: For each of the following
sub-tests, the evaluator shall initiate a new link:#abbr_TLS[TLS]
connection with a test link:#abbr_TLS[TLS] 1.2 server configured to send
a renegotiation_info extension as specified, but otherwise complete a
compliant link:#abbr_TLS[TLS] 1.2 session: [.testlist-]##
*** link:#_t_68[Test FCS_TLSC_EXT.4:1.2.1]: The evaluator shall
configure the test link:#abbr_TLS[TLS] 1.2 server to send a
renegotiation_info extension whose value indicates a non-zero length.
The evaluator shall confirm that the link:#abbr_TSF[TSF] terminates the
connection.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., illegal parameter) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).
*** link:#_t_69[Test FCS_TLSC_EXT.4:1.2.2]: The evaluator shall
configure the test link:#abbr_TLS[TLS] 1.2 server to send a compliant
renegotiation_info extension and observe the link:#abbr_TSF[TSF]
successfully completes the link:#abbr_TLS[TLS] 1.2 connection.
*** link:#_t_70[Test FCS_TLSC_EXT.4:1.2.3]: The evaluator shall initiate
a session renegotiation after completing a successful handshake with a
test link:#abbr_TLS[TLS] 1.2 server that completes a successful
link:#abbr_TLS[TLS] 1.2 handshake (as in
link:#tls-client-offers-renegotiation[Test FCS_TLSC_EXT.4:1.1]) and then
sends a hello reset request from the test link:#abbr_TLS[TLS] server
with a “renegotiation_info” extension that has an unexpected
“client_verify_data” or “server_verify_data” value (modify a byte from a
compliant response). The evaluator shall verify that the
link:#abbr_TSF[TSF] terminates the connection.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., illegal parameter, handshake error) in response to
this, but it is acceptable that the link:#abbr_TSF[TSF] terminates the
connection silently (i.e., without sending a fatal error alert).
* link:#tls-client-prevents-renegotiation[Test FCS_TLSC_EXT.4:2]:
[conditional] if the link:#abbr_TSF[TSF] supports a configuration that
prevents renegotiation, the evaluator shall perform the following tests:
[.testlist-]##
** link:#_t_72[Test FCS_TLSC_EXT.4:2.1]: (link:#abbr_TLS[TLS] 1.2)
[conditional] If the link:#abbr_TLS[TLS] supports a configuration to
reject link:#abbr_TLS[TLS] 1.2 renegotiation, the evaluator shall follow
the operational guidance as necessary to prevent renegotiation. The
evaluator shall initiate a link:#abbr_TLS[TLS] session between the
so-configured link:#abbr_TSF[TSF] and a test link:#abbr_TLS[TLS] 1.2
server that is configured to perform a compliant handshake, followed by
a hello reset request. The evaluator shall confirm that the
link:#abbr_TSF[TSF] completes the initial handshake successfully but
terminates the link:#abbr_TLS[TLS] session after receiving the hello
reset request.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., unexpected message) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).
** link:#_t_73[Test FCS_TLSC_EXT.4:2.2]: [conditional] If the
link:#abbr_TSF[TSF] supports link:#abbr_TLS[TLS] 1.3, the evaluator
shall initiate a link:#abbr_TLS[TLS] session between the
link:#abbr_TSF[TSF] and a test link:#abbr_TLS[TLS] 1.3 server that
completes a compliant link:#abbr_TLS[TLS] 1.3 handshake, followed by a
hello reset message. The evaluator shall observe that the
link:#abbr_TSF[TSF] completes the initial link:#abbr_TLS[TLS] 1.3
handshake successfully, but terminates the session on receiving the
hello reset message.
+
It is preferred that the link:#abbr_TSF[TSF] sends a fatal error alert
message (e.g., unexpected message) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).

[[FCS_TLSC_EXT.5]]
==== FCS_TLSC_EXT.5 TLS Client Support for Session Resumption

*_The inclusion of this selection-based component depends upon selection
in link:#FCS_TLSC_EXT.1.1[FCS_TLSC_EXT.1.1]._*

[[FCS_TLSC_EXT.5.1]]
link:#FCS_TLSC_EXT.5.1[FCS_TLSC_EXT.5.1]

The link:#abbr_TSF[TSF] shall support session resumption as a client via
the use of [*selection*: [#_s_298 .selectable-content]#session ID in
accordance with link:#abbr_RFC[RFC] 5246#,
[#_s_299 .selectable-content]#tickets in accordance with
link:#abbr_RFC[RFC] 5077#,
[#tlsc_v13_resumption .selectable-content]#PSK and tickets in accordance
with link:#abbr_RFC[RFC] 8446# ].

[.note-header]#Application Note: #[.note]# #

This link:#abbr_SFR[SFR] is claimed if "session resumption" is selected
in link:#FCS_TLSC_EXT.1.1[FCS_TLSC_EXT.1.1].

The link:#abbr_ST[ST] author indicates which session resumption
mechanisms are supported. One or both of the first two options, "session
ID in accordance with link:#abbr_RFC[RFC] 5246" and "tickets in
accordance with link:#abbr_RFC[RFC] 5077" are claimed for
link:#abbr_TLS[TLS] 1.2 resumption. If resumption of link:#abbr_TLS[TLS]
1.3 sessions is supported, "PSK and tickets in accordance with
link:#abbr_RFC[RFC] 8446" is selected, and the selection-based
link:#abbr_SFR[SFR] link:#FCS_TLSC_EXT.6[FCS_TLSC_EXT.6] must also be
claimed.

While it is possible to perform session resumption using PSK
ciphersuites in link:#abbr_TLS[TLS] 1.2, this is uncommon. Validation of
key exchange and session negotiation rules for PSK ciphersuites is
independent of the source of the pre-shared key and is covered in
link:#FCS_TLSC_EXT.1[FCS_TLSC_EXT.1].

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_TLSC_EXT.5[FCS_TLSC_EXT.5]

link:#abbr_TSS[TSS]

The evaluator shall examine the link:#abbr_ST[ST] and confirm that the
link:#abbr_TLS[TLS] client protocol description includes a description
of the supported resumption mechanisms.

Guidance

The evaluator shall ensure the operational guidance describes
instructions for any configurable features of the resumption mechanism.

Tests

The evaluator shall perform the following tests: [.testlist-]##

* link:#tls-client-successful-resumption[Test FCS_TLSC_EXT.5:1]: For
each supported link:#abbr_TLS[TLS] version and for each supported
resumption mechanism that is supported for that version, the evaluator
shall establish a new link:#abbr_TLS[TLS] session between the
link:#abbr_TSF[TSF] and a compliant test link:#abbr_TLS[TLS] server that
is configured to negotiate the indicated version and perform resumption
using the indicated mechanism. The evaluator shall confirm that the
link:#abbr_TSF[TSF] completes the initial link:#abbr_TLS[TLS] handshake
and shall cause the link:#abbr_TSF[TSF] to close the session normally.
The evaluator shall then cause the link:#abbr_TSF[TSF] to resume the
session with the test link:#abbr_TLS[TLS] server using the indicated
method and observe that the link:#abbr_TSF[TSF] successfully establishes
the session.
+
*Note:* For each method, successful establishment refers to proper use
of the mechanism, to include compliant extensions and behavior, as
indicated in the referenced link:#abbr_RFC[RFC].
* link:#_t_75[Test FCS_TLSC_EXT.5:2]: (link:#abbr_TLS[TLS] 1.3 session
id echo) [conditional] If the link:#abbr_TSF[TSF] supports
link:#abbr_TLS[TLS] 1.3, the evaluator shall initiate a new
link:#abbr_TLS[TLS] 1.3 session with a test link:#abbr_TLS[TLS] server.
The evaluator shall cause the test link:#abbr_TLS[TLS] server to send a
link:#abbr_TLS[TLS] 1.3 server hello message (or a hello retry request
if the link:#abbr_TSF[TSF] doesn’t include the key share extension) that
contains a different value in the legacy_session_id field, and observe
that the link:#abbr_TSF[TSF] terminates the session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., illegal parameter) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).

[[FCS_TLSC_EXT.6]]
==== FCS_TLSC_EXT.6 TLS Client TLS 1.3 Resumption Refinements

*_The inclusion of this selection-based component depends upon selection
in link:#FCS_TLSC_EXT.5.1[FCS_TLSC_EXT.5.1]._*

[[FCS_TLSC_EXT.6.1]]
link:#FCS_TLSC_EXT.6.1[FCS_TLSC_EXT.6.1]

The link:#abbr_TSF[TSF] shall send a psk_key_exchange_mode extension
with the value psk_dhe_ke when link:#abbr_TLS[TLS] 1.3 session
resumption is offered.

[[FCS_TLSC_EXT.6.2]]
link:#FCS_TLSC_EXT.6.2[FCS_TLSC_EXT.6.2]

The link:#abbr_TSF[TSF] shall not send early data in link:#abbr_TLS[TLS]
1.3 sessions.

[.note-header]#Application Note: #[.note]# #

This link:#abbr_SFR[SFR] is claimed if "PSK and tickets in accordance
with link:#abbr_RFC[RFC] 8446" is selected in
link:#FCS_TLSC_EXT.5.1[FCS_TLSC_EXT.5.1].

This link:#abbr_SFR[SFR] is claimed when session resumption is supported
for link:#abbr_TLS[TLS] 1.3. link:#abbr_RFC[RFC] 8446 allows pre-shared
keys to be used directly and also allows early data to be protected
using only the pre-shared key. This link:#abbr_SFR[SFR] refines the
link:#abbr_RFC[RFC] to use PSK only with a supplemental
link:#abbr_DHE[DHE] or link:#abbr_ECDHE[ECDHE] key exchange to ensure
perfect forward secrecy for all sessions.

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_TLSC_EXT.6[FCS_TLSC_EXT.6]

link:#abbr_TSS[TSS]

The evaluator shall examine the link:#abbr_TSS[TSS] to verify that the
link:#abbr_TLS[TLS] client protocol description indicates that the PSK
exchange requires link:#abbr_DHE[DHE] mode and prohibits sending early
data. The evaluator shall examine the link:#abbr_TSS[TSS] to verify it
lists all applications that can be secured by link:#abbr_TLS[TLS] 1.3
using pre-shared keys and describes how each link:#abbr_TLS[TLS] 1.3
client application ensures data for the application is not sent using
early data.

Guidance

The evaluator shall examine the operational guidance to verify that
instructions for any configurable features that are required to meet the
requirement are included. The evaluator shall ensure the operational
guidance includes any instructions required to configure applications so
the link:#abbr_TLS[TLS] 1.3 client implementation does not send early
data.

Tests

[conditional] For each application that is able to be secured via
link:#abbr_TLS[TLS] 1.3 using PSK, the evaluator shall follow
operational guidance to configure the application not to send early
data. The evaluator shall cause the application to initiate a resumed
link:#abbr_TLS[TLS] 1.3 session between the link:#abbr_TSF[TSF] and a
compliant test link:#abbr_TLS[TLS] 1.3 server as in
link:#tls-client-successful-resumption[Test FCS_TLSC_EXT.5:1] in
link:#FCS_TLSC_EXT.5[FCS_TLSC_EXT.5]. The evaluator shall observe that
the link:#abbr_TSF[TSF] client hello for link:#abbr_TLS[TLS] 1.3
includes the psk_mode extension with the value psk_dhe_ke and sends a
key share value for a supported group. The evaluator shall confirm that
early data is not received by the test link:#abbr_TLS[TLS] server.

*Note:* If no applications supported by the link:#abbr_TOE[TOE] provide
data to link:#abbr_TLS[TLS] 1.3 that can be sent using PSK, this test is
omitted.

[[FCS_TLSS_EXT.1]]
==== FCS_TLSS_EXT.1 TLS Server Protocol

*_The inclusion of this selection-based component depends upon selection
in link:#FCS_TLS_EXT.1.1[FCS_TLS_EXT.1.1]._*

[[FCS_TLSS_EXT.1.1]]
link:#FCS_TLSS_EXT.1.1[FCS_TLSS_EXT.1.1]

The link:#abbr_TSF[TSF] shall implement link:#abbr_TLS[TLS] 1.2
(link:#abbr_RFC[RFC] 5246) and [*selection*:
[#_s_301 .selectable-content]#link:#abbr_TLS[TLS] 1.3
(link:#abbr_RFC[RFC] 8446)#, [#_s_302 .selectable-content]#no other
link:#abbr_TLS[TLS] version# ] as a server that supports additional
functionality for session renegotiation protection and [*selection*:

* [#tlss_mutual_auth .selectable-content]#mutual authentication#
* [#tlss_downgrade_protection .selectable-content]#supplemental
downgrade protection#
* [#tlss_resumption .selectable-content]#session resumption#
* [#_s_306 .selectable-content]#no optional functionality#

] and shall reject connection attempts from clients supporting only
link:#abbr_TLS[TLS] 1.1, link:#abbr_TLS[TLS] 1.0, or SSL versions.

[.note-header]#Application Note: #[.note]# #

This link:#abbr_SFR[SFR] is claimed if "link:#abbr_TLS[TLS] as a server"
is selected in link:#FCS_TLS_EXT.1.1[FCS_TLS_EXT.1.1].

These requirements will be revisited as new link:#abbr_TLS[TLS] versions
are standardized by the link:#abbr_IETF[IETF].

Session renegotiation protection is required for both
link:#abbr_TLS[TLS] 1.2 and link:#abbr_TLS[TLS] 1.3, and the
link:#abbr_ST[ST] must include the requirements from
link:#FCS_TLSS_EXT.4[FCS_TLSS_EXT.4]. Within
link:#FCS_TLSS_EXT.4[FCS_TLSS_EXT.4], options for implementation of
secure session renegotiation for link:#abbr_TLS[TLS] 1.2 or rejecting
renegotiation requests are claimed.

If "mutual authentication" is selected, then the link:#abbr_ST[ST] must
additionally include the requirements from
link:#FCS_TLSS_EXT.2[FCS_TLSS_EXT.2]. If the link:#abbr_TOE[TOE]
implements mutual authentication, this selection must be made.

If "supplemental downgrade protection" is selected, then the
link:#abbr_ST[ST] must additionally include the requirements from
link:#FCS_TLSS_EXT.3[FCS_TLSS_EXT.3]. If the link:#abbr_TOE[TOE]
provides downgrade protection as indicated in link:#abbr_RFC[RFC] 8446,
in particular, if link:#abbr_TLS[TLS] 1.3 is supported, this selection
must be made.

If "session resumption" is selected, then the link:#abbr_ST[ST] must
additionally include the requirements from
link:#FCS_TLSS_EXT.5[FCS_TLSS_EXT.5].

[[FCS_TLSS_EXT.1.2]]
link:#FCS_TLSS_EXT.1.2[FCS_TLSS_EXT.1.2]

The link:#abbr_TSF[TSF] shall be able to support the following
link:#abbr_TLS[TLS] 1.2 ciphersuites: [*selection*:

* [#_s_307 .selectable-content]#TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
as defined in link:#abbr_RFC[RFC] 5289 and link:#abbr_RFC[RFC] 8422#
* [#_s_308 .selectable-content]#TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 5289 and link:#abbr_RFC[RFC] 8422#
* [#_s_309 .selectable-content]#TLS_RSA_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 5288#
* [#_s_310 .selectable-content]#TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 5288#
* [#_s_311 .selectable-content]#TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384
as defined in link:#abbr_RFC[RFC] 5289#
* [#_s_312 .selectable-content]#TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as
defined in link:#abbr_RFC[RFC] 5289#
* [#_s_313 .selectable-content]#TLS_RSA_WITH_AES_256_CBC_SHA256 as
defined in link:#abbr_RFC[RFC] 5246#
* [#_s_314 .selectable-content]#TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as
defined in link:#abbr_RFC[RFC] 5246#
* [#_s_315 .selectable-content]#TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
as defined in link:#abbr_RFC[RFC] 5289#
* [#_s_316 .selectable-content]#TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as
defined in link:#abbr_RFC[RFC] 5289#
* [#_s_317 .selectable-content]#TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256
as defined in link:#abbr_RFC[RFC] 5289#
* [#_s_318 .selectable-content]#TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as
defined in link:#abbr_RFC[RFC] 5289#
* [#_s_319 .selectable-content]#TLS_RSA_WITH_AES_128_CBC_SHA256 as
defined in link:#abbr_RFC[RFC] 5246#
* [#_s_320 .selectable-content]#TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as
defined in link:#abbr_RFC[RFC] 5246#
* [#_s_321 .selectable-content]#TLS_RSA_WITH_AES_128_CBC_SHA as defined
in link:#abbr_RFC[RFC] 5246#

], the following link:#abbr_PP[PP]-specific ciphersuites using
pre-shared secrets: [*selection*:

* [#_s_322 .selectable-content]#TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 8442#
* [#_s_323 .selectable-content]#TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 5487#
* [#_s_324 .selectable-content]#TLS_RSA_PSK_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 5487#
* [#_s_325 .selectable-content]#TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as
defined in link:#abbr_RFC[RFC] 8442#
* [#_s_326 .selectable-content]#TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as
defined in link:#abbr_RFC[RFC] 5487#
* [#_s_327 .selectable-content]#TLS_RSA_PSK_WITH_AES_128_GCM_SHA256 as
defined in link:#abbr_RFC[RFC] 5487#
* [#_s_328 .selectable-content]#no ciphersuites using pre-shared
secrets#

], and the following link:#abbr_TLS[TLS] 1.3 ciphersuites: [*selection*:

* [#_s_329 .selectable-content]#TLS_AES_256_GCM_SHA384 as defined in
link:#abbr_RFC[RFC] 8446#
* [#_s_330 .selectable-content]#TLS_AES_128_GCM_SHA256 as defined in
link:#abbr_RFC[RFC] 8446#
* [#_s_331 .selectable-content]#[*assignment*:
[.assignable-content]#other link:#abbr_TLS[TLS] 1.3 ciphersuites#]#
* [#_s_332 .selectable-content]#no link:#abbr_TLS[TLS] 1.3 ciphersuites#

] using a preference order based on [*selection*:
[#_s_333 .selectable-content]#link:#abbr_RFC[RFC] 9151 priority#,
[#_s_334 .selectable-content]#client hello ordering#,
[#_s_335 .selectable-content]#[*assignment*:
[.assignable-content]#additional priority#]# ].

[.note-header]#Application Note: #[.note]# #

The link:#abbr_ST[ST] author should select the ciphersuites that are
supported and must select at least one ciphersuite for each
link:#abbr_TLS[TLS] version supported. It is necessary to limit the
ciphersuites that can be used in an evaluated configuration
administratively on the server in the test environment. If
administrative steps need to be taken so that the ciphersuites
negotiated by the implementation are limited to those in this
requirement, then the appropriate instructions need to be contained in
the guidance.

The final selection indicates the link:#abbr_TOE[TOE]’s preference for
negotiating a ciphersuite. link:#abbr_RFC[RFC] 9151 indicates the
required ciphersuites for NSS systems and ‘link:#abbr_RFC[RFC] 9151
priority’ is claimed if those ciphersuites are selected whenever offered
by the client. In general, it is preferred that link:#abbr_GCM[GCM]
ciphersuites are selected over link:#abbr_CBC[CBC] ciphersuites,
link:#abbr_ECDHE[ECDHE] is selected over link:#abbr_RSA[RSA] and
link:#abbr_DHE[DHE], and SHA256 or SHA384 is selected over SHA1.

The ‘client hello ordering’ option is claimed if client priority is
considered; if both are claimed, the link:#abbr_ST[ST] author should
indicate which is primary and which is secondary, and whether the
priority scheme is configurable. If other priority schemes or if
tertiary priority is used, the link:#abbr_ST[ST] author will claim the
third option and describe the scheme in the link:#abbr_ST[ST].

Support for TLS_RSA_WITH_AES_128_CBC_SHA is not required despite being
mandated by link:#abbr_RFC[RFC] 5246.

[[FCS_TLSS_EXT.1.3]]
link:#FCS_TLSS_EXT.1.3[FCS_TLSS_EXT.1.3]

The link:#abbr_TSF[TSF] shall not establish a connection with a client
that does not indicate support for at least one of the supported
ciphersuites.

[[FCS_TLSS_EXT.1.4]]
link:#FCS_TLSS_EXT.1.4[FCS_TLSS_EXT.1.4]

The link:#abbr_TSF[TSF] shall be able to process the following
link:#abbr_TLS[TLS] client hello message extensions:

* signature_algorithms extension (link:#abbr_RFC[RFC] 8446) indicating
support for [*selection*:
** [#_s_336 .selectable-content]#ecdsa-secp384r1_sha384
(link:#abbr_RFC[RFC] 8446)#
** [#_s_337 .selectable-content]#rsa_pkcs1_sha384 (link:#abbr_RFC[RFC]
8446)#
+
], and [*selection*:
** [#_s_338 .selectable-content]#rsa_pss_pss_sha384 (link:#abbr_RFC[RFC]
8603)#
** [#_s_339 .selectable-content]#rsa_pss_rsae_sha384
(link:#abbr_RFC[RFC] 8603)#
** [#_s_340 .selectable-content]#[*assignment*:
[.assignable-content]#other non-deprecated signature algorithms#]#
** [#_s_341 .selectable-content]#no other signature algorithms#
+
]
* extended_master_secret extension (link:#abbr_RFC[RFC] 7627) enforcing
client support
* the following other extensions: [*selection*:
** [#_s_342 .selectable-content]#signature_algorithms_cert extension
(link:#abbr_RFC[RFC] 8446) indicating support for [*selection*: #
*** [#_s_343 .selectable-content]#ecdsa-secp384r1_sha384
(link:#abbr_RFC[RFC] 8446)#
*** [#_s_344 .selectable-content]#rsa_pkcs1_sha384 (link:#abbr_RFC[RFC]
8446)#
+
], and [*selection*:
*** [#_s_345 .selectable-content]#rsa_pss_pss_sha384
(link:#abbr_RFC[RFC] 8603)#
*** [#_s_346 .selectable-content]#rsa_pss_rsae_sha384
(link:#abbr_RFC[RFC] 8603)#
*** [#_s_347 .selectable-content]#rsa_pkcs1_sha256 (link:#abbr_RFC[RFC]
8446)#
*** [#_s_348 .selectable-content]#rsa_pss_rsae_sha256
(link:#abbr_RFC[RFC] 8446)#
*** [#_s_349 .selectable-content]#[*assignment*:
[.assignable-content]#other non-deprecated signature algorithms#]#
*** [#_s_350 .selectable-content]#no other signature algorithms#
+
]
** [#_s_351 .selectable-content]#supported_versions extension
(link:#abbr_RFC[RFC] 8446) indicating support for link:#abbr_TLS[TLS]
1.3#
** [#_s_352 .selectable-content]#supported_groups extension
(link:#abbr_RFC[RFC] 7919, link:#abbr_RFC[RFC] 8446) indicating support
for [*selection*: #
*** [#_s_353 .selectable-content]#secp256r1#
*** [#_s_354 .selectable-content]#secp384r1#
*** [#_s_355 .selectable-content]#secp521r1#
*** [#_s_356 .selectable-content]#ffdhe2048(256)#
*** [#_s_357 .selectable-content]#ffdhe3072(257)#
*** [#_s_358 .selectable-content]#ffdhe4096(258)#
*** [#_s_359 .selectable-content]#ffdhe6144(259)#
*** [#_s_360 .selectable-content]#ffdhe8192(260)#
+
]
** [#_s_361 .selectable-content]#key_share extension
(link:#abbr_RFC[RFC] 8446)#
** [#_s_362 .selectable-content]#no other extensions#
+
].

[.note-header]#Application Note: #[.note]# If support for
link:#abbr_TLS[TLS] 1.3 is claimed in
link:#FCS_TLSS_EXT.1.1[FCS_TLSS_EXT.1.1], the selections for
supported_versions, supported_groups, and key_share are claimed. Even if
support for link:#abbr_TLS[TLS] 1.3 is not claimed, if
link:#abbr_ECDHE[ECDHE] ciphersuites are claimed in
link:#FCS_TLSS_EXT.1.2[FCS_TLSS_EXT.1.2], the entry for supported_groups
is claimed. Support for additional extensions is acceptable. For
signature_algorithms and signature_algorithms_certs (if supported), at
least one of the signature schemes presented in the first sub-selection
is claimed. #

[[FCS_TLSS_EXT.1.5]]
link:#FCS_TLSS_EXT.1.5[FCS_TLSS_EXT.1.5]

The link:#abbr_TSF[TSF] shall perform key establishment for
link:#abbr_TLS[TLS] using [*selection*:

* [#_s_363 .selectable-content]#link:#abbr_RSA[RSA] with size
[*selection*: [#_s_364 .selectable-content]#2048#,
[#_s_365 .selectable-content]#3072#, [#_s_366 .selectable-content]#4096#
] bits and no other sizes#
* [#_s_367 .selectable-content]#Diffie-Hellman parameters with size
[*selection*: [#_s_368 .selectable-content]#2048#,
[#_s_369 .selectable-content]#3072#,
[#_s_370 .selectable-content]#4096#,
[#_s_371 .selectable-content]#6144#, [#_s_372 .selectable-content]#8192#
] bits and no other sizes#
* [#_s_373 .selectable-content]#Diffie-Hellman groups [*selection*:
[#_s_374 .selectable-content]#ffdhe2048#,
[#_s_375 .selectable-content]#ffdhe3072#,
[#_s_376 .selectable-content]#ffdhe4096#,
[#_s_377 .selectable-content]#ffdhe6144#,
[#_s_378 .selectable-content]#ffdhe8192# ] and no other groups,
consistent with the client's supported groups extension and
[*selection*: [#_s_379 .selectable-content]#key share#,
[#_s_380 .selectable-content]#no other# ] extension #
* [#_s_381 .selectable-content]#link:#abbr_ECDHE[ECDHE] parameters using
elliptic curves [*selection*: [#_s_382 .selectable-content]#secp256r1#,
[#_s_383 .selectable-content]#secp384r1#,
[#_s_384 .selectable-content]#secp521r1# ] and no other curves,
consistent with the client's supported groups extension and
[*selection*: [#_s_385 .selectable-content]#key share#,
[#_s_386 .selectable-content]#no other# ] extension and using
non-compressed formatting for points #

].

[.note-header]#Application Note: #[.note]# #

link:#abbr_TLS[TLS] 1.2 and link:#abbr_TLS[TLS] 1.3 perform key exchange
using different mechanisms. In link:#abbr_TLS[TLS] 1.2, the requirements
apply to the key exchange messages received by the server and optionally
(for link:#abbr_DHE[DHE] or link:#abbr_ECDHE[ECDHE] ciphersuites) sent
by the server. In link:#abbr_TLS[TLS] 1.3, the requirements apply to the
values of the key share extension contained in the client and server
hello messages. The options depend on the supported ciphersuites. For
each session, the key exchange method is consistent with the selected
ciphersuite (link:#abbr_TLS[TLS] 1.2), the supported groups extension
(link:#abbr_TLS[TLS] 1.3 and conditionally, link:#abbr_TLS[TLS] 1.2), or
the key share extension (link:#abbr_TLS[TLS] 1.3).

If the link:#abbr_ST[ST] lists an link:#abbr_RSA[RSA] ciphersuite in
link:#FCS_TLSS_EXT.1.2[FCS_TLSS_EXT.1.2], the link:#abbr_ST[ST] must
include the link:#abbr_RSA[RSA] selection in the requirement.

If the link:#abbr_ST[ST] lists a link:#abbr_DHE[DHE] ciphersuite in
link:#FCS_TLSS_EXT.1.2[FCS_TLSS_EXT.1.2], the link:#abbr_ST[ST] must
include the Diffie-Hellman selection for parameters of a certain size,
the Diffie-Hellman groups selection in support of link:#abbr_TLS[TLS]
1.2 exchanges, or both. The selection for "Diffie-Hellman parameters"
refers to the method defined by link:#abbr_RFC[RFC] 5246, section 7.4.3
where the server provides Diffie-Hellman parameters to the client. The
“Diffie-Hellman groups” selection indicates key exchange negotiation in
accordance with link:#abbr_RFC[RFC] 7919 using the supported groups
extension. link:#abbr_RFC[RFC] 7919 identifies particular Diffie-Hellman
groups, which are listed in the following selection. This option is the
preferred mechanism for link:#abbr_TLS[TLS] 1.2, and must be claimed if
link:#abbr_TLS[TLS] 1.3 link:#abbr_DHE[DHE] ciphersuites are supported.

If the link:#abbr_ST[ST] lists an link:#abbr_ECDHE[ECDHE] ciphersuite in
link:#FCS_TLSS_EXT.1.2[FCS_TLSS_EXT.1.2], the link:#abbr_ST[ST] must
include the selection for link:#abbr_ECDHE[ECDHE] using elliptic curves
in the requirement, consistent with the support indicated for the
supported groups extension in link:#FCS_TLSS_EXT.1.4[FCS_TLSS_EXT.1.4].

When link:#abbr_TLS[TLS] 1.3 is negotiated (if supported), the supported
group negotiated (a supported link:#abbr_DHE[DHE] or
link:#abbr_ECDHE[ECDHE] group) agrees with one of the client’s supported
groups and the supplied key share element, and the product’s key share
element is a member of the selected group. If the link:#abbr_TLS[TLS]
1.3 client does not initially provide a key share element for a group
supported by both the product and the client, the link:#abbr_TOE[TOE] is
expected to send a hello retry request message indicating the selected
group; the requirement for matching the group indicated in the client’s
hello message applies to the client’s hello message received in response
to the hello retry request message.

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_TLSS_EXT.1[FCS_TLSS_EXT.1]

link:#abbr_TSS[TSS]

The evaluator shall check the description of the implementation of this
protocol in the link:#abbr_TSS[TSS] to ensure the supported
link:#abbr_TLS[TLS] versions, features, ciphersuites, and extensions,
are specified in accordance with link:#abbr_RFC[RFC] 5246
(link:#abbr_TLS[TLS] 1.2) and link:#abbr_RFC[RFC] 8446
(link:#abbr_TLS[TLS] 1.3 and updates to link:#abbr_TLS[TLS] 1.2) as
appropriate. The evaluator shall check the description to see if beta
link:#abbr_TLS[TLS] 1.3 versions are supported.

The evaluator shall verify that ciphersuites indicated in
link:#FCS_TLSS_EXT.1.2[FCS_TLSS_EXT.1.2] are included in the
description, and that none of the following ciphersuites are supported:
ciphersuites indicating 'NULL,' 'RC2,' 'RC4,' 'DES,' 'IDEA,' or 'TDES'
in the encryption algorithm component, indicating 'anon,' or indicating
MD5 or link:#abbr_SHA[SHA] in the message digest algorithm component.

The evaluator shall verify that the link:#abbr_TLS[TLS] implementation
description includes the extensions as required in
link:#FCS_TLSS_EXT.1.4[FCS_TLSS_EXT.1.4].

The evaluator shall confirm that the link:#abbr_TLS[TLS] description
includes the number and types of certificates that can be installed to
represent the link:#abbr_TOE[TOE].

Guidance

The evaluator shall check the operational guidance to ensure that it
contains instructions on configuring the product so that the
link:#abbr_TSF[TSF] conforms to the requirements. If the
link:#abbr_ST[ST] indicates that beta versions of link:#abbr_TLS[TLS]
1.3 are supported for backward compatibility, the evaluator shall ensure
that the operational guidance provides instructions for disabling these
versions.

The evaluator shall review the operational guidance to ensure
instructions on installing certificates representing the
link:#abbr_TOE[TOE] are provided.

Tests

The evaluator shall perform the following tests: [.testlist-]##

* link:#_t_76[Test FCS_TLSS_EXT.1:1]: (supported link:#abbr_TLS[TLS] 1.2
configurations) The evaluator shall perform the following tests:
[.testlist-]##
** link:#tls-server-supported-configurations[Test FCS_TLSS_EXT.1:1.1]:
For each supported link:#abbr_TLS[TLS] 1.2 ciphersuite, the evaluator
shall send a compliant link:#abbr_TLS[TLS] 1.2 client hello with the
highest version or legacy version of 1.2 (value '03 03'), a single entry
in the ciphersuites field consisting of the specific ciphersuite, and no
supported version extension or key share extension. The evaluator shall
observe the link:#abbr_TSF[TSF]’s server hello indicates
link:#abbr_TLS[TLS] 1.2 in the highest version or legacy version field,
does not include a supported version or key share extension, and
indicates the specific ciphersuite in the ciphersuite field. If the
ciphersuite requires certificate-based authentication, the evaluator
shall observe that the link:#abbr_TSF[TSF] sends a valid certificate
representing the link:#abbr_TOE[TOE] and successfully completes the
link:#abbr_TLS[TLS] handshake.
+
*Note:* The ciphersuites TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 8442, TLS_DHE_PSK_WITH_AES_256_GCM_SHA384
as defined in link:#abbr_RFC[RFC] 5487,
TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as defined in link:#abbr_RFC[RFC]
8442, and TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as defined in
link:#abbr_RFC[RFC] 5487, if supported, do not require certificate-based
authentication of the server.
** link:#_t_78[Test FCS_TLSS_EXT.1:1.2]: (link:#abbr_TLS[TLS] 1.2
support for link:#abbr_TLS[TLS] 1.3 clients) [conditional] If the
link:#abbr_TSF[TSF] is configurable to support only link:#abbr_TLS[TLS]
1.2 (or if link:#abbr_TLS[TLS] 1.3 is not supported), and if the
link:#abbr_TSF[TSF] supports link:#abbr_DHE[DHE] or
link:#abbr_ECDHE[ECDHE] ciphersuites, the evaluator shall follow any
operational guidance instructions necessary to configure the
link:#abbr_TSF[TSF] to only support link:#abbr_TLS[TLS] 1.2. For each
supported link:#abbr_TLS[TLS] 1.2 ciphersuite with link:#abbr_DHE[DHE]
or link:#abbr_ECDHE[ECDHE] indicated as the key exchange method, the
evaluator shall send a client hello with the highest version or legacy
version of 1.2 (value '03 03'), a list of ciphersuites consisting of one
or more link:#abbr_TLS[TLS] 1.3 ciphersuites followed by the specific
link:#abbr_TLS[TLS] 1.2 ciphersuite and no other link:#abbr_TLS[TLS] 1.2
ciphersuites in the ciphersuites field, and including a
link:#abbr_TLS[TLS] 1.3 supported group and key share extension with
consistent values. The evaluator shall observe that the
link:#abbr_TSF[TSF]’s server hello indicates link:#abbr_TLS[TLS] 1.2 in
the highest version or legacy version field, does not include a
supported version or key share extension, and indicates the specific
link:#abbr_TLS[TLS] 1.2 ciphersuite in the ciphersuite field. The
evaluator shall observe that the link:#abbr_TSF[TSF] completes the
link:#abbr_TLS[TLS] 1.2 handshake successfully.
+
*Note:* Supported ciphersuites using link:#abbr_RSA[RSA] key exchange
should not be included in this test. The supported groups extension sent
by the test link:#abbr_TLS[TLS] client should be consistent with the
link:#abbr_TLS[TLS] 1.2 ciphersuite (e.g., it should be an EC group if
the ciphersuite is link:#abbr_ECDHE[ECDHE]).
** link:#_t_79[Test FCS_TLSS_EXT.1:1.3]: (link:#abbr_TLS[TLS] 1.3
support) [conditional] If the link:#abbr_TSF[TSF] supports
link:#abbr_TLS[TLS] 1.3, then for each supported link:#abbr_TLS[TLS] 1.3
ciphersuite and key exchange group, the evaluator shall send a compliant
link:#abbr_TLS[TLS] 1.3 client hello indicating a list of one or more
link:#abbr_TLS[TLS] 1.2 ciphersuites followed by the specific
link:#abbr_TLS[TLS] 1.3 ciphersuite and no other ciphersuites in the
ciphersuites field, a supported version extension indicating
link:#abbr_TLS[TLS] 1.3 (value '03 04') only, a supported groups
extension indicating the selected group, and a key share extension
containing a value representing an element of the specific group. The
evaluator shall observe the link:#abbr_TSF[TSF]’s server hello contains
the supported versions extension indicating link:#abbr_TLS[TLS] 1.3, the
specific ciphersuite in the selected ciphersuite field, and a key share
extension containing an element of the specific supported group. The
evaluator shall observe that the link:#abbr_TSF[TSF] completes the
link:#abbr_TLS[TLS] 1.3 handshake successfully.
+
*Note:* The connections in
link:#tls-server-supported-configurations[Test FCS_TLSS_EXT.1:1.1] may
be established as part of the establishment of a higher-level protocol,
e.g., as part of an link:#abbr_EAP[EAP] session.
+
It is sufficient to observe the successful negotiation of a ciphersuite
to satisfy the intent of the test; it is not necessary to examine the
characteristics of the encrypted traffic in an attempt to discern the
ciphersuite being used (for example, that the cryptographic algorithm is
128-bit link:#abbr_AES[AES] and not 256-bit link:#abbr_AES[AES]).
+
It is not necessary to pair every supported ciphersuite with every
supported group. It is sufficient to use a set of ciphersuite and
supported group pairs such that each ciphersuite and each supported
group are included in this set.
+
link:#abbr_TLS[TLS] 1.3 includes the supported_groups extension in the
encrypted_extensions message. This message may be observed at the test
client after it is decrypted to help verify the key_share is actually a
member of the supported group requested.
* link:#_t_80[Test FCS_TLSS_EXT.1:2]: (obsolete versions) The evaluator
shall perform the following tests: [.testlist-]##
** link:#tls-server-obsolete-versions[Test FCS_TLSS_EXT.1:2.1]: For each
of SSL version 2, SSL version 3, link:#abbr_TLS[TLS] version 1.0, and
link:#abbr_TLS[TLS] version 1.1, the evaluator shall send a client hello
to the link:#abbr_TSF[TSF] indicating the selected version as the
highest version. The evaluator shall observe the link:#abbr_TSF[TSF]
terminates the connection.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., protocol version, insufficient security) in
response to this, but it is acceptable that the link:#abbr_TSF[TSF]
terminates the connection silently (i.e., without sending a fatal error
alert).
** link:#tls-server-beta-versions[Test FCS_TLSS_EXT.1:2.2]: The
evaluator shall follow the operational guidance to configure the
link:#abbr_TSF[TSF] to ensure any supported beta link:#abbr_TLS[TLS] 1.3
versions are disabled, as necessary. The evaluator shall send the
link:#abbr_TSF[TSF] a client hello message indicating the supported
version (referred to as the legacy version in link:#abbr_RFC[RFC] 8446)
with the value '03 04' and observe that the link:#abbr_TSF[TSF] responds
with a server hello indicating the highest version supported.
+
*Note:* link:#tls-server-beta-versions[Test FCS_TLSS_EXT.1:2.2] is
intended to test the link:#abbr_TSF[TSF] response to non-standard
versions, including beta versions of link:#abbr_TLS[TLS] 1.3. If the
link:#abbr_TSF[TSF] supports such beta versions, the evaluator shall
follow the operational guidance instructions to disable them prior to
conducting link:#tls-server-beta-versions[Test FCS_TLSS_EXT.1:2.2].
+
Some link:#abbr_TLS[TLS] 1.3 implementations ignore the legacy version
field and only check for the supported_versions extension to determine
link:#abbr_TLS[TLS] 1.3 support by a client. It is preferred that the
legacy version field should still be set to a standard version ('03 03')
in the server hello, but it is acceptable that presence of the
supported_versions indicating link:#abbr_TLS[TLS] 1.3 (value '03 04')
overrides the legacy_version indication to determine highest supported
version.
* link:#_t_83[Test FCS_TLSS_EXT.1:3]: (ciphersuites) The evaluator shall
perform the following tests on handling unexpected ciphersuites using a
test link:#abbr_TLS[TLS] client sending handshake messages compliant
with the negotiated version except as indicated in the test:
[.testlist-]##
** link:#_t_84[Test FCS_TLSS_EXT.1:3.1]: (ciphersuite not supported) For
each supported version, the evaluator shall follow the operational
guidance, if available, to configure the link:#abbr_TSF[TSF] to disable
a supported ciphersuite. The evaluator shall send a compliant client
hello to the link:#abbr_TSF[TSF] indicating support for the specific
version and a ciphersuites field containing this single disabled
ciphersuite. The evaluator shall observe that the link:#abbr_TOE[TOE]
rejects the connection.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., handshake failure) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).
+
If the link:#abbr_TSF[TSF]’s ciphersuites are not configurable, it is
acceptable to use a named ciphersuite from the IANA link:#abbr_TLS[TLS]
protocols associated with the tested version. Additional special cases
of this test for special ciphersuites are performed separately.
** link:#tls-server-version-confusion[Test FCS_TLSS_EXT.1:3.2]: (version
confusion) For each supported version, the evaluator shall send a client
hello that is compliant for the specific version that includes a list of
ciphersuites consisting of a single ciphersuite not associated with that
version. The evaluator shall observe that the link:#abbr_TOE[TOE]
rejects the connection.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., handshake failure) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).
+
It is preferred that link:#tls-server-version-confusion[Test
FCS_TLSS_EXT.1:3.2] use link:#abbr_TLS[TLS] 1.3 ciphersuites for a
server negotiating link:#abbr_TLS[TLS] 1.2. If link:#abbr_TLS[TLS] 1.3
is supported, link:#tls-server-version-confusion[Test
FCS_TLSS_EXT.1:3.2] also includes a server negotiating
link:#abbr_TLS[TLS] 1.3 with a link:#abbr_TLS[TLS] 1.2 ciphersuite – in
this case, the negotiated ciphersuite should be chosen to be one
supported by the link:#abbr_TOE[TOE] if negotiating link:#abbr_TLS[TLS]
1.2. If the link:#abbr_TOE[TOE] is configurable to allow both
link:#abbr_TLS[TLS] 1.2 and link:#abbr_TLS[TLS] 1.3 clients (or does so
by default), this configuration is used for both the link:#abbr_TLS[TLS]
1.2 and link:#abbr_TLS[TLS] 1.3 iteration of this test; otherwise the
link:#abbr_TOE[TOE] is configured to support the negotiated version in
each iteration.
** link:#_t_86[Test FCS_TLSS_EXT.1:3.3]: (null ciphersuite) For each
supported version, the evaluator shall send a client hello indicating
support for the version and include a ciphersuite list consisting of
only the null ciphersuite (TLS_NULL_WITH_NULL_NULL, with the value '00
00') and observe that the link:#abbr_TOE[TOE] rejects the connection.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., handshake failure, insufficient security) in
response to this, but it is acceptable that the link:#abbr_TSF[TSF]
terminates the connection silently (i.e., without sending a fatal error
alert).
** link:#_t_87[Test FCS_TLSS_EXT.1:3.4]: (anon ciphersuite) The
evaluator shall send the link:#abbr_TSF[TSF] a link:#abbr_TLS[TLS] 1.2
handshake that is compliant, except that the ciphersuites field includes
a ciphersuite list consisting only of ciphersuites using the anonymous
server authentication method and observe that the link:#abbr_TOE[TOE]
rejects the connection.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., handshake failure, insufficient security) in
response to this, but it is acceptable that the link:#abbr_TSF[TSF]
terminates the connection silently (i.e., without sending a fatal error
alert).
+
See IANA link:#abbr_TLS[TLS] parameters for available ciphersuites to be
included in the client hello. The test ciphersuites list should include
ciphersuites using supported cryptographic algorithms in as many of the
other components as possible. For example, if the link:#abbr_TSF[TSF]
supports the ciphersuite TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384, the
evaluator should include TLS_DH_ANON_WITH_AES_256_GCM_SHA_384.
** link:#tls-server-deprecated-encryption[Test FCS_TLSS_EXT.1:3.5]:
(deprecated encryption algorithm) The evaluator shall send the
link:#abbr_TSF[TSF] a link:#abbr_TLS[TLS] 1.2 client hello that is
compliant, except that the ciphersuites field is a list consisting only
of ciphersuites indicating a deprecated encryption algorithm, including
at least one each of NULL, RC2, RC4, DES, IDEA, and TDES. The evaluator
shall observe that the link:#abbr_TOE[TOE] rejects the connection.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., handshake failure, insufficient security) in
response to this, but it is acceptable that the link:#abbr_TSF[TSF]
terminates the connection silently (i.e., without sending a fatal error
alert).
+
See IANA link:#abbr_TLS[TLS] parameters for available ciphersuites to be
included. The test ciphersuite should use supported cryptographic
algorithms for as many of the other components as possible. For example,
if the link:#abbr_TSF[TSF] supports
TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384, the test could include
TLS_ECDHE_PSK_WITH_NULL_SHA_384, TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5,
TLS_ECDHE_RSA_WITH_RC4_128_SHA, TLS_DHE_DSS_WITH_DES_CBC_SHA,
TLS_RSA_WITH_IDEA_CBC_SHA, and TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA.
* link:#_t_89[Test FCS_TLSS_EXT.1:4]: (extensions) [.testlist-]##
** link:#_t_90[Test FCS_TLSS_EXT.1:4.1]: (signature algorithms)
[conditional] If the link:#abbr_TSF[TSF] supports certificate-based
authentication, then for each supported signature algorithm indicated in
the link:#abbr_ST[ST], the evaluator shall perform the following
sub-tests with certificates that represent the link:#abbr_TOE[TOE]. For
each sub-test, the evaluator shall establish a certificate representing
the link:#abbr_TOE[TOE] and using a public-private key pair suitable for
the specific signature algorithm value, and signed by a certification
authority that uses the same signature algorithm.
+
If the link:#abbr_TSF[TSF] also supports the signature_algorithms_cert
extension, then for each value of the signature_algorithms_cert
extension, the evaluator shall repeat the sub-tests using a certificate
representing the link:#abbr_TOE[TOE] and using a key pair consistent
with the signature algorithm, but signed by a certification authority
using the signature algorithm specified in the signature_algorithms_cert
extension.
+
*Note:* The link:#abbr_TSF[TSF] supports certificate-based server
authentication if the link:#abbr_TLS[TLS] 1.2 supported ciphersuites
include ciphersuites other than TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 as
defined in link:#abbr_RFC[RFC] 8442, TLS_DHE_PSK_WITH_AES_256_GCM_SHA384
as defined in link:#abbr_RFC[RFC] 5487,
TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 as defined in link:#abbr_RFC[RFC]
8442, and TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 as defined in
link:#abbr_RFC[RFC] 5487. If these are the only supported ciphersuites,
this test is omitted. For link:#abbr_TLS[TLS] 1.3, certificate-based
server authentication, the client hello should not include the PSK
extension.
+
The evaluator shall follow operational guidance instructions to
provision the link:#abbr_TSF[TSF] with one or more of these certificates
as indicated in the following sub-tests:
+
[.testlist-]##
*** link:#tls-server-correct-signature[Test FCS_TLSS_EXT.1:4.1.1]:
(link:#abbr_TLS[TLS] 1.2) For each supported value of the
signature_algorithms extension, the evaluator shall provision a
certificate with a key pair compatible with the specific
signature_algorithm value and send the link:#abbr_TSF[TSF] a
link:#abbr_TLS[TLS] 1.2 client hello that indicates all supported
ciphersuites and has a signature_algorithms extension consisting of a
single value matching the specific signature algorithm.
+
If the link:#abbr_TSF[TSF] supports signature_algorithms_cert extension,
the client hello also contains the value consistent with the previsioned
certificate.
+
The evaluator shall observe that the link:#abbr_TSF[TSF] negotiates
link:#abbr_TLS[TLS] 1.2 with a link:#abbr_TLS[TLS] 1.2 ciphersuite that
is compatible with the signature algorithm, and that it sends a
certificate message containing the provisioned certificate with a key
pair that is consistent with the specific signature_algorithm value (and
signed using the signature_algorithms_cert extension value, if
supported).
+
*Note:* For link:#abbr_TLS[TLS] 1.2, the ciphersuite describes the
signature algorithm as link:#abbr_RSA[RSA] or link:#abbr_ECDSA[ECDSA]
and is compatible with the certificate used if the signature algorithm
component of the ciphersuite is of the same type as the signature value
of the signature_algorithms extension.
*** link:#tls-server-correct-1-3-signature[Test FCS_TLSS_EXT.1:4.1.2]:
[conditional] If the link:#abbr_TSF[TSF] supports link:#abbr_TLS[TLS]
1.3, then for each supported value of the signature_algorithm, the
evaluator shall provision a certificate with a key pair that is
compatible with the specific signature_algorithm value, send a
link:#abbr_TLS[TLS] 1.3 client hello that indicates a supported
ciphersuite and has a signature_algorithms extension consisting of a
single value matching the specific signature algorithm.
+
If the link:#abbr_TSF[TSF] supports the signature_algorithms_cert
extension, the client hello also contains a signature_algorithms_cert
extension with a value consistent with the provisioned certificate.
+
The evaluator shall observe that the link:#abbr_TSF[TSF] sends a
certificate message containing the provisioned certificate consistent
with the specific signature_algorithm value (and signed using the
signature_algorithms_cert extension value) and a certificate verify
message using the signature_algorithms extension value.
+
*Note:* For link:#abbr_TLS[TLS] 1.3, the certificate message and
certificate verify is encrypted. The evaluator confirms the values of
these messages as received at the test link:#abbr_TLS[TLS] client, using
logs, or using a test link:#abbr_TLS[TLS] client designed to expose the
certificates after they are decrypted.
+
It is not necessary to manually verify the signature used in the key
exchange message (link:#abbr_TLS[TLS] 1.2) or certificate verify message
(link:#abbr_TLS[TLS] 1.3).
*** link:#_t_93[Test FCS_TLSS_EXT.1:4.1.3]: [conditional] If the
link:#abbr_ST[ST] indicates that the link:#abbr_TSF[TSF] supports
provisioning of multiple certificates, the evaluator shall conduct the
following sub-tests: [.testlist-]##
**** link:#tls-server-mismatch-signature[Test FCS_TLSS_EXT.1:4.1.3.1]:
The evaluator shall repeat link:#tls-server-correct-signature[Test
FCS_TLSS_EXT.1:4.1.1] with both the provisioned certificate indicated
for link:#tls-server-correct-signature[Test FCS_TLSS_EXT.1:4.1.1] and a
provisioned certificate using a public key that is not consistent with
the signature_algorithm value, but signed by a link:#abbr_CA[CA] using
the signature algorithm specified in the client hello. The evaluator
shall observe that the link:#abbr_TSF[TSF]’s certificate message does
not include the certificate that does not match the signature_algorithm
value in the client hello.
**** link:#tls-server-mismatch-1-3-signature[Test
FCS_TLSS_EXT.1:4.1.3.2]: [conditional] If the link:#abbr_ST[ST] also
indicates support for link:#abbr_TLS[TLS] 1.3, the evaluator shall
similarly repeat link:#tls-server-correct-1-3-signature[Test
FCS_TLSS_EXT.1:4.1.2] with both the provisioned certificate indicated
for test link:#tls-server-correct-1-3-signature[Test
FCS_TLSS_EXT.1:4.1.2] and a provisioned certificate with public keys
that are not consistent with the signature_algorithm value but which are
signed by a link:#abbr_CA[CA] using the signature_algorithm value
specified in the client hello, and observe that the certificate message
sent by the link:#abbr_TSF[TSF] does not include the certificate that
does not match the value of the signature_algorithm entry in the client
hello.
**** link:#_t_96[Test FCS_TLSS_EXT.1:4.1.3.3]: [conditional] If the
link:#abbr_ST[ST] also indicates support for the
signature_algorithms_cert extension, the evaluator shall repeat
link:#tls-server-mismatch-signature[Test FCS_TLSS_EXT.1:4.1.3.1] and
link:#tls-server-mismatch-1-3-signature[Test FCS_TLSS_EXT.1:4.1.3.2] (if
link:#abbr_TLS[TLS] 1.3 is supported) using additional provisioned
certificates representing the link:#abbr_TOE[TOE] that use public keys
consistent with the signature_algorithm value, but which are signed by
CAs using signature algorithms that do not match the value of the
signature_algorithms_cert in the client hello and observe that the
link:#abbr_TSF[TSF]’s certificate message does not include the
certificate that does not match the signature_algorithms_cert values in
the client hello.
*** link:#_t_97[Test FCS_TLSS_EXT.1:4.1.4]: (link:#abbr_TLS[TLS] 1.2)
The evaluator shall provision a certificate as in
link:#tls-server-correct-signature[Test FCS_TLSS_EXT.1:4.1.1] but shall
send a client hello that only offers ciphersuites whose signature
component does not match the value of the signature_algorithms
extension. The evaluator shall observe that the link:#abbr_TSF[TSF]
terminates the handshake.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., handshake failure, illegal parameter) in response
to this, but it is acceptable that the link:#abbr_TSF[TSF] terminates
the connection silently (i.e., without sending a fatal error alert).
** link:#_t_98[Test FCS_TLSS_EXT.1:4.2]: (extended master secret): The
evaluator shall initiate a link:#abbr_TLS[TLS] 1.2 session with the
link:#abbr_TSF[TSF] from a test link:#abbr_TLS[TLS] client for which the
client hello does not include the extended master secret extension and
observe that the link:#abbr_TSF[TSF] terminates the session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., handshake error) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).
* link:#tls-server-key-exchange[Test FCS_TLSS_EXT.1:5]: (key exchange)
The evaluator shall perform the following tests to confirm compliant key
exchange: [.testlist-]##
** link:#_t_100[Test FCS_TLSS_EXT.1:5.1]: (link:#abbr_TLS[TLS] 1.2
link:#abbr_RSA[RSA] key exchange) [conditional] If any of the supported
link:#abbr_TLS[TLS] 1.2 ciphersuites in the link:#abbr_ST[ST] includes
link:#abbr_RSA[RSA] for the key exchange method, the evaluator shall
perform the following sub-tests: [.testlist-]##
*** link:#_t_101[Test FCS_TLSS_EXT.1:5.1.1]: For each supported
link:#abbr_RSA[RSA] key size, the evaluator shall provision the
link:#abbr_TSF[TSF] with a valid certificate that has an
link:#abbr_RSA[RSA] public key of that size. The evaluator shall
initiate a valid link:#abbr_TLS[TLS] 1.2 handshake from a compliant test
link:#abbr_TLS[TLS] 1.2 client and observe that the server certificate
message matches the provisioned certificate.
*** link:#_t_102[Test FCS_TLSS_EXT.1:5.1.2]: For each supported
link:#abbr_RSA[RSA] key size, the evaluator shall send the
link:#abbr_TSF[TSF] a compliant link:#abbr_TLS[TLS] 1.2 client hello,
but in place of the client’s key exchange message, the evaluator shall
send the link:#abbr_TSF[TSF] a (non-compliant) key exchange message that
is properly formatted but uses an invalid EncryptedPreMasterSecret field
in the link:#abbr_TLS[TLS] handshake (e.g., modify a byte of a properly
computed value). The evaluator shall attempt to complete the handshake
using compliant client change cipher spec and finished messages and
verify that the link:#abbr_TSF[TSF] terminates the handshake in a manner
that is indistinguishable from a finished message error and does not
send application data.
+
*Note:* Mitigations for oracle attacks described in link:#abbr_RFC[RFC]
5246 Appendix D require the link:#abbr_TSF[TSF] to exhibit the same
behavior for key exchange failures as it does for finished message
failures. It is preferred that the link:#abbr_TSF[TSF] send a fatal
decrypt failure error alert at the end of the handshake in both this
case and for a finished message error, but it is acceptable that the
link:#abbr_TSF[TSF] terminate the session with another error alert, or
without sending an error alert in either case. If the failure error
alert is not for a decryption failure, the evaluator shall note that the
link:#abbr_TSF[TSF]’s response agrees with the response observed in the
link:#abbr_TLS[TLS] 1.2 iteration of
link:#tls-server-rejects-bad-client-finished[Test FCS_TLSS_EXT.1:5.2].
** link:#tls-server-rejects-bad-client-finished[Test
FCS_TLSS_EXT.1:5.2]: For each supported version, the evaluator shall
initiate a compliant handshake up through the (implied for
link:#abbr_TLS[TLS] 1.3) change cipher spec message. The evaluator shall
then send a (non-compliant) client finished handshake message with an
invalid ‘verify data’ value and verify that the server terminates the
session and does not send any application data.
+
*Note:* link:#abbr_TLS[TLS] 1.2 handshakes include explicit change
cipher spec messages, but link:#abbr_TLS[TLS] 1.3 omits the change
cipher spec message. If link:#abbr_TLS[TLS] 1.3 is supported, the
modified finished message is sent as the final message from the client
after receiving the server’s second flight of handshake messages
[encrypted extensions, (new ticket), (certificate, certificate verify),
(certificate request)].
+
It is preferred that the link:#abbr_TSF[TSF] send a fatal decryption
failure error alert, but it is acceptable that the link:#abbr_TSF[TSF]
terminate the session using another error alert or without sending an
error alert.
+
The finished message is encrypted. The invalid ‘verify data’ can be
constructed by modifying a byte of a compliant finished message payload.
** link:#_t_104[Test FCS_TLSS_EXT.1:5.3]: (link:#abbr_TLS[TLS] 1.2
link:#abbr_DHE[DHE] or link:#abbr_ECDHE[ECDHE] key exchange)
[conditional] If the link:#abbr_ST[ST] indicates support for
link:#abbr_DHE[DHE] or link:#abbr_ECDHE[ECDHE] ciphersuites for
link:#abbr_TLS[TLS] 1.2, then the evaluator shall perform the following
sub-tests: [.testlist-]##
*** link:#_t_105[Test FCS_TLSS_EXT.1:5.3.1]: [conditional] If the
link:#abbr_TSF[TSF] supports link:#abbr_DHE[DHE] ciphersuites and
supports link:#abbr_DHE[DHE] parameters that are not specified in the
supported groups extension, then for each supported link:#abbr_DHE[DHE]
parameter set, the evaluator shall follow the operational guidance to
configure the link:#abbr_TSF[TSF] to use the link:#abbr_DHE[DHE]
parameters in its key exchange. The evaluator shall then initiate a
link:#abbr_TLS[TLS] 1.2 handshake from a test client with a client hello
indicating a single link:#abbr_DHE[DHE] ciphersuite. The evaluator shall
observe that the link:#abbr_TSF[TSF] key exchange message indicates the
configured parameters and ensure that the client key exchange is a valid
point for the parameter set. The evaluator shall confirm that the
link:#abbr_TSF[TSF] successfully completes the session.
+
The evaluator shall close the session and resend the client hello. After
the link:#abbr_TSF[TSF] responds with a valid key exchange message, the
evaluator shall send an empty client key exchange message and observe
that the link:#abbr_TSF[TSF] terminates the session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., decryption failure, illegal parameter, handshake
error) in response to this, but it is acceptable that the
link:#abbr_TSF[TSF] terminates the connection silently (i.e., without
sending a fatal error alert).
*** link:#_t_106[Test FCS_TLSS_EXT.1:5.3.2]: [conditional] If the
link:#abbr_TSF[TSF] supports link:#abbr_DHE[DHE] ciphersuites and
supports link:#abbr_DHE[DHE] groups in the supported groups extension,
then for each supported link:#abbr_DHE[DHE] group, the evaluator shall
send the link:#abbr_TSF[TSF] a compliant link:#abbr_TLS[TLS] 1.2 client
hello indicating a single ciphersuite that is compatible with the group
and indicating the group in the supported groups extension. The
evaluator shall observe that the link:#abbr_TSF[TSF] negotiates
link:#abbr_TLS[TLS] 1.2 using the indicated ciphersuite and that the
server key exchange message indicates the specific group. The evaluator
shall send the link:#abbr_TOE[TOE] a client key exchange with a valid
point in the group and observe that the link:#abbr_TSF[TSF] successfully
completes the session.
+
The evaluator shall close the session and resend the client hello. After
the link:#abbr_TSF[TSF] responds with a valid key exchange message, the
evaluator shall send the link:#abbr_TSF[TSF] a client key exchange with
the public key value '0.' The evaluator shall observe that the
link:#abbr_TSF[TSF] terminates the session.
+
The evaluator shall send a new client hello including the same
ciphersuite but indicating a group not supported by the
link:#abbr_TSF[TSF] in the supported groups extension. The evaluator
shall observe that the link:#abbr_TSF[TSF] terminates the session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., decryption failure, illegal parameter, handshake
error) in response to this, but it is acceptable that the
link:#abbr_TSF[TSF] terminates the connection silently (i.e., without
sending a fatal error alert).
*** link:#_t_107[Test FCS_TLSS_EXT.1:5.3.3]: [conditional] If the
link:#abbr_TSF[TSF] supports link:#abbr_ECDHE[ECDHE] ciphersuites (and
therefore supports link:#abbr_ECDHE[ECDHE] groups in the supported
groups extension), the evaluator shall send a client hello message
indicating a single supported link:#abbr_ECDHE[ECDHE] ciphersuite and
including the supported link:#abbr_ECDHE[ECDHE] group in the supported
groups extension. The evaluator shall observe that the
link:#abbr_TSF[TSF] sends a key exchange message with a valid point of
the specified group. The evaluator shall send the link:#abbr_TSF[TSF] a
client key exchange message to the link:#abbr_TSF[TSF] consisting of a
valid element in the supported group and observe that the
link:#abbr_TSF[TSF] successfully completes the session.
+
The evaluator shall close the session and resend the client hello. After
the link:#abbr_TSF[TSF] sends the valid key exchange message, the
evaluator shall send a client key exchange message consisting of an
invalid element of the supported group and observe that the
link:#abbr_TSF[TSF] terminates the handshake.
+
The evaluator shall send a third client hello to the link:#abbr_TSF[TSF]
indicating the supported link:#abbr_ECDHE[ECDHE] ciphersuite and
including an link:#abbr_ECDHE[ECDHE] group that is not supported. The
evaluator shall observe that the link:#abbr_TSF[TSF] terminates the
session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., decryption failure, illegal parameter, handshake
error, insufficient security) in response to this, but it is acceptable
that the link:#abbr_TSF[TSF] terminates the connection silently (i.e.,
without sending a fatal error alert).
+
An invalid link:#abbr_ECDSA[ECDSA] point consists of properly formatted
x and y components, but for which the equation of the curve is not
satisfied. To obtain an invalid point, the evaluator can modify a byte
of the y coordinate value of a valid point and confirm that the point is
not on the curve.
+
The IANA link:#abbr_TLS[TLS] parameters website lists registered
link:#abbr_ECDHE[ECDHE] groups for use in selecting a non-supported
group. If the link:#abbr_TSF[TSF] supports all registered
link:#abbr_ECDHE[ECDHE] groups, it is acceptable to send the client
hello without a supported groups extension. The link:#abbr_TSF[TSF]
should reject such a client hello, but it is acceptable for the
link:#abbr_TSF[TSF] to default to a supported group. In this case, the
link:#abbr_TSF[TSF] passes the test.
** link:#_t_108[Test FCS_TLSS_EXT.1:5.4]: (link:#abbr_TLS[TLS] 1.3 key
exchange) [conditional] If the link:#abbr_TSF[TSF] supports
link:#abbr_TLS[TLS] 1.3, then for each supported group the evaluator
shall perform the following sub-tests: [.testlist-]##
*** link:#_t_109[Test FCS_TLSS_EXT.1:5.4.1]: The evaluator shall send
the link:#abbr_TSF[TSF] a compliant link:#abbr_TLS[TLS] 1.3 client hello
indicating a single key share value from the supported group and shall
observe that the server hello includes valid elements of the supported
group.
*** link:#_t_110[Test FCS_TLSS_EXT.1:5.4.2]: The evaluator shall send
the link:#abbr_TSF[TSF] a link:#abbr_TLS[TLS] 1.3 client hello
indicating a supported groups value supported by the link:#abbr_TSF[TSF]
but containing a key share extension indicating an element claiming to
be in the supported group that does not represent a valid element of the
group. The evaluator shall observe that the link:#abbr_TSF[TSF]
terminates the session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., illegal parameter, handshake failure, decryption
failure) in response to this, but it is acceptable that the
link:#abbr_TSF[TSF] terminates the connection silently (i.e., without
sending a fatal error alert).
+
For link:#abbr_DHE[DHE] groups, the invalid element may be of the wrong
length; for link:#abbr_ECDHE[ECDHE] groups, the invalid element has
coordinates (x and y) that do not satisfy the equation of the elliptic
curve. To obtain an invalid link:#abbr_ECDHE[ECDHE] point, the evaluator
can modify a byte of the y coordinate value of a valid point and confirm
that the point is not on the curve.
** link:#tls-server-no-finished-msg[Test FCS_TLSS_EXT.1:5.5]: For each
supported version, the evaluator shall initiate a link:#abbr_TLS[TLS]
handshake from a test link:#abbr_TLS[TLS] client with compliant
handshake messages negotiating the version and supported parameters to
include the change cipher spec message (implied for link:#abbr_TLS[TLS]
1.3), but which omits the finished message and instead sends an
application message containing random data. The evaluator shall observe
that the link:#abbr_TSF[TSF] terminates the connection.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., decryption failure) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).
+
Application data is indicated by the TLSCipherText ContentType field
having value 23 (application data). The legacy record version '03 03'
and length fields should match a valid TLSCipherText message of the same
size.

[[FCS_TLSS_EXT.2]]
==== FCS_TLSS_EXT.2 TLS Server Support for Mutual Authentication

*_The inclusion of this selection-based component depends upon selection
in link:#FCS_TLSS_EXT.1.1[FCS_TLSS_EXT.1.1]._*

[[FCS_TLSS_EXT.2.1]]
link:#FCS_TLSS_EXT.2.1[FCS_TLSS_EXT.2.1]

The link:#abbr_TSF[TSF] shall support authentication of
link:#abbr_TLS[TLS] clients using X.509v3 certificates during the
link:#abbr_TLS[TLS] handshake and [*selection*:
[#_s_387 .selectable-content]#during post-handshake requests#,
[#_s_388 .selectable-content]#at no other time# ] using the certificate
types indicated in the client’s signature_algorithms and [*selection*:
[#_s_389 .selectable-content]#signature_algorithms_cert#,
[#_s_390 .selectable-content]#no other# ] extension.

[.note-header]#Application Note: #[.note]# #

This link:#abbr_SFR[SFR] is claimed if "mutual authentication" is
selected in link:#FCS_TLSS_EXT.1.1[FCS_TLSS_EXT.1.1].

link:#abbr_TLS[TLS] 1.3 supports authentication after completing the
abbreviated handshake with pre-shared keys. A server may send a client a
certificate request after the finished message whenever the client
includes the post-handshake authentication extension. The
link:#abbr_ST[ST] author claims ‘during post-handshake request’ if this
feature is supported. If link:#abbr_TLS[TLS] 1.3 is not supported, or if
the link:#abbr_TLS[TLS] post-handshake request extension is not
recognized in a link:#abbr_TLS[TLS] 1.3 handshake, the link:#abbr_ST[ST]
author selects ‘at no other time’.

[[FCS_TLSS_EXT.2.2]]
link:#FCS_TLSS_EXT.2.2[FCS_TLSS_EXT.2.2]

The link:#abbr_TSF[TSF] shall support authentication of
link:#abbr_TLS[TLS] clients using X.509v3 certificates in accordance
with [.no-link]#FIA_X509_EXT.1#.

[[FCS_TLSS_EXT.2.3]]
link:#FCS_TLSS_EXT.2.3[FCS_TLSS_EXT.2.3]

The link:#abbr_TSF[TSF] shall be able to reject the establishment of a
trusted channel if the requested client certificate is invalid and
[*selection*:

* [#_s_391 .selectable-content]#continue establishment of a server-only
authenticated link:#abbr_TLS[TLS] channel in accordance with
link:#FCS_TLSS_EXT.1[FCS_TLSS_EXT.1] in support of [*selection*:
[#_s_392 .selectable-content]#all applications#,
[#_s_393 .selectable-content]#[*assignment*: [.assignable-content]#list
of calling applications that accept both authenticated and
unauthenticated client sessions#]# ] when an empty certificate message
is provided by the client#
* [#_s_394 .selectable-content]#continue establishment of a mutually
authenticated link:#abbr_TLS[TLS] channel when revocation status
information for the [*selection*: [#_s_395 .selectable-content]#client's
leaf certificate#, [#_s_396 .selectable-content]#[*assignment*:
[.assignable-content]#specific intermediate link:#abbr_CA[CA]
certificates#]#, [#_s_397 .selectable-content]#any non-trust store
certificate in the certificate chain# ] is not available in support of
[*selection*: [#_s_398 .selectable-content]#all applications#,
[#_s_399 .selectable-content]#[*assignment*: [.assignable-content]#list
of calling applications configurable to perform certificate status
information bypass processing#]# ] as [*selection*:
[#_s_400 .selectable-content]#configured by an administrator#,
[#_s_401 .selectable-content]#confirmed by the application user#,
[#_s_402 .selectable-content]#a default for [*assignment*:
[.assignable-content]#subset of applications#]# ] #
* [#_s_403 .selectable-content]#no other processing options for missing
or invalid client certificates#

].

[.note-header]#Application Note: #[.note]# #

The link:#abbr_ST[ST] author claims any certificate processing
exceptions that are allowed for specific calling applications. The
‘continue establishment of a server-only authenticated
link:#abbr_TLS[TLS] channel…’ selection is claimed if the
link:#abbr_TLS[TLS] product supports applications that can provide
services to unauthenticated users if the user does not possess an
appropriate certificate. Within this selection, the link:#abbr_ST[ST]
author indicates which applications are able to support both
authenticated and unauthenticated users.

The link:#abbr_ST[ST] author claims ‘continue establishment of a
mutually authenticated link:#abbr_TLS[TLS] channel…’ if there is an
administrator configuration or user confirmation that revocation status
information is not available for one or more of the certificates in the
client’s certificate chain. If claimed, the link:#abbr_ST[ST] author
will describe in the assignment for intermediate values which
link:#abbr_CA[CA] certificates are included in the exception (for
example, “all intermediates but the issuing link:#abbr_CA[CA]” or
“specific end-entity certificates as configured”). Within this
selection, the link:#abbr_ST[ST] author specifies which applications are
impacted and which authorized user is allowed to approve continuing with
the session when revocation information is not available. If an
administrator configures whether a user may accept a certificate without
status information, both selections are claimed. The ‘as a default’
should only be selected for applications that do not have access to
revocation information. Methods for obtaining revocation information are
included in [.no-link]#FIA_X509_EXT.1#.

[[FCS_TLSS_EXT.2.4]]
link:#FCS_TLSS_EXT.2.4[FCS_TLSS_EXT.2.4]

The link:#abbr_TSF[TSF] shall be able to [*selection*:

* [#_s_404 .selectable-content]#not establish a link:#abbr_TLS[TLS]
session if an entry of the Distinguished Name or a [*selection*:
[#_s_405 .selectable-content]#rfc822_name#,
[#_s_406 .selectable-content]#dns_name#,
[#_s_407 .selectable-content]#[*assignment*:
[.assignable-content]#supported name types#]# ] in the Subject Alternate
Name extension contained in the client certificate does not match one of
the expected identifiers for the client in accordance with [*selection*:
[#_s_408 .selectable-content]#link:#abbr_RFC[RFC] 2822#,
[#_s_409 .selectable-content]#link:#abbr_RFC[RFC] 6125#,
[#_s_410 .selectable-content]#link:#abbr_RFC[RFC] 5280#,
[#_s_411 .selectable-content]#[*assignment*:
[.assignable-content]#link:#abbr_RFC[RFC] for the supported name type#]#
] matching rules#
* [#_s_412 .selectable-content]#pass the [*selection*:
[#_s_413 .selectable-content]#validated certificate#,
[#_s_414 .selectable-content]#link:#abbr_RFC[RFC] 2822 name normalized
according to link:#abbr_RFC[RFC] 2822#,
[#_s_415 .selectable-content]#link:#abbr_DNS[DNS] name normalized
according to link:#abbr_RFC[RFC] 6125#,
[#_s_416 .selectable-content]#[*assignment*: [.assignable-content]#list
of link:#abbr_RFC[RFC] 5280 name types and normalization rules#]#,
[#_s_417 .selectable-content]#[*assignment*: [.assignable-content]#list
of 'other' name types and standard normalization rules#]# ] to
[*assignment*: [.assignable-content]#list of calling applications
capable of making access decisions#]#

].

[.note-header]#Application Note: #[.note]# #

Authorization for services provided by the applications that are
protected by the link:#abbr_TLS[TLS] session is determined either by the
application establishing a set of reference identifiers or by passing
the received identifiers to the application. The link:#abbr_ST[ST]
author indicates the methods supported and, for each method supported,
indicates all name types supported; at least one name type is required.
In the assignment of the first option, the link:#abbr_ST[ST] author
indicates all name types and the corresponding method for matching in
the sub-selections. In the second method option, the link:#abbr_ST[ST]
author indicates which name type normalizations the product supports. If
the product passes the entire validated certificate to the application,
no normalization of the names contained in the certificate is expected.

If name normalization is claimed, care should be taken regarding
wildcards and link:#abbr_IP[IP] addresses. link:#abbr_IP[IP] addresses
embedded in link:#abbr_DNS[DNS] host names and in Directory Name
link:#abbr_CN[CN] components have been observed to include non-standard
wildcard designations including the ‘*’ character. Any embedded
link:#abbr_IP[IP] addresses should use standard CIDR notation and should
not include nonstandard encoding.

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_TLSS_EXT.2[FCS_TLSS_EXT.2]

link:#abbr_TSS[TSS]

The evaluator shall ensure that the link:#abbr_TSS[TSS] description
required per [.no-link]#FIA_X509_EXT.2.1# includes the use of
client-side certificates for link:#abbr_TLS[TLS] mutual authentication,
and that the description includes any certificate validation exception
rules and the name types supported for matching to reference identifiers
for all applications that use link:#abbr_TLS[TLS]. The evaluator shall
examine the link:#abbr_TSS[TSS] to ensure that any
link:#abbr_CN[CN]-embedded name types that are used include a
description of the encoding and matching rules.

Guidance

The evaluator shall verify that the operational guidance includes
instructions for configuring trust stores for client-side certificates
used in link:#abbr_TLS[TLS] mutual authentication. The evaluator shall
ensure that the operational guidance includes instructions for
configuring the server to require mutual authentication of clients using
these certificates and for configuring any certificate validation
exception rules. The evaluator shall ensure that the operational
guidance includes instructions for configuring reference identifiers
normalized or matched by the link:#abbr_TSF[TSF] and matching rules for
the supported name types.

Tests

The evaluator shall use link:#abbr_TLS[TLS] as a function to verify that
the validation rules in [.no-link]#FIA_X509_EXT.1# are adhered to and
shall perform the tests listed below. The evaluator shall apply the
operational guidance to configure the server to require
link:#abbr_TLS[TLS] mutual authentication of clients for these tests
unless overridden by instructions in the test activity.

*Note:* link:#abbr_TLS[TLS] 1.3 is a fundamentally different protocol
than link:#abbr_TLS[TLS] 1.2, so even though the certificate validation
and name checking tests are identical for both versions, it is likely
that early deployments of link:#abbr_TLS[TLS] 1.3 may use a different
code-base that warrants independent testing. If link:#abbr_TLS[TLS] 1.3
is supported and the evaluator can verify that the link:#abbr_TSF[TSF]
uses the same code-base for certificate validation and name checking for
both link:#abbr_TLS[TLS] 1.3 and link:#abbr_TLS[TLS] 1.2, it is
acceptable that testing be performed for only one version for these
tests.

[.testlist-]##

* link:#_t_112[Test FCS_TLSS_EXT.2:1]: For each supported version, the
evaluator shall follow the operational guidance to configure the
link:#abbr_TOE[TOE] to require valid client authentication with no
exceptions and initiate a link:#abbr_TLS[TLS] session from a compliant
link:#abbr_TLS[TLS] test client supporting that version. The evaluator
shall ensure that the test client sends a certificate_list structure
which has a length of zero. The evaluator shall verify the
link:#abbr_TSF[TSF] terminates the session and no application data
flows.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., handshake failure, bad certificaate, unknown
certificate, unknown link:#abbr_CA[CA]) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).
* link:#_t_113[Test FCS_TLSS_EXT.2:2]: [conditional] If the
link:#abbr_ST[ST] indicates that the link:#abbr_TSF[TSF] supports
establishment of a link:#abbr_TLS[TLS] session for missing or invalid
certificates, then for each supported version, and for each supported
response option for a missing or invalid certificate indicated in
link:#FCS_TLSS_EXT.2.3[FCS_TLSS_EXT.2.3], the evaluator shall configure
the link:#abbr_TSF[TSF] according to the operational guidance to respond
as indicated for the calling application. The evaluator shall send
client handshake messages from a test link:#abbr_TLS[TLS] client as
indicated for each sub-test. The evaluator shall perform the following
sub-tests: [.testlist-]##
** link:#_t_114[Test FCS_TLSS_EXT.2:2.1]: [conditional]: If the
link:#abbr_TSF[TSF] supports non-authenticated session establishment
when receiving an empty certificate message, the evaluator shall
initiate a link:#abbr_TLS[TLS] handshake from a compliant test
link:#abbr_TLS[TLS] client supporting the version and providing a
certificate message containing a certificate_list structure of length
zero. The evaluator shall confirm that the link:#abbr_TSF[TSF] notifies
the calling application that the user is unauthenticated.
+
*Note:* Specific procedures for determining that the calling application
is notified will vary based on the application. If an API to the calling
application is not available, the evaluator may attempt to configure the
calling application to provide a different response (e.g., require
authentication for flagged data) for authenticated and non-authenticated
users and make a request at the test client that results in a response
indicating the application is treating the client as non-authenticated.
** link:#_t_115[Test FCS_TLSS_EXT.2:2.2]: [conditional] If the
link:#abbr_TSF[TSF] supports exceptions for when revocation status
information is unavailable, then the evaluator shall follow the
operational guidance to attempt to establish a narrowly defined
exception for which both exempt and non-exempt certificates can be
established. The evaluator shall establish a primary certificate chain
for the test client that only exhibits the allowed exception and one or
more alternate certificate chains for the test client that do not pass
the exception rule, as necessary to test the boundaries of the exception
rules.
+
The evaluator shall follow the operational guidance to remove any cached
revocation status information for the test client’s primary certificate
chain. The evaluator shall initiate a valid link:#abbr_TLS[TLS] session
from the test client that presents the primary certificate for the test
client, provide any feedback requested by the link:#abbr_TSF[TSF] to
confirm the exception, and observe that the link:#abbr_TSF[TSF] allows
the certificate and completes the link:#abbr_TLS[TLS] handshake
successfully.
+
For each alternate certificate chain, the evaluator shall repeat the
session initiation from the test client but present the alternate
certificate chain and observe that the link:#abbr_TSF[TSF] terminates
the session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., bad certificate, unknown certificate, access
denied, handshake error) in response to this, but it is acceptable that
the link:#abbr_TSF[TSF] terminates the connection silently (i.e.,
without sending a fatal error alert).
+
The alternate certificate chains are intended to test the boundaries of
the exception rules. For example, if the exception rule indicates that
only leaf certificates are exempt, the evaluator will include an
alternate certificate chain for which a link:#abbr_CA[CA] certificate’s
revocation information is advertised but is not available; if the
exception can be configured for an explicit leaf certificate, or
particular subjects, an alternate chain will be included that does not
include an excepted certificate or subject. If the exception rules can
be configured for all certificates having advertised revocation
information, an alternate certificate chain can include an expired
certificate – only one additional validity failure (e.g., expired
certificate) is required in this case. More comprehensive validity
failure handling is addressed by testing for [.no-link]#FIA_X509_EXT.1#.
* link:#_t_116[Test FCS_TLSS_EXT.2:3]: For each supported version, the
evaluator shall configure the link:#abbr_TSF[TSF] to negotiate the
version and require client authentication and perform the following
steps:
** For each supported name matching method indicated in the outer
selection of link:#FCS_TLSS_EXT.2.4[FCS_TLSS_EXT.2.4], and for each name
type supported by the matching method as indicated in the
inner-selections claimed in each outer selection, the evaluator shall
establish a valid primary certificate chain with single names for a test
client containing only the supported name types and a valid alternate
certificate chain with single names indicating a different name of the
same type.
** [conditional] If any of the supported name types include
link:#abbr_CN[CN] encoding of a name type also supported as a
link:#abbr_SAN[SAN] entry, the evaluator shall establish additional
certificate chains:
*** The evaluator shall establish a primary certificate chain with
multiple names, to include a leaf certificate with:
**** a link:#abbr_SAN[SAN] entry that matches the name in the primary
certificate chain with single names, of the same link:#abbr_SAN[SAN]
name type; and
**** a link:#abbr_CN[CN] entry encoding the same link:#abbr_SAN[SAN]
type which matches the name in the alternate certificate chain with
single names of the link:#abbr_CN[CN] encoding of the same
link:#abbr_SAN[SAN] name type;
*** The evaluator shall establish an alternate certificate chain with
multiple names, to include a leaf certificate with:
**** A link:#abbr_SAN[SAN] entry that matches the name in the alternate
certificate chain with single names, of the same link:#abbr_SAN[SAN]
name type; and
**** a link:#abbr_CN[CN] entry encoding the same link:#abbr_SAN[SAN]
type which matches the name in the primary certificate chain with single
names, of the link:#abbr_CN[CN] encoding of the same link:#abbr_SAN[SAN]
name type.
** [conditional] If any of the supported name types include
link:#abbr_CN[CN] encoding, the evaluator shall follow the operational
guidance to configure the link:#abbr_TSF[TSF], establishing trust in the
root link:#abbr_CA[CA] for all primary and alternate certificate chains.
The evaluator shall configure the link:#abbr_TSF[TSF] and any relevant
link:#abbr_TOE[TOE] applications that use link:#abbr_TLS[TLS] for client
authentication as necessary to establish reference identifiers that
match the names in the client’s primary certificate chains with single
names, but not matching any of the names in the alternate certificate
chains with single names.
** For each primary certificate chain (with single or multiple names),
the evaluator shall initiate a link:#abbr_TLS[TLS] session from the test
link:#abbr_TLS[TLS] client that is configured to present the primary
certificate chain in a certificate message and a valid certificate
verify message in response to the server’s certificate request message.
The evaluator shall confirm that the link:#abbr_TSF[TSF] accepts the
certificate and completes the authenticated link:#abbr_TLS[TLS] session
successfully.
** For each alternate certificate chain (with single or multiple names),
the evaluator shall initiate a link:#abbr_TLS[TLS] session from the test
link:#abbr_TLS[TLS] client that is configured to present the alternate
certificate chain in a certificate message and a valid certificate
verify message in response to the server’s certificate request message.
The evaluator shall confirm that the link:#abbr_TSF[TSF] terminates the
session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., access denied) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).
+
The intent of this test is to confirm that for each method that the
link:#abbr_TSF[TSF] uses to match name types presented in validated
certificates, it is able to recognize both matching and non-matching
names. Names of special types implicitly encoded in the
link:#abbr_CN[CN] entry of the certificate subject name are especially
prone to error since they may only be validated by the issuing
link:#abbr_CA[CA] as a directory name (RDN) type, especially if the
issuing link:#abbr_CA[CA] is unaware of the intended encoding as a
different name type. It is a best practice that when the
link:#abbr_CN[CN] is interpreted as an embedded name type other than
RDN, an explicitly encoded link:#abbr_SAN[SAN] entry should take
precedence.

[[FCS_TLSS_EXT.3]]
==== FCS_TLSS_EXT.3 TLS Server Downgrade Protection

*_The inclusion of this selection-based component depends upon selection
in link:#FCS_TLSS_EXT.1.1[FCS_TLSS_EXT.1.1]._*

[[FCS_TLSS_EXT.3.1]]
link:#FCS_TLSS_EXT.3.1[FCS_TLSS_EXT.3.1]

The link:#abbr_TSF[TSF] shall set the server hello extension to a random
value concatenated with the link:#abbr_TLS[TLS] 1.2 downgrade indicator
when negotiating link:#abbr_TLS[TLS] 1.2 as indicated in
link:#abbr_RFC[RFC] 8446 section 4.1.3.

[.note-header]#Application Note: #[.note]# #

This link:#abbr_SFR[SFR] is claimed if "supplemental downgrade
protection" is selected in link:#FCS_TLSS_EXT.1.1[FCS_TLSS_EXT.1.1].

link:#abbr_RFC[RFC] 8446 requires both the link:#abbr_TLS[TLS] 1.2
downgrade indicator as well as an indicator for link:#abbr_TLS[TLS] 1.1
and below. This link:#abbr_FP[FP] requires the server to reject attempts
to establish link:#abbr_TLS[TLS] 1.1 and below, making this mechanism
redundant. However, products may still implement both indicators to be
compliant with the link:#abbr_RFC[RFC].

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_TLSS_EXT.3[FCS_TLSS_EXT.3]

link:#abbr_TSS[TSS]

The evaluator shall examine the link:#abbr_ST[ST] and confirm that the
link:#abbr_TLS[TLS] description includes details on the session
downgrade protections that are supported.

Guidance

The evaluator shall examine the operational guidance to confirm that
instructions are included to configure the link:#abbr_TSF[TSF] to
support only link:#abbr_TLS[TLS] 1.3 and to provide the associated
downgrade indications.

Tests

The evaluator shall follow the operational guidance as necessary to
configure the link:#abbr_TSF[TSF] to negotiate only link:#abbr_TLS[TLS]
1.3 and to provide the associated downgrade indications. The evaluator
shall send a link:#abbr_TLS[TLS] client hello to the link:#abbr_TOE[TOE]
that indicates support for only link:#abbr_TLS[TLS] 1.2. The evaluator
shall observe that the link:#abbr_TSF[TSF] sends a server hello with the
last eight bytes of the server random value equal to 44 4F 57 4E 47 52
44 01.

[[FCS_TLSS_EXT.4]]
==== FCS_TLSS_EXT.4 TLS Server Support for Renegotiation

*_The inclusion of this selection-based component depends upon selection
in link:#FCS_TLS_EXT.1.1[FCS_TLS_EXT.1.1]._*

[[FCS_TLSS_EXT.4.1]]
link:#FCS_TLSS_EXT.4.1[FCS_TLSS_EXT.4.1]

The link:#abbr_TSF[TSF] shall support secure renegotiation through the
use of [*selection*: [#_s_418 .selectable-content]#the
"renegotiation_info" link:#abbr_TLS[TLS] extension#,
[#_s_419 .selectable-content]#not allowing session renegotiation# ] in
accordance with link:#abbr_RFC[RFC] 5746.

[[FCS_TLSS_EXT.4.2]]
link:#FCS_TLSS_EXT.4.2[FCS_TLSS_EXT.4.2]

The link:#abbr_TSF[TSF] shall, when negotiating a link:#abbr_TLS[TLS]
1.2 session, [*selection*: [#_s_420 .selectable-content]#include the
renegotiation_info extension in server hello messages when a client
hello with the renegotiation_info extension is received and shall
terminate a session if neither of the renegotiation_info or
TLS_EMPTY_RENEGOTIATION_INFO_SCSV signaling ciphersuites are indicated
in the client hello#, [#_s_421 .selectable-content]#not allow
renegotiation# ].

[[FCS_TLSS_EXT.4.3]]
link:#FCS_TLSS_EXT.4.3[FCS_TLSS_EXT.4.3]

The link:#abbr_TSF[TSF] shall terminate the session if an unexpected
client hello is received during an active link:#abbr_TLS[TLS] session.

[.note-header]#Application Note: #[.note]# #

This link:#abbr_SFR[SFR] is claimed if "link:#abbr_TLS[TLS] as a server"
is selected in link:#FCS_TLS_EXT.1.1[FCS_TLS_EXT.1.1].

link:#abbr_RFC[RFC] 5746 defines an extension to link:#abbr_TLS[TLS] 1.2
that binds renegotiation handshakes to the cryptography in the original
handshake. As a refinement of the link:#abbr_RFC[RFC], servers that
support renegotiation and negotiating link:#abbr_TLS[TLS] 1.2 will
terminate a session if neither of the methods described in
link:#abbr_RFC[RFC] 5746 are offered by the client. link:#abbr_RFC[RFC]
5746 indicates that a server negotiating link:#abbr_TLS[TLS] 1.2 is
required to terminate the session if the conditions for secure
renegotiation are not met. Alternatively, a link:#abbr_TLS[TLS] server
may negotiate link:#abbr_TLS[TLS] 1.2 without any link:#abbr_RFC[RFC]
5746 client renegotiation indicators if it always terminates an existing
session when a new client hello is received, similar to the
implementation of link:#abbr_TLS[TLS] 1.3.

link:#abbr_TLS[TLS] 1.3 does not allow renegotiation. Termination, as
indicated in link:#FCS_TLSS_EXT.4.3[FCS_TLSS_EXT.4.3], covers
link:#abbr_TLS[TLS] 1.3 sessions as well as link:#abbr_TLS[TLS] 1.2
sessions where the client hello received does not comply with
link:#abbr_RFC[RFC] 5746, or when configured to reject renegotiation (if
the product is configurable).

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_TLSS_EXT.4[FCS_TLSS_EXT.4]

link:#abbr_TSS[TSS]

The evaluator shall examine the link:#abbr_ST[ST] to confirm that the
link:#abbr_TLS[TLS] description includes details on session
renegotiation protection methods supported, to include when
renegotiation is prohibited.

Guidance

The evaluator shall examine the operational guidance to confirm that any
instructions that are needed to meet the requirements are included. If
support for link:#abbr_TLS[TLS] 1.2 is configurable to use
link:#abbr_RFC[RFC] 5746 methods or to deny renegotiation, the evaluator
shall ensure that the operational guidance includes instructions for
configuring the link:#abbr_TSF[TSF] in this manner.

Tests

The evaluator shall perform the following tests, as indicated for each
version supported, using a test link:#abbr_TLS[TLS] client able to
construct the indicated messages and expose messages received from the
link:#abbr_TSF[TSF]: [.testlist-]##

* link:#_t_117[Test FCS_TLSS_EXT.4:1]: (link:#abbr_RFC[RFC] 5746
compliant link:#abbr_TLS[TLS] 1.2 initial handshake) [conditional] If
the link:#abbr_TSF[TSF] supports renegotiation, the evaluator shall
follow the operational guidance as necessary to configure the
link:#abbr_TSF[TSF] to enforce link:#abbr_RFC[RFC] 5746 methods. The
evaluator shall initiate a link:#abbr_TLS[TLS] 1.2 session from a test
link:#abbr_TLS[TLS] client for each of the following sub-tests:
[.testlist-]##
** link:#_t_118[Test FCS_TLSS_EXT.4:1.1]: The evaluator shall send an
initial client hello without the renegotiation_info extension and
without including the signaling ciphersuite value,
TLS_EMPTY_RENEGOTIATION_INFO_SCSV. The evaluator shall observe that the
link:#abbr_TSF[TSF] terminates the session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., handshake failure) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).
** link:#_t_119[Test FCS_TLSS_EXT.4:1.2]: The evaluator shall send an
initial client hello with the renegotiation_info extension indicating a
renegotiated_connection length greater than zero. The evaluator shall
observe that the link:#abbr_TSF[TSF] terminates the session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., handshake failure) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).
* link:#_t_120[Test FCS_TLSS_EXT.4:2]: (renegotiation attempt) For each
of the following sub-tests, the evaluator shall establish a compliant
link:#abbr_TLS[TLS] channel with an initial handshake that uses the
indicated secure renegotiation method for the version indicated. Without
closing the session, the evaluator shall send a second client hello
within the channel specific to the version as indicated: [.testlist-]##
** link:#_t_121[Test FCS_TLSS_EXT.4:2.1]: [conditional] If the
link:#abbr_TSF[TSF] allows renegotiation, the evaluator shall configure
the link:#abbr_TSF[TSF] to support link:#abbr_RFC[RFC] 5746 methods,
send an initial handshake with a valid renegotiation extension, send a
new link:#abbr_TLS[TLS] 1.2 client hello on the link:#abbr_TLS[TLS] 1.2
channel containing the renegotiation_info extension indicating valid
client_verify_data, and observe the link:#abbr_TSF[TSF] successfully
completes the handshake.
** link:#_t_122[Test FCS_TLSS_EXT.4:2.2]: [conditional] If the
link:#abbr_TSF[TSF] allows renegotiation, the evaluator shall send an
initial client hello containing a valid renegotiation extension, send a
new link:#abbr_TLS[TLS] 1.2 client hello on the link:#abbr_TLS[TLS] 1.2
channel with the signaling ciphersuite value, TLS_
EMPTY_RENEGOTIATION_INFO_SCSV, and observe that the link:#abbr_TSF[TSF]
terminates the session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., handshake failure) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).
** link:#_t_123[Test FCS_TLSS_EXT.4:2.3]: [conditional] If the
link:#abbr_TSF[TSF] allows renegotiation, for each link:#abbr_TLS[TLS]
1.2 renegotiation method claimed in accordance with link:#abbr_RFC[RFC]
5746, the evaluator shall send an initial client hello indicating the
method, send a new link:#abbr_TLS[TLS] 1.2 client hello on the
link:#abbr_TLS[TLS] 1.2 channel without a renegotiation_info extension,
and observe that the link:#abbr_TSF[TSF] terminates the session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., unexpected message) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).
** link:#_t_124[Test FCS_TLSS_EXT.4:2.4]: [conditional]: If the
link:#abbr_TSF[TSF] allows renegotiation, for each link:#abbr_TLS[TLS]
1.2 renegotiation method claimed in accordance with link:#abbr_RFC[RFC]
5746, the evaluator shall send an initial client hello indicating the
method, send a new link:#abbr_TLS[TLS] 1.2 client hello on the
link:#abbr_TLS[TLS] 1.2 channel with a renegotiation_info extension
indicating an invalid client_verify_data value (modify a byte of a valid
value), and observe that the link:#abbr_TSF[TSF] terminates the session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., unexpected message) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).
** link:#_t_125[Test FCS_TLSS_EXT.4:2.5]: [conditional] If the
link:#abbr_TSF[TSF] supports link:#abbr_TLS[TLS] 1.3, or if the
link:#abbr_TSF[TSF] rejects renegotiation for link:#abbr_TLS[TLS] 1.2,
then for each such version, the evaluator shall follow the operational
guidance as necessary to configure the link:#abbr_TSF[TSF] to negotiate
the version and reject renegotiation. The evaluator shall initiate a
valid initial session for the specified version, send a valid client
hello on the non-renegotiable link:#abbr_TLS[TLS] channel, and observe
that the link:#abbr_TSF[TSF] terminates the session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., unexpected message) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).

[[FCS_TLSS_EXT.5]]
==== FCS_TLSS_EXT.5 TLS Server Support for Session Resumption

*_The inclusion of this selection-based component depends upon selection
in link:#FCS_TLSS_EXT.1.1[FCS_TLSS_EXT.1.1]._*

[[FCS_TLSS_EXT.5.1]]
link:#FCS_TLSS_EXT.5.1[FCS_TLSS_EXT.5.1]

The link:#abbr_TSF[TSF] shall support session resumption as a server via
the use of [*selection*: [#_s_422 .selectable-content]#session ID in
accordance with link:#abbr_RFC[RFC] 5246#,
[#_s_423 .selectable-content]#tickets in accordance with
link:#abbr_RFC[RFC] 5077#,
[#tlss_v13_resumption .selectable-content]#PSK and tickets in accordance
with link:#abbr_RFC[RFC] 8446# ].

[.note-header]#Application Note: #[.note]# #

This link:#abbr_SFR[SFR] is claimed if "session resumption" is selected
in link:#FCS_TLSS_EXT.1.1[FCS_TLSS_EXT.1.1].

The link:#abbr_ST[ST] author indicates which session resumption
mechanisms are supported. One or both of the first two options, "session
ID in accordance with link:#abbr_RFC[RFC] 5246" and "tickets in
accordance with link:#abbr_RFC[RFC] 5077" are claimed for
link:#abbr_TLS[TLS] 1.2 resumption. If resumption of link:#abbr_TLS[TLS]
1.3 sessions is supported, "PSK and tickets in accordance with
link:#abbr_RFC[RFC] 8446" is selected, and the selection-based
link:#abbr_SFR[SFR] link:#FCS_TLSS_EXT.6[FCS_TLSS_EXT.6] must also be
claimed.

While it is possible to perform session resumption using PSK
ciphersuites in link:#abbr_TLS[TLS] 1.2, this is uncommon. Validation of
key exchange and session negotiation rules for PSK ciphersuites is
independent of the source of the pre-shared key and is covered in
link:#FCS_TLSS_EXT.1[FCS_TLSS_EXT.1].

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_TLSS_EXT.5[FCS_TLSS_EXT.5]

link:#abbr_TSS[TSS]

The evaluator shall examine the link:#abbr_ST[ST] and confirm that the
link:#abbr_TLS[TLS] server protocol description includes a description
of the supported resumption mechanisms.

Guidance

The evaluator shall ensure the operational guidance describes
instructions for any configurable features of the resumption mechanism.

Tests

The evaluator shall perform the following tests: [.testlist-]##

* link:#tls-server-successful-resumption[Test FCS_TLSS_EXT.5:1]: For
each supported version, and for each supported resumption method for
that version, the evaluator shall establish a compliant initial
link:#abbr_TLS[TLS] session with the link:#abbr_TOE[TOE] for the version
using the specified method. The evaluator shall close the successful
session and initiate resumption using the specified mechanism. The
evaluator shall observe that the link:#abbr_TSF[TSF] successfully
establishes the resumed session in accordance with the requirements.
* link:#_t_127[Test FCS_TLSS_EXT.5:2]: For each supported version and
each supported resumption method for that version, the evaluator shall
send a compliant client hello message supporting only the specific
version and indicating support for the resumption method. The evaluator
shall allow the link:#abbr_TOE[TOE] and test client to continue with the
compliant handshake until resumption information is established but then
cause a fatal error to terminate the session. The evaluator shall then
send a new client hello in an attempt to resume the session with the
resumption information provided and verify that the link:#abbr_TSF[TSF]
does not resume the session, but instead either terminates the session
or completes a full handshake, ignoring the resumption information.
+
*Note:* For link:#abbr_TLS[TLS] 1.2, resumption information should be
established at the point the link:#abbr_TSF[TSF] sends a server hello,
either acknowledging the session-based resumption or acknowledging
support for ticket-based resumption and sending a new_ticket message. A
link:#abbr_TLS[TLS] 1.2 session can then be terminated by sending a
modified finished message. For link:#abbr_TLS[TLS] 1.3, the new_ticket
message is sent after the finished message; once received by the client,
the session can be terminated by modifying a byte of the encrypted
application data.

[[FCS_TLSS_EXT.6]]
==== FCS_TLSS_EXT.6 TLS Server TLS 1.3 Resumption Refinements

*_The inclusion of this selection-based component depends upon selection
in link:#FCS_TLSS_EXT.5.1[FCS_TLSS_EXT.5.1]._*

[[FCS_TLSS_EXT.6.1]]
link:#FCS_TLSS_EXT.6.1[FCS_TLSS_EXT.6.1]

The link:#abbr_TSF[TSF] shall support link:#abbr_TLS[TLS] 1.3 resumption
using PSK with psk_key_exchange_mode extension with the value
psk_dhe_ke.

[[FCS_TLSS_EXT.6.2]]
link:#FCS_TLSS_EXT.6.2[FCS_TLSS_EXT.6.2]

The link:#abbr_TSF[TSF] shall ignore early data received in
link:#abbr_TLS[TLS] 1.3 sessions.

[.note-header]#Application Note: #[.note]# #

This link:#abbr_SFR[SFR] is claimed if "PSK and tickets in accordance
with link:#abbr_RFC[RFC] 8446" is selected in
link:#FCS_TLSS_EXT.5.1[FCS_TLSS_EXT.5.1].

link:#abbr_RFC[RFC] 8446 allows pre-shared keys to be used directly and
also allows early data to be protected using only the pre-shared key.
This link:#abbr_SFR[SFR] refines the link:#abbr_RFC[RFC] to use PSK only
with a supplemental link:#abbr_DHE[DHE] or link:#abbr_ECDHE[ECDHE] key
exchange to ensure perfect forward secrecy for all sessions.

link:#[[.activity_pane_label]# Evaluation Activities #[.toggler]##]

link:#FCS_TLSS_EXT.6[FCS_TLSS_EXT.6]

link:#abbr_TSS[TSS]

The evaluator shall examine the link:#abbr_ST[ST] to confirm that the
link:#abbr_TLS[TLS] description includes details on session resumption
for link:#abbr_TLS[TLS] 1.3, describes each application capable of using
link:#abbr_TLS[TLS] 1.3 with PSK, and describes how the
link:#abbr_TSF[TSF] and application respond to client attempts to use
early data (including via logging or observable responses). The
evaluator shall confirm that the link:#abbr_TLS[TLS] description shows
that only the psk_dhe_ke psk_key_exchange_mode is supported and that
early information is ignored.

Guidance

The evaluator shall examine the operational guidance to verify that
instructions for any configurable features that are required to meet the
requirement are included.

Tests

The evaluator shall follow the operational guidance to configure the
link:#abbr_TSF[TSF] to negotiate link:#abbr_TLS[TLS] 1.3 and shall
perform the following tests: [.testlist-]##

* link:#_t_128[Test FCS_TLSS_EXT.6:1]: The evaluator shall attempt a
resumed session (as for link:#FCS_TLSS_EXT.5[FCS_TLSS_EXT.5]
link:#tls-server-successful-resumption[Test FCS_TLSS_EXT.5:1]) but using
psk_ke mode as the value for the psk_key_exchange_mode in the resumption
client hello. The evaluator shall observe that the link:#abbr_TSF[TSF]
refuses to resume the session, either by completing a full
link:#abbr_TLS[TLS] 1.3 handshake or by terminating the session.
+
*Note:* It is preferred that the link:#abbr_TSF[TSF] sends a fatal error
alert message (e.g., illegal parameter) in response to this, but it is
acceptable that the link:#abbr_TSF[TSF] terminates the connection
silently (i.e., without sending a fatal error alert).
* link:#_t_129[Test FCS_TLSS_EXT.6:2]: The evaluator shall initiate a
resumed session (as for link:#FCS_TLSS_EXT.5[FCS_TLSS_EXT.5]
link:#tls-server-successful-resumption[Test FCS_TLSS_EXT.5:1]) with a
test link:#abbr_TLS[TLS] 1.3 client attempting to provide early data
that provokes a known reaction at the link:#abbr_TOE[TOE] if received.
The evaluator shall observe that the link:#abbr_TSF[TSF] does not react
to the early data, indicating that the data was ignored.
+
*Note:* The specific early data used may depend on the applications
calling the link:#abbr_TLS[TLS] session and should be selected to
initiate an observable response in the link:#abbr_TSF[TSF] or calling
application as described in the link:#abbr_ST[ST]. For HTTPS, for
example, the early data can be an link:#abbr_HTTP[HTTP] POST that
updates data at the link:#abbr_TOE[TOE], which can then be observed via
a user interface for the application if the data was posted or via
application logging indicating that the operation failed.

[[acronyms]]
== Appendix C - Acronyms

[cols=",",]
|===
|Acronym |Meaning

|[#abbr_AES .term]#link:#abbr_AES[AES]# |[#long_abbr_AES]#Advanced
Encryption Standard#

|[#abbr_Base-PP .term]#link:#abbr_Base-PP[Base-PP]#
|[#long_abbr_Base-PP]#Base Protection Profile#

|[#abbr_CA .term]#link:#abbr_CA[CA]# |[#long_abbr_CA]#Certificate
Authority#

|[#abbr_CBC .term]#link:#abbr_CBC[CBC]# |[#long_abbr_CBC]#Cipher Block
Chaining#

|[#abbr_CC .term]#link:#abbr_CC[CC]# |[#long_abbr_CC]#Common Criteria#

|[#abbr_CEM .term]#link:#abbr_CEM[CEM]# |[#long_abbr_CEM]#Common
Evaluation Methodology#

|[#abbr_CN .term]#link:#abbr_CN[CN]# |[#long_abbr_CN]#Common Name#

|[#abbr_cPP .term]#link:#abbr_cPP[cPP]# |[#long_abbr_cPP]#Collaborative
Protection Profile#

|[#abbr_DHE .term]#link:#abbr_DHE[DHE]# |[#long_abbr_DHE]#Diffie-Hellman
Ephemeral#

|[#abbr_DN .term]#link:#abbr_DN[DN]# |[#long_abbr_DN]#Distinguished
Name#

|[#abbr_DNS .term]#link:#abbr_DNS[DNS]# |[#long_abbr_DNS]#Domain Name
Server#

|[#abbr_DTLS .term]#link:#abbr_DTLS[DTLS]# |[#long_abbr_DTLS]#Datagram
Transport Layer Security#

|[#abbr_EAP .term]#link:#abbr_EAP[EAP]# |[#long_abbr_EAP]#Extensible
Authentication Protocol#

|[#abbr_ECDHE .term]#link:#abbr_ECDHE[ECDHE]#
|[#long_abbr_ECDHE]#Elliptic Curve Diffie-Hellman Ephemeral#

|[#abbr_ECDSA .term]#link:#abbr_ECDSA[ECDSA]#
|[#long_abbr_ECDSA]#Elliptic Curve Digital Signature Algorithm#

|[#abbr_EP .term]#link:#abbr_EP[EP]# |[#long_abbr_EP]#Extended Package#

|[#abbr_FP .term]#link:#abbr_FP[FP]# |[#long_abbr_FP]#Functional
Package#

|[#abbr_GCM .term]#link:#abbr_GCM[GCM]# |[#long_abbr_GCM]#Galois/Counter
Mode#

|[#abbr_HTTP .term]#link:#abbr_HTTP[HTTP]# |[#long_abbr_HTTP]#Hypertext
Transfer Protocol#

|[#abbr_IETF .term]#link:#abbr_IETF[IETF]# |[#long_abbr_IETF]#Internet
Engineering Task Force#

|[#abbr_IP .term]#link:#abbr_IP[IP]# |[#long_abbr_IP]#Internet Protocol#

|[#abbr_NIST .term]#link:#abbr_NIST[NIST]# |[#long_abbr_NIST]#National
Institute of Standards and Technology#

|[#abbr_OE .term]#link:#abbr_OE[OE]# |[#long_abbr_OE]#Operational
Environment#

|[#abbr_PP .term]#link:#abbr_PP[PP]# |[#long_abbr_PP]#Protection
Profile#

|[#abbr_PP-Configuration .term]#link:#abbr_PP-Configuration[PP-Configuration]#
|[#long_abbr_PP-Configuration]#Protection Profile Configuration#

|[#abbr_PP-Module .term]#link:#abbr_PP-Module[PP-Module]#
|[#long_abbr_PP-Module]#Protection Profile Module#

|[#abbr_RFC .term]#link:#abbr_RFC[RFC]# |[#long_abbr_RFC]#Request for
Comment (link:#abbr_IETF[IETF])#

|[#abbr_RSA .term]#link:#abbr_RSA[RSA]# |[#long_abbr_RSA]#Rivest Shamir
Adelman#

|[#abbr_SAN .term]#link:#abbr_SAN[SAN]# |[#long_abbr_SAN]#Subject
Alternative Name#

|[#abbr_SAR .term]#link:#abbr_SAR[SAR]# |[#long_abbr_SAR]#Security
Assurance Requirement#

|[#abbr_SCSV .term]#link:#abbr_SCSV[SCSV]# |[#long_abbr_SCSV]#Signaling
ciphersuite Value#

|[#abbr_SFR .term]#link:#abbr_SFR[SFR]# |[#long_abbr_SFR]#Security
Functional Requirement#

|[#abbr_SHA .term]#link:#abbr_SHA[SHA]# |[#long_abbr_SHA]#Secure Hash
Algorithm#

|[#abbr_ST .term]#link:#abbr_ST[ST]# |[#long_abbr_ST]#Security Target#

|[#abbr_TCP .term]#link:#abbr_TCP[TCP]# |[#long_abbr_TCP]#Transmission
Control Protocol#

|[#abbr_TLS .term]#link:#abbr_TLS[TLS]# |[#long_abbr_TLS]#Transport
Layer Security#

|[#abbr_TOE .term]#link:#abbr_TOE[TOE]# |[#long_abbr_TOE]#Target of
Evaluation#

|[#abbr_TSF .term]#link:#abbr_TSF[TSF]#
|[#long_abbr_TSF]#link:#abbr_TOE[TOE] Security Functionality#

|[#abbr_TSFI .term]#link:#abbr_TSFI[TSFI]#
|[#long_abbr_TSFI]#link:#abbr_TSF[TSF] Interface#

|[#abbr_TSS .term]#link:#abbr_TSS[TSS]#
|[#long_abbr_TSS]#link:#abbr_TOE[TOE] Summary Specification#

|[#abbr_UDP .term]#link:#abbr_UDP[UDP]# |[#long_abbr_UDP]#User Datagram
Protocol#

|[#abbr_URI .term]#link:#abbr_URI[URI]# |[#long_abbr_URI]#Uniform
Resource Identifier#

|[#abbr_URL .term]#link:#abbr_URL[URL]# |[#long_abbr_URL]#Uniform
Resource Locator#
|===

[[appendix-bibliography]]
== Appendix D - Bibliography

[width="100%",cols="50%,50%",]
|===
|Identifier |Title

|[#bibCC]#[link:#abbr_CC[CC]]# a|
[.description]#Common Criteria for Information Technology Security
Evaluation - #

* http://www.commoncriteriaportal.org/files/ccfiles/CCPART1V3.1R5.pdf[Part
1: Introduction and General Model], CCMB-2017-04-001, Version 3.1
Revision 5, April 2017.
* http://www.commoncriteriaportal.org/files/ccfiles/CCPART2V3.1R5.pdf[Part
2: Security Functional Components], CCMB-2017-04-002, Version 3.1
Revision 5, April 2017.
* http://www.commoncriteriaportal.org/files/ccfiles/CCPART3V3.1R5.pdf[Part
3: Security Assurance Components], CCMB-2017-04-003, Version 3.1
Revision 5, April 2017.

|===
